"use strict";(self.webpackChunkgeostat_tw=self.webpackChunkgeostat_tw||[]).push([[179],{881:()=>{function qt(n){return"function"==typeof n}function hu(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const qh=hu(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function nl(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class Ni{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._teardowns=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(qt(i))try{i()}catch(s){e=s instanceof qh?s.errors:[s]}const{_teardowns:r}=this;if(r){this._teardowns=null;for(const s of r)try{IC(s)}catch(o){e=null!=e?e:[],o instanceof qh?e=[...e,...o.errors]:e.push(o)}}if(e)throw new qh(e)}}add(e){var t;if(e&&e!==this)if(this.closed)IC(e);else{if(e instanceof Ni){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._teardowns=null!==(t=this._teardowns)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&nl(t,e)}remove(e){const{_teardowns:t}=this;t&&nl(t,e),e instanceof Ni&&e._removeParent(this)}}Ni.EMPTY=(()=>{const n=new Ni;return n.closed=!0,n})();const DC=Ni.EMPTY;function AC(n){return n instanceof Ni||n&&"closed"in n&&qt(n.remove)&&qt(n.add)&&qt(n.unsubscribe)}function IC(n){qt(n)?n():n.unsubscribe()}const Jo={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Yh={setTimeout(...n){const{delegate:e}=Yh;return((null==e?void 0:e.setTimeout)||setTimeout)(...n)},clearTimeout(n){const{delegate:e}=Yh;return((null==e?void 0:e.clearTimeout)||clearTimeout)(n)},delegate:void 0};function RC(n){Yh.setTimeout(()=>{const{onUnhandledError:e}=Jo;if(!e)throw n;e(n)})}function fu(){}const yO=l_("C",void 0,void 0);function l_(n,e,t){return{kind:n,value:e,error:t}}let Ko=null;function Xh(n){if(Jo.useDeprecatedSynchronousErrorHandling){const e=!Ko;if(e&&(Ko={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=Ko;if(Ko=null,t)throw i}}else n()}class c_ extends Ni{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,AC(e)&&e.add(this)):this.destination=xO}static create(e,t,i){return new Qh(e,t,i)}next(e){this.isStopped?d_(function wO(n){return l_("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?d_(function vO(n){return l_("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?d_(yO,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}class Qh extends c_{constructor(e,t,i){let r;if(super(),qt(e))r=e;else if(e){let s;({next:r,error:t,complete:i}=e),this&&Jo.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe()):s=e,r=null==r?void 0:r.bind(s),t=null==t?void 0:t.bind(s),i=null==i?void 0:i.bind(s)}this.destination={next:r?u_(r):fu,error:u_(null!=t?t:PC),complete:i?u_(i):fu}}}function u_(n,e){return(...t)=>{try{n(...t)}catch(i){Jo.useDeprecatedSynchronousErrorHandling?function bO(n){Jo.useDeprecatedSynchronousErrorHandling&&Ko&&(Ko.errorThrown=!0,Ko.error=n)}(i):RC(i)}}}function PC(n){throw n}function d_(n,e){const{onStoppedNotification:t}=Jo;t&&Yh.setTimeout(()=>t(n,e))}const xO={closed:!0,next:fu,error:PC,complete:fu},h_="function"==typeof Symbol&&Symbol.observable||"@@observable";function Zo(n){return n}let en=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const s=function MO(n){return n&&n instanceof c_||function CO(n){return n&&qt(n.next)&&qt(n.error)&&qt(n.complete)}(n)&&AC(n)}(t)?t:new Qh(t,i,r);return Xh(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=LC(i))((r,s)=>{let o;o=this.subscribe(a=>{try{t(a)}catch(l){s(l),null==o||o.unsubscribe()}},s,r)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[h_](){return this}pipe(...t){return function NC(n){return 0===n.length?Zo:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}(t)(this)}toPromise(t){return new(t=LC(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function LC(n){var e;return null!==(e=null!=n?n:Jo.Promise)&&void 0!==e?e:Promise}const SO=hu(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let gr=(()=>{class n extends en{constructor(){super(),this.closed=!1,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new OC(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new SO}next(t){Xh(()=>{if(this._throwIfClosed(),!this.isStopped){const i=this.observers.slice();for(const r of i)r.next(t)}})}error(t){Xh(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){Xh(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:s}=this;return i||r?DC:(s.push(t),new Ni(()=>nl(s,t)))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:s}=this;i?t.error(r):s&&t.complete()}asObservable(){const t=new en;return t.source=this,t}}return n.create=(e,t)=>new OC(e,t),n})();class OC extends gr{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:DC}}function FC(n){return qt(null==n?void 0:n.lift)}function Ln(n){return e=>{if(FC(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}class Mn extends c_{constructor(e,t,i,r,s){super(e),this.onFinalize=s,this._next=t?function(o){try{t(o)}catch(a){e.error(a)}}:super._next,this._error=r?function(o){try{r(o)}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(o){e.error(o)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}function tt(n,e){return Ln((t,i)=>{let r=0;t.subscribe(new Mn(i,s=>{i.next(n.call(e,s,r++))}))})}function ea(n){return this instanceof ea?(this.v=n,this):new ea(n)}function DO(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(n,e||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(h){i[h]&&(r[h]=function(f){return new Promise(function(p,_){s.push([h,f,p,_])>1||a(h,f)})})}function a(h,f){try{!function l(h){h.value instanceof ea?Promise.resolve(h.value.v).then(c,u):d(s[0][2],h)}(i[h](f))}catch(p){d(s[0][3],p)}}function c(h){a("next",h)}function u(h){a("throw",h)}function d(h,f){h(f),s.shift(),s.length&&a(s[0][0],s[0][1])}}function AO(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function VC(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(o){return new Promise(function(a,l){!function r(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}(a,l,(o=n[s](o)).done,o.value)})}}}const UC=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function HC(n){return qt(null==n?void 0:n.then)}function zC(n){return qt(n[h_])}function GC(n){return Symbol.asyncIterator&&qt(null==n?void 0:n[Symbol.asyncIterator])}function WC(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const jC=function RO(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function $C(n){return qt(null==n?void 0:n[jC])}function qC(n){return DO(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:r}=yield ea(t.read());if(r)return yield ea(void 0);yield yield ea(i)}}finally{t.releaseLock()}})}function YC(n){return qt(null==n?void 0:n.getReader)}function Br(n){if(n instanceof en)return n;if(null!=n){if(zC(n))return function PO(n){return new en(e=>{const t=n[h_]();if(qt(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(UC(n))return function NO(n){return new en(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(HC(n))return function LO(n){return new en(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,RC)})}(n);if(GC(n))return XC(n);if($C(n))return function OO(n){return new en(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(YC(n))return function FO(n){return XC(qC(n))}(n)}throw WC(n)}function XC(n){return new en(e=>{(function kO(n,e){var t,i,r,s;return function EO(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(d){o(d)}}function l(u){try{c(i.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=AO(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function gs(n,e,t,i=0,r=!1){const s=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function sn(n,e,t=1/0){return qt(e)?sn((i,r)=>tt((s,o)=>e(i,s,r,o))(Br(n(i,r))),t):("number"==typeof e&&(t=e),Ln((i,r)=>function BO(n,e,t,i,r,s,o,a){const l=[];let c=0,u=0,d=!1;const h=()=>{d&&!l.length&&!c&&e.complete()},f=_=>c<i?p(_):l.push(_),p=_=>{s&&e.next(_),c++;let y=!1;Br(t(_,u++)).subscribe(new Mn(e,g=>{null==r||r(g),s?f(g):e.next(g)},()=>{y=!0},void 0,()=>{if(y)try{for(c--;l.length&&c<i;){const g=l.shift();o?gs(e,o,()=>p(g)):p(g)}h()}catch(g){e.error(g)}}))};return n.subscribe(new Mn(e,f,()=>{d=!0,h()})),()=>{null==a||a()}}(i,r,n,t)))}function pu(n=1/0){return sn(Zo,n)}const _s=new en(n=>n.complete());function QC(n){return n&&qt(n.schedule)}function p_(n){return n[n.length-1]}function JC(n){return qt(p_(n))?n.pop():void 0}function mu(n){return QC(p_(n))?n.pop():void 0}function KC(n,e=0){return Ln((t,i)=>{t.subscribe(new Mn(i,r=>gs(i,n,()=>i.next(r),e),()=>gs(i,n,()=>i.complete(),e),r=>gs(i,n,()=>i.error(r),e)))})}function ZC(n,e=0){return Ln((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function eM(n,e){if(!n)throw new Error("Iterable cannot be null");return new en(t=>{gs(t,e,()=>{const i=n[Symbol.asyncIterator]();gs(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function On(n,e){return e?function $O(n,e){if(null!=n){if(zC(n))return function HO(n,e){return Br(n).pipe(ZC(e),KC(e))}(n,e);if(UC(n))return function GO(n,e){return new en(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(HC(n))return function zO(n,e){return Br(n).pipe(ZC(e),KC(e))}(n,e);if(GC(n))return eM(n,e);if($C(n))return function WO(n,e){return new en(t=>{let i;return gs(t,e,()=>{i=n[jC](),gs(t,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>qt(null==i?void 0:i.return)&&i.return()})}(n,e);if(YC(n))return function jO(n,e){return eM(qC(n),e)}(n,e)}throw WC(n)}(n,e):Br(n)}function Li(n){return n<=0?()=>_s:Ln((e,t)=>{let i=0;e.subscribe(new Mn(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function m_(n,e,...t){return!0===e?(n(),null):!1===e?null:e(...t).pipe(Li(1)).subscribe(()=>n())}function Ht(n){for(let e in n)if(n[e]===Ht)return e;throw Error("Could not find renamed property on target object.")}function g_(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Lt(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Lt).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function __(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const XO=Ht({__forward_ref__:Ht});function Yt(n){return n.__forward_ref__=Yt,n.toString=function(){return Lt(this())},n}function nt(n){return tM(n)?n():n}function tM(n){return"function"==typeof n&&n.hasOwnProperty(XO)&&n.__forward_ref__===Yt}class Ct extends Error{constructor(e,t){super(function y_(n,e){return`NG0${Math.abs(n)}${e?": "+e:""}`}(e,t)),this.code=e}}function Xe(n){return"string"==typeof n?n:null==n?"":String(n)}function di(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Xe(n)}function Jh(n,e){const t=e?` in ${e}`:"";throw new Ct(-201,`No provider for ${di(n)} found${t}`)}function Fi(n,e){null==n&&function tn(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function Ne(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function ki(n){return{providers:n.providers||[],imports:n.imports||[]}}function v_(n){return nM(n,Kh)||nM(n,rM)}function nM(n,e){return n.hasOwnProperty(e)?n[e]:null}function iM(n){return n&&(n.hasOwnProperty(w_)||n.hasOwnProperty(nF))?n[w_]:null}const Kh=Ht({\u0275prov:Ht}),w_=Ht({\u0275inj:Ht}),rM=Ht({ngInjectableDef:Ht}),nF=Ht({ngInjectorDef:Ht});var $e=(()=>(($e=$e||{})[$e.Default=0]="Default",$e[$e.Host=1]="Host",$e[$e.Self=2]="Self",$e[$e.SkipSelf=4]="SkipSelf",$e[$e.Optional=8]="Optional",$e))();let b_;function Zs(n){const e=b_;return b_=n,e}function sM(n,e,t){const i=v_(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&$e.Optional?null:void 0!==e?e:void Jh(Lt(n),"Injector")}function eo(n){return{toString:n}.toString()}var _r=(()=>((_r=_r||{})[_r.OnPush=0]="OnPush",_r[_r.Default=1]="Default",_r))(),Vr=(()=>{return(n=Vr||(Vr={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",Vr;var n})();const rF="undefined"!=typeof globalThis&&globalThis,sF="undefined"!=typeof window&&window,oF="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Bt=rF||"undefined"!=typeof global&&global||sF||oF,il={},zt=[],Zh=Ht({\u0275cmp:Ht}),x_=Ht({\u0275dir:Ht}),C_=Ht({\u0275pipe:Ht}),oM=Ht({\u0275mod:Ht}),vs=Ht({\u0275fac:Ht}),gu=Ht({__NG_ELEMENT_ID__:Ht});let aF=0;function Ci(n){return eo(()=>{const t={},i={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===_r.OnPush,directiveDefs:null,pipeDefs:null,selectors:n.selectors||zt,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||Vr.Emulated,id:"c",styles:n.styles||zt,_:null,setInput:null,schemas:n.schemas||null,tView:null},r=n.directives,s=n.features,o=n.pipes;return i.id+=aF++,i.inputs=uM(n.inputs,t),i.outputs=uM(n.outputs),s&&s.forEach(a=>a(i)),i.directiveDefs=r?()=>("function"==typeof r?r():r).map(aM):null,i.pipeDefs=o?()=>("function"==typeof o?o():o).map(lM):null,i})}function aM(n){return ti(n)||function to(n){return n[x_]||null}(n)}function lM(n){return function ta(n){return n[C_]||null}(n)}const cM={};function Zi(n){return eo(()=>{const e={type:n.type,bootstrap:n.bootstrap||zt,declarations:n.declarations||zt,imports:n.imports||zt,exports:n.exports||zt,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null};return null!=n.id&&(cM[n.id]=n.type),e})}function uM(n,e){if(null==n)return il;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,e&&(e[r]=s)}return t}const Ge=Ci;function Mi(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,onDestroy:n.type.prototype.ngOnDestroy||null}}function ti(n){return n[Zh]||null}function er(n,e){const t=n[oM]||null;if(!t&&!0===e)throw new Error(`Type ${Lt(n)} does not have '\u0275mod' property.`);return t}function Ur(n){return Array.isArray(n)&&"object"==typeof n[1]}function vr(n){return Array.isArray(n)&&!0===n[1]}function E_(n){return 0!=(8&n.flags)}function rf(n){return 2==(2&n.flags)}function sf(n){return 1==(1&n.flags)}function wr(n){return null!==n.template}function fF(n){return 0!=(512&n[2])}function sa(n,e){return n.hasOwnProperty(vs)?n[vs]:null}class gF{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function nr(){return hM}function hM(n){return n.type.prototype.ngOnChanges&&(n.setInput=yF),_F}function _F(){const n=pM(this),e=null==n?void 0:n.current;if(e){const t=n.previous;if(t===il)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function yF(n,e,t,i){const r=pM(n)||function vF(n,e){return n[fM]=e}(n,{previous:il,current:null}),s=r.current||(r.current={}),o=r.previous,a=this.declaredInputs[t],l=o[a];s[a]=new gF(l&&l.currentValue,e,o===il),n[i]=e}nr.ngInherit=!0;const fM="__ngSimpleChanges__";function pM(n){return n[fM]||null}let R_;function pn(n){return!!n.listen}const mM={createRenderer:(n,e)=>function P_(){return void 0!==R_?R_:"undefined"!=typeof document?document:void 0}()};function Sn(n){for(;Array.isArray(n);)n=n[0];return n}function of(n,e){return Sn(e[n])}function rr(n,e){return Sn(e[n.index])}function N_(n,e){return n.data[e]}function ll(n,e){return n[e]}function Vi(n,e){const t=e[n];return Ur(t)?t:t[0]}function gM(n){return 4==(4&n[2])}function L_(n){return 128==(128&n[2])}function no(n,e){return null==e?null:n[e]}function _M(n){n[18]=0}function O_(n,e){n[5]+=e;let t=n,i=n[3];for(;null!==i&&(1===e&&1===t[5]||-1===e&&0===t[5]);)i[5]+=e,t=i,i=i[3]}const We={lFrame:SM(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function yM(){return We.bindingsEnabled}function te(){return We.lFrame.lView}function Mt(){return We.lFrame.tView}function je(n){return We.lFrame.contextLView=n,n[8]}function Fn(){let n=vM();for(;null!==n&&64===n.type;)n=n.parent;return n}function vM(){return We.lFrame.currentTNode}function Hr(n,e){const t=We.lFrame;t.currentTNode=n,t.isParent=e}function F_(){return We.lFrame.isParent}function k_(){We.lFrame.isParent=!1}function af(){return We.isInCheckNoChangesMode}function lf(n){We.isInCheckNoChangesMode=n}function hi(){const n=We.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function cl(){return We.lFrame.bindingIndex++}function FF(n,e){const t=We.lFrame;t.bindingIndex=t.bindingRootIndex=n,B_(e)}function B_(n){We.lFrame.currentDirectiveIndex=n}function xM(){return We.lFrame.currentQueryIndex}function U_(n){We.lFrame.currentQueryIndex=n}function BF(n){const e=n[1];return 2===e.type?e.declTNode:1===e.type?n[6]:null}function CM(n,e,t){if(t&$e.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&$e.Host||(r=BF(s),null===r||(s=s[15],10&r.type))););if(null===r)return!1;e=r,n=s}const i=We.lFrame=MM();return i.currentTNode=e,i.lView=n,!0}function cf(n){const e=MM(),t=n[1];We.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function MM(){const n=We.lFrame,e=null===n?null:n.child;return null===e?SM(n):e}function SM(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function EM(){const n=We.lFrame;return We.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const TM=EM;function uf(){const n=EM();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function fi(){return We.lFrame.selectedIndex}function io(n){We.lFrame.selectedIndex=n}function mn(){const n=We.lFrame;return N_(n.tView,n.selectedIndex)}function df(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=s;o&&(n.contentHooks||(n.contentHooks=[])).push(-t,o),a&&((n.contentHooks||(n.contentHooks=[])).push(t,a),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(t,a)),l&&(n.viewHooks||(n.viewHooks=[])).push(-t,l),c&&((n.viewHooks||(n.viewHooks=[])).push(t,c),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(t,c)),null!=u&&(n.destroyHooks||(n.destroyHooks=[])).push(t,u)}}function hf(n,e,t){DM(n,e,3,t)}function ff(n,e,t,i){(3&n[2])===t&&DM(n,e,t,i)}function H_(n,e){let t=n[2];(3&t)===e&&(t&=2047,t+=1,n[2]=t)}function DM(n,e,t,i){const s=null!=i?i:-1,o=e.length-1;let a=0;for(let l=void 0!==i?65535&n[18]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=i&&a>=i)break}else e[l]<0&&(n[18]+=65536),(a<s||-1==s)&&(qF(n,t,e,l),n[18]=(4294901760&n[18])+l+2),l++}function qF(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];if(r){if(n[2]>>11<n[18]>>16&&(3&n[2])===e){n[2]+=2048;try{s.call(a)}finally{}}}else try{s.call(a)}finally{}}class bu{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function pf(n,e,t){const i=pn(n);let r=0;for(;r<t.length;){const s=t[r];if("number"==typeof s){if(0!==s)break;r++;const o=t[r++],a=t[r++],l=t[r++];i?n.setAttribute(e,a,l,o):e.setAttributeNS(o,a,l)}else{const o=s,a=t[++r];G_(o)?i&&n.setProperty(e,o,a):i?n.setAttribute(e,o,a):e.setAttribute(o,a),r++}}return r}function AM(n){return 3===n||4===n||6===n}function G_(n){return 64===n.charCodeAt(0)}function mf(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||IM(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function IM(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}function RM(n){return-1!==n}function ul(n){return 32767&n}function dl(n,e){let t=function KF(n){return n>>16}(n),i=e;for(;t>0;)i=i[15],t--;return i}let W_=!0;function gf(n){const e=W_;return W_=n,e}let ZF=0;function Cu(n,e){const t=$_(n,e);if(-1!==t)return t;const i=e[1];i.firstCreatePass&&(n.injectorIndex=e.length,j_(i.data,n),j_(e,null),j_(i.blueprint,null));const r=_f(n,e),s=n.injectorIndex;if(RM(r)){const o=ul(r),a=dl(r,e),l=a[1].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function j_(n,e){n.push(0,0,0,0,0,0,0,0,e)}function $_(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function _f(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){const s=r[1],o=s.type;if(i=2===o?s.declTNode:1===o?r[6]:null,null===i)return-1;if(t++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return-1}function yf(n,e,t){!function ek(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(gu)&&(i=t[gu]),null==i&&(i=t[gu]=ZF++);const r=255&i;e.data[n+(r>>5)]|=1<<r}(n,e,t)}function LM(n,e,t){if(t&$e.Optional)return n;Jh(e,"NodeInjector")}function OM(n,e,t,i){if(t&$e.Optional&&void 0===i&&(i=null),0==(t&($e.Self|$e.Host))){const r=n[9],s=Zs(void 0);try{return r?r.get(e,i,t&$e.Optional):sM(e,i,t&$e.Optional)}finally{Zs(s)}}return LM(i,e,t)}function FM(n,e,t,i=$e.Default,r){if(null!==n){const s=function rk(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(gu)?n[gu]:void 0;return"number"==typeof e?e>=0?255&e:nk:e}(t);if("function"==typeof s){if(!CM(e,n,i))return i&$e.Host?LM(r,t,i):OM(e,t,i,r);try{const o=s(i);if(null!=o||i&$e.Optional)return o;Jh(t)}finally{TM()}}else if("number"==typeof s){let o=null,a=$_(n,e),l=-1,c=i&$e.Host?e[16][6]:null;for((-1===a||i&$e.SkipSelf)&&(l=-1===a?_f(n,e):e[a+8],-1!==l&&VM(i,!1)?(o=e[1],a=ul(l),e=dl(l,e)):a=-1);-1!==a;){const u=e[1];if(BM(s,a,u.data)){const d=ik(a,e,t,o,i,c);if(d!==kM)return d}l=e[a+8],-1!==l&&VM(i,e[1].data[a+8]===c)&&BM(s,a,e)?(o=u,a=ul(l),e=dl(l,e)):a=-1}}}return OM(e,t,i,r)}const kM={};function nk(){return new hl(Fn(),te())}function ik(n,e,t,i,r,s){const o=e[1],a=o.data[n+8],u=vf(a,o,t,null==i?rf(a)&&W_:i!=o&&0!=(3&a.type),r&$e.Host&&s===a);return null!==u?Mu(e,o,u,a):kM}function vf(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,l=n.directiveStart,u=s>>20,h=r?a+u:n.directiveEnd;for(let f=i?a:a+u;f<h;f++){const p=o[f];if(f<l&&t===p||f>=l&&p.type===t)return f}if(r){const f=o[l];if(f&&wr(f)&&f.type===t)return l}return null}function Mu(n,e,t,i){let r=n[t];const s=e.data;if(function YF(n){return n instanceof bu}(r)){const o=r;o.resolving&&function QO(n,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new Ct(-200,`Circular dependency in DI detected for ${n}${t}`)}(di(s[t]));const a=gf(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?Zs(o.injectImpl):null;CM(n,i,$e.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function $F(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=hM(e);(t.preOrderHooks||(t.preOrderHooks=[])).push(n,o),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,o)}r&&(t.preOrderHooks||(t.preOrderHooks=[])).push(0-n,r),s&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n,s),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,s))}(t,s[t],e)}finally{null!==l&&Zs(l),gf(a),o.resolving=!1,TM()}}return r}function BM(n,e,t){return!!(t[e+(n>>5)]&1<<n)}function VM(n,e){return!(n&$e.Self||n&$e.Host&&e)}class hl{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return FM(this._tNode,this._lView,e,i,t)}}function ii(n){return eo(()=>{const e=n.prototype.constructor,t=e[vs]||q_(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[vs]||q_(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function q_(n){return tM(n)?()=>{const e=q_(nt(n));return e&&e()}:sa(n)}const pl="__parameters__";function gl(n,e,t){return eo(()=>{const i=function Y_(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,c,u){const d=l.hasOwnProperty(pl)?l[pl]:Object.defineProperty(l,pl,{value:[]})[pl];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}class lt{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=Ne({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}toString(){return`InjectionToken ${this._desc}`}}const ok=new lt("AnalyzeForEntryComponents");function sr(n,e){void 0===e&&(e=n);for(let t=0;t<n.length;t++){let i=n[t];Array.isArray(i)?(e===n&&(e=n.slice(0,t)),sr(i,e)):e!==n&&e.push(i)}return e}function zr(n,e){n.forEach(t=>Array.isArray(t)?zr(t,e):e(t))}function HM(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function wf(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function Ui(n,e,t){let i=_l(n,e);return i>=0?n[1|i]=t:(i=~i,function ck(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function Q_(n,e){const t=_l(n,e);if(t>=0)return n[1|t]}function _l(n,e){return function WM(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const s=i+(r-i>>1),o=n[s<<t];if(e===o)return s<<t;o>e?r=s:i=s+1}return~(r<<t)}(n,e,1)}const Au={},K_="__NG_DI_FLAG__",xf="ngTempTokenPath",gk=/\n/gm,$M="__source",yk=Ht({provide:String,useValue:Ht});let Iu;function qM(n){const e=Iu;return Iu=n,e}function vk(n,e=$e.Default){if(void 0===Iu)throw new Ct(203,"");return null===Iu?sM(n,void 0,e):Iu.get(n,e&$e.Optional?null:void 0,e)}function pe(n,e=$e.Default){return(function iF(){return b_}()||vk)(nt(n),e)}const wk=pe;function Z_(n){const e=[];for(let t=0;t<n.length;t++){const i=nt(n[t]);if(Array.isArray(i)){if(0===i.length)throw new Ct(900,"");let r,s=$e.Default;for(let o=0;o<i.length;o++){const a=i[o],l=bk(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(pe(r,s))}else e.push(pe(i))}return e}function Ru(n,e){return n[K_]=e,n.prototype[K_]=e,n}function bk(n){return n[K_]}const Cf=Ru(gl("Inject",n=>({token:n})),-1),so=Ru(gl("Optional"),8),Pu=Ru(gl("SkipSelf"),4);class nS{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function oo(n){return n instanceof nS?n.changingThisBreaksApplicationSecurity:n}const Gk=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Wk=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;var En=(()=>((En=En||{})[En.NONE=0]="NONE",En[En.HTML=1]="HTML",En[En.STYLE=2]="STYLE",En[En.SCRIPT=3]="SCRIPT",En[En.URL=4]="URL",En[En.RESOURCE_URL=5]="RESOURCE_URL",En))();function xs(n){const e=function Fu(){const n=te();return n&&n[12]}();return e?e.sanitize(En.URL,n)||"":function Lu(n,e){const t=function Vk(n){return n instanceof nS&&n.getTypeName()||null}(n);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see https://g.co/ng/security#xss)`)}return t===e}(n,"URL")?oo(n):function Tf(n){return(n=String(n)).match(Gk)||n.match(Wk)?n:"unsafe:"+n}(Xe(n))}const hS="__ngContext__";function ri(n,e){n[hS]=e}function ly(n){const e=function ku(n){return n[hS]||null}(n);return e?Array.isArray(e)?e:e.lView:null}function uy(n){return n.ngOriginalError}function fB(n,...e){n.error(...e)}class Bu{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e),i=function hB(n){return n&&n.ngErrorLogger||fB}(e);i(this._console,"ERROR",e),t&&i(this._console,"ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&uy(e);for(;t&&uy(t);)t=uy(t);return t||null}}const CB=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Bt))();function _S(n){return n.ownerDocument.defaultView}function Wr(n){return n instanceof Function?n():n}var Hi=(()=>((Hi=Hi||{})[Hi.Important=1]="Important",Hi[Hi.DashCase=2]="DashCase",Hi))();function hy(n,e){return undefined(n,e)}function Vu(n){const e=n[3];return vr(e)?e[3]:e}function fy(n){return xS(n[13])}function py(n){return xS(n[4])}function xS(n){for(;null!==n&&!vr(n);)n=n[4];return n}function bl(n,e,t,i,r){if(null!=i){let s,o=!1;vr(i)?s=i:Ur(i)&&(o=!0,i=i[0]);const a=Sn(i);0===n&&null!==t?null==r?DS(e,t,a):oa(e,t,a,r||null,!0):1===n&&null!==t?oa(e,t,a,r||null,!0):2===n?function OS(n,e,t){const i=Af(n,e);i&&function FB(n,e,t,i){pn(n)?n.removeChild(e,t,i):e.removeChild(t)}(n,i,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function VB(n,e,t,i,r){const s=t[7];s!==Sn(t)&&bl(e,n,i,s,r);for(let a=10;a<t.length;a++){const l=t[a];Uu(l[1],l,n,e,i,s)}}(e,n,s,t,r)}}function gy(n,e,t){if(pn(n))return n.createElement(e,t);{const i=null!==t?function CF(n){const e=n.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(t):null;return null===i?n.createElement(e):n.createElementNS(i,e)}}function MS(n,e){const t=n[9],i=t.indexOf(e),r=e[3];1024&e[2]&&(e[2]&=-1025,O_(r,-1)),t.splice(i,1)}function _y(n,e){if(n.length<=10)return;const t=10+e,i=n[t];if(i){const r=i[17];null!==r&&r!==n&&MS(r,i),e>0&&(n[t-1][4]=i[4]);const s=wf(n,10+e);!function DB(n,e){Uu(n,e,e[11],2,null,null),e[0]=null,e[6]=null}(i[1],i);const o=s[19];null!==o&&o.detachView(s[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}function SS(n,e){if(!(256&e[2])){const t=e[11];pn(t)&&t.destroyNode&&Uu(n,e,t,3,null,null),function RB(n){let e=n[13];if(!e)return yy(n[1],n);for(;e;){let t=null;if(Ur(e))t=e[13];else{const i=e[10];i&&(t=i)}if(!t){for(;e&&!e[4]&&e!==n;)Ur(e)&&yy(e[1],e),e=e[3];null===e&&(e=n),Ur(e)&&yy(e[1],e),t=e&&e[4]}e=t}}(e)}}function yy(n,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function OB(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof bu)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];try{l.call(a)}finally{}}else try{s.call(r)}finally{}}}}(n,e),function LB(n,e){const t=n.cleanup,i=e[7];let r=-1;if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+1],a="function"==typeof o?o(e):Sn(e[o]),l=i[r=t[s+2]],c=t[s+3];"boolean"==typeof c?a.removeEventListener(t[s],l,c):c>=0?i[r=c]():i[r=-c].unsubscribe(),s+=2}else{const o=i[r=t[s+1]];t[s].call(o)}if(null!==i){for(let s=r+1;s<i.length;s++)i[s]();e[7]=null}}(n,e),1===e[1].type&&pn(e[11])&&e[11].destroy();const t=e[17];if(null!==t&&vr(e[3])){t!==e[3]&&MS(t,e);const i=e[19];null!==i&&i.detachView(n)}}}function ES(n,e,t){return function TS(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[0];if(2&i.flags){const r=n.data[i.directiveStart].encapsulation;if(r===Vr.None||r===Vr.Emulated)return null}return rr(i,t)}(n,e.parent,t)}function oa(n,e,t,i,r){pn(n)?n.insertBefore(e,t,i,r):e.insertBefore(t,i,r)}function DS(n,e,t){pn(n)?n.appendChild(e,t):e.appendChild(t)}function AS(n,e,t,i,r){null!==i?oa(n,e,t,i,r):DS(n,e,t)}function Af(n,e){return pn(n)?n.parentNode(e):e.parentNode}let PS=function RS(n,e,t){return 40&n.type?rr(n,t):null};function If(n,e,t,i){const r=ES(n,i,e),s=e[11],a=function IS(n,e,t){return PS(n,e,t)}(i.parent||e[6],i,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)AS(s,r,t[l],a,!1);else AS(s,r,t,a,!1)}function Rf(n,e){if(null!==e){const t=e.type;if(3&t)return rr(e,n);if(4&t)return wy(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return Rf(n,i);{const r=n[e.index];return vr(r)?wy(-1,r):Sn(r)}}if(32&t)return hy(e,n)()||Sn(n[e.index]);{const i=LS(n,e);return null!==i?Array.isArray(i)?i[0]:Rf(Vu(n[16]),i):Rf(n,e.next)}}return null}function LS(n,e){return null!==e?n[16][6].projection[e.projection]:null}function wy(n,e){const t=10+n+1;if(t<e.length){const i=e[t],r=i[1].firstChild;if(null!==r)return Rf(i,r)}return e[7]}function by(n,e,t,i,r,s,o){for(;null!=t;){const a=i[t.index],l=t.type;if(o&&0===e&&(a&&ri(Sn(a),i),t.flags|=4),64!=(64&t.flags))if(8&l)by(n,e,t.child,i,r,s,!1),bl(e,n,r,a,s);else if(32&l){const c=hy(t,i);let u;for(;u=c();)bl(e,n,r,u,s);bl(e,n,r,a,s)}else 16&l?FS(n,e,i,t,r,s):bl(e,n,r,a,s);t=o?t.projectionNext:t.next}}function Uu(n,e,t,i,r,s){by(t,i,n.firstChild,e,r,s,!1)}function FS(n,e,t,i,r,s){const o=t[16],l=o[6].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)bl(e,n,r,l[c],s);else by(n,e,l,o[3],r,s,!0)}function kS(n,e,t){pn(n)?n.setAttribute(e,"style",t):e.style.cssText=t}function xy(n,e,t){pn(n)?""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t):e.className=t}function BS(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}const VS="ng-template";function HB(n,e,t){let i=0;for(;i<n.length;){let r=n[i++];if(t&&"class"===r){if(r=n[i],-1!==BS(r.toLowerCase(),e,0))return!0}else if(1===r){for(;i<n.length&&"string"==typeof(r=n[i++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function US(n){return 4===n.type&&n.value!==VS}function zB(n,e,t){return e===(4!==n.type||t?n.value:VS)}function GB(n,e,t){let i=4;const r=n.attrs||[],s=function $B(n){for(let e=0;e<n.length;e++)if(AM(n[e]))return e;return n.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!zB(n,l,t)||""===l&&1===e.length){if(br(i))return!1;o=!0}}else{const c=8&i?l:e[++a];if(8&i&&null!==n.attrs){if(!HB(n.attrs,c,t)){if(br(i))return!1;o=!0}continue}const d=WB(8&i?"class":l,r,US(n),t);if(-1===d){if(br(i))return!1;o=!0;continue}if(""!==c){let h;h=d>s?"":r[d+1].toLowerCase();const f=8&i?h:null;if(f&&-1!==BS(f,c,0)||2&i&&c!==h){if(br(i))return!1;o=!0}}}}else{if(!o&&!br(i)&&!br(l))return!1;if(o&&br(l))continue;o=!1,i=l|1&i}}return br(i)||o}function br(n){return 0==(1&n)}function WB(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function qB(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function HS(n,e,t=!1){for(let i=0;i<e.length;i++)if(GB(n,e[i],t))return!0;return!1}function zS(n,e){return n?":not("+e.trim()+")":e}function XB(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!br(o)&&(e+=zS(s,r),r=""),i=o,s=s||!br(i);t++}return""!==r&&(e+=zS(s,r)),e}const Qe={};function ie(n){GS(Mt(),te(),fi()+n,af())}function GS(n,e,t,i){if(!i)if(3==(3&e[2])){const s=n.preOrderCheckHooks;null!==s&&hf(e,s,t)}else{const s=n.preOrderHooks;null!==s&&ff(e,s,0,t)}io(t)}function Pf(n,e){return n<<17|e<<2}function xr(n){return n>>17&32767}function Cy(n){return 2|n}function Cs(n){return(131068&n)>>2}function My(n,e){return-131069&n|e<<2}function Sy(n){return 1|n}function eE(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const r=t[i],s=t[i+1];if(-1!==s){const o=n.data[s];U_(r),o.contentQueries(2,e[s],s)}}}function Hu(n,e,t,i,r,s,o,a,l,c){const u=e.blueprint.slice();return u[0]=r,u[2]=140|i,_M(u),u[3]=u[15]=n,u[8]=t,u[10]=o||n&&n[10],u[11]=a||n&&n[11],u[12]=l||n&&n[12]||null,u[9]=c||n&&n[9]||null,u[6]=s,u[16]=2==e.type?n[16]:u,u}function xl(n,e,t,i,r){let s=n.data[e];if(null===s)s=function Ly(n,e,t,i,r){const s=vM(),o=F_(),l=n.data[e]=function fV(n,e,t,i,r,s){return{type:t,index:i,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l)),l}(n,e,t,i,r),function OF(){return We.lFrame.inI18n}()&&(s.flags|=64);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function wu(){const n=We.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Hr(s,!0),s}function Cl(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function zu(n,e,t){cf(e);try{const i=n.viewQuery;null!==i&&Gy(1,i,t);const r=n.template;null!==r&&tE(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&eE(n,e),n.staticViewQueries&&Gy(2,n.viewQuery,t);const s=n.components;null!==s&&function uV(n,e){for(let t=0;t<e.length;t++)RV(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[2]&=-5,uf()}}function Ml(n,e,t,i){const r=e[2];if(256==(256&r))return;cf(e);const s=af();try{_M(e),function wM(n){return We.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&tE(n,e,t,2,i);const o=3==(3&r);if(!s)if(o){const c=n.preOrderCheckHooks;null!==c&&hf(e,c,null)}else{const c=n.preOrderHooks;null!==c&&ff(e,c,0,null),H_(e,0)}if(function AV(n){for(let e=fy(n);null!==e;e=py(e)){if(!e[2])continue;const t=e[9];for(let i=0;i<t.length;i++){const r=t[i],s=r[3];0==(1024&r[2])&&O_(s,1),r[2]|=1024}}}(e),function DV(n){for(let e=fy(n);null!==e;e=py(e))for(let t=10;t<e.length;t++){const i=e[t],r=i[1];L_(i)&&Ml(r,i,r.template,i[8])}}(e),null!==n.contentQueries&&eE(n,e),!s)if(o){const c=n.contentCheckHooks;null!==c&&hf(e,c)}else{const c=n.contentHooks;null!==c&&ff(e,c,1),H_(e,1)}!function lV(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const r=t[i];if(r<0)io(~r);else{const s=r,o=t[++i],a=t[++i];FF(o,s),a(2,e[s])}}}finally{io(-1)}}(n,e);const a=n.components;null!==a&&function cV(n,e){for(let t=0;t<e.length;t++)IV(n,e[t])}(e,a);const l=n.viewQuery;if(null!==l&&Gy(2,l,i),!s)if(o){const c=n.viewCheckHooks;null!==c&&hf(e,c)}else{const c=n.viewHooks;null!==c&&ff(e,c,2),H_(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),s||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,O_(e[3],-1))}finally{uf()}}function dV(n,e,t,i){const r=e[10],s=!af(),o=gM(e);try{s&&!o&&r.begin&&r.begin(),o&&zu(n,e,i),Ml(n,e,t,i)}finally{s&&!o&&r.end&&r.end()}}function tE(n,e,t,i,r){const s=fi(),o=2&i;try{io(-1),o&&e.length>20&&GS(n,e,20,af()),t(i,r)}finally{io(s)}}function nE(n,e,t){if(E_(e)){const r=e.directiveEnd;for(let s=e.directiveStart;s<r;s++){const o=n.data[s];o.contentQueries&&o.contentQueries(1,t[s],s)}}}function Oy(n,e,t){!yM()||(function wV(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;n.firstCreatePass||Cu(t,e),ri(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=n.data[a],c=wr(l);c&&SV(e,t,l);const u=Mu(e,n,a,t);ri(u,e),null!==o&&EV(0,a-r,u,l,0,o),c&&(Vi(t.index,e)[8]=u)}}(n,e,t,rr(t,e)),128==(128&t.flags)&&function bV(n,e,t){const i=t.directiveStart,r=t.directiveEnd,o=t.index,a=function kF(){return We.lFrame.currentDirectiveIndex}();try{io(o);for(let l=i;l<r;l++){const c=n.data[l],u=e[l];B_(l),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&uE(c,u)}}finally{io(-1),B_(a)}}(n,e,t))}function Fy(n,e,t=rr){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}function iE(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=Of(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):e}function Of(n,e,t,i,r,s,o,a,l,c){const u=20+i,d=u+r,h=function hV(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:Qe);return t}(u,d),f="function"==typeof c?c():c;return h[1]={type:n,blueprint:h,template:t,queries:null,viewQuery:a,declTNode:e,data:h.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:f,incompleteFirstPass:!1}}function oE(n,e,t,i){const r=gE(e);null===t?r.push(i):(r.push(t),n.firstCreatePass&&_E(n).push(i,r.length-1))}function aE(n,e,t){for(let i in n)if(n.hasOwnProperty(i)){const r=n[i];(t=null===t?{}:t).hasOwnProperty(i)?t[i].push(e,r):t[i]=[e,r]}return t}function zi(n,e,t,i,r,s,o,a){const l=rr(e,t);let u,c=e.inputs;!a&&null!=c&&(u=c[i])?(wE(n,t,u,i,r),rf(e)&&function gV(n,e){const t=Vi(e,n);16&t[2]||(t[2]|=64)}(t,e.index)):3&e.type&&(i=function mV(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,pn(s)?s.setProperty(l,i,r):G_(i)||(l.setProperty?l.setProperty(i,r):l[i]=r))}function ky(n,e,t,i){let r=!1;if(yM()){const s=function xV(n,e,t){const i=n.directiveRegistry;let r=null;if(i)for(let s=0;s<i.length;s++){const o=i[s];HS(t,o.selectors,!1)&&(r||(r=[]),yf(Cu(t,e),n,o.type),wr(o)?(dE(n,t),r.unshift(o)):r.push(o))}return r}(n,e,t),o=null===i?null:{"":-1};if(null!==s){r=!0,hE(t,n.data.length,s.length);for(let u=0;u<s.length;u++){const d=s[u];d.providersResolver&&d.providersResolver(d)}let a=!1,l=!1,c=Cl(n,e,s.length,null);for(let u=0;u<s.length;u++){const d=s[u];t.mergedAttrs=mf(t.mergedAttrs,d.hostAttrs),fE(n,t,e,c,d),MV(c,d,o),null!==d.contentQueries&&(t.flags|=8),(null!==d.hostBindings||null!==d.hostAttrs||0!==d.hostVars)&&(t.flags|=128);const h=d.type.prototype;!a&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t.index),a=!0),!l&&(h.ngOnChanges||h.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t.index),l=!0),c++}!function pV(n,e){const i=e.directiveEnd,r=n.data,s=e.attrs,o=[];let a=null,l=null;for(let c=e.directiveStart;c<i;c++){const u=r[c],d=u.inputs,h=null===s||US(e)?null:TV(d,s);o.push(h),a=aE(d,c,a),l=aE(u.outputs,c,l)}null!==a&&(a.hasOwnProperty("class")&&(e.flags|=16),a.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=o,e.inputs=a,e.outputs=l}(n,t)}o&&function CV(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new Ct(-301,!1);i.push(e[r],s)}}}(t,i,o)}return t.mergedAttrs=mf(t.mergedAttrs,t.attrs),r}function cE(n,e,t,i,r,s){const o=s.hostBindings;if(o){let a=n.hostBindingOpCodes;null===a&&(a=n.hostBindingOpCodes=[]);const l=~e.index;(function vV(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(a)!=l&&a.push(l),a.push(i,r,o)}}function uE(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function dE(n,e){e.flags|=2,(n.components||(n.components=[])).push(e.index)}function MV(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;wr(e)&&(t[""]=n)}}function hE(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function fE(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=sa(r.type)),o=new bu(s,wr(r),null);n.blueprint[i]=o,t[i]=o,cE(n,e,0,i,Cl(n,t,r.hostVars,Qe),r)}function SV(n,e,t){const i=rr(e,n),r=iE(t),s=n[10],o=Ff(n,Hu(n,r,null,t.onPush?64:16,i,e,s,s.createRenderer(i,t),null,null));n[e.index]=o}function jr(n,e,t,i,r,s){const o=rr(n,e);!function By(n,e,t,i,r,s,o){if(null==s)pn(n)?n.removeAttribute(e,r,t):e.removeAttribute(r);else{const a=null==o?Xe(s):o(s,i||"",r);pn(n)?n.setAttribute(e,r,a,t):t?e.setAttributeNS(t,r,a):e.setAttribute(r,a)}}(e[11],o,s,n.value,t,i,r)}function EV(n,e,t,i,r,s){const o=s[e];if(null!==o){const a=i.setInput;for(let l=0;l<o.length;){const c=o[l++],u=o[l++],d=o[l++];null!==a?i.setInput(t,d,c,u):t[u]=d}}}function TV(n,e){let t=null,i=0;for(;i<e.length;){const r=e[i];if(0!==r)if(5!==r){if("number"==typeof r)break;n.hasOwnProperty(r)&&(null===t&&(t=[]),t.push(r,n[r],e[i+1])),i+=2}else i+=2;else i+=4}return t}function pE(n,e,t,i){return new Array(n,!0,!1,e,null,0,i,t,null,null)}function IV(n,e){const t=Vi(e,n);if(L_(t)){const i=t[1];80&t[2]?Ml(i,t,i.template,t[8]):t[5]>0&&Vy(t)}}function Vy(n){for(let i=fy(n);null!==i;i=py(i))for(let r=10;r<i.length;r++){const s=i[r];if(1024&s[2]){const o=s[1];Ml(o,s,o.template,s[8])}else s[5]>0&&Vy(s)}const t=n[1].components;if(null!==t)for(let i=0;i<t.length;i++){const r=Vi(t[i],n);L_(r)&&r[5]>0&&Vy(r)}}function RV(n,e){const t=Vi(e,n),i=t[1];(function PV(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])})(i,t),zu(i,t,t[8])}function Ff(n,e){return n[13]?n[14][4]=e:n[13]=e,n[14]=e,e}function Uy(n){for(;n;){n[2]|=64;const e=Vu(n);if(fF(n)&&!e)return n;n=e}return null}function zy(n,e,t){const i=e[10];i.begin&&i.begin();try{Ml(n,e,n.template,t)}catch(r){throw vE(e,r),r}finally{i.end&&i.end()}}function mE(n){!function Hy(n){for(let e=0;e<n.components.length;e++){const t=n.components[e],i=ly(t),r=i[1];dV(r,i,r.template,t)}}(n[8])}function Gy(n,e,t){U_(0),e(n,t)}const FV=(()=>Promise.resolve(null))();function gE(n){return n[7]||(n[7]=[])}function _E(n){return n.cleanup||(n.cleanup=[])}function vE(n,e){const t=n[9],i=t?t.get(Bu,null):null;i&&i.handleError(e)}function wE(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++],l=e[o],c=n.data[o];null!==c.setInput?c.setInput(l,r,i,a):l[a]=r}}function Ms(n,e,t){const i=of(e,n);!function CS(n,e,t){pn(n)?n.setValue(e,t):e.textContent=t}(n[11],i,t)}function kf(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=__(r,a):2==s&&(i=__(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}const Wy=new lt("INJECTOR",-1);class bE{get(e,t=Au){if(t===Au){const i=new Error(`NullInjectorError: No provider for ${Lt(e)}!`);throw i.name="NullInjectorError",i}return t}}const jy=new lt("Set Injector scope."),Gu={},VV={};let $y;function xE(){return void 0===$y&&($y=new bE),$y}function CE(n,e=null,t=null,i){const r=ME(n,e,t,i);return r._resolveInjectorDefTypes(),r}function ME(n,e=null,t=null,i){return new UV(n,t,e||xE(),i)}class UV{constructor(e,t,i,r=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];t&&zr(t,a=>this.processProvider(a,e,t)),zr([e],a=>this.processInjectorType(a,[],s)),this.records.set(Wy,Sl(void 0,this));const o=this.records.get(jy);this.scope=null!=o?o.value:null,this.source=r||("object"==typeof e?null:Lt(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,t=Au,i=$e.Default){this.assertNotDestroyed();const r=qM(this),s=Zs(void 0);try{if(!(i&$e.SkipSelf)){let a=this.records.get(e);if(void 0===a){const l=function YV(n){return"function"==typeof n||"object"==typeof n&&n instanceof lt}(e)&&v_(e);a=l&&this.injectableDefInScope(l)?Sl(qy(e),Gu):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(i&$e.Self?xE():this.parent).get(e,t=i&$e.Optional&&t===Au?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[xf]=o[xf]||[]).unshift(Lt(e)),r)throw o;return function xk(n,e,t,i){const r=n[xf];throw e[$M]&&r.unshift(e[$M]),n.message=function Ck(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.substr(2):n;let r=Lt(e);if(Array.isArray(e))r=e.map(Lt).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):Lt(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(gk,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[xf]=null,n}(o,e,"R3InjectorError",this.source)}throw o}finally{Zs(s),qM(r)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((i,r)=>e.push(Lt(r))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Ct(205,!1)}processInjectorType(e,t,i){if(!(e=nt(e)))return!1;let r=iM(e);const s=null==r&&e.ngModule||void 0,o=void 0===s?e:s,a=-1!==i.indexOf(o);if(void 0!==s&&(r=iM(s)),null==r)return!1;if(null!=r.imports&&!a){let u;i.push(o);try{zr(r.imports,d=>{this.processInjectorType(d,t,i)&&(void 0===u&&(u=[]),u.push(d))})}finally{}if(void 0!==u)for(let d=0;d<u.length;d++){const{ngModule:h,providers:f}=u[d];zr(f,p=>this.processProvider(p,h,f||zt))}}this.injectorDefTypes.add(o);const l=sa(o)||(()=>new o);this.records.set(o,Sl(l,Gu));const c=r.providers;if(null!=c&&!a){const u=e;zr(c,d=>this.processProvider(d,u,c))}return void 0!==s&&void 0!==e.providers}processProvider(e,t,i){let r=El(e=nt(e))?e:nt(e&&e.provide);const s=function zV(n,e,t){return EE(n)?Sl(void 0,n.useValue):Sl(SE(n),Gu)}(e);if(El(e)||!0!==e.multi)this.records.get(r);else{let o=this.records.get(r);o||(o=Sl(void 0,Gu,!0),o.factory=()=>Z_(o.multi),this.records.set(r,o)),r=e,o.multi.push(e)}this.records.set(r,s)}hydrate(e,t){return t.value===Gu&&(t.value=VV,t.value=t.factory()),"object"==typeof t.value&&t.value&&function qV(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this.onDestroy.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=nt(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}function qy(n){const e=v_(n),t=null!==e?e.factory:sa(n);if(null!==t)return t;if(n instanceof lt)throw new Ct(204,!1);if(n instanceof Function)return function HV(n){const e=n.length;if(e>0)throw function Du(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}(e,"?"),new Ct(204,!1);const t=function eF(n){const e=n&&(n[Kh]||n[rM]);if(e){const t=function tF(n){if(n.hasOwnProperty("name"))return n.name;const e=(""+n).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${t}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${t}" class.`),e}return null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new Ct(204,!1)}function SE(n,e,t){let i;if(El(n)){const r=nt(n);return sa(r)||qy(r)}if(EE(n))i=()=>nt(n.useValue);else if(function WV(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...Z_(n.deps||[]));else if(function GV(n){return!(!n||!n.useExisting)}(n))i=()=>pe(nt(n.useExisting));else{const r=nt(n&&(n.useClass||n.provide));if(!function $V(n){return!!n.deps}(n))return sa(r)||qy(r);i=()=>new r(...Z_(n.deps))}return i}function Sl(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function EE(n){return null!==n&&"object"==typeof n&&yk in n}function El(n){return"function"==typeof n}let si=(()=>{class n{static create(t,i){var r;if(Array.isArray(t))return CE({name:""},i,t,"");{const s=null!==(r=t.name)&&void 0!==r?r:"";return CE({name:s},t.parent,t.providers,s)}}}return n.THROW_IF_NOT_FOUND=Au,n.NULL=new bE,n.\u0275prov=Ne({token:n,providedIn:"any",factory:()=>pe(Wy)}),n.__NG_ELEMENT_ID__=-1,n})();function n4(n,e){df(ly(n)[1],Fn())}function Ot(n){let e=function BE(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(wr(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Ct(903,"");r=e.\u0275dir}if(r){if(t){i.push(r);const o=n;o.inputs=Qy(n.inputs),o.declaredInputs=Qy(n.declaredInputs),o.outputs=Qy(n.outputs);const a=r.hostBindings;a&&o4(n,a);const l=r.viewQuery,c=r.contentQueries;if(l&&r4(n,l),c&&s4(n,c),g_(n.inputs,r.inputs),g_(n.declaredInputs,r.declaredInputs),g_(n.outputs,r.outputs),wr(r)&&r.data.animation){const u=n.data;u.animation=(u.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===Ot&&(t=!1)}}e=Object.getPrototypeOf(e)}!function i4(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=mf(r.hostAttrs,t=mf(t,r.hostAttrs))}}(i)}function Qy(n){return n===il?{}:n===zt?[]:n}function r4(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function s4(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,s)=>{e(i,r,s),t(i,r,s)}:e}function o4(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}let Bf=null;function Tl(){if(!Bf){const n=Bt.Symbol;if(n&&n.iterator)Bf=n.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const i=e[t];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(Bf=i)}}}return Bf}function Wu(n){return!!Jy(n)&&(Array.isArray(n)||!(n instanceof Map)&&Tl()in n)}function Jy(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function $r(n,e,t){return n[e]=t}function oi(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function aa(n,e,t,i){const r=oi(n,e,t);return oi(n,e+1,i)||r}function qr(n,e,t,i){const r=te();return oi(r,cl(),e)&&(Mt(),jr(mn(),r,n,e,t,i)),qr}function Al(n,e,t,i){return oi(n,cl(),t)?e+Xe(t)+i:Qe}function rt(n,e,t,i,r,s,o,a){const l=te(),c=Mt(),u=n+20,d=c.firstCreatePass?function f4(n,e,t,i,r,s,o,a,l){const c=e.consts,u=xl(e,n,4,o||null,no(c,a));ky(e,t,u,no(c,l)),df(e,u);const d=u.tViews=Of(2,u,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,u),d.queries=e.queries.embeddedTView(u)),u}(u,c,l,e,t,i,r,s,o):c.data[u];Hr(d,!1);const h=l[11].createComment("");If(c,l,h,d),ri(h,l),Ff(l,l[u]=pE(h,l,h,d)),sf(d)&&Oy(c,l,d),null!=o&&Fy(l,d,a)}function Yr(n){return ll(function LF(){return We.lFrame.contextLView}(),20+n)}function $(n,e=$e.Default){const t=te();return null===t?pe(n,e):FM(Fn(),t,nt(n),e)}function nv(){throw new Error("invalid")}function ne(n,e,t){const i=te();return oi(i,cl(),e)&&zi(Mt(),mn(),i,n,e,i[11],t,!1),ne}function iv(n,e,t,i,r){const o=r?"class":"style";wE(n,t,e.inputs[o],o,i)}function V(n,e,t,i){const r=te(),s=Mt(),o=20+n,a=r[11],l=r[o]=gy(a,e,function jF(){return We.lFrame.currentNamespace}()),c=s.firstCreatePass?function L4(n,e,t,i,r,s,o){const a=e.consts,c=xl(e,n,2,r,no(a,s));return ky(e,t,c,no(a,o)),null!==c.attrs&&kf(c,c.attrs,!1),null!==c.mergedAttrs&&kf(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,r,0,e,t,i):s.data[o];Hr(c,!0);const u=c.mergedAttrs;null!==u&&pf(a,l,u);const d=c.classes;null!==d&&xy(a,l,d);const h=c.styles;return null!==h&&kS(a,l,h),64!=(64&c.flags)&&If(s,r,l,c),0===function AF(){return We.lFrame.elementDepthCount}()&&ri(l,r),function IF(){We.lFrame.elementDepthCount++}(),sf(c)&&(Oy(s,r,c),nE(s,c,r)),null!==i&&Fy(r,c),V}function Y(){let n=Fn();F_()?k_():(n=n.parent,Hr(n,!1));const e=n;!function RF(){We.lFrame.elementDepthCount--}();const t=Mt();return t.firstCreatePass&&(df(t,n),E_(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function QF(n){return 0!=(16&n.flags)}(e)&&iv(t,e,te(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function JF(n){return 0!=(32&n.flags)}(e)&&iv(t,e,te(),e.stylesWithoutHost,!1),Y}function ct(n,e,t,i){return V(n,e,t,i),Y(),ct}function Bl(n,e,t){const i=te(),r=Mt(),s=n+20,o=r.firstCreatePass?function O4(n,e,t,i,r){const s=e.consts,o=no(s,i),a=xl(e,n,8,"ng-container",o);return null!==o&&kf(a,o,!0),ky(e,t,a,no(s,r)),null!==e.queries&&e.queries.elementStart(e,a),a}(s,r,i,e,t):r.data[s];Hr(o,!0);const a=i[s]=i[11].createComment("");return If(r,i,a,o),ri(a,i),sf(o)&&(Oy(r,i,o),nE(r,o,i)),null!=t&&Fy(i,o),Bl}function Vl(){let n=Fn();const e=Mt();return F_()?k_():(n=n.parent,Hr(n,!1)),e.firstCreatePass&&(df(e,n),E_(n)&&e.queries.elementEnd(n)),Vl}function Gt(){return te()}function $u(n){return!!n&&"function"==typeof n.then}const rv=function s1(n){return!!n&&"function"==typeof n.subscribe};function Ee(n,e,t,i){const r=te(),s=Mt(),o=Fn();return function a1(n,e,t,i,r,s,o,a){const l=sf(i),u=n.firstCreatePass&&_E(n),d=e[8],h=gE(e);let f=!0;if(3&i.type||a){const y=rr(i,e),g=a?a(y):y,m=h.length,v=a?w=>a(Sn(w[i.index])):i.index;if(pn(t)){let w=null;if(!a&&l&&(w=function F4(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[7],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==w)(w.__ngLastListenerFn__||w).__ngNextListenerFn__=s,w.__ngLastListenerFn__=s,f=!1;else{s=sv(i,e,d,s,!1);const b=t.listen(g,r,s);h.push(s,b),u&&u.push(r,v,m,m+1)}}else s=sv(i,e,d,s,!0),g.addEventListener(r,s,o),h.push(s),u&&u.push(r,v,m,o)}else s=sv(i,e,d,s,!1);const p=i.outputs;let _;if(f&&null!==p&&(_=p[r])){const y=_.length;if(y)for(let g=0;g<y;g+=2){const T=e[_[g]][_[g+1]].subscribe(s),A=h.length;h.push(s,T),u&&u.push(r,i.index,A,-(A+1))}}}(s,r,r[11],o,n,e,!!t,i),Ee}function l1(n,e,t,i){try{return!1!==t(i)}catch(r){return vE(n,r),!1}}function sv(n,e,t,i,r){return function s(o){if(o===Function)return i;const a=2&n.flags?Vi(n.index,e):e;0==(32&e[2])&&Uy(a);let l=l1(e,0,i,o),c=s.__ngNextListenerFn__;for(;c;)l=l1(e,0,c,o)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&(o.preventDefault(),o.returnValue=!1),l}}function Re(n=1){return function VF(n){return(We.lFrame.contextLView=function UF(n,e){for(;n>0;)e=e[15],n--;return e}(n,We.lFrame.contextLView))[8]}(n)}function ov(n,e,t){return av(n,"",e,"",t),ov}function av(n,e,t,i,r){const s=te(),o=Al(s,e,t,i);return o!==Qe&&zi(Mt(),mn(),s,n,o,s[11],r,!1),av}function _1(n,e,t,i,r){const s=n[t+1],o=null===e;let a=i?xr(s):Cs(s),l=!1;for(;0!==a&&(!1===l||o);){const u=n[a+1];z4(n[a],e)&&(l=!0,n[a+1]=i?Sy(u):Cy(u)),a=i?xr(u):Cs(u)}l&&(n[t+1]=i?Cy(s):Sy(s))}function z4(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&_l(n,e)>=0}function Hf(n,e){return function Mr(n,e,t,i){const r=te(),s=Mt(),o=function bs(n){const e=We.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}(2);s.firstUpdatePass&&function E1(n,e,t,i){const r=n.data;if(null===r[t+1]){const s=r[fi()],o=function S1(n,e){return e>=n.expandoStartIndex}(n,t);(function I1(n,e){return 0!=(n.flags&(e?16:32))})(s,i)&&null===e&&!o&&(e=!1),e=function J4(n,e,t,i){const r=function V_(n){const e=We.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=qu(t=lv(null,n,e,t,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==r)if(t=lv(r,n,e,t,i),null===s){let l=function K4(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==Cs(i))return n[xr(i)]}(n,e,i);void 0!==l&&Array.isArray(l)&&(l=lv(null,n,e,l[1],i),l=qu(l,e.attrs,i),function Z4(n,e,t,i){n[xr(t?e.classBindings:e.styleBindings)]=i}(n,e,i,l))}else s=function eU(n,e,t){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=qu(i,n[s].hostAttrs,t);return qu(i,e.attrs,t)}(n,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,i),function U4(n,e,t,i,r,s){let o=s?e.classBindings:e.styleBindings,a=xr(o),l=Cs(o);n[i]=t;let u,c=!1;if(Array.isArray(t)){const d=t;u=d[1],(null===u||_l(d,u)>0)&&(c=!0)}else u=t;if(r)if(0!==l){const h=xr(n[a+1]);n[i+1]=Pf(h,a),0!==h&&(n[h+1]=My(n[h+1],i)),n[a+1]=function KB(n,e){return 131071&n|e<<17}(n[a+1],i)}else n[i+1]=Pf(a,0),0!==a&&(n[a+1]=My(n[a+1],i)),a=i;else n[i+1]=Pf(l,0),0===a?a=i:n[l+1]=My(n[l+1],i),l=i;c&&(n[i+1]=Cy(n[i+1])),_1(n,u,i,!0),_1(n,u,i,!1),function H4(n,e,t,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&_l(s,e)>=0&&(t[i+1]=Sy(t[i+1]))}(e,u,n,i,s),o=Pf(a,l),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,i)}}(s,n,o,i),e!==Qe&&oi(r,o,e)&&function D1(n,e,t,i,r,s,o,a){if(!(3&e.type))return;const l=n.data,c=l[a+1];zf(function $S(n){return 1==(1&n)}(c)?A1(l,e,t,r,Cs(c),o):void 0)||(zf(s)||function jS(n){return 2==(2&n)}(c)&&(s=A1(l,null,t,r,a,o)),function UB(n,e,t,i,r){const s=pn(n);if(e)r?s?n.addClass(t,i):t.classList.add(i):s?n.removeClass(t,i):t.classList.remove(i);else{let o=-1===i.indexOf("-")?void 0:Hi.DashCase;if(null==r)s?n.removeStyle(t,i,o):t.style.removeProperty(i);else{const a="string"==typeof r&&r.endsWith("!important");a&&(r=r.slice(0,-10),o|=Hi.Important),s?n.setStyle(t,i,r,o):t.style.setProperty(i,r,a?"important":"")}}}(i,o,of(fi(),t),r,s))}(s,s.data[fi()],r,r[11],n,r[o+1]=function iU(n,e){return null==n||("string"==typeof e?n+=e:"object"==typeof n&&(n=Lt(oo(n)))),n}(e,t),i,o)}(n,e,null,!0),Hf}function lv(n,e,t,i,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],i=qu(i,s.hostAttrs,r),s!==n);)a++;return null!==n&&(t.directiveStylingLast=a),i}function qu(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Ui(n,o,!!t||e[++s]))}return void 0===n?null:n}function A1(n,e,t,i,r,s){const o=null===e;let a;for(;r>0;){const l=n[r],c=Array.isArray(l),u=c?l[1]:l,d=null===u;let h=t[r+1];h===Qe&&(h=d?zt:void 0);let f=d?Q_(h,i):u===i?h:void 0;if(c&&!zf(f)&&(f=Q_(l,i)),zf(f)&&(a=f,o))return a;const p=n[r+1];r=o?xr(p):Cs(p)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=Q_(l,i))}return a}function zf(n){return void 0!==n}function Me(n,e=""){const t=te(),i=Mt(),r=n+20,s=i.firstCreatePass?xl(i,r,1,e,null):i.data[r],o=t[r]=function my(n,e){return pn(n)?n.createText(e):n.createTextNode(e)}(t[11],e);If(i,t,o,s),Hr(s,!1)}function Gi(n){return Ei("",n,""),Gi}function Ei(n,e,t){const i=te(),r=Al(i,n,e,t);return r!==Qe&&Ms(i,fi(),r),Ei}const la=void 0;var CU=["en",[["a","p"],["AM","PM"],la],[["AM","PM"],la,la],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],la,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],la,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",la,"{1} 'at' {0}",la],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function xU(n){const t=Math.floor(Math.abs(n)),i=n.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===i?1:5}];let Hl={};function mi(n){const e=function MU(n){return n.toLowerCase().replace(/_/g,"-")}(n);let t=J1(e);if(t)return t;const i=e.split("-")[0];if(t=J1(i),t)return t;if("en"===i)return CU;throw new Error(`Missing locale data for the locale "${n}".`)}function J1(n){return n in Hl||(Hl[n]=Bt.ng&&Bt.ng.common&&Bt.ng.common.locales&&Bt.ng.common.locales[n]),Hl[n]}var be=(()=>((be=be||{})[be.LocaleId=0]="LocaleId",be[be.DayPeriodsFormat=1]="DayPeriodsFormat",be[be.DayPeriodsStandalone=2]="DayPeriodsStandalone",be[be.DaysFormat=3]="DaysFormat",be[be.DaysStandalone=4]="DaysStandalone",be[be.MonthsFormat=5]="MonthsFormat",be[be.MonthsStandalone=6]="MonthsStandalone",be[be.Eras=7]="Eras",be[be.FirstDayOfWeek=8]="FirstDayOfWeek",be[be.WeekendRange=9]="WeekendRange",be[be.DateFormat=10]="DateFormat",be[be.TimeFormat=11]="TimeFormat",be[be.DateTimeFormat=12]="DateTimeFormat",be[be.NumberSymbols=13]="NumberSymbols",be[be.NumberFormats=14]="NumberFormats",be[be.CurrencyCode=15]="CurrencyCode",be[be.CurrencySymbol=16]="CurrencySymbol",be[be.CurrencyName=17]="CurrencyName",be[be.Currencies=18]="Currencies",be[be.Directionality=19]="Directionality",be[be.PluralCase=20]="PluralCase",be[be.ExtraData=21]="ExtraData",be))();const Gf="en-US";let K1=Gf;function dv(n,e,t,i,r){if(n=nt(n),Array.isArray(n))for(let s=0;s<n.length;s++)dv(n[s],e,t,i,r);else{const s=Mt(),o=te();let a=El(n)?n:nt(n.provide),l=SE(n);const c=Fn(),u=1048575&c.providerIndexes,d=c.directiveStart,h=c.providerIndexes>>20;if(El(n)||!n.multi){const f=new bu(l,r,$),p=fv(a,e,r?u:u+h,d);-1===p?(yf(Cu(c,o),s,a),hv(s,n,e.length),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(f),o.push(f)):(t[p]=f,o[p]=f)}else{const f=fv(a,e,u+h,d),p=fv(a,e,u,u+h),_=f>=0&&t[f],y=p>=0&&t[p];if(r&&!y||!r&&!_){yf(Cu(c,o),s,a);const g=function x5(n,e,t,i,r){const s=new bu(n,t,$);return s.multi=[],s.index=e,s.componentProviders=0,xT(s,r,i&&!t),s}(r?b5:w5,t.length,r,i,l);!r&&y&&(t[p].providerFactory=g),hv(s,n,e.length,0),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(g),o.push(g)}else hv(s,n,f>-1?f:p,xT(t[r?p:f],l,!r&&i));!r&&i&&y&&t[p].componentProviders++}}}function hv(n,e,t,i){const r=El(e),s=function jV(n){return!!n.useClass}(e);if(r||s){const l=(s?nt(e.useClass):e).prototype.ngOnDestroy;if(l){const c=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){const u=c.indexOf(t);-1===u?c.push(t,[i,l]):c[u+1].push(i,l)}else c.push(t,l)}}}function xT(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function fv(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function w5(n,e,t,i){return pv(this.multi,[])}function b5(n,e,t,i){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=Mu(t,t[1],this.providerFactory.index,i);s=a.slice(0,o),pv(r,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],pv(r,s);return s}function pv(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function an(n,e=[]){return t=>{t.providersResolver=(i,r)=>function v5(n,e,t){const i=Mt();if(i.firstCreatePass){const r=wr(n);dv(t,i.data,i.blueprint,r,!0),dv(e,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,e)}}class CT{}class S5{resolveComponentFactory(e){throw function M5(n){const e=Error(`No component factory found for ${Lt(n)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=n,e}(e)}}let Ku=(()=>{class n{}return n.NULL=new S5,n})();function E5(){return Gl(Fn(),te())}function Gl(n,e){return new Wi(rr(n,e))}let Wi=(()=>{class n{constructor(t){this.nativeElement=t}}return n.__NG_ELEMENT_ID__=E5,n})();function T5(n){return n instanceof Wi?n.nativeElement:n}class ST{}let Ss=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function A5(){const n=te(),t=Vi(Fn().index,n);return function D5(n){return n[11]}(Ur(t)?t:n)}(),n})(),I5=(()=>{class n{}return n.\u0275prov=Ne({token:n,providedIn:"root",factory:()=>null}),n})();class Zu{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const R5=new Zu("13.2.7"),mv={};function Yf(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&i.push(Sn(s)),vr(s))for(let a=10;a<s.length;a++){const l=s[a],c=l[1].firstChild;null!==c&&Yf(l[1],l,c,i)}const o=t.type;if(8&o)Yf(n,e,t.child,i);else if(32&o){const a=hy(t,e);let l;for(;l=a();)i.push(l)}else if(16&o){const a=LS(e,t);if(Array.isArray(a))i.push(...a);else{const l=Vu(e[16]);Yf(l[1],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}class ed{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return Yf(t,e,t.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(vr(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(_y(e,i),wf(t,i))}this._attachedToViewContainer=!1}SS(this._lView[1],this._lView)}onDestroy(e){oE(this._lView[1],this._lView,null,e)}markForCheck(){Uy(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){zy(this._lView[1],this._lView,this.context)}checkNoChanges(){!function LV(n,e,t){lf(!0);try{zy(n,e,t)}finally{lf(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Ct(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function IB(n,e){Uu(n,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Ct(902,"");this._appRef=e}}class P5 extends ed{constructor(e){super(e),this._view=e}detectChanges(){mE(this._view)}checkNoChanges(){!function OV(n){lf(!0);try{mE(n)}finally{lf(!1)}}(this._view)}get context(){return null}}class ET extends Ku{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=ti(e);return new gv(t,this.ngModule)}}function TT(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}class gv extends CT{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function QB(n){return n.map(XB).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return TT(this.componentDef.inputs)}get outputs(){return TT(this.componentDef.outputs)}create(e,t,i,r){const s=(r=r||this.ngModule)?function L5(n,e){return{get:(t,i,r)=>{const s=n.get(t,mv,r);return s!==mv||i===mv?s:e.get(t,i,r)}}}(e,r.injector):e,o=s.get(ST,mM),a=s.get(I5,null),l=o.createRenderer(null,this.componentDef),c=this.componentDef.selectors[0][0]||"div",u=i?function sE(n,e,t){if(pn(n))return n.selectRootElement(e,t===Vr.ShadowDom);let i="string"==typeof e?n.querySelector(e):e;return i.textContent="",i}(l,i,this.componentDef.encapsulation):gy(o.createRenderer(null,this.componentDef),c,function N5(n){const e=n.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(c)),d=this.componentDef.onPush?576:528,h=function kE(n,e){return{components:[],scheduler:n||CB,clean:FV,playerHandler:e||null,flags:0}}(),f=Of(0,null,null,1,0,null,null,null,null,null),p=Hu(null,f,h,d,null,null,o,l,a,s);let _,y;cf(p);try{const g=function OE(n,e,t,i,r,s){const o=t[1];t[20]=n;const l=xl(o,20,2,"#host",null),c=l.mergedAttrs=e.hostAttrs;null!==c&&(kf(l,c,!0),null!==n&&(pf(r,n,c),null!==l.classes&&xy(r,n,l.classes),null!==l.styles&&kS(r,n,l.styles)));const u=i.createRenderer(n,e),d=Hu(t,iE(e),null,e.onPush?64:16,t[20],l,i,u,s||null,null);return o.firstCreatePass&&(yf(Cu(l,t),o,e.type),dE(o,l),hE(l,t.length,1)),Ff(t,d),t[20]=d}(u,this.componentDef,p,o,l);if(u)if(i)pf(l,u,["ng-version",R5.full]);else{const{attrs:m,classes:v}=function JB(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!br(r))break;r=s}i++}return{attrs:e,classes:t}}(this.componentDef.selectors[0]);m&&pf(l,u,m),v&&v.length>0&&xy(l,u,v.join(" "))}if(y=N_(f,20),void 0!==t){const m=y.projection=[];for(let v=0;v<this.ngContentSelectors.length;v++){const w=t[v];m.push(null!=w?Array.from(w):null)}}_=function FE(n,e,t,i,r){const s=t[1],o=function yV(n,e,t){const i=Fn();n.firstCreatePass&&(t.providersResolver&&t.providersResolver(t),fE(n,i,e,Cl(n,e,1,null),t));const r=Mu(e,n,i.directiveStart,i);ri(r,e);const s=rr(i,e);return s&&ri(s,e),r}(s,t,e);if(i.components.push(o),n[8]=o,r&&r.forEach(l=>l(o,e)),e.contentQueries){const l=Fn();e.contentQueries(1,o,l.directiveStart)}const a=Fn();return!s.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(io(a.index),cE(t[1],a,0,a.directiveStart,a.directiveEnd,e),uE(e,o)),o}(g,this.componentDef,p,h,[n4]),zu(f,p,null)}finally{uf()}return new F5(this.componentType,_,Gl(y,p),p,y)}}class F5 extends class C5{}{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.instance=t,this.hostView=this.changeDetectorRef=new P5(r),this.componentType=e}get injector(){return new hl(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}class Es{}class DT{}const Wl=new Map;class RT extends Es{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new ET(this);const i=er(e);this._bootstrapComponents=Wr(i.bootstrap),this._r3Injector=ME(e,t,[{provide:Es,useValue:this},{provide:Ku,useValue:this.componentFactoryResolver}],Lt(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,t=si.THROW_IF_NOT_FOUND,i=$e.Default){return e===si||e===Es||e===Wy?this:this._r3Injector.get(e,t,i)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class _v extends DT{constructor(e){super(),this.moduleType=e,null!==er(e)&&function B5(n){const e=new Set;!function t(i){const r=er(i,!0),s=r.id;null!==s&&(function AT(n,e,t){if(e&&e!==t)throw new Error(`Duplicate module registered for ${n} - ${Lt(e)} vs ${Lt(e.name)}`)}(s,Wl.get(s),i),Wl.set(s,i));const o=Wr(r.imports);for(const a of o)e.has(a)||(e.add(a),t(a))}(n)}(e)}create(e){return new RT(this.moduleType,e)}}function Xf(n,e,t){const i=hi()+n,r=te();return r[i]===Qe?$r(r,i,t?e.call(t):e()):function ju(n,e){return n[e]}(r,i)}function ji(n,e,t,i){return function NT(n,e,t,i,r,s){const o=e+t;return oi(n,o,r)?$r(n,o+1,s?i.call(s,r):i(r)):td(n,o+1)}(te(),hi(),n,e,t,i)}function yv(n,e,t,i,r){return LT(te(),hi(),n,e,t,i,r)}function PT(n,e,t,i,r,s){return function OT(n,e,t,i,r,s,o,a){const l=e+t;return function Vf(n,e,t,i,r){const s=aa(n,e,t,i);return oi(n,e+2,r)||s}(n,l,r,s,o)?$r(n,l+3,a?i.call(a,r,s,o):i(r,s,o)):td(n,l+3)}(te(),hi(),n,e,t,i,r,s)}function td(n,e){const t=n[e];return t===Qe?void 0:t}function LT(n,e,t,i,r,s,o){const a=e+t;return aa(n,a,r,s)?$r(n,a+2,o?i.call(o,r,s):i(r,s)):td(n,a+2)}function vv(n,e){const t=Mt();let i;const r=n+20;t.firstCreatePass?(i=function j5(n,e){if(e)for(let t=e.length-1;t>=0;t--){const i=e[t];if(n===i.name)return i}}(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks||(t.destroyHooks=[])).push(r,i.onDestroy)):i=t.data[r];const s=i.factory||(i.factory=sa(i.type)),o=Zs($);try{const a=gf(!1),l=s();return gf(a),function p4(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}(t,te(),r,l),l}finally{Zs(o)}}function wv(n,e,t,i){const r=n+20,s=te(),o=ll(s,r);return function nd(n,e){return n[1].data[e].pure}(s,r)?LT(s,hi(),e,o.transform,t,i,o):o.transform(t,i)}function bv(n){return e=>{setTimeout(n,void 0,e)}}const pt=class Q5 extends gr{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){var r,s,o;let a=e,l=t||(()=>null),c=i;if(e&&"object"==typeof e){const d=e;a=null===(r=d.next)||void 0===r?void 0:r.bind(d),l=null===(s=d.error)||void 0===s?void 0:s.bind(d),c=null===(o=d.complete)||void 0===o?void 0:o.bind(d)}this.__isAsync&&(l=bv(l),a&&(a=bv(a)),c&&(c=bv(c)));const u=super.subscribe({next:a,error:l,complete:c});return e instanceof Ni&&e.add(u),u}};function J5(){return this._results[Tl()]()}class xv{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=Tl(),i=xv.prototype;i[t]||(i[t]=J5)}get changes(){return this._changes||(this._changes=new pt)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const r=sr(e);(this._changesDetected=!function ak(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let Ts=(()=>{class n{}return n.__NG_ELEMENT_ID__=eH,n})();const K5=Ts,Z5=class extends K5{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}createEmbeddedView(e){const t=this._declarationTContainer.tViews,i=Hu(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);i[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(i[19]=s.createEmbeddedView(t)),zu(t,i,e),new ed(i)}};function eH(){return Qf(Fn(),te())}function Qf(n,e){return 4&n.type?new Z5(e,n,Gl(n,e)):null}let Er=(()=>{class n{}return n.__NG_ELEMENT_ID__=tH,n})();function tH(){return UT(Fn(),te())}const nH=Er,BT=class extends nH{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return Gl(this._hostTNode,this._hostLView)}get injector(){return new hl(this._hostTNode,this._hostLView)}get parentInjector(){const e=_f(this._hostTNode,this._hostLView);if(RM(e)){const t=dl(e,this._hostLView),i=ul(e);return new hl(t[1].data[i+8],t)}return new hl(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=VT(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,i){const r=e.createEmbeddedView(t||{});return this.insert(r,i),r}createComponent(e,t,i,r,s){const o=e&&!function Tu(n){return"function"==typeof n}(e);let a;if(o)a=t;else{const d=t||{};a=d.index,i=d.injector,r=d.projectableNodes,s=d.ngModuleRef}const l=o?e:new gv(ti(e)),c=i||this.parentInjector;if(!s&&null==l.ngModule){const h=(o?c:this.parentInjector).get(Es,null);h&&(s=h)}const u=l.create(c,r,void 0,s);return this.insert(u.hostView,a),u}insert(e,t){const i=e._lView,r=i[1];if(function DF(n){return vr(n[3])}(i)){const u=this.indexOf(e);if(-1!==u)this.detach(u);else{const d=i[3],h=new BT(d,d[6],d[3]);h.detach(h.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;!function PB(n,e,t,i){const r=10+i,s=t.length;i>0&&(t[r-1][4]=e),i<s-10?(e[4]=t[r],HM(t,10+i,e)):(t.push(e),e[4]=null),e[3]=t;const o=e[17];null!==o&&t!==o&&function NB(n,e){const t=n[9];e[16]!==e[3][3][16]&&(n[2]=!0),null===t?n[9]=[e]:t.push(e)}(o,e);const a=e[19];null!==a&&a.insertView(n),e[2]|=128}(r,i,o,s);const a=wy(s,o),l=i[11],c=Af(l,o[7]);return null!==c&&function AB(n,e,t,i,r,s){i[0]=r,i[6]=e,Uu(n,i,t,1,r,s)}(r,o[6],l,i,c,a),e.attachToViewContainerRef(),HM(Cv(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=VT(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=_y(this._lContainer,t);i&&(wf(Cv(this._lContainer),t),SS(i[1],i))}detach(e){const t=this._adjustIndex(e,-1),i=_y(this._lContainer,t);return i&&null!=wf(Cv(this._lContainer),t)?new ed(i):null}_adjustIndex(e,t=0){return null==e?this.length+t:e}};function VT(n){return n[8]}function Cv(n){return n[8]||(n[8]=[])}function UT(n,e){let t;const i=e[n.index];if(vr(i))t=i;else{let r;if(8&n.type)r=Sn(i);else{const s=e[11];r=s.createComment("");const o=rr(n,e);oa(s,Af(s,o),r,function kB(n,e){return pn(n)?n.nextSibling(e):e.nextSibling}(s,o),!1)}e[n.index]=t=pE(i,e,r,n),Ff(e,t)}return new BT(t,n,e)}class Mv{constructor(e){this.queryList=e,this.matches=null}clone(){return new Mv(this.queryList)}setDirty(){this.queryList.setDirty()}}class Sv{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new Sv(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==jT(e,t).matches&&this.queries[t].setDirty()}}class HT{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class Ev{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new Ev(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class Tv{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new Tv(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,sH(t,s)),this.matchTNodeWithReadOption(e,t,vf(t,e,s,!1,!1))}else i===Ts?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,vf(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===Wi||r===Er||r===Ts&&4&t.type)this.addMatch(t.index,-2);else{const s=vf(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function sH(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function aH(n,e,t,i){return-1===t?function oH(n,e){return 11&n.type?Gl(n,e):4&n.type?Qf(n,e):null}(e,n):-2===t?function lH(n,e,t){return t===Wi?Gl(e,n):t===Ts?Qf(e,n):t===Er?UT(e,n):void 0}(n,e,i):Mu(n,n[1],t,e)}function zT(n,e,t,i){const r=e[19].queries[i];if(null===r.matches){const s=n.data,o=t.matches,a=[];for(let l=0;l<o.length;l+=2){const c=o[l];a.push(c<0?null:aH(e,s[c],o[l+1],t.metadata.read))}r.matches=a}return r.matches}function Dv(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=zT(n,e,r,t);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)i.push(o[a/2]);else{const c=s[a+1],u=e[-l];for(let d=10;d<u.length;d++){const h=u[d];h[17]===h[3]&&Dv(h[1],h,c,i)}if(null!==u[9]){const d=u[9];for(let h=0;h<d.length;h++){const f=d[h];Dv(f[1],f,c,i)}}}}}return i}function id(n){const e=te(),t=Mt(),i=xM();U_(i+1);const r=jT(t,i);if(n.dirty&&gM(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const s=r.crossesNgTemplate?Dv(t,e,i,[]):zT(t,e,r,i);n.reset(s,T5),n.notifyOnChanges()}return!0}return!1}function Av(n,e,t){const i=Mt();i.firstCreatePass&&(function WT(n,e,t){null===n.queries&&(n.queries=new Ev),n.queries.track(new Tv(e,t))}(i,new HT(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),function GT(n,e,t){const i=new xv(4==(4&t));oE(n,e,i,i.destroy),null===e[19]&&(e[19]=new Sv),e[19].queries.push(new Mv(i))}(i,te(),e)}function rd(){return function cH(n,e){return n[19].queries[e].queryList}(te(),xM())}function jT(n,e){return n.queries.getByIndex(e)}function Zf(...n){}const Fv=new lt("Application Initializer");let kv=(()=>{class n{constructor(t){this.appInits=t,this.resolve=Zf,this.reject=Zf,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const t=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if($u(s))t.push(s);else if(rv(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}}return n.\u0275fac=function(t){return new(t||n)(pe(Fv,8))},n.\u0275prov=Ne({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const od=new lt("AppId",{providedIn:"root",factory:function lD(){return`${Bv()}${Bv()}${Bv()}`}});function Bv(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const cD=new lt("Platform Initializer"),ep=new lt("Platform ID"),uD=new lt("appBootstrapListener");let dD=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ne({token:n,factory:n.\u0275fac}),n})();const co=new lt("LocaleId",{providedIn:"root",factory:()=>wk(co,$e.Optional|$e.SkipSelf)||function DH(){return"undefined"!=typeof $localize&&$localize.locale||Gf}()});class IH{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let hD=(()=>{class n{compileModuleSync(t){return new _v(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),s=Wr(er(t).declarations).reduce((o,a)=>{const l=ti(a);return l&&o.push(new gv(l)),o},[]);return new IH(i,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ne({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const PH=(()=>Promise.resolve(0))();function Vv(n){"undefined"==typeof Zone?PH.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class Jn{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new pt(!1),this.onMicrotaskEmpty=new pt(!1),this.onStable=new pt(!1),this.onError=new pt(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function NH(){let n=Bt.requestAnimationFrame,e=Bt.cancelAnimationFrame;if("undefined"!=typeof Zone&&n&&e){const t=n[Zone.__symbol__("OriginalDelegate")];t&&(n=t);const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function FH(n){const e=()=>{!function OH(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Bt,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,Hv(n),n.isCheckStableRunning=!0,Uv(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),Hv(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,o,a)=>{try{return fD(n),t.invokeTask(r,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),pD(n)}},onInvoke:(t,i,r,s,o,a,l)=>{try{return fD(n),t.invoke(r,s,o,a,l)}finally{n.shouldCoalesceRunChangeDetection&&e(),pD(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,Hv(n),Uv(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Jn.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Jn.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,LH,Zf,Zf);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const LH={};function Uv(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function Hv(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function fD(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function pD(n){n._nesting--,Uv(n)}class kH{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new pt,this.onMicrotaskEmpty=new pt,this.onStable=new pt,this.onError=new pt}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}let zv=(()=>{class n{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Jn.assertNotInAngularZone(),Vv(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Vv(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,i,r){return[]}}return n.\u0275fac=function(t){return new(t||n)(pe(Jn))},n.\u0275prov=Ne({token:n,factory:n.\u0275fac}),n})(),mD=(()=>{class n{constructor(){this._applications=new Map,Gv.addToWindow(this)}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return Gv.findTestabilityInTree(this,t,i)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ne({token:n,factory:n.\u0275fac}),n})();class BH{addToWindow(e){}findTestabilityInTree(e,t,i){return null}}let Tr,Gv=new BH;const gD=new lt("AllowMultipleToken");class _D{constructor(e,t){this.name=e,this.token=t}}function yD(n,e,t=[]){const i=`Platform: ${e}`,r=new lt(i);return(s=[])=>{let o=vD();if(!o||o.injector.get(gD,!1))if(n)n(t.concat(s).concat({provide:r,useValue:!0}));else{const a=t.concat(s).concat({provide:r,useValue:!0},{provide:jy,useValue:"platform"});!function zH(n){if(Tr&&!Tr.destroyed&&!Tr.injector.get(gD,!1))throw new Ct(400,"");Tr=n.get(wD);const e=n.get(cD,null);e&&e.forEach(t=>t())}(si.create({providers:a,name:i}))}return function GH(n){const e=vD();if(!e)throw new Ct(401,"");return e}()}}function vD(){return Tr&&!Tr.destroyed?Tr:null}let wD=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const a=function WH(n,e){let t;return t="noop"===n?new kH:("zone.js"===n?void 0:n)||new Jn({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==e?void 0:e.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==e?void 0:e.ngZoneRunCoalescing)}),t}(i?i.ngZone:void 0,{ngZoneEventCoalescing:i&&i.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:i&&i.ngZoneRunCoalescing||!1}),l=[{provide:Jn,useValue:a}];return a.run(()=>{const c=si.create({providers:l,parent:this.injector,name:t.moduleType.name}),u=t.create(c),d=u.injector.get(Bu,null);if(!d)throw new Ct(402,"");return a.runOutsideAngular(()=>{const h=a.onError.subscribe({next:f=>{d.handleError(f)}});u.onDestroy(()=>{jv(this._modules,u),h.unsubscribe()})}),function jH(n,e,t){try{const i=t();return $u(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(d,a,()=>{const h=u.injector.get(kv);return h.runInitializers(),h.donePromise.then(()=>(function DU(n){Fi(n,"Expected localeId to be defined"),"string"==typeof n&&(K1=n.toLowerCase().replace(/_/g,"-"))}(u.injector.get(co,Gf)||Gf),this._moduleDoBootstrap(u),u))})})}bootstrapModule(t,i=[]){const r=bD({},i);return function UH(n,e,t){const i=new _v(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get(Wv);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new Ct(403,"");t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Ct(404,"");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(t){return new(t||n)(pe(si))},n.\u0275prov=Ne({token:n,factory:n.\u0275fac}),n})();function bD(n,e){return Array.isArray(e)?e.reduce(bD,n):Object.assign(Object.assign({},n),e)}let Wv=(()=>{class n{constructor(t,i,r,s,o){this._zone=t,this._injector=i,this._exceptionHandler=r,this._componentFactoryResolver=s,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const a=new en(c=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{c.next(this._stable),c.complete()})}),l=new en(c=>{let u;this._zone.runOutsideAngular(()=>{u=this._zone.onStable.subscribe(()=>{Jn.assertNotInAngularZone(),Vv(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,c.next(!0))})})});const d=this._zone.onUnstable.subscribe(()=>{Jn.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{c.next(!1)}))});return()=>{u.unsubscribe(),d.unsubscribe()}});this.isStable=function qO(...n){const e=mu(n),t=function UO(n,e){return"number"==typeof p_(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?Br(i[0]):pu(t)(On(i,e)):_s}(a,l.pipe(function YO(n={}){const{connector:e=(()=>new gr),resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return s=>{let o=null,a=null,l=null,c=0,u=!1,d=!1;const h=()=>{null==a||a.unsubscribe(),a=null},f=()=>{h(),o=l=null,u=d=!1},p=()=>{const _=o;f(),null==_||_.unsubscribe()};return Ln((_,y)=>{c++,!d&&!u&&h();const g=l=null!=l?l:e();y.add(()=>{c--,0===c&&!d&&!u&&(a=m_(p,r))}),g.subscribe(y),o||(o=new Qh({next:m=>g.next(m),error:m=>{d=!0,h(),a=m_(f,t,m),g.error(m)},complete:()=>{u=!0,h(),a=m_(f,i),g.complete()}}),On(_).subscribe(o))})(s)}}()))}bootstrap(t,i){if(!this._initStatus.done)throw new Ct(405,"");let r;r=t instanceof CT?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(r.componentType);const s=function HH(n){return n.isBoundToModule}(r)?void 0:this._injector.get(Es),a=r.create(si.NULL,[],i||r.selector,s),l=a.location.nativeElement,c=a.injector.get(zv,null),u=c&&a.injector.get(mD);return c&&u&&u.registerApplication(l,c),a.onDestroy(()=>{this.detachView(a.hostView),jv(this.components,a),u&&u.unregisterApplication(l)}),this._loadComponent(a),a}tick(){if(this._runningTick)throw new Ct(101,"");try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;jv(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(uD,[]).concat(this._bootstrapListeners).forEach(r=>r(t))}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return n.\u0275fac=function(t){return new(t||n)(pe(Jn),pe(si),pe(Bu),pe(Ku),pe(kv))},n.\u0275prov=Ne({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function jv(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}let CD=!0,tp=(()=>{class n{}return n.__NG_ELEMENT_ID__=YH,n})();function YH(n){return function XH(n,e,t){if(rf(n)&&!t){const i=Vi(n.index,e);return new ed(i,i)}return 47&n.type?new ed(e[16],e):null}(Fn(),te(),16==(16&n))}class DD{constructor(){}supports(e){return Wu(e)}create(e){return new t8(e)}}const e8=(n,e)=>e;class t8{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||e8}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,s=null;for(;t||i;){const o=!i||t&&t.currentIndex<ID(i,r,s)?t:i,a=ID(o,r,s),l=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const c=a-r,u=l-r;if(c!=u){for(let h=0;h<c;h++){const f=h<s.length?s[h]:s[h]=0,p=f+h;u<=p&&p<c&&(s[h]=f+1)}s[o.previousIndex]=u-c}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!Wu(e))throw new Ct(900,"");return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),i=!0),t=t._next}else r=0,function h4(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[Tl()]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,a=>{o=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new n8(t,i),s,r),e}_verifyReinsertion(e,t,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new AD),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new AD),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class n8{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class i8{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class AD{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new i8,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function ID(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}class RD{constructor(){}supports(e){return e instanceof Map||Jy(e)}create(){return new r8}}class r8{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||Jy(e)))throw new Ct(900,"")}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const i=new s8(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class s8{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function PD(){return new rp([new DD])}let rp=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||PD()),deps:[[n,new Pu,new so]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new Ct(901,"")}}return n.\u0275prov=Ne({token:n,providedIn:"root",factory:PD}),n})();function ND(){return new ad([new RD])}let ad=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||ND()),deps:[[n,new Pu,new so]]}}find(t){const i=this.factories.find(s=>s.supports(t));if(i)return i;throw new Ct(901,"")}}return n.\u0275prov=Ne({token:n,providedIn:"root",factory:ND}),n})();const l8=yD(null,"core",[{provide:ep,useValue:"unknown"},{provide:wD,deps:[si]},{provide:mD,deps:[]},{provide:dD,deps:[]}]);let c8=(()=>{class n{constructor(t){}}return n.\u0275fac=function(t){return new(t||n)(pe(Wv))},n.\u0275mod=Zi({type:n}),n.\u0275inj=ki({}),n})(),sp=null;function Jr(){return sp}const $i=new lt("DocumentToken");let ua=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ne({token:n,factory:function(){return function f8(){return pe(LD)}()},providedIn:"platform"}),n})();const p8=new lt("Location Initialized");let LD=(()=>{class n extends ua{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Jr().getBaseHref(this._doc)}onPopState(t){const i=Jr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=Jr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,i,r){OD()?this._history.pushState(t,i,r):this.location.hash=r}replaceState(t,i,r){OD()?this._history.replaceState(t,i,r):this.location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(pe($i))},n.\u0275prov=Ne({token:n,factory:function(){return function m8(){return new LD(pe($i))}()},providedIn:"platform"}),n})();function OD(){return!!window.history.pushState}function Qv(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function FD(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function Ds(n){return n&&"?"!==n[0]?"?"+n:n}let $l=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ne({token:n,factory:function(){return function g8(n){const e=pe($i).location;return new kD(pe(ua),e&&e.origin||"")}()},providedIn:"root"}),n})();const Jv=new lt("appBaseHref");let kD=(()=>{class n extends $l{constructor(t,i){if(super(),this._platformLocation=t,this._removeListenerFns=[],null==i&&(i=this._platformLocation.getBaseHrefFromDOM()),null==i)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=i}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Qv(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+Ds(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const o=this.prepareExternalUrl(r+Ds(s));this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){const o=this.prepareExternalUrl(r+Ds(s));this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var i,r;null===(r=(i=this._platformLocation).historyGo)||void 0===r||r.call(i,t)}}return n.\u0275fac=function(t){return new(t||n)(pe(ua),pe(Jv,8))},n.\u0275prov=Ne({token:n,factory:n.\u0275fac}),n})(),_8=(()=>{class n extends $l{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=Qv(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,s){let o=this.prepareExternalUrl(r+Ds(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){let o=this.prepareExternalUrl(r+Ds(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var i,r;null===(r=(i=this._platformLocation).historyGo)||void 0===r||r.call(i,t)}}return n.\u0275fac=function(t){return new(t||n)(pe(ua),pe(Jv,8))},n.\u0275prov=Ne({token:n,factory:n.\u0275fac}),n})(),Kv=(()=>{class n{constructor(t,i){this._subject=new pt,this._urlChangeListeners=[],this._platformStrategy=t;const r=this._platformStrategy.getBaseHref();this._platformLocation=i,this._baseHref=FD(BD(r)),this._platformStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+Ds(i))}normalize(t){return n.stripTrailingSlash(function v8(n,e){return n&&e.startsWith(n)?e.substring(n.length):e}(this._baseHref,BD(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._platformStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Ds(i)),r)}replaceState(t,i="",r=null){this._platformStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Ds(i)),r)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(t=0){var i,r;null===(r=(i=this._platformStrategy).historyGo)||void 0===r||r.call(i,t)}onUrlChange(t){this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}))}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}}return n.normalizeQueryParams=Ds,n.joinWithSlash=Qv,n.stripTrailingSlash=FD,n.\u0275fac=function(t){return new(t||n)(pe($l),pe(ua))},n.\u0275prov=Ne({token:n,factory:function(){return function y8(){return new Kv(pe($l),pe(ua))}()},providedIn:"root"}),n})();function BD(n){return n.replace(/\/index.html$/,"")}var Ti=(()=>((Ti=Ti||{})[Ti.Decimal=0]="Decimal",Ti[Ti.Percent=1]="Percent",Ti[Ti.Currency=2]="Currency",Ti[Ti.Scientific=3]="Scientific",Ti))(),ke=(()=>((ke=ke||{})[ke.Decimal=0]="Decimal",ke[ke.Group=1]="Group",ke[ke.List=2]="List",ke[ke.PercentSign=3]="PercentSign",ke[ke.PlusSign=4]="PlusSign",ke[ke.MinusSign=5]="MinusSign",ke[ke.Exponential=6]="Exponential",ke[ke.SuperscriptingExponent=7]="SuperscriptingExponent",ke[ke.PerMille=8]="PerMille",ke[ke.Infinity=9]="Infinity",ke[ke.NaN=10]="NaN",ke[ke.TimeSeparator=11]="TimeSeparator",ke[ke.CurrencyDecimal=12]="CurrencyDecimal",ke[ke.CurrencyGroup=13]="CurrencyGroup",ke))();function ar(n,e){const t=mi(n),i=t[be.NumberSymbols][e];if(void 0===i){if(e===ke.CurrencyDecimal)return t[be.NumberSymbols][ke.Decimal];if(e===ke.CurrencyGroup)return t[be.NumberSymbols][ke.Group]}return i}const j8=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function a0(n){const e=parseInt(n);if(isNaN(e))throw new Error("Invalid integer literal when parsing "+n);return e}function qD(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}let ud=(()=>{class n{constructor(t,i,r,s){this._iterableDiffers=t,this._keyValueDiffers=i,this._ngEl=r,this._renderer=s,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(t){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof t?t.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(t){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof t?t.split(/\s+/):t,this._rawClass&&(Wu(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const t=this._iterableDiffer.diff(this._rawClass);t&&this._applyIterableChanges(t)}else if(this._keyValueDiffer){const t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}_applyKeyValueChanges(t){t.forEachAddedItem(i=>this._toggleClass(i.key,i.currentValue)),t.forEachChangedItem(i=>this._toggleClass(i.key,i.currentValue)),t.forEachRemovedItem(i=>{i.previousValue&&this._toggleClass(i.key,!1)})}_applyIterableChanges(t){t.forEachAddedItem(i=>{if("string"!=typeof i.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${Lt(i.item)}`);this._toggleClass(i.item,!0)}),t.forEachRemovedItem(i=>this._toggleClass(i.item,!1))}_applyClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(i=>this._toggleClass(i,!0)):Object.keys(t).forEach(i=>this._toggleClass(i,!!t[i])))}_removeClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(i=>this._toggleClass(i,!1)):Object.keys(t).forEach(i=>this._toggleClass(i,!1)))}_toggleClass(t,i){(t=t.trim())&&t.split(/\s+/g).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return n.\u0275fac=function(t){return new(t||n)($(rp),$(ad),$(Wi),$(Ss))},n.\u0275dir=Ge({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),n})();class i6{constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let dd=(()=>{class n{constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=this._viewContainer;t.forEachOperation((r,s,o)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new i6(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)i.remove(null===s?void 0:s);else if(null!==s){const a=i.get(s);i.move(a,o),YD(a,r)}});for(let r=0,s=i.length;r<s;r++){const a=i.get(r).context;a.index=r,a.count=s,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{YD(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)($(Er),$(Ts),$(rp))},n.\u0275dir=Ge({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),n})();function YD(n,e){n.context.$implicit=e.item}let Is=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new r6,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){XD("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){XD("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)($(Er),$(Ts))},n.\u0275dir=Ge({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),n})();class r6{constructor(){this.$implicit=null,this.ngIf=null}}function XD(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${Lt(e)}'.`)}class c0{constructor(e,t){this._viewContainerRef=e,this._templateRef=t,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(e){e&&!this._created?this.create():!e&&this._created&&this.destroy()}}let mp=(()=>{class n{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(t){this._ngSwitch=t,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(t){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(t)}_matchCase(t){const i=t==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||i,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),i}_updateDefaultCases(t){if(this._defaultViews&&t!==this._defaultUsed){this._defaultUsed=t;for(let i=0;i<this._defaultViews.length;i++)this._defaultViews[i].enforceState(t)}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=Ge({type:n,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"}}),n})(),QD=(()=>{class n{constructor(t,i,r){this.ngSwitch=r,r._addCase(),this._view=new c0(t,i)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return n.\u0275fac=function(t){return new(t||n)($(Er),$(Ts),$(mp,9))},n.\u0275dir=Ge({type:n,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"}}),n})(),Rs=(()=>{class n{constructor(t,i,r){this._ngEl=t,this._differs=i,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){const t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,i){const[r,s]=t.split(".");null!=(i=null!=i&&s?`${i}${s}`:i)?this._renderer.setStyle(this._ngEl.nativeElement,r,i):this._renderer.removeStyle(this._ngEl.nativeElement,r)}_applyChanges(t){t.forEachRemovedItem(i=>this._setStyle(i.key,null)),t.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),t.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}}return n.\u0275fac=function(t){return new(t||n)($(Wi),$(ad),$(Ss))},n.\u0275dir=Ge({type:n,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}}),n})();let ZD=(()=>{class n{constructor(t){this._locale=t}transform(t,i,r){if(!function u0(n){return!(null==n||""===n||n!=n)}(t))return null;r=r||this._locale;try{return function J8(n,e,t){return function s0(n,e,t,i,r,s,o=!1){let a="",l=!1;if(isFinite(n)){let c=function Z8(n){let i,r,s,o,a,e=Math.abs(n)+"",t=0;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(s=e.search(/e/i))>0?(r<0&&(r=s),r+=+e.slice(s+1),e=e.substring(0,s)):r<0&&(r=e.length),s=0;"0"===e.charAt(s);s++);if(s===(a=e.length))i=[0],r=1;else{for(a--;"0"===e.charAt(a);)a--;for(r-=s,i=[],o=0;s<=a;s++,o++)i[o]=Number(e.charAt(s))}return r>22&&(i=i.splice(0,21),t=r-1,r=1),{digits:i,exponent:t,integerLen:r}}(n);o&&(c=function K8(n){if(0===n.digits[0])return n;const e=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(0===e?n.digits.push(0,0):1===e&&n.digits.push(0),n.integerLen+=2),n}(c));let u=e.minInt,d=e.minFrac,h=e.maxFrac;if(s){const m=s.match(j8);if(null===m)throw new Error(`${s} is not a valid digit info`);const v=m[1],w=m[3],b=m[5];null!=v&&(u=a0(v)),null!=w&&(d=a0(w)),null!=b?h=a0(b):null!=w&&d>h&&(h=d)}!function e6(n,e,t){if(e>t)throw new Error(`The minimum number of digits after fraction (${e}) is higher than the maximum (${t}).`);let i=n.digits,r=i.length-n.integerLen;const s=Math.min(Math.max(e,r),t);let o=s+n.integerLen,a=i[o];if(o>0){i.splice(Math.max(n.integerLen,o));for(let d=o;d<i.length;d++)i[d]=0}else{r=Math.max(0,r),n.integerLen=1,i.length=Math.max(1,o=s+1),i[0]=0;for(let d=1;d<o;d++)i[d]=0}if(a>=5)if(o-1<0){for(let d=0;d>o;d--)i.unshift(0),n.integerLen++;i.unshift(1),n.integerLen++}else i[o-1]++;for(;r<Math.max(0,s);r++)i.push(0);let l=0!==s;const c=e+n.integerLen,u=i.reduceRight(function(d,h,f,p){return p[f]=(h+=d)<10?h:h-10,l&&(0===p[f]&&f>=c?p.pop():l=!1),h>=10?1:0},0);u&&(i.unshift(u),n.integerLen++)}(c,d,h);let f=c.digits,p=c.integerLen;const _=c.exponent;let y=[];for(l=f.every(m=>!m);p<u;p++)f.unshift(0);for(;p<0;p++)f.unshift(0);p>0?y=f.splice(p,f.length):(y=f,f=[0]);const g=[];for(f.length>=e.lgSize&&g.unshift(f.splice(-e.lgSize,f.length).join(""));f.length>e.gSize;)g.unshift(f.splice(-e.gSize,f.length).join(""));f.length&&g.unshift(f.join("")),a=g.join(ar(t,i)),y.length&&(a+=ar(t,r)+y.join("")),_&&(a+=ar(t,ke.Exponential)+"+"+_)}else a=ar(t,ke.Infinity);return a=n<0&&!l?e.negPre+a+e.negSuf:e.posPre+a+e.posSuf,a}(n,function o0(n,e="-"){const t={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},i=n.split(";"),r=i[0],s=i[1],o=-1!==r.indexOf(".")?r.split("."):[r.substring(0,r.lastIndexOf("0")+1),r.substring(r.lastIndexOf("0")+1)],a=o[0],l=o[1]||"";t.posPre=a.substr(0,a.indexOf("#"));for(let u=0;u<l.length;u++){const d=l.charAt(u);"0"===d?t.minFrac=t.maxFrac=u+1:"#"===d?t.maxFrac=u+1:t.posSuf+=d}const c=a.split(",");if(t.gSize=c[1]?c[1].length:0,t.lgSize=c[2]||c[1]?(c[2]||c[1]).length:0,s){const u=r.length-t.posPre.length-t.posSuf.length,d=s.indexOf("#");t.negPre=s.substr(0,d).replace(/'/g,""),t.negSuf=s.substr(d+u).replace(/'/g,"")}else t.negPre=e+t.posPre,t.negSuf=t.posSuf;return t}(function Zv(n,e){return mi(n)[be.NumberFormats][e]}(e,Ti.Decimal),ar(e,ke.MinusSign)),e,ke.Group,ke.Decimal,t)}(function d0(n){if("string"==typeof n&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if("number"!=typeof n)throw new Error(`${n} is not a number`);return n}(t),r,i)}catch(s){throw function Ar(n,e){return new Ct(2100,"")}()}}}return n.\u0275fac=function(t){return new(t||n)($(co,16))},n.\u0275pipe=Mi({name:"number",type:n,pure:!0}),n})();let D6=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Zi({type:n}),n.\u0275inj=ki({}),n})();let P6=(()=>{class n{}return n.\u0275prov=Ne({token:n,providedIn:"root",factory:()=>new N6(pe($i),window)}),n})();class N6{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function L6(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=tA(this.window.history)||tA(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(e){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}function tA(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class nA{}class h0 extends class O6 extends class h8{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function d8(n){sp||(sp=n)}(new h0)}onAndCancel(e,t,i){return e.addEventListener(t,i,!1),()=>{e.removeEventListener(t,i,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function F6(){return hd=hd||document.querySelector("base"),hd?hd.getAttribute("href"):null}();return null==t?null:function k6(n){gp=gp||document.createElement("a"),gp.setAttribute("href",n);const e=gp.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){hd=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return qD(document.cookie,e)}}let gp,hd=null;const iA=new lt("TRANSITION_ID"),V6=[{provide:Fv,useFactory:function B6(n,e,t){return()=>{t.get(kv).donePromise.then(()=>{const i=Jr(),r=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let s=0;s<r.length;s++)i.remove(r[s])})}},deps:[iA,$i,si],multi:!0}];class f0{static init(){!function VH(n){Gv=n}(new f0)}addToWindow(e){Bt.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new Error("Could not find testability for element.");return s},Bt.getAllAngularTestabilities=()=>e.getAllTestabilities(),Bt.getAllAngularRootElements=()=>e.getAllRootElements(),Bt.frameworkStabilizers||(Bt.frameworkStabilizers=[]),Bt.frameworkStabilizers.push(i=>{const r=Bt.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&i(o)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(e,t,i){if(null==t)return null;const r=e.getTestability(t);return null!=r?r:i?Jr().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}let U6=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ne({token:n,factory:n.\u0275fac}),n})();const _p=new lt("EventManagerPlugins");let yp=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>r.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}addGlobalEventListener(t,i,r){return this._findPluginFor(i).addGlobalEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){const i=this._eventNameToPlugin.get(t);if(i)return i;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(t))return this._eventNameToPlugin.set(t,o),o}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(pe(_p),pe(Jn))},n.\u0275prov=Ne({token:n,factory:n.\u0275fac}),n})();class rA{constructor(e){this._doc=e}addGlobalEventListener(e,t,i){const r=Jr().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,i)}}let sA=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(t){const i=new Set;t.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),i.add(r))}),this.onStylesAdded(i)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ne({token:n,factory:n.\u0275fac}),n})(),fd=(()=>{class n extends sA{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,i,r){t.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,r.push(i.appendChild(o))})}addHost(t){const i=[];this._addStylesToHost(this._stylesSet,t,i),this._hostNodes.set(t,i)}removeHost(t){const i=this._hostNodes.get(t);i&&i.forEach(oA),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((i,r)=>{this._addStylesToHost(t,r,i)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(oA))}}return n.\u0275fac=function(t){return new(t||n)(pe($i))},n.\u0275prov=Ne({token:n,factory:n.\u0275fac}),n})();function oA(n){Jr().remove(n)}const p0={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},m0=/%COMP%/g;function vp(n,e,t){for(let i=0;i<e.length;i++){let r=e[i];Array.isArray(r)?vp(n,r,t):(r=r.replace(m0,n),t.push(r))}return t}function cA(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let g0=(()=>{class n{constructor(t,i,r){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new _0(t)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;switch(i.encapsulation){case Vr.Emulated:{let r=this.rendererByCompId.get(i.id);return r||(r=new $6(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,r)),r.applyToHost(t),r}case 1:case Vr.ShadowDom:return new q6(this.eventManager,this.sharedStylesHost,t,i);default:if(!this.rendererByCompId.has(i.id)){const r=vp(i.id,i.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(pe(yp),pe(fd),pe(od))},n.\u0275prov=Ne({token:n,factory:n.\u0275fac}),n})();class _0{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(p0[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,i){e&&e.insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error(`The selector "${e}" did not match any elements`);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=p0[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=p0[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(Hi.DashCase|Hi.Important)?e.style.setProperty(t,i,r&Hi.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Hi.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,cA(i)):this.eventManager.addEventListener(e,t,cA(i))}}class $6 extends _0{constructor(e,t,i,r){super(e),this.component=i;const s=vp(r+"-"+i.id,i.styles,[]);t.addStyles(s),this.contentAttr=function G6(n){return"_ngcontent-%COMP%".replace(m0,n)}(r+"-"+i.id),this.hostAttr=function W6(n){return"_nghost-%COMP%".replace(m0,n)}(r+"-"+i.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}class q6 extends _0{constructor(e,t,i,r){super(e),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=vp(r.id,r.styles,[]);for(let o=0;o<s.length;o++){const a=document.createElement("style");a.textContent=s[o],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let Y6=(()=>{class n extends rA{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}}return n.\u0275fac=function(t){return new(t||n)(pe($i))},n.\u0275prov=Ne({token:n,factory:n.\u0275fac}),n})();const dA=["alt","control","meta","shift"],Q6={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},hA={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},J6={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let K6=(()=>{class n extends rA{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Jr().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="";if(dA.forEach(l=>{const c=i.indexOf(l);c>-1&&(i.splice(c,1),o+=l+".")}),o+=s,0!=i.length||0===s.length)return null;const a={};return a.domEventName=r,a.fullKey=o,a}static getEventFullKey(t){let i="",r=function Z6(n){let e=n.key;if(null==e){if(e=n.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===n.location&&hA.hasOwnProperty(e)&&(e=hA[e]))}return Q6[e]||e}(t);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),dA.forEach(s=>{s!=r&&J6[s](t)&&(i+=s+".")}),i+=r,i}static eventCallback(t,i,r){return s=>{n.getEventFullKey(s)===t&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(pe($i))},n.\u0275prov=Ne({token:n,factory:n.\u0275fac}),n})();const iz=yD(l8,"browser",[{provide:ep,useValue:"browser"},{provide:cD,useValue:function ez(){h0.makeCurrent(),f0.init()},multi:!0},{provide:$i,useFactory:function nz(){return function MF(n){R_=n}(document),document},deps:[]}]),rz=[{provide:jy,useValue:"root"},{provide:Bu,useFactory:function tz(){return new Bu},deps:[]},{provide:_p,useClass:Y6,multi:!0,deps:[$i,Jn,ep]},{provide:_p,useClass:K6,multi:!0,deps:[$i]},{provide:g0,useClass:g0,deps:[yp,fd,od]},{provide:ST,useExisting:g0},{provide:sA,useExisting:fd},{provide:fd,useClass:fd,deps:[$i]},{provide:zv,useClass:zv,deps:[Jn]},{provide:yp,useClass:yp,deps:[_p,Jn]},{provide:nA,useClass:U6,deps:[]}];let sz=(()=>{class n{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:n,providers:[{provide:od,useValue:t.appId},{provide:iA,useExisting:od},V6]}}}return n.\u0275fac=function(t){return new(t||n)(pe(n,12))},n.\u0275mod=Zi({type:n}),n.\u0275inj=ki({providers:rz,imports:[D6,c8]}),n})();function Be(...n){return On(n,mu(n))}"undefined"!=typeof window&&window;class Gn extends gr{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}const{isArray:gz}=Array,{getPrototypeOf:_z,prototype:yz,keys:vz}=Object;function mA(n){if(1===n.length){const e=n[0];if(gz(e))return{args:e,keys:null};if(function wz(n){return n&&"object"==typeof n&&_z(n)===yz}(e)){const t=vz(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}const{isArray:bz}=Array;function gA(n){return tt(e=>function xz(n,e){return bz(e)?n(...e):n(e)}(n,e))}function _A(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}function yA(n,e,t){n?gs(t,n,e):e()}function wp(n,e){const t=qt(n)?n:()=>n,i=r=>r.error(t());return new en(e?r=>e.schedule(i,0,r):i)}const ql=hu(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function bp(...n){return function Sz(){return pu(1)}()(On(n,mu(n)))}function vA(n){return new en(e=>{Br(n()).subscribe(e)})}function wA(){return Ln((n,e)=>{let t=null;n._refCount++;const i=new Mn(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class Ez extends en{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,FC(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,null==e||e.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Ni;const t=this.getSubject();e.add(this.source.subscribe(new Mn(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Ni.EMPTY)}return e}refCount(){return wA()(this)}}function Kr(n,e){return Ln((t,i)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&i.complete();t.subscribe(new Mn(i,l=>{null==r||r.unsubscribe();let c=0;const u=s++;Br(n(l,u)).subscribe(r=new Mn(i,d=>i.next(e?e(l,d,u,c++):d),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function Dz(n,e,t,i,r){return(s,o)=>{let a=t,l=e,c=0;s.subscribe(new Mn(o,u=>{const d=c++;l=a?n(l,u,d):(a=!0,u),i&&o.next(l)},r&&(()=>{a&&o.next(l),o.complete()})))}}function bA(n,e){return Ln(Dz(n,e,arguments.length>=2,!0))}function ho(n,e){return Ln((t,i)=>{let r=0;t.subscribe(new Mn(i,s=>n.call(e,s,r++)&&i.next(s)))})}function Ps(n){return Ln((e,t)=>{let s,i=null,r=!1;i=e.subscribe(new Mn(t,void 0,void 0,o=>{s=Br(n(o,Ps(n)(e))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}function Ns(n,e){return qt(e)?sn(n,e,1):sn(n,1)}function v0(n){return n<=0?()=>_s:Ln((e,t)=>{let i=[];e.subscribe(new Mn(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function xA(n=Az){return Ln((e,t)=>{let i=!1;e.subscribe(new Mn(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function Az(){return new ql}function CA(n){return Ln((e,t)=>{let i=!1;e.subscribe(new Mn(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function Yl(n,e){const t=arguments.length>=2;return i=>i.pipe(n?ho((r,s)=>n(r,s,i)):Zo,Li(1),t?CA(e):xA(()=>new ql))}function qi(n,e,t){const i=qt(n)||e||t?{next:n,error:e,complete:t}:n;return i?Ln((r,s)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let a=!0;r.subscribe(new Mn(s,l=>{var c;null===(c=i.next)||void 0===c||c.call(i,l),s.next(l)},()=>{var l;a=!1,null===(l=i.complete)||void 0===l||l.call(i),s.complete()},l=>{var c;a=!1,null===(c=i.error)||void 0===c||c.call(i,l),s.error(l)},()=>{var l,c;a&&(null===(l=i.unsubscribe)||void 0===l||l.call(i)),null===(c=i.finalize)||void 0===c||c.call(i)}))}):Zo}class Ls{constructor(e,t){this.id=e,this.url=t}}class w0 extends Ls{constructor(e,t,i="imperative",r=null){super(e,t),this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class pd extends Ls{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class MA extends Ls{constructor(e,t,i){super(e,t),this.reason=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Pz extends Ls{constructor(e,t,i){super(e,t),this.error=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Nz extends Ls{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Lz extends Ls{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Oz extends Ls{constructor(e,t,i,r,s){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Fz extends Ls{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class kz extends Ls{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class SA{constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class EA{constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Bz{constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Vz{constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Uz{constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Hz{constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class TA{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const mt="primary";class zz{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function Xl(n){return new zz(n)}const DA="ngNavigationCancelingError";function b0(n){const e=Error("NavigationCancelingError: "+n);return e[DA]=!0,e}function Wz(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const r={};for(let s=0;s<i.length;s++){const o=i[s],a=n[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function Zr(n,e){const t=n?Object.keys(n):void 0,i=e?Object.keys(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!AA(n[r],e[r]))return!1;return!0}function AA(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((r,s)=>i[s]===r)}return n===e}function IA(n){return Array.prototype.concat.apply([],n)}function RA(n){return n.length>0?n[n.length-1]:null}function Kn(n,e){for(const t in n)n.hasOwnProperty(t)&&e(n[t],t)}function es(n){return rv(n)?n:$u(n)?On(Promise.resolve(n)):Be(n)}const qz={exact:function LA(n,e,t){if(!ha(n.segments,e.segments)||!xp(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!LA(n.children[i],e.children[i],t))return!1;return!0},subset:OA},PA={exact:function Yz(n,e){return Zr(n,e)},subset:function Xz(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>AA(n[t],e[t]))},ignored:()=>!0};function NA(n,e,t){return qz[t.paths](n.root,e.root,t.matrixParams)&&PA[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function OA(n,e,t){return FA(n,e,e.segments,t)}function FA(n,e,t,i){if(n.segments.length>t.length){const r=n.segments.slice(0,t.length);return!(!ha(r,t)||e.hasChildren()||!xp(r,t,i))}if(n.segments.length===t.length){if(!ha(n.segments,t)||!xp(n.segments,t,i))return!1;for(const r in e.children)if(!n.children[r]||!OA(n.children[r],e.children[r],i))return!1;return!0}{const r=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!!(ha(n.segments,r)&&xp(n.segments,r,i)&&n.children[mt])&&FA(n.children[mt],e,s,i)}}function xp(n,e,t){return e.every((i,r)=>PA[t](n[r].parameters,i.parameters))}class da{constructor(e,t,i){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Xl(this.queryParams)),this._queryParamMap}toString(){return Kz.serialize(this)}}class bt{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Kn(t,(i,r)=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Cp(this)}}class md{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=Xl(this.parameters)),this._parameterMap}toString(){return HA(this)}}function ha(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}class kA{}class BA{parse(e){const t=new aG(e);return new da(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${gd(e.root,!0)}`,i=function tG(n){const e=Object.keys(n).map(t=>{const i=n[t];return Array.isArray(i)?i.map(r=>`${Mp(t)}=${Mp(r)}`).join("&"):`${Mp(t)}=${Mp(i)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${i}${"string"==typeof e.fragment?`#${function Zz(n){return encodeURI(n)}(e.fragment)}`:""}`}}const Kz=new BA;function Cp(n){return n.segments.map(e=>HA(e)).join("/")}function gd(n,e){if(!n.hasChildren())return Cp(n);if(e){const t=n.children[mt]?gd(n.children[mt],!1):"",i=[];return Kn(n.children,(r,s)=>{s!==mt&&i.push(`${s}:${gd(r,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function Jz(n,e){let t=[];return Kn(n.children,(i,r)=>{r===mt&&(t=t.concat(e(i,r)))}),Kn(n.children,(i,r)=>{r!==mt&&(t=t.concat(e(i,r)))}),t}(n,(i,r)=>r===mt?[gd(n.children[mt],!1)]:[`${r}:${gd(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[mt]?`${Cp(n)}/${t[0]}`:`${Cp(n)}/(${t.join("//")})`}}function VA(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Mp(n){return VA(n).replace(/%3B/gi,";")}function x0(n){return VA(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Sp(n){return decodeURIComponent(n)}function UA(n){return Sp(n.replace(/\+/g,"%20"))}function HA(n){return`${x0(n.path)}${function eG(n){return Object.keys(n).map(e=>`;${x0(e)}=${x0(n[e])}`).join("")}(n.parameters)}`}const nG=/^[^\/()?;=#]+/;function Ep(n){const e=n.match(nG);return e?e[0]:""}const iG=/^[^=?&#]+/,sG=/^[^&#]+/;class aG{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new bt([],{}):new bt([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[mt]=new bt(e,t)),i}parseSegment(){const e=Ep(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(e),new md(Sp(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=Ep(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=Ep(this.remaining);r&&(i=r,this.capture(i))}e[Sp(t)]=Sp(i)}parseQueryParam(e){const t=function rG(n){const e=n.match(iG);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const o=function oG(n){const e=n.match(sG);return e?e[0]:""}(this.remaining);o&&(i=o,this.capture(i))}const r=UA(t),s=UA(i);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=Ep(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error(`Cannot parse url '${this.url}'`);let s;i.indexOf(":")>-1?(s=i.substr(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=mt);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[mt]:new bt([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Error(`Expected "${e}".`)}}class zA{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=C0(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=C0(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=M0(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return M0(e,this._root).map(t=>t.value)}}function C0(n,e){if(n===e.value)return e;for(const t of e.children){const i=C0(n,t);if(i)return i}return null}function M0(n,e){if(n===e.value)return[e];for(const t of e.children){const i=M0(n,t);if(i.length)return i.unshift(e),i}return[]}class Os{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function Ql(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class GA extends zA{constructor(e,t){super(e),this.snapshot=t,S0(this,e)}toString(){return this.snapshot.toString()}}function WA(n,e){const t=function lG(n,e){const o=new Tp([],{},{},"",{},mt,e,null,n.root,-1,{});return new $A("",new Os(o,[]))}(n,e),i=new Gn([new md("",{})]),r=new Gn({}),s=new Gn({}),o=new Gn({}),a=new Gn(""),l=new fo(i,r,o,a,s,mt,e,t.root);return l.snapshot=t.root,new GA(new Os(l,[]),t)}class fo{constructor(e,t,i,r,s,o,a,l){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this._futureSnapshot=l}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(tt(e=>Xl(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(tt(e=>Xl(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function jA(n,e="emptyOnly"){const t=n.pathFromRoot;let i=0;if("always"!==e)for(i=t.length-1;i>=1;){const r=t[i],s=t[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(s.component)break;i--}}return function cG(n){return n.reduce((e,t)=>({params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}),{params:{},data:{},resolve:{}})}(t.slice(i))}class Tp{constructor(e,t,i,r,s,o,a,l,c,u,d){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._urlSegment=c,this._lastPathIndex=u,this._resolve=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Xl(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Xl(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class $A extends zA{constructor(e,t){super(t),this.url=e,S0(this,t)}toString(){return qA(this._root)}}function S0(n,e){e.value._routerState=n,e.children.forEach(t=>S0(n,t))}function qA(n){const e=n.children.length>0?` { ${n.children.map(qA).join(", ")} } `:"";return`${n.value}${e}`}function E0(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Zr(e.queryParams,t.queryParams)||n.queryParams.next(t.queryParams),e.fragment!==t.fragment&&n.fragment.next(t.fragment),Zr(e.params,t.params)||n.params.next(t.params),function jz(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Zr(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.url.next(t.url),Zr(e.data,t.data)||n.data.next(t.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function T0(n,e){const t=Zr(n.params,e.params)&&function Qz(n,e){return ha(n,e)&&n.every((t,i)=>Zr(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||T0(n.parent,e.parent))}function _d(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const r=function dG(n,e,t){return e.children.map(i=>{for(const r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return _d(n,i,r);return _d(n,i)})}(n,e,t);return new Os(i,r)}{if(n.shouldAttach(e.value)){const s=n.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>_d(n,a)),o}}const i=function hG(n){return new fo(new Gn(n.url),new Gn(n.params),new Gn(n.queryParams),new Gn(n.fragment),new Gn(n.data),n.outlet,n.component,n)}(e.value),r=e.children.map(s=>_d(n,s));return new Os(i,r)}}function Dp(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function yd(n){return"object"==typeof n&&null!=n&&n.outlets}function D0(n,e,t,i,r){let s={};if(i&&Kn(i,(a,l)=>{s[l]=Array.isArray(a)?a.map(c=>`${c}`):`${a}`}),n===e)return new da(t,s,r);const o=YA(n,e,t);return new da(o,s,r)}function YA(n,e,t){const i={};return Kn(n.children,(r,s)=>{i[s]=r===e?t:YA(r,e,t)}),new bt(n.segments,i)}class XA{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&Dp(i[0]))throw new Error("Root segment cannot have matrix parameters");const r=i.find(yd);if(r&&r!==RA(i))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class A0{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function QA(n,e,t){if(n||(n=new bt([],{})),0===n.segments.length&&n.hasChildren())return Ap(n,e,t);const i=function yG(n,e,t){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return s;const o=n.segments[r],a=t[i];if(yd(a))break;const l=`${a}`,c=i<t.length-1?t[i+1]:null;if(r>0&&void 0===l)break;if(l&&c&&"object"==typeof c&&void 0===c.outlets){if(!KA(l,c,o))return s;i+=2}else{if(!KA(l,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const s=new bt(n.segments.slice(0,i.pathIndex),{});return s.children[mt]=new bt(n.segments.slice(i.pathIndex),n.children),Ap(s,0,r)}return i.match&&0===r.length?new bt(n.segments,{}):i.match&&!n.hasChildren()?I0(n,e,t):i.match?Ap(n,0,r):I0(n,e,t)}function Ap(n,e,t){if(0===t.length)return new bt(n.segments,{});{const i=function _G(n){return yd(n[0])?n[0].outlets:{[mt]:n}}(t),r={};return Kn(i,(s,o)=>{"string"==typeof s&&(s=[s]),null!==s&&(r[o]=QA(n.children[o],e,s))}),Kn(n.children,(s,o)=>{void 0===i[o]&&(r[o]=s)}),new bt(n.segments,r)}}function I0(n,e,t){const i=n.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(yd(s)){const l=vG(s.outlets);return new bt(i,l)}if(0===r&&Dp(t[0])){i.push(new md(n.segments[e].path,JA(t[0]))),r++;continue}const o=yd(s)?s.outlets[mt]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&Dp(a)?(i.push(new md(o,JA(a))),r+=2):(i.push(new md(o,{})),r++)}return new bt(i,{})}function vG(n){const e={};return Kn(n,(t,i)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[i]=I0(new bt([],{}),0,t))}),e}function JA(n){const e={};return Kn(n,(t,i)=>e[i]=`${t}`),e}function KA(n,e,t){return n==t.path&&Zr(e,t.parameters)}class bG{constructor(e,t,i,r){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),E0(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const r=Ql(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),Kn(r,(s,o)=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=Ql(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);if(i&&i.outlet){const o=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=Ql(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);i&&i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated(),i.attachRef=null,i.resolver=null,i.route=null)}activateChildRoutes(e,t,i){const r=Ql(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new Hz(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Vz(e.value.snapshot))}activateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(E0(r),r===s)if(r.component){const o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,i);else if(r.component){const o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),E0(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=function xG(n){for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig;if(t&&t.component)return null}return null}(r.snapshot),l=a?a.module.componentFactoryResolver:null;o.attachRef=null,o.route=r,o.resolver=l,o.outlet&&o.outlet.activateWith(r,l),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,i)}}class R0{constructor(e,t){this.routes=e,this.module=t}}function po(n){return"function"==typeof n}function fa(n){return n instanceof da}const vd=Symbol("INITIAL_VALUE");function wd(){return Kr(n=>function Cz(...n){const e=mu(n),t=JC(n),{args:i,keys:r}=mA(n);if(0===i.length)return On([],e);const s=new en(function Mz(n,e,t=Zo){return i=>{yA(e,()=>{const{length:r}=n,s=new Array(r);let o=r,a=r;for(let l=0;l<r;l++)yA(e,()=>{const c=On(n[l],e);let u=!1;c.subscribe(new Mn(i,d=>{s[l]=d,u||(u=!0,a--),a||i.next(t(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}(i,e,r?o=>_A(r,o):Zo));return t?s.pipe(gA(t)):s}(n.map(e=>e.pipe(Li(1),function Tz(...n){const e=mu(n);return Ln((t,i)=>{(e?bp(n,t,e):bp(n,t)).subscribe(i)})}(vd)))).pipe(bA((e,t)=>{let i=!1;return t.reduce((r,s,o)=>r!==vd?r:(s===vd&&(i=!0),i||!1!==s&&o!==t.length-1&&!fa(s)?r:s),e)},vd),ho(e=>e!==vd),tt(e=>fa(e)?e:!0===e),Li(1)))}class DG{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new bd,this.attachRef=null}}class bd{constructor(){this.contexts=new Map}onChildOutletCreated(e,t){const i=this.getOrCreateContext(e);i.outlet=t,this.contexts.set(e,i)}onChildOutletDestroyed(e){const t=this.getContext(e);t&&(t.outlet=null,t.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let t=this.getContext(e);return t||(t=new DG,this.contexts.set(e,t)),t}getContext(e){return this.contexts.get(e)||null}}let P0=(()=>{class n{constructor(t,i,r,s,o){this.parentContexts=t,this.location=i,this.resolver=r,this.changeDetector=o,this.activated=null,this._activatedRoute=null,this.activateEvents=new pt,this.deactivateEvents=new pt,this.attachEvents=new pt,this.detachEvents=new pt,this.name=s||mt,t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const o=(i=i||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),a=this.parentContexts.getOrCreateContext(this.name).children,l=new AG(t,a,this.location.injector);this.activated=this.location.createComponent(o,this.location.length,l),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(t){return new(t||n)($(bd),$(Er),$(Ku),function Su(n){return function tk(n,e){if("class"===e)return n.classes;if("style"===e)return n.styles;const t=n.attrs;if(t){const i=t.length;let r=0;for(;r<i;){const s=t[r];if(AM(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<i&&"string"==typeof t[r];)r++;else{if(s===e)return t[r+1];r+=2}}}return null}(Fn(),n)}("name"),$(tp))},n.\u0275dir=Ge({type:n,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),n})();class AG{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===fo?this.route:e===bd?this.childContexts:this.parent.get(e,t)}}let ZA=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Ci({type:n,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,i){1&t&&ct(0,"router-outlet")},directives:[P0],encapsulation:2}),n})();function eI(n,e=""){for(let t=0;t<n.length;t++){const i=n[t];IG(i,RG(e,i))}}function IG(n,e){n.children&&eI(n.children,e)}function RG(n,e){return e?n||e.path?n&&!e.path?`${n}/`:!n&&e.path?e.path:`${n}/${e.path}`:"":n}function N0(n){const e=n.children&&n.children.map(N0),t=e?Object.assign(Object.assign({},n),{children:e}):Object.assign({},n);return!t.component&&(e||t.loadChildren)&&t.outlet&&t.outlet!==mt&&(t.component=ZA),t}function cr(n){return n.outlet||mt}function tI(n,e){const t=n.filter(i=>cr(i)===e);return t.push(...n.filter(i=>cr(i)!==e)),t}const nI={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Ip(n,e,t){var i;if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?Object.assign({},nI):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const s=(e.matcher||Wz)(t,n,e);if(!s)return Object.assign({},nI);const o={};Kn(s.posParams,(l,c)=>{o[c]=l.path});const a=s.consumed.length>0?Object.assign(Object.assign({},o),s.consumed[s.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:s.consumed,remainingSegments:t.slice(s.consumed.length),parameters:a,positionalParamSegments:null!==(i=s.posParams)&&void 0!==i?i:{}}}function Rp(n,e,t,i,r="corrected"){if(t.length>0&&function LG(n,e,t){return t.some(i=>Pp(n,e,i)&&cr(i)!==mt)}(n,t,i)){const o=new bt(e,function NG(n,e,t,i){const r={};r[mt]=i,i._sourceSegment=n,i._segmentIndexShift=e.length;for(const s of t)if(""===s.path&&cr(s)!==mt){const o=new bt([],{});o._sourceSegment=n,o._segmentIndexShift=e.length,r[cr(s)]=o}return r}(n,e,i,new bt(t,n.children)));return o._sourceSegment=n,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:[]}}if(0===t.length&&function OG(n,e,t){return t.some(i=>Pp(n,e,i))}(n,t,i)){const o=new bt(n.segments,function PG(n,e,t,i,r,s){const o={};for(const a of i)if(Pp(n,t,a)&&!r[cr(a)]){const l=new bt([],{});l._sourceSegment=n,l._segmentIndexShift="legacy"===s?n.segments.length:e.length,o[cr(a)]=l}return Object.assign(Object.assign({},r),o)}(n,e,t,i,n.children,r));return o._sourceSegment=n,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:t}}const s=new bt(n.segments,n.children);return s._sourceSegment=n,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:t}}function Pp(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function iI(n,e,t,i){return!!(cr(n)===i||i!==mt&&Pp(e,t,n))&&("**"===n.path||Ip(e,n,t).matched)}function rI(n,e,t){return 0===e.length&&!n.children[t]}class Np{constructor(e){this.segmentGroup=e||null}}class sI{constructor(e){this.urlTree=e}}function xd(n){return wp(new Np(n))}function oI(n){return wp(new sI(n))}class VG{constructor(e,t,i,r,s){this.configLoader=t,this.urlSerializer=i,this.urlTree=r,this.config=s,this.allowRedirects=!0,this.ngModule=e.get(Es)}apply(){const e=Rp(this.urlTree.root,[],[],this.config).segmentGroup,t=new bt(e.segments,e.children);return this.expandSegmentGroup(this.ngModule,this.config,t,mt).pipe(tt(s=>this.createUrlTree(L0(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Ps(s=>{if(s instanceof sI)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof Np?this.noMatchError(s):s}))}match(e){return this.expandSegmentGroup(this.ngModule,this.config,e.root,mt).pipe(tt(r=>this.createUrlTree(L0(r),e.queryParams,e.fragment))).pipe(Ps(r=>{throw r instanceof Np?this.noMatchError(r):r}))}noMatchError(e){return new Error(`Cannot match any routes. URL Segment: '${e.segmentGroup}'`)}createUrlTree(e,t,i){const r=e.segments.length>0?new bt([],{[mt]:e}):e;return new da(r,t,i)}expandSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(e,t,i).pipe(tt(s=>new bt([],s))):this.expandSegment(e,i,t,i.segments,r,!0)}expandChildren(e,t,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return On(r).pipe(Ns(s=>{const o=i.children[s],a=tI(t,s);return this.expandSegmentGroup(e,a,o,s).pipe(tt(l=>({segment:l,outlet:s})))}),bA((s,o)=>(s[o.outlet]=o.segment,s),{}),function Iz(n,e){const t=arguments.length>=2;return i=>i.pipe(n?ho((r,s)=>n(r,s,i)):Zo,v0(1),t?CA(e):xA(()=>new ql))}())}expandSegment(e,t,i,r,s,o){return On(i).pipe(Ns(a=>this.expandSegmentAgainstRoute(e,t,i,a,r,s,o).pipe(Ps(c=>{if(c instanceof Np)return Be(null);throw c}))),Yl(a=>!!a),Ps((a,l)=>{if(a instanceof ql||"EmptyError"===a.name)return rI(t,r,s)?Be(new bt([],{})):xd(t);throw a}))}expandSegmentAgainstRoute(e,t,i,r,s,o,a){return iI(r,t,s,o)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,s,o):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o):xd(t):xd(t)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,i,r){const s=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?oI(s):this.lineralizeSegments(i,s).pipe(sn(o=>{const a=new bt(o,{});return this.expandSegment(e,a,t,o,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){const{matched:a,consumedSegments:l,remainingSegments:c,positionalParamSegments:u}=Ip(t,r,s);if(!a)return xd(t);const d=this.applyRedirectCommands(l,r.redirectTo,u);return r.redirectTo.startsWith("/")?oI(d):this.lineralizeSegments(r,d).pipe(sn(h=>this.expandSegment(e,t,i,h.concat(c),o,!1)))}matchSegmentAgainstRoute(e,t,i,r,s){if("**"===i.path)return i.loadChildren?(i._loadedConfig?Be(i._loadedConfig):this.configLoader.load(e.injector,i)).pipe(tt(d=>(i._loadedConfig=d,new bt(r,{})))):Be(new bt(r,{}));const{matched:o,consumedSegments:a,remainingSegments:l}=Ip(t,i,r);return o?this.getChildConfig(e,i,r).pipe(sn(u=>{const d=u.module,h=u.routes,{segmentGroup:f,slicedSegments:p}=Rp(t,a,l,h),_=new bt(f.segments,f.children);if(0===p.length&&_.hasChildren())return this.expandChildren(d,h,_).pipe(tt(v=>new bt(a,v)));if(0===h.length&&0===p.length)return Be(new bt(a,{}));const y=cr(i)===s;return this.expandSegment(d,_,h,p,y?mt:s,!0).pipe(tt(m=>new bt(a.concat(m.segments),m.children)))})):xd(t)}getChildConfig(e,t,i){return t.children?Be(new R0(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?Be(t._loadedConfig):this.runCanLoadGuards(e.injector,t,i).pipe(sn(r=>r?this.configLoader.load(e.injector,t).pipe(tt(s=>(t._loadedConfig=s,s))):function kG(n){return wp(b0(`Cannot load children because the guard of the route "path: '${n.path}'" returned false`))}(t))):Be(new R0([],e))}runCanLoadGuards(e,t,i){const r=t.canLoad;return r&&0!==r.length?Be(r.map(o=>{const a=e.get(o);let l;if(function MG(n){return n&&po(n.canLoad)}(a))l=a.canLoad(t,i);else{if(!po(a))throw new Error("Invalid CanLoad guard");l=a(t,i)}return es(l)})).pipe(wd(),qi(o=>{if(!fa(o))return;const a=b0(`Redirecting to "${this.urlSerializer.serialize(o)}"`);throw a.url=o,a}),tt(o=>!0===o)):Be(!0)}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return Be(i);if(r.numberOfChildren>1||!r.children[mt])return wp(new Error(`Only absolute redirects can have named outlets. redirectTo: '${e.redirectTo}'`));r=r.children[mt]}}applyRedirectCommands(e,t,i){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,i)}applyRedirectCreatreUrlTree(e,t,i,r){const s=this.createSegmentGroup(e,t.root,i,r);return new da(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return Kn(e,(r,s)=>{if("string"==typeof r&&r.startsWith(":")){const a=r.substring(1);i[s]=t[a]}else i[s]=r}),i}createSegmentGroup(e,t,i,r){const s=this.createSegments(e,t.segments,i,r);let o={};return Kn(t.children,(a,l)=>{o[l]=this.createSegmentGroup(e,a,i,r)}),new bt(s,o)}createSegments(e,t,i,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,t,i){const r=i[t.path.substring(1)];if(!r)throw new Error(`Cannot redirect to '${e}'. Cannot find '${t.path}'.`);return r}findOrReturn(e,t){let i=0;for(const r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}}function L0(n){const e={};for(const i of Object.keys(n.children)){const s=L0(n.children[i]);(s.segments.length>0||s.hasChildren())&&(e[i]=s)}return function UG(n){if(1===n.numberOfChildren&&n.children[mt]){const e=n.children[mt];return new bt(n.segments.concat(e.segments),e.children)}return n}(new bt(n.segments,e))}class aI{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class Lp{constructor(e,t){this.component=e,this.route=t}}function zG(n,e,t){const i=n._root;return Cd(i,e?e._root:null,t,[i.value])}function Op(n,e,t){const i=function WG(n){if(!n)return null;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig}return null}(e);return(i?i.module.injector:t).get(n)}function Cd(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=Ql(e);return n.children.forEach(o=>{(function jG(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function $G(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!ha(n.url,e.url);case"pathParamsOrQueryParamsChange":return!ha(n.url,e.url)||!Zr(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!T0(n,e)||!Zr(n.queryParams,e.queryParams);default:return!T0(n,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new aI(i)):(s.data=o.data,s._resolvedData=o._resolvedData),Cd(n,e,s.component?a?a.children:null:t,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Lp(a.outlet.component,o))}else o&&Md(e,a,r),r.canActivateChecks.push(new aI(i)),Cd(n,null,s.component?a?a.children:null:t,i,r)})(o,s[o.value.outlet],t,i.concat([o.value]),r),delete s[o.value.outlet]}),Kn(s,(o,a)=>Md(o,t.getContext(a),r)),r}function Md(n,e,t){const i=Ql(n),r=n.value;Kn(i,(s,o)=>{Md(s,r.component?e?e.children.getContext(o):null:e,t)}),t.canDeactivateChecks.push(new Lp(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}class tW{}function lI(n){return new en(e=>e.error(n))}class iW{constructor(e,t,i,r,s,o){this.rootComponentType=e,this.config=t,this.urlTree=i,this.url=r,this.paramsInheritanceStrategy=s,this.relativeLinkResolution=o}recognize(){const e=Rp(this.urlTree.root,[],[],this.config.filter(o=>void 0===o.redirectTo),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,mt);if(null===t)return null;const i=new Tp([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},mt,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new Os(i,t),s=new $A(this.url,r);return this.inheritParamsAndData(s._root),s}inheritParamsAndData(e){const t=e.value,i=jA(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,i){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,i)}processChildren(e,t){const i=[];for(const s of Object.keys(t.children)){const o=t.children[s],a=tI(e,s),l=this.processSegmentGroup(a,o,s);if(null===l)return null;i.push(...l)}const r=cI(i);return function rW(n){n.sort((e,t)=>e.value.outlet===mt?-1:t.value.outlet===mt?1:e.value.outlet.localeCompare(t.value.outlet))}(r),r}processSegment(e,t,i,r){for(const s of e){const o=this.processSegmentAgainstRoute(s,t,i,r);if(null!==o)return o}return rI(t,i,r)?[]:null}processSegmentAgainstRoute(e,t,i,r){if(e.redirectTo||!iI(e,t,i,r))return null;let s,o=[],a=[];if("**"===e.path){const f=i.length>0?RA(i).parameters:{};s=new Tp(i,f,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,hI(e),cr(e),e.component,e,uI(t),dI(t)+i.length,fI(e))}else{const f=Ip(t,e,i);if(!f.matched)return null;o=f.consumedSegments,a=f.remainingSegments,s=new Tp(o,f.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,hI(e),cr(e),e.component,e,uI(t),dI(t)+o.length,fI(e))}const l=function sW(n){return n.children?n.children:n.loadChildren?n._loadedConfig.routes:[]}(e),{segmentGroup:c,slicedSegments:u}=Rp(t,o,a,l.filter(f=>void 0===f.redirectTo),this.relativeLinkResolution);if(0===u.length&&c.hasChildren()){const f=this.processChildren(l,c);return null===f?null:[new Os(s,f)]}if(0===l.length&&0===u.length)return[new Os(s,[])];const d=cr(e)===r,h=this.processSegment(l,c,u,d?mt:r);return null===h?null:[new Os(s,h)]}}function oW(n){const e=n.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function cI(n){const e=[],t=new Set;for(const i of n){if(!oW(i)){e.push(i);continue}const r=e.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):e.push(i)}for(const i of t){const r=cI(i.children);e.push(new Os(i.value,r))}return e.filter(i=>!t.has(i))}function uI(n){let e=n;for(;e._sourceSegment;)e=e._sourceSegment;return e}function dI(n){let e=n,t=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift?e._segmentIndexShift:0;return t-1}function hI(n){return n.data||{}}function fI(n){return n.resolve||{}}function pI(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function O0(n){return Kr(e=>{const t=n(e);return t?On(t).pipe(tt(()=>e)):Be(e)})}class pW extends class fW{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}{}const F0=new lt("ROUTES");class mI{constructor(e,t,i,r){this.injector=e,this.compiler=t,this.onLoadStartListener=i,this.onLoadEndListener=r}load(e,t){if(t._loader$)return t._loader$;this.onLoadStartListener&&this.onLoadStartListener(t);const r=this.loadModuleFactory(t.loadChildren).pipe(tt(s=>{this.onLoadEndListener&&this.onLoadEndListener(t);const o=s.create(e);return new R0(IA(o.injector.get(F0,void 0,$e.Self|$e.Optional)).map(N0),o)}),Ps(s=>{throw t._loader$=void 0,s}));return t._loader$=new Ez(r,()=>new gr).pipe(wA()),t._loader$}loadModuleFactory(e){return es(e()).pipe(sn(t=>t instanceof DT?Be(t):On(this.compiler.compileModuleAsync(t))))}}class gW{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,t){return e}}function _W(n){throw n}function yW(n,e,t){return e.parse("/")}function gI(n,e){return Be(null)}const vW={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},wW={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Di=(()=>{class n{constructor(t,i,r,s,o,a,l){this.rootComponentType=t,this.urlSerializer=i,this.rootContexts=r,this.location=s,this.config=l,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new gr,this.errorHandler=_W,this.malformedUriErrorHandler=yW,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:gI,afterPreactivation:gI},this.urlHandlingStrategy=new gW,this.routeReuseStrategy=new pW,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=o.get(Es),this.console=o.get(dD);const d=o.get(Jn);this.isNgZoneEnabled=d instanceof Jn&&Jn.isInAngularZone(),this.resetConfig(l),this.currentUrlTree=function $z(){return new da(new bt([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new mI(o,a,h=>this.triggerEvent(new SA(h)),h=>this.triggerEvent(new EA(h))),this.routerState=WA(this.currentUrlTree,this.rootComponentType),this.transitions=new Gn({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var t;return null===(t=this.location.getState())||void 0===t?void 0:t.\u0275routerPageId}setupNavigations(t){const i=this.events;return t.pipe(ho(r=>0!==r.id),tt(r=>Object.assign(Object.assign({},r),{extractedUrl:this.urlHandlingStrategy.extract(r.rawUrl)})),Kr(r=>{let s=!1,o=!1;return Be(r).pipe(qi(a=>{this.currentNavigation={id:a.id,initialUrl:a.currentRawUrl,extractedUrl:a.extractedUrl,trigger:a.source,extras:a.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Kr(a=>{const l=this.browserUrlTree.toString(),c=!this.navigated||a.extractedUrl.toString()!==l||l!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||c)&&this.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return _I(a.source)&&(this.browserUrlTree=a.extractedUrl),Be(a).pipe(Kr(d=>{const h=this.transitions.getValue();return i.next(new w0(d.id,this.serializeUrl(d.extractedUrl),d.source,d.restoredState)),h!==this.transitions.getValue()?_s:Promise.resolve(d)}),function HG(n,e,t,i){return Kr(r=>function BG(n,e,t,i,r){return new VG(n,e,t,i,r).apply()}(n,e,t,r.extractedUrl,i).pipe(tt(s=>Object.assign(Object.assign({},r),{urlAfterRedirects:s}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),qi(d=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:d.urlAfterRedirects})}),function aW(n,e,t,i,r){return sn(s=>function nW(n,e,t,i,r="emptyOnly",s="legacy"){try{const o=new iW(n,e,t,i,r,s).recognize();return null===o?lI(new tW):Be(o)}catch(o){return lI(o)}}(n,e,s.urlAfterRedirects,t(s.urlAfterRedirects),i,r).pipe(tt(o=>Object.assign(Object.assign({},s),{targetSnapshot:o}))))}(this.rootComponentType,this.config,d=>this.serializeUrl(d),this.paramsInheritanceStrategy,this.relativeLinkResolution),qi(d=>{if("eager"===this.urlUpdateStrategy){if(!d.extras.skipLocationChange){const f=this.urlHandlingStrategy.merge(d.urlAfterRedirects,d.rawUrl);this.setBrowserUrl(f,d)}this.browserUrlTree=d.urlAfterRedirects}const h=new Nz(d.id,this.serializeUrl(d.extractedUrl),this.serializeUrl(d.urlAfterRedirects),d.targetSnapshot);i.next(h)}));if(c&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:h,extractedUrl:f,source:p,restoredState:_,extras:y}=a,g=new w0(h,this.serializeUrl(f),p,_);i.next(g);const m=WA(f,this.rootComponentType).snapshot;return Be(Object.assign(Object.assign({},a),{targetSnapshot:m,urlAfterRedirects:f,extras:Object.assign(Object.assign({},y),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=a.rawUrl,a.resolve(null),_s}),O0(a=>{const{targetSnapshot:l,id:c,extractedUrl:u,rawUrl:d,extras:{skipLocationChange:h,replaceUrl:f}}=a;return this.hooks.beforePreactivation(l,{navigationId:c,appliedUrlTree:u,rawUrlTree:d,skipLocationChange:!!h,replaceUrl:!!f})}),qi(a=>{const l=new Lz(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot);this.triggerEvent(l)}),tt(a=>Object.assign(Object.assign({},a),{guards:zG(a.targetSnapshot,a.currentSnapshot,this.rootContexts)})),function qG(n,e){return sn(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?Be(Object.assign(Object.assign({},t),{guardsResult:!0})):function YG(n,e,t,i){return On(n).pipe(sn(r=>function eW(n,e,t,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?Be(s.map(a=>{const l=Op(a,e,r);let c;if(function TG(n){return n&&po(n.canDeactivate)}(l))c=es(l.canDeactivate(n,e,t,i));else{if(!po(l))throw new Error("Invalid CanDeactivate guard");c=es(l(n,e,t,i))}return c.pipe(Yl())})).pipe(wd()):Be(!0)}(r.component,r.route,t,e,i)),Yl(r=>!0!==r,!0))}(o,i,r,n).pipe(sn(a=>a&&function CG(n){return"boolean"==typeof n}(a)?function XG(n,e,t,i){return On(e).pipe(Ns(r=>bp(function JG(n,e){return null!==n&&e&&e(new Bz(n)),Be(!0)}(r.route.parent,i),function QG(n,e){return null!==n&&e&&e(new Uz(n)),Be(!0)}(r.route,i),function ZG(n,e,t){const i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function GG(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(o)).filter(o=>null!==o).map(o=>vA(()=>Be(o.guards.map(l=>{const c=Op(l,o.node,t);let u;if(function EG(n){return n&&po(n.canActivateChild)}(c))u=es(c.canActivateChild(i,n));else{if(!po(c))throw new Error("Invalid CanActivateChild guard");u=es(c(i,n))}return u.pipe(Yl())})).pipe(wd())));return Be(s).pipe(wd())}(n,r.path,t),function KG(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return Be(!0);const r=i.map(s=>vA(()=>{const o=Op(s,e,t);let a;if(function SG(n){return n&&po(n.canActivate)}(o))a=es(o.canActivate(e,n));else{if(!po(o))throw new Error("Invalid CanActivate guard");a=es(o(e,n))}return a.pipe(Yl())}));return Be(r).pipe(wd())}(n,r.route,t))),Yl(r=>!0!==r,!0))}(i,s,n,e):Be(a)),tt(a=>Object.assign(Object.assign({},t),{guardsResult:a})))})}(this.ngModule.injector,a=>this.triggerEvent(a)),qi(a=>{if(fa(a.guardsResult)){const c=b0(`Redirecting to "${this.serializeUrl(a.guardsResult)}"`);throw c.url=a.guardsResult,c}const l=new Oz(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);this.triggerEvent(l)}),ho(a=>!!a.guardsResult||(this.restoreHistory(a),this.cancelNavigationTransition(a,""),!1)),O0(a=>{if(a.guards.canActivateChecks.length)return Be(a).pipe(qi(l=>{const c=new Fz(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(c)}),Kr(l=>{let c=!1;return Be(l).pipe(function lW(n,e){return sn(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return Be(t);let s=0;return On(r).pipe(Ns(o=>function cW(n,e,t,i){return function uW(n,e,t,i){const r=pI(n);if(0===r.length)return Be({});const s={};return On(r).pipe(sn(o=>function dW(n,e,t,i){const r=Op(n,e,i);return es(r.resolve?r.resolve(e,t):r(e,t))}(n[o],e,t,i).pipe(qi(a=>{s[o]=a}))),v0(1),sn(()=>pI(s).length===r.length?Be(s):_s))}(n._resolve,n,e,i).pipe(tt(s=>(n._resolvedData=s,n.data=Object.assign(Object.assign({},n.data),jA(n,t).resolve),null)))}(o.route,i,n,e)),qi(()=>s++),v0(1),sn(o=>s===r.length?Be(t):_s))})}(this.paramsInheritanceStrategy,this.ngModule.injector),qi({next:()=>c=!0,complete:()=>{c||(this.restoreHistory(l),this.cancelNavigationTransition(l,"At least one route resolver didn't emit any value."))}}))}),qi(l=>{const c=new kz(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(c)}))}),O0(a=>{const{targetSnapshot:l,id:c,extractedUrl:u,rawUrl:d,extras:{skipLocationChange:h,replaceUrl:f}}=a;return this.hooks.afterPreactivation(l,{navigationId:c,appliedUrlTree:u,rawUrlTree:d,skipLocationChange:!!h,replaceUrl:!!f})}),tt(a=>{const l=function uG(n,e,t){const i=_d(n,e._root,t?t._root:void 0);return new GA(i,e)}(this.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);return Object.assign(Object.assign({},a),{targetRouterState:l})}),qi(a=>{this.currentUrlTree=a.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(a.urlAfterRedirects,a.rawUrl),this.routerState=a.targetRouterState,"deferred"===this.urlUpdateStrategy&&(a.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,a),this.browserUrlTree=a.urlAfterRedirects)}),((n,e,t)=>tt(i=>(new bG(e,i.targetRouterState,i.currentRouterState,t).activate(n),i)))(this.rootContexts,this.routeReuseStrategy,a=>this.triggerEvent(a)),qi({next(){s=!0},complete(){s=!0}}),function Rz(n){return Ln((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}(()=>{var a;s||o||this.cancelNavigationTransition(r,`Navigation ID ${r.id} is not equal to the current navigation id ${this.navigationId}`),(null===(a=this.currentNavigation)||void 0===a?void 0:a.id)===r.id&&(this.currentNavigation=null)}),Ps(a=>{if(o=!0,function Gz(n){return n&&n[DA]}(a)){const l=fa(a.url);l||(this.navigated=!0,this.restoreHistory(r,!0));const c=new MA(r.id,this.serializeUrl(r.extractedUrl),a.message);i.next(c),l?setTimeout(()=>{const u=this.urlHandlingStrategy.merge(a.url,this.rawUrlTree),d={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||_I(r.source)};this.scheduleNavigation(u,"imperative",null,d,{resolve:r.resolve,reject:r.reject,promise:r.promise})},0):r.resolve(!1)}else{this.restoreHistory(r,!0);const l=new Pz(r.id,this.serializeUrl(r.extractedUrl),a);i.next(l);try{r.resolve(this.errorHandler(a))}catch(c){r.reject(c)}}return _s}))}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}setTransition(t){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const i="popstate"===t.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{var r;const s={replaceUrl:!0},o=(null===(r=t.state)||void 0===r?void 0:r.navigationId)?t.state:null;if(o){const l=Object.assign({},o);delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(s.state=l)}const a=this.parseUrl(t.url);this.scheduleNavigation(a,i,o,s)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){eI(t),this.config=t.map(N0),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,i={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=i,c=r||this.routerState.root,u=l?this.currentUrlTree.fragment:o;let d=null;switch(a){case"merge":d=Object.assign(Object.assign({},this.currentUrlTree.queryParams),s);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=s||null}return null!==d&&(d=this.removeEmptyProps(d)),function fG(n,e,t,i,r){if(0===t.length)return D0(e.root,e.root,e.root,i,r);const s=function pG(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new XA(!0,0,n);let e=0,t=!1;const i=n.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Kn(s.outlets,(l,c)=>{a[c]="string"==typeof l?l.split("/"):l}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?t=!0:".."===a?e++:""!=a&&r.push(a))}),r):[...r,s]},[]);return new XA(t,e,i)}(t);if(s.toRoot())return D0(e.root,e.root,new bt([],{}),i,r);const o=function mG(n,e,t){if(n.isAbsolute)return new A0(e.root,!0,0);if(-1===t.snapshot._lastPathIndex){const s=t.snapshot._urlSegment;return new A0(s,s===e.root,0)}const i=Dp(n.commands[0])?0:1;return function gG(n,e,t){let i=n,r=e,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new Error("Invalid number of '../'");r=i.segments.length}return new A0(i,!1,r-s)}(t.snapshot._urlSegment,t.snapshot._lastPathIndex+i,n.numberOfDoubleDots)}(s,e,n),a=o.processChildren?Ap(o.segmentGroup,o.index,s.commands):QA(o.segmentGroup,o.index,s.commands);return D0(e.root,o.segmentGroup,a,i,r)}(c,this.currentUrlTree,t,d,null!=u?u:null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=fa(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,"imperative",null,i)}navigate(t,i={skipLocationChange:!1}){return function bW(n){for(let e=0;e<n.length;e++){const t=n[e];if(null==t)throw new Error(`The requested path contains ${t} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let i;try{i=this.urlSerializer.parse(t)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return i}isActive(t,i){let r;if(r=!0===i?Object.assign({},vW):!1===i?Object.assign({},wW):i,fa(t))return NA(this.currentUrlTree,t,r);const s=this.parseUrl(t);return NA(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.keys(t).reduce((i,r)=>{const s=t[r];return null!=s&&(i[r]=s),i},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId,this.events.next(new pd(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,t.resolve(!0)},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}scheduleNavigation(t,i,r,s,o){var a,l;if(this.disposed)return Promise.resolve(!1);let c,u,d;o?(c=o.resolve,u=o.reject,d=o.promise):d=new Promise((p,_)=>{c=p,u=_});const h=++this.navigationId;let f;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(r=this.location.getState()),f=r&&r.\u0275routerPageId?r.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?null!==(a=this.browserPageId)&&void 0!==a?a:0:(null!==(l=this.browserPageId)&&void 0!==l?l:0)+1):f=0,this.setTransition({id:h,targetPageId:f,source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:s,resolve:c,reject:u,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(p=>Promise.reject(p))}setBrowserUrl(t,i){const r=this.urlSerializer.serialize(t),s=Object.assign(Object.assign({},i.extras.state),this.generateNgRouterState(i.id,i.targetPageId));this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl?this.location.replaceState(r,"",s):this.location.go(r,"",s)}restoreHistory(t,i=!1){var r,s;if("computed"===this.canceledNavigationResolution){const o=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(r=this.currentNavigation)||void 0===r?void 0:r.finalUrl)||0===o?this.currentUrlTree===(null===(s=this.currentNavigation)||void 0===s?void 0:s.finalUrl)&&0===o&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(o)}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(t,i){const r=new MA(t.id,this.serializeUrl(t.extractedUrl),i);this.triggerEvent(r),t.resolve(!1)}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}}return n.\u0275fac=function(t){nv()},n.\u0275prov=Ne({token:n,factory:n.\u0275fac}),n})();function _I(n){return"imperative"!==n}class yI{}class vI{preload(e,t){return Be(null)}}let wI=(()=>{class n{constructor(t,i,r,s){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=new mI(r,i,l=>t.triggerEvent(new SA(l)),l=>t.triggerEvent(new EA(l)))}setUpPreloading(){this.subscription=this.router.events.pipe(ho(t=>t instanceof pd),Ns(()=>this.preload())).subscribe(()=>{})}preload(){const t=this.injector.get(Es);return this.processRoutes(t,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const r=[];for(const s of i)if(s.loadChildren&&!s.canLoad&&s._loadedConfig){const o=s._loadedConfig;r.push(this.processRoutes(o.module,o.routes))}else s.loadChildren&&!s.canLoad?r.push(this.preloadConfig(t,s)):s.children&&r.push(this.processRoutes(t,s.children));return On(r).pipe(pu(),tt(s=>{}))}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>(i._loadedConfig?Be(i._loadedConfig):this.loader.load(t.injector,i)).pipe(sn(s=>(i._loadedConfig=s,this.processRoutes(s.module,s.routes)))))}}return n.\u0275fac=function(t){return new(t||n)(pe(Di),pe(hD),pe(si),pe(yI))},n.\u0275prov=Ne({token:n,factory:n.\u0275fac}),n})(),V0=(()=>{class n{constructor(t,i,r={}){this.router=t,this.viewportScroller=i,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof w0?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof pd&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof TA&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.router.triggerEvent(new TA(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return n.\u0275fac=function(t){nv()},n.\u0275prov=Ne({token:n,factory:n.\u0275fac}),n})();const pa=new lt("ROUTER_CONFIGURATION"),bI=new lt("ROUTER_FORROOT_GUARD"),SW=[Kv,{provide:kA,useClass:BA},{provide:Di,useFactory:function IW(n,e,t,i,r,s,o={},a,l){const c=new Di(null,n,e,t,i,r,IA(s));return a&&(c.urlHandlingStrategy=a),l&&(c.routeReuseStrategy=l),function RW(n,e){n.errorHandler&&(e.errorHandler=n.errorHandler),n.malformedUriErrorHandler&&(e.malformedUriErrorHandler=n.malformedUriErrorHandler),n.onSameUrlNavigation&&(e.onSameUrlNavigation=n.onSameUrlNavigation),n.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=n.paramsInheritanceStrategy),n.relativeLinkResolution&&(e.relativeLinkResolution=n.relativeLinkResolution),n.urlUpdateStrategy&&(e.urlUpdateStrategy=n.urlUpdateStrategy),n.canceledNavigationResolution&&(e.canceledNavigationResolution=n.canceledNavigationResolution)}(o,c),o.enableTracing&&c.events.subscribe(u=>{var d,h;null===(d=console.group)||void 0===d||d.call(console,`Router Event: ${u.constructor.name}`),console.log(u.toString()),console.log(u),null===(h=console.groupEnd)||void 0===h||h.call(console)}),c},deps:[kA,bd,Kv,si,hD,F0,pa,[class mW{},new so],[class hW{},new so]]},bd,{provide:fo,useFactory:function PW(n){return n.routerState.root},deps:[Di]},wI,vI,class MW{preload(e,t){return t().pipe(Ps(()=>Be(null)))}},{provide:pa,useValue:{enableTracing:!1}}];function EW(){return new _D("Router",Di)}let xI=(()=>{class n{constructor(t,i){}static forRoot(t,i){return{ngModule:n,providers:[SW,CI(t),{provide:bI,useFactory:AW,deps:[[Di,new so,new Pu]]},{provide:pa,useValue:i||{}},{provide:$l,useFactory:DW,deps:[ua,[new Cf(Jv),new so],pa]},{provide:V0,useFactory:TW,deps:[Di,P6,pa]},{provide:yI,useExisting:i&&i.preloadingStrategy?i.preloadingStrategy:vI},{provide:_D,multi:!0,useFactory:EW},[U0,{provide:Fv,multi:!0,useFactory:NW,deps:[U0]},{provide:MI,useFactory:LW,deps:[U0]},{provide:uD,multi:!0,useExisting:MI}]]}}static forChild(t){return{ngModule:n,providers:[CI(t)]}}}return n.\u0275fac=function(t){return new(t||n)(pe(bI,8),pe(Di,8))},n.\u0275mod=Zi({type:n}),n.\u0275inj=ki({}),n})();function TW(n,e,t){return t.scrollOffset&&e.setOffset(t.scrollOffset),new V0(n,e,t)}function DW(n,e,t={}){return t.useHash?new _8(n,e):new kD(n,e)}function AW(n){return"guarded"}function CI(n){return[{provide:ok,multi:!0,useValue:n},{provide:F0,multi:!0,useValue:n}]}let U0=(()=>{class n{constructor(t){this.injector=t,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new gr}appInitializer(){return this.injector.get(p8,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let i=null;const r=new Promise(a=>i=a),s=this.injector.get(Di),o=this.injector.get(pa);return"disabled"===o.initialNavigation?(s.setUpLocationChangeListener(),i(!0)):"enabled"===o.initialNavigation||"enabledBlocking"===o.initialNavigation?(s.hooks.afterPreactivation=()=>this.initNavigation?Be(null):(this.initNavigation=!0,i(!0),this.resultOfPreactivationDone),s.initialNavigation()):i(!0),r})}bootstrapListener(t){const i=this.injector.get(pa),r=this.injector.get(wI),s=this.injector.get(V0),o=this.injector.get(Di),a=this.injector.get(Wv);t===a.components[0]&&(("enabledNonBlocking"===i.initialNavigation||void 0===i.initialNavigation)&&o.initialNavigation(),r.setUpPreloading(),s.init(),o.resetRootComponentType(a.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return n.\u0275fac=function(t){return new(t||n)(pe(si))},n.\u0275prov=Ne({token:n,factory:n.\u0275fac}),n})();function NW(n){return n.appInitializer.bind(n)}function LW(n){return n.bootstrapListener.bind(n)}const MI=new lt("Router Initializer");function SI(n,e,t,i,r,s,o){try{var a=n[s](o),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(i,r)}function Je(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(l){SI(s,i,r,o,a,"next",l)}function a(l){SI(s,i,r,o,a,"throw",l)}o(void 0)})}}function ts(n,e){const t="object"==typeof e;return new Promise((i,r)=>{let o,s=!1;n.subscribe({next:a=>{o=a,s=!0},error:r,complete:()=>{s?i(o):t?i(e.defaultValue):r(new ql)}})})}class EI{}class TI{}class Yi{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),s=r.toLowerCase(),o=t.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let i=e[t];const r=t.toLowerCase();"string"==typeof i&&(i=[i]),i.length>0&&(this.headers.set(r,i),this.maybeSetNormalizedName(t,r))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof Yi?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new Yi;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof Yi?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class FW{encodeKey(e){return DI(e)}encodeValue(e){return DI(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const BW=/%(\d[a-f0-9])/gi,VW={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function DI(n){return encodeURIComponent(n).replace(BW,(e,t)=>{var i;return null!==(i=VW[t])&&void 0!==i?i:e})}function AI(n){return`${n}`}class mo{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new FW,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function kW(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[o,a]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],l=t.get(o)||[];l.push(a),t.set(o,l)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const i=e.fromObject[t];this.map.set(t,Array.isArray(i)?i:[i])})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(i=>{const r=e[i];Array.isArray(r)?r.forEach(s=>{t.push({param:i,value:s,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new mo({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(AI(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let i=this.map.get(e.param)||[];const r=i.indexOf(AI(e.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class UW{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function II(n){return"undefined"!=typeof ArrayBuffer&&n instanceof ArrayBuffer}function RI(n){return"undefined"!=typeof Blob&&n instanceof Blob}function PI(n){return"undefined"!=typeof FormData&&n instanceof FormData}class Sd{constructor(e,t,i,r){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function HW(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new Yi),this.context||(this.context=new UW),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new mo,this.urlWithParams=t}serializeBody(){return null===this.body?null:II(this.body)||RI(this.body)||PI(this.body)||function zW(n){return"undefined"!=typeof URLSearchParams&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof mo?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||PI(this.body)?null:RI(this.body)?this.body.type||null:II(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof mo?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){var t;const i=e.method||this.method,r=e.url||this.url,s=e.responseType||this.responseType,o=void 0!==e.body?e.body:this.body,a=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,l=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let c=e.headers||this.headers,u=e.params||this.params;const d=null!==(t=e.context)&&void 0!==t?t:this.context;return void 0!==e.setHeaders&&(c=Object.keys(e.setHeaders).reduce((h,f)=>h.set(f,e.setHeaders[f]),c)),e.setParams&&(u=Object.keys(e.setParams).reduce((h,f)=>h.set(f,e.setParams[f]),u)),new Sd(i,r,o,{params:u,headers:c,context:d,reportProgress:l,responseType:s,withCredentials:a})}}var An=(()=>((An=An||{})[An.Sent=0]="Sent",An[An.UploadProgress=1]="UploadProgress",An[An.ResponseHeader=2]="ResponseHeader",An[An.DownloadProgress=3]="DownloadProgress",An[An.Response=4]="Response",An[An.User=5]="User",An))();class H0{constructor(e,t=200,i="OK"){this.headers=e.headers||new Yi,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class z0 extends H0{constructor(e={}){super(e),this.type=An.ResponseHeader}clone(e={}){return new z0({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class Fp extends H0{constructor(e={}){super(e),this.type=An.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new Fp({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class NI extends H0{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function G0(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let Ed=(()=>{class n{constructor(t){this.handler=t}request(t,i,r={}){let s;if(t instanceof Sd)s=t;else{let l,c;l=r.headers instanceof Yi?r.headers:new Yi(r.headers),r.params&&(c=r.params instanceof mo?r.params:new mo({fromObject:r.params})),s=new Sd(t,i,void 0!==r.body?r.body:null,{headers:l,context:r.context,params:c,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const o=Be(s).pipe(Ns(l=>this.handler.handle(l)));if(t instanceof Sd||"events"===r.observe)return o;const a=o.pipe(ho(l=>l instanceof Fp));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(tt(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(tt(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(tt(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return a.pipe(tt(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new mo).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,G0(r,i))}post(t,i,r={}){return this.request("POST",t,G0(r,i))}put(t,i,r={}){return this.request("PUT",t,G0(r,i))}}return n.\u0275fac=function(t){return new(t||n)(pe(EI))},n.\u0275prov=Ne({token:n,factory:n.\u0275fac}),n})();class LI{constructor(e,t){this.next=e,this.interceptor=t}handle(e){return this.interceptor.intercept(e,this.next)}}const OI=new lt("HTTP_INTERCEPTORS");let GW=(()=>{class n{intercept(t,i){return i.handle(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ne({token:n,factory:n.\u0275fac}),n})();const WW=/^\)\]\}',?\n/;let FI=(()=>{class n{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new en(i=>{const r=this.xhrFactory.build();if(r.open(t.method,t.urlWithParams),t.withCredentials&&(r.withCredentials=!0),t.headers.forEach((f,p)=>r.setRequestHeader(f,p.join(","))),t.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const f=t.detectContentTypeHeader();null!==f&&r.setRequestHeader("Content-Type",f)}if(t.responseType){const f=t.responseType.toLowerCase();r.responseType="json"!==f?f:"text"}const s=t.serializeBody();let o=null;const a=()=>{if(null!==o)return o;const f=r.statusText||"OK",p=new Yi(r.getAllResponseHeaders()),_=function jW(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(r)||t.url;return o=new z0({headers:p,status:r.status,statusText:f,url:_}),o},l=()=>{let{headers:f,status:p,statusText:_,url:y}=a(),g=null;204!==p&&(g=void 0===r.response?r.responseText:r.response),0===p&&(p=g?200:0);let m=p>=200&&p<300;if("json"===t.responseType&&"string"==typeof g){const v=g;g=g.replace(WW,"");try{g=""!==g?JSON.parse(g):null}catch(w){g=v,m&&(m=!1,g={error:w,text:g})}}m?(i.next(new Fp({body:g,headers:f,status:p,statusText:_,url:y||void 0})),i.complete()):i.error(new NI({error:g,headers:f,status:p,statusText:_,url:y||void 0}))},c=f=>{const{url:p}=a(),_=new NI({error:f,status:r.status||0,statusText:r.statusText||"Unknown Error",url:p||void 0});i.error(_)};let u=!1;const d=f=>{u||(i.next(a()),u=!0);let p={type:An.DownloadProgress,loaded:f.loaded};f.lengthComputable&&(p.total=f.total),"text"===t.responseType&&!!r.responseText&&(p.partialText=r.responseText),i.next(p)},h=f=>{let p={type:An.UploadProgress,loaded:f.loaded};f.lengthComputable&&(p.total=f.total),i.next(p)};return r.addEventListener("load",l),r.addEventListener("error",c),r.addEventListener("timeout",c),r.addEventListener("abort",c),t.reportProgress&&(r.addEventListener("progress",d),null!==s&&r.upload&&r.upload.addEventListener("progress",h)),r.send(s),i.next({type:An.Sent}),()=>{r.removeEventListener("error",c),r.removeEventListener("abort",c),r.removeEventListener("load",l),r.removeEventListener("timeout",c),t.reportProgress&&(r.removeEventListener("progress",d),null!==s&&r.upload&&r.upload.removeEventListener("progress",h)),r.readyState!==r.DONE&&r.abort()}})}}return n.\u0275fac=function(t){return new(t||n)(pe(nA))},n.\u0275prov=Ne({token:n,factory:n.\u0275fac}),n})();const W0=new lt("XSRF_COOKIE_NAME"),j0=new lt("XSRF_HEADER_NAME");class kI{}let $W=(()=>{class n{constructor(t,i,r){this.doc=t,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=qD(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return n.\u0275fac=function(t){return new(t||n)(pe($i),pe(ep),pe(W0))},n.\u0275prov=Ne({token:n,factory:n.\u0275fac}),n})(),$0=(()=>{class n{constructor(t,i){this.tokenService=t,this.headerName=i}intercept(t,i){const r=t.url.toLowerCase();if("GET"===t.method||"HEAD"===t.method||r.startsWith("http://")||r.startsWith("https://"))return i.handle(t);const s=this.tokenService.getToken();return null!==s&&!t.headers.has(this.headerName)&&(t=t.clone({headers:t.headers.set(this.headerName,s)})),i.handle(t)}}return n.\u0275fac=function(t){return new(t||n)(pe(kI),pe(j0))},n.\u0275prov=Ne({token:n,factory:n.\u0275fac}),n})(),qW=(()=>{class n{constructor(t,i){this.backend=t,this.injector=i,this.chain=null}handle(t){if(null===this.chain){const i=this.injector.get(OI,[]);this.chain=i.reduceRight((r,s)=>new LI(r,s),this.backend)}return this.chain.handle(t)}}return n.\u0275fac=function(t){return new(t||n)(pe(TI),pe(si))},n.\u0275prov=Ne({token:n,factory:n.\u0275fac}),n})(),YW=(()=>{class n{static disable(){return{ngModule:n,providers:[{provide:$0,useClass:GW}]}}static withOptions(t={}){return{ngModule:n,providers:[t.cookieName?{provide:W0,useValue:t.cookieName}:[],t.headerName?{provide:j0,useValue:t.headerName}:[]]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Zi({type:n}),n.\u0275inj=ki({providers:[$0,{provide:OI,useExisting:$0,multi:!0},{provide:kI,useClass:$W},{provide:W0,useValue:"XSRF-TOKEN"},{provide:j0,useValue:"X-XSRF-TOKEN"}]}),n})(),XW=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Zi({type:n}),n.\u0275inj=ki({providers:[Ed,{provide:EI,useClass:qW},FI,{provide:TI,useExisting:FI}],imports:[[YW.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),n})(),q0=(()=>{class n{constructor(t){this.httpClient=t,this.getMaps=()=>this.httpClient.get("https://us-central1-twgeostat.cloudfunctions.net/getDB/maps"),this.getMockMaps=()=>Be([{mapId:1,mapName:"\u5206\u5e97\u8cc7\u6599",createdTime:"2022-05-22T03:34:43Z",creator:"admin",defualtCategoryId:"-N-SasgrgpgWs2szH-aH"},{mapId:2,mapName:"\u7c21\u5831\u7528\u5730\u5716",createdTime:"2022-05-24T05:35:35Z",creator:"admin",defualtCategoryId:"-N1hLpiGatywxzYbbuJy"},{mapId:3,mapName:"\u958b\u5f35\u5206\u5e97\u5730\u5716",createdTime:"2022-05-24T13:05:06Z",creator:"admin",defualtCategoryId:"adwqfeswdq"},{mapId:4,mapName:"\u958b\u5f35\u5206\u5e97\u5730\u5716",createdTime:"2022-05-24T13:09:58Z",creator:"admin",defualtCategoryId:"adwqfeswdq"},{mapId:5,mapName:"\u5be6\u9ad4\u884c\u92b7\u8209\u8fa6\u5206\u5e97\u5730\u5716",createdTime:"2022-05-24T13:13:31Z",creator:"admin",defualtCategoryId:"-N-SasgrgpgWs2szH-aH"}]),this.deleteMap=i=>{let r=(new Yi).set("content-type","application/x-www-form-urlencoded");return this.httpClient.delete(`https://us-central1-twgeostat.cloudfunctions.net/getDB/maps/${i}`,{headers:r})},this.renameMap=(i,r)=>{let s=(new Yi).set("content-type","application/x-www-form-urlencoded"),o=new URLSearchParams;return o.set("name",r),this.httpClient.post(`https://us-central1-twgeostat.cloudfunctions.net/getDB/maps/${i}/rename`,o.toString(),{headers:s})},this.addMap=(i,r,s,o)=>{let a=new URLSearchParams;a.set("name",i),a.set("creator",r),a.set("defualtCategoryId",s),a.set("mapSettingId",o);let l=(new Yi).set("content-type","application/x-www-form-urlencoded");return this.httpClient.post("https://us-central1-twgeostat.cloudfunctions.net/getDB/maps/",a.toString(),{headers:l})},this.getMap=i=>this.httpClient.get(`https://us-central1-twgeostat.cloudfunctions.net/getDB/maps/${i}`),this.changeDefaultCategory=(i,r)=>{const s=(new Yi).set("content-type","application/x-www-form-urlencoded");let o=new URLSearchParams;return o.set("category",r),this.httpClient.post(`https://us-central1-twgeostat.cloudfunctions.net/getDB/maps/${i}/category`,o.toString(),{headers:s})}}}return n.\u0275fac=function(t){return new(t||n)(pe(Ed))},n.\u0275prov=Ne({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const ue=function(n,e){if(!n)throw Kl(e)},Kl=function(n){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+n)},BI=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=63&r|128):55296==(64512&r)&&i+1<n.length&&56320==(64512&n.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&n.charCodeAt(++i)),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=63&r|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=63&r|128)}return e},X0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],o=r+1<n.length,a=o?n[r+1]:0,l=r+2<n.length,c=l?n[r+2]:0;let h=(15&a)<<2|c>>6,f=63&c;l||(f=64,o||(h=64)),i.push(t[s>>2],t[(3&s)<<4|a>>4],t[h],t[f])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(BI(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[t++];e[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){const l=((7&r)<<18|(63&n[t++])<<12|(63&n[t++])<<6|63&n[t++])-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(1023&l))}else{const s=n[t++],o=n[t++];e[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=t[n.charAt(r++)],a=r<n.length?t[n.charAt(r)]:0;++r;const c=r<n.length?t[n.charAt(r)]:64;++r;const d=r<n.length?t[n.charAt(r)]:64;if(++r,null==s||null==a||null==c||null==d)throw Error();i.push(s<<2|a>>4),64!==c&&(i.push(a<<4&240|c>>2),64!==d&&i.push(c<<6&192|d))}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},VI=function(n){const e=BI(n);return X0.encodeByteArray(e,!0)},kp=function(n){return VI(n).replace(/\./g,"")},UI=function(n){try{return X0.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function JW(n){return HI(void 0,n)}function HI(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===n&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!KW(t)||(n[t]=HI(n[t],e[t]));return n}function KW(n){return"__proto__"!==n}class Bp{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,i))}}}function zI(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(function Vp(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}())}class Q0 extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name="FirebaseError",Object.setPrototypeOf(this,Q0.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,GI.prototype.create)}}class GI{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?function r9(n,e){return n.replace(s9,(t,i)=>{const r=e[i];return null!=r?String(r):`<${i}?>`})}(s,i):"Error";return new Q0(r,`${this.serviceName}: ${o} (${r}).`,i)}}const s9=/\{\$([^}]+)}/g;function Td(n){return JSON.parse(n)}function Wn(n){return JSON.stringify(n)}const Up=function(n){let e={},t={},i={},r="";try{const s=n.split(".");e=Td(UI(s[0])||""),t=Td(UI(s[1])||""),r=s[2],i=t.d||{},delete t.d}catch(s){}return{header:e,claims:t,data:i,signature:r}};function ks(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Zl(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function WI(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Hp(n,e,t){const i={};for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=e.call(t,n[r],r,n));return i}function J0(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const s=n[r],o=e[r];if(jI(s)&&jI(o)){if(!J0(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function jI(n){return null!==n&&"object"==typeof n}class c9{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const i=this.W_;if("string"==typeof e)for(let d=0;d<16;d++)i[d]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let d=0;d<16;d++)i[d]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let d=16;d<80;d++){const h=i[d-3]^i[d-8]^i[d-14]^i[d-16];i[d]=4294967295&(h<<1|h>>>31)}let c,u,r=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4];for(let d=0;d<80;d++){d<40?d<20?(c=a^s&(o^a),u=1518500249):(c=s^o^a,u=1859775393):d<60?(c=s&o|a&(s|o),u=2400959708):(c=s^o^a,u=3395469782);const h=(r<<5|r>>>27)+c+l+u+i[d]&4294967295;l=a,a=o,o=4294967295&(s<<30|s>>>2),s=r,r=h}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const i=t-this.blockSize;let r=0;const s=this.buf_;let o=this.inbuf_;for(;r<t;){if(0===o)for(;r<=i;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(s[o]=e.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}else for(;r<t;)if(s[o]=e[r],++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=255&t,t/=256;this.compress_(this.buf_);let i=0;for(let r=0;r<5;r++)for(let s=24;s>=0;s-=8)e[i]=this.chain_[r]>>s&255,++i;return e}}function ec(n,e){return`${n} failed: ${e} argument `}const zp=function(n){let e=0;for(let t=0;t<n.length;t++){const i=n.charCodeAt(t);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,t++):e+=3}return e};function Dd(n){return n&&n._delegate?n._delegate:n}function Ad(n,e){return new Promise((t,i)=>{n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{var s;i(`${e}: ${null===(s=r.target.error)||void 0===s?void 0:s.message}`)}})}class $I{constructor(e){this._db=e,this.objectStoreNames=this._db.objectStoreNames}transaction(e,t){return new qI(this._db.transaction.call(this._db,e,t))}createObjectStore(e,t){return new YI(this._db.createObjectStore(e,t))}close(){this._db.close()}}class qI{constructor(e){this._transaction=e,this.complete=new Promise((t,i)=>{this._transaction.oncomplete=function(){t()},this._transaction.onerror=()=>{i(this._transaction.error)},this._transaction.onabort=()=>{i(this._transaction.error)}})}objectStore(e){return new YI(this._transaction.objectStore(e))}}class YI{constructor(e){this._store=e}index(e){return new XI(this._store.index(e))}createIndex(e,t,i){return new XI(this._store.createIndex(e,t,i))}get(e){return Ad(this._store.get(e),"Error reading from IndexedDB")}put(e,t){return Ad(this._store.put(e,t),"Error writing to IndexedDB")}delete(e){return Ad(this._store.delete(e),"Error deleting from IndexedDB")}clear(){return Ad(this._store.clear(),"Error clearing IndexedDB object store")}}class XI{constructor(e){this._index=e}get(e){return Ad(this._index.get(e),"Error reading from IndexedDB")}}class Id{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const ma="[DEFAULT]";class v9{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new Bp;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch(r){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(i)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:i})}catch(s){if(r)return null;throw s}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function b9(n){return"EAGER"===n.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:ma})}catch(t){}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch(s){}}}}clearInstance(e=ma){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){var e=this;return Je(function*(){const t=Array.from(e.instances.values());yield Promise.all([...t.filter(i=>"INTERNAL"in i).map(i=>i.INTERNAL.delete()),...t.filter(i=>"_delete"in i).map(i=>i._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(e=ma){return this.instances.has(e)}getOptions(e=ma){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[s,o]of this.instancesDeferred.entries())i===this.normalizeInstanceIdentifier(s)&&o.resolve(r);return r}onInit(e,t){var i;const r=this.normalizeInstanceIdentifier(t),s=null!==(i=this.onInitCallbacks.get(r))&&void 0!==i?i:new Set;s.add(e),this.onInitCallbacks.set(r,s);const o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch(s){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:(n=e,n===ma?void 0:n),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch(r){}var n;return i||null}normalizeInstanceIdentifier(e=ma){return this.component?this.component.multipleInstances?e:ma:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class x9{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new v9(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const ew=[];var Vt=(()=>{return(n=Vt||(Vt={}))[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",Vt;var n})();const QI={debug:Vt.DEBUG,verbose:Vt.VERBOSE,info:Vt.INFO,warn:Vt.WARN,error:Vt.ERROR,silent:Vt.SILENT},C9=Vt.INFO,M9={[Vt.DEBUG]:"log",[Vt.VERBOSE]:"log",[Vt.INFO]:"info",[Vt.WARN]:"warn",[Vt.ERROR]:"error"},S9=(n,e,...t)=>{if(e<n.logLevel)return;const i=(new Date).toISOString(),r=M9[e];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[r](`[${i}]  ${n.name}:`,...t)};class JI{constructor(e){this.name=e,this._logLevel=C9,this._logHandler=S9,this._userLogHandler=null,ew.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Vt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?QI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Vt.DEBUG,...e),this._logHandler(this,Vt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Vt.VERBOSE,...e),this._logHandler(this,Vt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Vt.INFO,...e),this._logHandler(this,Vt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Vt.WARN,...e),this._logHandler(this,Vt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Vt.ERROR,...e),this._logHandler(this,Vt.ERROR,...e)}}class E9{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(function T9(n){const e=n.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}return null}).filter(t=>t).join(" ")}}const tw="@firebase/app",nw=new JI("@firebase/app"),iw="[DEFAULT]",Z9={[tw]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},ga=new Map,Gp=new Map;function e7(n,e){try{n.container.addComponent(e)}catch(t){nw.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Wp(n){const e=n.name;if(Gp.has(e))return nw.debug(`There were multiple attempts to register component ${e}.`),!1;Gp.set(e,n);for(const t of ga.values())e7(t,n);return!0}const go=new GI("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."});class n7{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Id("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw go.create("app-deleted",{appName:this._name})}}function tc(n,e,t){var i;let r=null!==(i=Z9[n])&&void 0!==i?i:n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${r}" with version "${e}":`];return s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void nw.warn(a.join(" "))}Wp(new Id(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const Rd="firebase-heartbeat-store";let sw=null;function e2(){return sw||(sw=function y9(n,e,t){return new Promise((i,r)=>{try{const s=indexedDB.open(n,e);s.onsuccess=o=>{i(new $I(o.target.result))},s.onerror=o=>{var a;r(`Error opening indexedDB: ${null===(a=o.target.error)||void 0===a?void 0:a.message}`)},s.onupgradeneeded=o=>{t(new $I(s.result),o.oldVersion,o.newVersion,new qI(s.transaction))}}catch(s){r(`Error opening indexedDB: ${s.message}`)}})}("firebase-heartbeat-database",1,(n,e)=>{0===e&&n.createObjectStore(Rd)}).catch(n=>{throw go.create("storage-open",{originalErrorMessage:n.message})})),sw}function ow(){return(ow=Je(function*(n){try{return(yield e2()).transaction(Rd).objectStore(Rd).get(n2(n))}catch(e){throw go.create("storage-get",{originalErrorMessage:e.message})}})).apply(this,arguments)}function t2(n,e){return aw.apply(this,arguments)}function aw(){return(aw=Je(function*(n,e){try{const i=(yield e2()).transaction(Rd,"readwrite");return yield i.objectStore(Rd).put(e,n2(n)),i.complete}catch(t){throw go.create("storage-set",{originalErrorMessage:t.message})}})).apply(this,arguments)}function n2(n){return`${n.name}!${n.options.appId}`}class d7{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new f7(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}triggerHeartbeat(){var e=this;return Je(function*(){const i=e.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=i2();if(null===e._heartbeatsCache&&(e._heartbeatsCache=yield e._heartbeatsCachePromise),e._heartbeatsCache.lastSentHeartbeatDate!==r&&!e._heartbeatsCache.heartbeats.some(s=>s.date===r))return e._heartbeatsCache.heartbeats.push({date:r,agent:i}),e._heartbeatsCache.heartbeats=e._heartbeatsCache.heartbeats.filter(s=>{const o=new Date(s.date).valueOf();return Date.now()-o<=2592e6}),e._storage.overwrite(e._heartbeatsCache)})()}getHeartbeatsHeader(){var e=this;return Je(function*(){if(null===e._heartbeatsCache&&(yield e._heartbeatsCachePromise),null===e._heartbeatsCache||0===e._heartbeatsCache.heartbeats.length)return"";const t=i2(),{heartbeatsToSend:i,unsentEntries:r}=function h7(n,e=1024){const t=[];let i=n.slice();for(const r of n){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),r2(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),r2(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}(e._heartbeatsCache.heartbeats),s=kp(JSON.stringify({version:2,heartbeats:i}));return e._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(e._heartbeatsCache.heartbeats=r,yield e._storage.overwrite(e._heartbeatsCache)):(e._heartbeatsCache.heartbeats=[],e._storage.overwrite(e._heartbeatsCache)),s})()}}function i2(){return(new Date).toISOString().substring(0,10)}class f7{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return Je(function*(){return!!function t9(){return"object"==typeof indexedDB}()&&function n9(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var s;e((null===(s=r.error)||void 0===s?void 0:s.message)||"")}}catch(t){e(t)}})}().then(()=>!0).catch(()=>!1)})()}read(){var e=this;return Je(function*(){return(yield e._canUseIndexedDBPromise)&&(yield function l7(n){return ow.apply(this,arguments)}(e.app))||{heartbeats:[]}})()}overwrite(e){var t=this;return Je(function*(){var i;if(yield t._canUseIndexedDBPromise){const s=yield t.read();return t2(t.app,{lastSentHeartbeatDate:null!==(i=e.lastSentHeartbeatDate)&&void 0!==i?i:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}})()}add(e){var t=this;return Je(function*(){var i;if(yield t._canUseIndexedDBPromise){const s=yield t.read();return t2(t.app,{lastSentHeartbeatDate:null!==(i=e.lastSentHeartbeatDate)&&void 0!==i?i:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}})()}}function r2(n){return kp(JSON.stringify({version:2,heartbeats:n})).length}!function p7(n){Wp(new Id("platform-logger",e=>new E9(e),"PRIVATE")),Wp(new Id("heartbeat",e=>new d7(e),"PRIVATE")),tc(tw,"0.7.20",n),tc(tw,"0.7.20","esm2017"),tc("fire-js","")}(""),tc("firebase","9.6.10","app");const s2="@firebase/database";let lw="";class y7{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Wn(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:Td(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class v7{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return ks(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const a2=function(n){try{if("undefined"!=typeof window&&void 0!==window[n]){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new y7(e)}}catch(e){}return new v7},_a=a2("localStorage"),cw=a2("sessionStorage"),nc=new JI("@firebase/database"),l2=function(){let n=1;return function(){return n++}}(),c2=function(n){const e=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);if(r>=55296&&r<=56319){const s=r-55296;i++,ue(i<n.length,"Surrogate pair missing trail surrogate."),r=65536+(s<<10)+(n.charCodeAt(i)-56320)}r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=63&r|128):r<65536?(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=63&r|128):(e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=63&r|128)}return e}(n),t=new c9;t.update(e);const i=t.digest();return X0.encodeByteArray(i)},Pd=function(...n){let e="";for(let t=0;t<n.length;t++){const i=n[t];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?e+=Pd.apply(null,i):e+="object"==typeof i?Wn(i):i,e+=" "}return e};let ya=null,u2=!0;const jn=function(...n){if(!0===u2&&(u2=!1,null===ya&&!0===cw.get("logging_enabled")&&function(n,e){ue(!e||!0===n||!1===n,"Can't turn on custom loggers persistently."),!0===n?(nc.logLevel=Vt.VERBOSE,ya=nc.log.bind(nc),e&&cw.set("logging_enabled",!0)):"function"==typeof n?ya=n:(ya=null,cw.remove("logging_enabled"))}(!0)),ya){const e=Pd.apply(null,n);ya(e)}},Nd=function(n){return function(...e){jn(n,...e)}},uw=function(...n){const e="FIREBASE INTERNAL ERROR: "+Pd(...n);nc.error(e)},ns=function(...n){const e=`FIREBASE FATAL ERROR: ${Pd(...n)}`;throw nc.error(e),new Error(e)},_i=function(...n){const e="FIREBASE WARNING: "+Pd(...n);nc.warn(e)},jp=function(n){return"number"==typeof n&&(n!=n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},Bs="[MIN_NAME]",is="[MAX_NAME]",va=function(n,e){if(n===e)return 0;if(n===Bs||e===is)return-1;if(e===Bs||n===is)return 1;{const t=$p(n),i=$p(e);return null!==t?null!==i?t-i==0?n.length-e.length:t-i:-1:null!==i?1:n<e?-1:1}},x7=function(n,e){return n===e?0:n<e?-1:1},Ld=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+Wn(e))},dw=function(n){if("object"!=typeof n||null===n)return Wn(n);const e=[];for(const i in n)e.push(i);e.sort();let t="{";for(let i=0;i<e.length;i++)0!==i&&(t+=","),t+=Wn(e[i]),t+=":",t+=dw(n[e[i]]);return t+="}",t},h2=function(n,e){const t=n.length;if(t<=e)return[n];const i=[];for(let r=0;r<t;r+=e)i.push(n.substring(r,r+e>t?t:r+e));return i};function $n(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const f2=function(n){ue(!jp(n),"Invalid JSON number");const i=1023;let r,s,o,a,l;0===n?(s=0,o=0,r=1/n==-1/0?1:0):(r=n<0,(n=Math.abs(n))>=Math.pow(2,1-i)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),i),s=a+i,o=Math.round(n*Math.pow(2,52-a)-Math.pow(2,52))):(s=0,o=Math.round(n/Math.pow(2,-1074))));const c=[];for(l=52;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(l=11;l;l-=1)c.push(s%2?1:0),s=Math.floor(s/2);c.push(r?1:0),c.reverse();const u=c.join("");let d="";for(l=0;l<64;l+=8){let h=parseInt(u.substr(l,8),2).toString(16);1===h.length&&(h="0"+h),d+=h}return d.toLowerCase()},E7=new RegExp("^-?(0*)\\d{1,10}$"),$p=function(n){if(E7.test(n)){const e=Number(n);if(e>=-2147483648&&e<=2147483647)return e}return null},ic=function(n){try{n()}catch(e){setTimeout(()=>{throw _i("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},Od=function(n,e){const t=setTimeout(n,e);return"object"==typeof t&&t.unref&&t.unref(),t};class D7{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then(i=>this.appCheck=i)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){_i(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class A7{constructor(e,t,i){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&"auth/token-not-initialized"===t.code?(jn("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',_i(e)}}let Fd=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}return n.OWNER="owner",n})();const v2=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,b2="websocket",x2="long_polling";class pw{constructor(e,t,i,r,s=!1,o="",a=!1){this.secure=t,this.namespace=i,this.webSocketOnly=r,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=_a.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&_a.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function C2(n,e,t){let i;if(ue("string"==typeof e,"typeof type must == string"),ue("object"==typeof t,"typeof params must == object"),e===b2)i=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else{if(e!==x2)throw new Error("Unknown connection type: "+e);i=(n.secure?"https://":"http://")+n.internalHost+"/.lp?"}(function R7(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams})(n)&&(t.ns=n.namespace);const r=[];return $n(t,(s,o)=>{r.push(s+"="+o)}),i+r.join("&")}class P7{constructor(){this.counters_={}}incrementCounter(e,t=1){ks(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return JW(this.counters_)}}const mw={},gw={};function _w(n){const e=n.toString();return mw[e]||(mw[e]=new P7),mw[e]}class L7{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<i.length;++r)i[r]&&ic(()=>{this.onMessage_(i[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class rc{constructor(e,t,i,r,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Nd(e),this.stats_=_w(t),this.urlFn=l=>(this.appCheckToken&&(l.ac=this.appCheckToken),C2(t,x2,l))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new L7(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(n){if("complete"===document.readyState)n();else{let e=!1;const t=function(){document.body?e||(e=!0,n()):setTimeout(t,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&t()}),window.attachEvent("onload",t))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new yw((...s)=>{const[o,a,l,c,u]=s;if(this.incrementIncomingBytes_(s),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===o)this.id=a,this.password=l;else{if("close"!==o)throw new Error("Unrecognized command received: "+o);a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_()}},(...s)=>{const[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const i={start:"t"};i.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(i.cb=this.scriptTagHolder.uniqueCallbackIdentifier),i.v="5",this.transportSessionId&&(i.s=this.transportSessionId),this.lastSessionId&&(i.ls=this.lastSessionId),this.applicationId&&(i.p=this.applicationId),this.appCheckToken&&(i.ac=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&v2.test(location.hostname)&&(i.r="f");const r=this.urlFn(i);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){rc.forceAllow_=!0}static forceDisallow(){rc.forceDisallow_=!0}static isAvailable(){return!(!rc.forceAllow_&&(rc.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=Wn(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=VI(t),r=h2(i,1840);for(let s=0;s<r.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const i={dframe:"t"};i.id=e,i.pw=t,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=Wn(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class yw{constructor(e,t,i,r){this.onDisconnect=i,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=l2(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=yw.createIFrame_();let s="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){jn("frame writing exception"),a.stack&&jn(a.stack),jn(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||jn("No IE domain setting required")}catch(t){const i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),i="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+i.length<=1870;){const o=this.pendingSegs.shift();i=i+"&seg"+r+"="+o.seg+"&ts"+r+"="+o.ts+"&d"+r+"="+o.d,r++}return t+=i,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,i){this.pendingSegs.push({seg:e,ts:t,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const i=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(i,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(r),i()})}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){const r=i.readyState;(!r||"loaded"===r||"complete"===r)&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=()=>{jn("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch(i){}},Math.floor(1))}}let kd=null;"undefined"!=typeof MozWebSocket?kd=MozWebSocket:"undefined"!=typeof WebSocket&&(kd=WebSocket);let Bd=(()=>{class n{constructor(t,i,r,s,o,a,l){this.connId=t,this.applicationId=r,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Nd(this.connId),this.stats_=_w(i),this.connURL=n.connectionURL_(i,a,l,s),this.nodeAdmin=i.nodeAdmin}static connectionURL_(t,i,r,s){const o={v:"5"};return"undefined"!=typeof location&&location.hostname&&v2.test(location.hostname)&&(o.r="f"),i&&(o.s=i),r&&(o.ls=r),s&&(o.ac=s),C2(t,b2,o)}open(t,i){this.onDisconnect=i,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,_a.set("previous_websocket_failure",!0);try{this.mySock=new kd(this.connURL,[],{headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}})}catch(r){this.log_("Error instantiating WebSocket.");const s=r.message||r.data;return s&&this.log_(s),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const r=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);r&&r.length>1&&parseFloat(r[1])<4.4&&(t=!0)}return!t&&null!==kd&&!n.forceDisallow_}static previouslyFailed(){return _a.isInMemoryStorage||!0===_a.get("previous_websocket_failure")}markConnectionHealthy(){_a.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const i=this.frames.join("");this.frames=null;const r=Td(i);this.onMessage(r)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(ue(null===this.frames,"We already have a frame buffer"),t.length<=6){const i=Number(t);if(!isNaN(i))return this.handleNewFrameCount_(i),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(null===this.mySock)return;const i=t.data;if(this.bytesReceived+=i.length,this.stats_.incrementCounter("bytes_received",i.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(i);else{const r=this.extractFrameCount_(i);null!==r&&this.appendFrame_(r)}}send(t){this.resetKeepAlive();const i=Wn(t);this.bytesSent+=i.length,this.stats_.incrementCounter("bytes_sent",i.length);const r=h2(i,16384);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(t){try{this.mySock.send(t)}catch(i){this.log_("Exception thrown from WebSocket.send():",i.message||i.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4,n})();class vw{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[rc,Bd]}initTransports_(e){const t=Bd&&Bd.isAvailable();let i=t&&!Bd.previouslyFailed();if(e.webSocketOnly&&(t||_i("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Bd];else{const r=this.transports_=[];for(const s of vw.ALL_TRANSPORTS)s&&s.isAvailable()&&r.push(s)}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}class F2{constructor(e,t,i,r,s,o,a,l,c,u){this.id=e,this.repoInfo_=t,this.applicationId_=i,this.appCheckToken_=r,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Nd("c:"+this.id+":"),this.transportManager_=new vw(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,i)},Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=Od(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Ld("t",e),i=Ld("d",e);if("c"===t)this.onSecondaryControl_(i);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(i)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Ld("t",e),i=Ld("d",e);"c"===t?this.onControl_(i):"d"===t&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Ld("t",e);if("d"in e){const i=e.d;if("h"===t)this.onHandshake_(i);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(i):"r"===t?this.onReset_(i):"e"===t?uw("Server Error: "+i):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):uw("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,i=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==i&&_i("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,i),Od(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Od(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(_a.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class k2{put(e,t,i,r){}merge(e,t,i,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,i){}onDisconnectMerge(e,t,i){}onDisconnectCancel(e,t){}reportStats(e){}}class B2{constructor(e){this.allowedEvents_=e,this.listeners_={},ue(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(let r=0;r<i.length;r++)i[r].callback.apply(i[r].context,t)}}on(e,t,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:i});const r=this.getInitialEvent(e);r&&t.apply(i,r)}off(e,t,i){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let s=0;s<r.length;s++)if(r[s].callback===t&&(!i||i===r[s].context))return void r.splice(s,1)}validateEventType_(e){ue(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class Yp extends B2{constructor(){super(["online"]),this.online_=!0,"undefined"!=typeof window&&void 0!==window.addEventListener&&!zI()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new Yp}getInitialEvent(e){return ue("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class It{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let i=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[i]=this.pieces_[r],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function Dt(){return new It("")}function ut(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function _o(n){return n.pieces_.length-n.pieceNum_}function Wt(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new It(n.pieces_,e)}function bw(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function Vd(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function H2(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new It(e,0)}function ln(n,e){const t=[];for(let i=n.pieceNum_;i<n.pieces_.length;i++)t.push(n.pieces_[i]);if(e instanceof It)for(let i=e.pieceNum_;i<e.pieces_.length;i++)t.push(e.pieces_[i]);else{const i=e.split("/");for(let r=0;r<i.length;r++)i[r].length>0&&t.push(i[r])}return new It(t,0)}function dt(n){return n.pieceNum_>=n.pieces_.length}function yi(n,e){const t=ut(n),i=ut(e);if(null===t)return e;if(t===i)return yi(Wt(n),Wt(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function xw(n,e){if(_o(n)!==_o(e))return!1;for(let t=n.pieceNum_,i=e.pieceNum_;t<=n.pieces_.length;t++,i++)if(n.pieces_[t]!==e.pieces_[i])return!1;return!0}function ur(n,e){let t=n.pieceNum_,i=e.pieceNum_;if(_o(n)>_o(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[i])return!1;++t,++i}return!0}class ij{constructor(e,t){this.errorPrefix_=t,this.parts_=Vd(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=zp(this.parts_[i]);z2(this)}}function z2(n){if(n.byteLength_>768)throw new Error(n.errorPrefix_+"has a key path longer than 768 bytes ("+n.byteLength_+").");if(n.parts_.length>32)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+wa(n))}function wa(n){return 0===n.parts_.length?"":"in property '"+n.parts_.join(".")+"'"}class Cw extends B2{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new Cw}getInitialEvent(e){return ue("visible"===e,"Unknown event type: "+e),[this.visible_]}}const Ud=1e3;let Qp,ba=(()=>{class n extends k2{constructor(t,i,r,s,o,a,l,c){if(super(),this.repoInfo_=t,this.applicationId_=i,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=l,this.authOverride_=c,this.id=n.nextPersistentConnectionId_++,this.log_=Nd("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Ud,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Cw.getInstance().on("visible",this.onVisible_,this),-1===t.host.indexOf("fblocal")&&Yp.getInstance().on("online",this.onOnline_,this)}sendRequest(t,i,r){const s=++this.requestNumber_,o={r:s,a:t,b:i};this.log_(Wn(o)),ue(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),r&&(this.requestCBHash_[s]=r)}get(t){this.initConnection_();const i=new Bp,r={p:t._path.toString(),q:t._queryObject},s={action:"g",request:r,onComplete:a=>{const l=a.d;"ok"===a.s?(this.onDataUpdate_(r.p,l,!1,null),i.resolve(l)):i.reject(l)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const o=this.outstandingGets_.length-1;return this.connected_||setTimeout(()=>{const a=this.outstandingGets_[o];void 0===a||s!==a||(delete this.outstandingGets_[o],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),this.log_("get "+o+" timed out on connection"),i.reject(new Error("Client is offline.")))},3e3),this.connected_&&this.sendGet_(o),i.promise}listen(t,i,r,s){this.initConnection_();const o=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),ue(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),ue(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");const l={onComplete:s,hashFn:i,query:t,tag:r};this.listens.get(a).set(o,l),this.connected_&&this.sendListen_(l)}sendGet_(t){const i=this.outstandingGets_[t];this.sendRequest("g",i.request,r=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),i.onComplete&&i.onComplete(r)})}sendListen_(t){const i=t.query,r=i._path.toString(),s=i._queryIdentifier;this.log_("Listen on "+r+" for "+s);const o={p:r};t.tag&&(o.q=i._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest("q",o,l=>{const c=l.d,u=l.s;n.warnOnListenWarnings_(c,i),(this.listens.get(r)&&this.listens.get(r).get(s))===t&&(this.log_("listen response",l),"ok"!==u&&this.removeListen_(r,s),t.onComplete&&t.onComplete(u,c))})}static warnOnListenWarnings_(t,i){if(t&&"object"==typeof t&&ks(t,"w")){const r=Zl(t,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const s='".indexOn": "'+i._queryParams.getIndex().toString()+'"',o=i._path.toString();_i(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&40===t.length||function(n){const e=Up(n).claims;return"object"==typeof e&&!0===e.admin}(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,i=function(n){const t=Up(n).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")}(t)?"auth":"gauth",r={cred:t};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(i,r,s=>{const o=s.s,a=s.d||"error";this.authToken_===t&&("ok"===o?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const i=t.s,r=t.d||"error";"ok"===i?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(i,r)})}unlisten(t,i){const r=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),ue(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,t._queryObject,i)}sendUnlisten_(t,i,r,s){this.log_("Unlisten on "+t+" for "+i);const o={p:t};s&&(o.q=r,o.t=s),this.sendRequest("n",o)}onDisconnectPut(t,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,i,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:i,onComplete:r})}onDisconnectMerge(t,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,i,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:i,onComplete:r})}onDisconnectCancel(t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:i})}sendOnDisconnect_(t,i,r,s){const o={p:i,d:r};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(t,i,r,s){this.putInternal("p",t,i,r,s)}merge(t,i,r,s){this.putInternal("m",t,i,r,s)}putInternal(t,i,r,s,o){this.initConnection_();const a={p:i,d:r};void 0!==o&&(a.h=o),this.outstandingPuts_.push({action:t,request:a,onComplete:s}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+i)}sendPut_(t){const i=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(i,r,o=>{this.log_(i+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){const i={c:t};this.log_("reportStats",i),this.sendRequest("s",i,r=>{"ok"!==r.s&&this.log_("reportStats","Error sending stats: "+r.d)})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+Wn(t));const i=t.r,r=this.requestCBHash_[i];r&&(delete this.requestCBHash_[i],r(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,i){this.log_("handleServerMessage",t,i),"d"===t?this.onDataUpdate_(i.p,i.d,!1,i.t):"m"===t?this.onDataUpdate_(i.p,i.d,!0,i.t):"c"===t?this.onListenRevoked_(i.p,i.q):"ac"===t?this.onAuthRevoked_(i.s,i.d):"apc"===t?this.onAppCheckRevoked_(i.s,i.d):"sd"===t?this.onSecurityDebugPacket_(i):uw("Unrecognized action received from server: "+Wn(t)+"\nAre you using the latest client?")}onReady_(t,i){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=i,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){ue(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ud,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Ud,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Ud),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const t=(new Date).getTime()-this.lastConnectionAttemptTime_;let i=Math.max(0,this.reconnectDelay_-t);i=Math.random()*i,this.log_("Trying to reconnect in "+i+"ms"),this.scheduleConnect_(i),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var t=this;return Je(function*(){if(t.shouldReconnect_()){t.log_("Making a connection attempt"),t.lastConnectionAttemptTime_=(new Date).getTime(),t.lastConnectionEstablishedTime_=null;const i=t.onDataMessage_.bind(t),r=t.onReady_.bind(t),s=t.onRealtimeDisconnect_.bind(t),o=t.id+":"+n.nextConnectionId_++,a=t.lastSessionId;let l=!1,c=null;const u=function(){c?c.close():(l=!0,s())};t.realtime_={close:u,sendRequest:function(f){ue(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(f)}};const h=t.forceTokenRefresh_;t.forceTokenRefresh_=!1;try{const[f,p]=yield Promise.all([t.authTokenProvider_.getToken(h),t.appCheckTokenProvider_.getToken(h)]);l?jn("getToken() completed but was canceled"):(jn("getToken() completed. Creating connection."),t.authToken_=f&&f.accessToken,t.appCheckToken_=p&&p.token,c=new F2(o,t.repoInfo_,t.applicationId_,t.appCheckToken_,t.authToken_,i,r,s,_=>{_i(_+" ("+t.repoInfo_.toString()+")"),t.interrupt("server_kill")},a))}catch(f){t.log_("Failed to get token: "+f),l||(t.repoInfo_.nodeAdmin&&_i(f),u())}}})()}interrupt(t){jn("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){jn("Resuming connection for reason: "+t),delete this.interruptReasons_[t],WI(this.interruptReasons_)&&(this.reconnectDelay_=Ud,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const i=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:i})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const i=this.outstandingPuts_[t];i&&"h"in i.request&&i.queued&&(i.onComplete&&i.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(t,i){let r;r=i?i.map(o=>dw(o)).join("$"):"default";const s=this.removeListen_(t,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,i){const r=new It(t).toString();let s;if(this.listens.has(r)){const o=this.listens.get(r);s=o.get(i),o.delete(i),0===o.size&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(t,i){jn("Auth token revoked: "+t+"/"+i),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===t||"permission_denied"===t)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,i){jn("App check token revoked: "+t+"/"+i),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===t||"permission_denied"===t)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const i of t.values())this.sendListen_(i);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let i="js";t["sdk."+i+"."+lw.replace(/\./g,"-")]=1,zI()?t["framework.cordova"]=1:function e9(){return"object"==typeof navigator&&"ReactNative"===navigator.product}()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=Yp.getInstance().currentlyOnline();return WI(this.interruptReasons_)&&t}}return n.nextPersistentConnectionId_=0,n.nextConnectionId_=0,n})();class gt{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new gt(e,t)}}class Xp{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const i=new gt(Bs,e),r=new gt(Bs,t);return 0!==this.compare(i,r)}minPost(){return gt.MIN}}class j2 extends Xp{static get __EMPTY_NODE(){return Qp}static set __EMPTY_NODE(e){Qp=e}compare(e,t){return va(e.name,t.name)}isDefinedOn(e){throw Kl("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return gt.MIN}maxPost(){return new gt(is,Qp)}makePost(e,t){return ue("string"==typeof e,"KeyIndex indexValue must always be a string."),new gt(e,Qp)}toString(){return".key"}}const rs=new j2;class Jp{constructor(e,t,i,r,s=null){this.isReverse_=r,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?i(e.key,t):1,r&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}let Sw,Ir=(()=>{class n{constructor(t,i,r,s,o){this.key=t,this.value=i,this.color=null!=r?r:n.RED,this.left=null!=s?s:Ai.EMPTY_NODE,this.right=null!=o?o:Ai.EMPTY_NODE}copy(t,i,r,s,o){return new n(null!=t?t:this.key,null!=i?i:this.value,null!=r?r:this.color,null!=s?s:this.left,null!=o?o:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,i,r){let s=this;const o=r(t,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(t,i,r),null):0===o?s.copy(null,i,null,null,null):s.copy(null,null,null,null,s.right.insert(t,i,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Ai.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,i){let r,s;if(r=this,i(t,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(t,i),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),0===i(t,r.key)){if(r.right.isEmpty())return Ai.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(t,i))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,i)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})();class Ai{constructor(e,t=Ai.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Ai(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Ir.BLACK,null,null))}remove(e){return new Ai(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Ir.BLACK,null,null))}get(e){let t,i=this.root_;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),0===t)return i.value;t<0?i=i.left:t>0&&(i=i.right)}return null}getPredecessorKey(e){let t,i=this.root_,r=null;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),0===t){if(i.left.isEmpty())return r?r.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}t<0?i=i.left:t>0&&(r=i,i=i.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Jp(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Jp(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Jp(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Jp(this.root_,null,this.comparator_,!0,e)}}function hj(n,e){return va(n.name,e.name)}function Mw(n,e){return va(n,e)}Ai.EMPTY_NODE=new class dj{copy(e,t,i,r,s){return this}insert(e,t,i){return new Ir(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const $2=function(n){return"number"==typeof n?"number:"+f2(n):"string:"+n},q2=function(n){if(n.isLeafNode()){const e=n.val();ue("string"==typeof e||"number"==typeof e||"object"==typeof e&&ks(e,".sv"),"Priority must be a string or number.")}else ue(n===Sw||n.isEmpty(),"priority of unexpected type.");ue(n===Sw||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let Y2,X2,Q2,sc=(()=>{class n{constructor(t,i=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=i,this.lazyHash_=null,ue(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),q2(this.priorityNode_)}static set __childrenNodeConstructor(t){Y2=t}static get __childrenNodeConstructor(){return Y2}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return".priority"===t?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return dt(t)?this:".priority"===ut(t)?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,i){return null}updateImmediateChild(t,i){return".priority"===t?this.updatePriority(i):i.isEmpty()&&".priority"!==t?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,i).updatePriority(this.priorityNode_)}updateChild(t,i){const r=ut(t);return null===r?i:i.isEmpty()&&".priority"!==r?this:(ue(".priority"!==r||1===_o(t),".priority must be the last token in a path"),this.updateImmediateChild(r,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(Wt(t),i)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,i){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+$2(this.priorityNode_.val())+":");const i=typeof this.value_;t+=i+":",t+="number"===i?f2(this.value_):this.value_,this.lazyHash_=c2(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:(ue(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const i=typeof t.value_,r=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(i),o=n.VALUE_TYPE_ORDER.indexOf(r);return ue(s>=0,"Unknown leaf type: "+i),ue(o>=0,"Unknown leaf type: "+r),s===o?"object"===r?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const i=t;return this.value_===i.value_&&this.priorityNode_.equals(i.priorityNode_)}return!1}}return n.VALUE_TYPE_ORDER=["object","boolean","number","string"],n})();const Jt=new class gj extends Xp{compare(e,t){const i=e.node.getPriority(),r=t.node.getPriority(),s=i.compareTo(r);return 0===s?va(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return gt.MIN}maxPost(){return new gt(is,new sc("[PRIORITY-POST]",Q2))}makePost(e,t){const i=X2(e);return new gt(t,new sc("[PRIORITY-POST]",i))}toString(){return".priority"}},_j=Math.log(2);class yj{constructor(e){this.count=parseInt(Math.log(e+1)/_j,10),this.current_=this.count-1;const r=(s=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=e+1&r}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Kp=function(n,e,t,i){n.sort(e);const r=function(l,c){const u=c-l;let d,h;if(0===u)return null;if(1===u)return d=n[l],h=t?t(d):d,new Ir(h,d.node,Ir.BLACK,null,null);{const f=parseInt(u/2,10)+l,p=r(l,f),_=r(f+1,c);return d=n[f],h=t?t(d):d,new Ir(h,d.node,Ir.BLACK,p,_)}},a=function(l){let c=null,u=null,d=n.length;const h=function(p,_){const y=d-p,g=d;d-=p;const m=r(y+1,g),v=n[y],w=t?t(v):v;f(new Ir(w,v.node,_,null,m))},f=function(p){c?(c.left=p,c=p):(u=p,c=p)};for(let p=0;p<l.count;++p){const _=l.nextBitIsOne(),y=Math.pow(2,l.count-(p+1));_?h(y,Ir.BLACK):(h(y,Ir.BLACK),h(y,Ir.RED))}return u}(new yj(n.length));return new Ai(i||e,a)};let Ew;const oc={};class Vs{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return ue(oc&&Jt,"ChildrenNode.ts has not been loaded"),Ew=Ew||new Vs({".priority":oc},{".priority":Jt}),Ew}get(e){const t=Zl(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Ai?t:null}hasIndex(e){return ks(this.indexSet_,e.toString())}addIndex(e,t){ue(e!==rs,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let r=!1;const s=t.getIterator(gt.Wrap);let a,o=s.getNext();for(;o;)r=r||e.isDefinedOn(o.node),i.push(o),o=s.getNext();a=r?Kp(i,e.getCompare()):oc;const l=e.toString(),c=Object.assign({},this.indexSet_);c[l]=e;const u=Object.assign({},this.indexes_);return u[l]=a,new Vs(u,c)}addToIndexes(e,t){const i=Hp(this.indexes_,(r,s)=>{const o=Zl(this.indexSet_,s);if(ue(o,"Missing index implementation for "+s),r===oc){if(o.isDefinedOn(e.node)){const a=[],l=t.getIterator(gt.Wrap);let c=l.getNext();for(;c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),Kp(a,o.getCompare())}return oc}{const a=t.get(e.name);let l=r;return a&&(l=l.remove(new gt(e.name,a))),l.insert(e,e.node)}});return new Vs(i,this.indexSet_)}removeFromIndexes(e,t){const i=Hp(this.indexes_,r=>{if(r===oc)return r;{const s=t.get(e.name);return s?r.remove(new gt(e.name,s)):r}});return new Vs(i,this.indexSet_)}}let Hd,Ke=(()=>{class n{constructor(t,i,r){this.children_=t,this.priorityNode_=i,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&q2(this.priorityNode_),this.children_.isEmpty()&&ue(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Hd||(Hd=new n(new Ai(Mw),null,Vs.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Hd}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(".priority"===t)return this.getPriority();{const i=this.children_.get(t);return null===i?Hd:i}}getChild(t){const i=ut(t);return null===i?this:this.getImmediateChild(i).getChild(Wt(t))}hasChild(t){return null!==this.children_.get(t)}updateImmediateChild(t,i){if(ue(i,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(i);{const r=new gt(t,i);let s,o;i.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(t,i),o=this.indexMap_.addToIndexes(r,this.children_));const a=s.isEmpty()?Hd:this.priorityNode_;return new n(s,a,o)}}updateChild(t,i){const r=ut(t);if(null===r)return i;{ue(".priority"!==ut(t)||1===_o(t),".priority must be the last token in a path");const s=this.getImmediateChild(r).updateChild(Wt(t),i);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const i={};let r=0,s=0,o=!0;if(this.forEachChild(Jt,(a,l)=>{i[a]=l.val(t),r++,o&&n.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!t&&o&&s<2*r){const a=[];for(const l in i)a[l]=i[l];return a}return t&&!this.getPriority().isEmpty()&&(i[".priority"]=this.getPriority().val()),i}hash(){if(null===this.lazyHash_){let t="";this.getPriority().isEmpty()||(t+="priority:"+$2(this.getPriority().val())+":"),this.forEachChild(Jt,(i,r)=>{const s=r.hash();""!==s&&(t+=":"+i+":"+s)}),this.lazyHash_=""===t?"":c2(t)}return this.lazyHash_}getPredecessorChildName(t,i,r){const s=this.resolveIndex_(r);if(s){const o=s.getPredecessorKey(new gt(t,i));return o?o.name:null}return this.children_.getPredecessorKey(t)}getFirstChildName(t){const i=this.resolveIndex_(t);if(i){const r=i.minKey();return r&&r.name}return this.children_.minKey()}getFirstChild(t){const i=this.getFirstChildName(t);return i?new gt(i,this.children_.get(i)):null}getLastChildName(t){const i=this.resolveIndex_(t);if(i){const r=i.maxKey();return r&&r.name}return this.children_.maxKey()}getLastChild(t){const i=this.getLastChildName(t);return i?new gt(i,this.children_.get(i)):null}forEachChild(t,i){const r=this.resolveIndex_(t);return r?r.inorderTraversal(s=>i(s.name,s.node)):this.children_.inorderTraversal(i)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,i){const r=this.resolveIndex_(i);if(r)return r.getIteratorFrom(t,s=>s);{const s=this.children_.getIteratorFrom(t.name,gt.Wrap);let o=s.peek();for(;null!=o&&i.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,i){const r=this.resolveIndex_(i);if(r)return r.getReverseIteratorFrom(t,s=>s);{const s=this.children_.getReverseIteratorFrom(t.name,gt.Wrap);let o=s.peek();for(;null!=o&&i.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===zd?-1:0}withIndex(t){if(t===rs||this.indexMap_.hasIndex(t))return this;{const i=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,i)}}isIndexed(t){return t===rs||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const i=t;if(this.getPriority().equals(i.getPriority())){if(this.children_.count()===i.children_.count()){const r=this.getIterator(Jt),s=i.getIterator(Jt);let o=r.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=r.getNext(),a=s.getNext()}return null===o&&null===a}return!1}return!1}}resolveIndex_(t){return t===rs?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})();const zd=new class vj extends Ke{constructor(){super(new Ai(Mw),Ke.EMPTY_NODE,Vs.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Ke.EMPTY_NODE}isEmpty(){return!1}};function hn(n,e=null){if(null===n)return Ke.EMPTY_NODE;if("object"==typeof n&&".priority"in n&&(e=n[".priority"]),ue(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof n&&".value"in n&&null!==n[".value"]&&(n=n[".value"]),"object"!=typeof n||".sv"in n)return new sc(n,hn(e));if(n instanceof Array){let t=Ke.EMPTY_NODE;return $n(n,(i,r)=>{if(ks(n,i)&&"."!==i.substring(0,1)){const s=hn(r);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(i,s))}}),t.updatePriority(hn(e))}{const t=[];let i=!1;if($n(n,(o,a)=>{if("."!==o.substring(0,1)){const l=hn(a);l.isEmpty()||(i=i||!l.getPriority().isEmpty(),t.push(new gt(o,l)))}}),0===t.length)return Ke.EMPTY_NODE;const s=Kp(t,hj,o=>o.name,Mw);if(i){const o=Kp(t,Jt.getCompare());return new Ke(s,hn(e),new Vs({".priority":o},{".priority":Jt}))}return new Ke(s,hn(e),Vs.Default)}}Object.defineProperties(gt,{MIN:{value:new gt(Bs,Ke.EMPTY_NODE)},MAX:{value:new gt(is,zd)}}),j2.__EMPTY_NODE=Ke.EMPTY_NODE,sc.__childrenNodeConstructor=Ke,function fj(n){Sw=n}(zd),function mj(n){Q2=n}(zd),function pj(n){X2=n}(hn);class Tw extends Xp{constructor(e){super(),this.indexPath_=e,ue(!dt(e)&&".priority"!==ut(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const i=this.extractChild(e.node),r=this.extractChild(t.node),s=i.compareTo(r);return 0===s?va(e.name,t.name):s}makePost(e,t){const i=hn(e),r=Ke.EMPTY_NODE.updateChild(this.indexPath_,i);return new gt(t,r)}maxPost(){const e=Ke.EMPTY_NODE.updateChild(this.indexPath_,zd);return new gt(is,e)}toString(){return Vd(this.indexPath_,0).join("/")}}const Dw=new class bj extends Xp{compare(e,t){const i=e.node.compareTo(t.node);return 0===i?va(e.name,t.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return gt.MIN}maxPost(){return gt.MAX}makePost(e,t){const i=hn(e);return new gt(t,i)}toString(){return".value"}},ac="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",xj=function(){let n=0;const e=[];return function(t){const i=t===n;let r;n=t;const s=new Array(8);for(r=7;r>=0;r--)s[r]=ac.charAt(t%64),t=Math.floor(t/64);ue(0===t,"Cannot push at time == 0");let o=s.join("");if(i){for(r=11;r>=0&&63===e[r];r--)e[r]=0;e[r]++}else for(r=0;r<12;r++)e[r]=Math.floor(64*Math.random());for(r=0;r<12;r++)o+=ac.charAt(e[r]);return ue(20===o.length,"nextPushId: Length should be 20."),o}}();function tR(n){return{type:"value",snapshotNode:n}}function lc(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Gd(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function Wd(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}class Iw{constructor(e){this.index_=e}updateChild(e,t,i,r,s,o){ue(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(t);return a.getChild(r).equals(i.getChild(r))&&a.isEmpty()===i.isEmpty()||(null!=o&&(i.isEmpty()?e.hasChild(t)?o.trackChildChange(Gd(t,a)):ue(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(lc(t,i)):o.trackChildChange(Wd(t,i,a))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(t,i).withIndex(this.index_)}updateFullNode(e,t,i){return null!=i&&(e.isLeafNode()||e.forEachChild(Jt,(r,s)=>{t.hasChild(r)||i.trackChildChange(Gd(r,s))}),t.isLeafNode()||t.forEachChild(Jt,(r,s)=>{if(e.hasChild(r)){const o=e.getImmediateChild(r);o.equals(s)||i.trackChildChange(Wd(r,s,o))}else i.trackChildChange(lc(r,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?Ke.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class jd{constructor(e){this.indexedFilter_=new Iw(e.getIndex()),this.index_=e.getIndex(),this.startPost_=jd.getStartPost_(e),this.endPost_=jd.getEndPost_(e)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}updateChild(e,t,i,r,s,o){return this.matches(new gt(t,i))||(i=Ke.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,i,r,s,o)}updateFullNode(e,t,i){t.isLeafNode()&&(t=Ke.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(Ke.EMPTY_NODE);const s=this;return t.forEachChild(Jt,(o,a)=>{s.matches(new gt(o,a))||(r=r.updateImmediateChild(o,Ke.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class Mj{constructor(e){this.rangedFilter_=new jd(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}updateChild(e,t,i,r,s,o){return this.rangedFilter_.matches(new gt(t,i))||(i=Ke.EMPTY_NODE),e.getImmediateChild(t).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,i,r,s,o):this.fullLimitUpdateChild_(e,t,i,s,o)}updateFullNode(e,t,i){let r;if(t.isLeafNode()||t.isEmpty())r=Ke.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let s;r=Ke.EMPTY_NODE.withIndex(this.index_),s=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){const a=s.getNext();let l;if(l=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:this.index_.compare(a,this.rangedFilter_.getEndPost())<=0,!l)break;r=r.updateImmediateChild(a.name,a.node),o++}}else{let s,o,a,l;if(r=t.withIndex(this.index_),r=r.updatePriority(Ke.EMPTY_NODE),this.reverse_){l=r.getReverseIterator(this.index_),s=this.rangedFilter_.getEndPost(),o=this.rangedFilter_.getStartPost();const d=this.index_.getCompare();a=(h,f)=>d(f,h)}else l=r.getIterator(this.index_),s=this.rangedFilter_.getStartPost(),o=this.rangedFilter_.getEndPost(),a=this.index_.getCompare();let c=0,u=!1;for(;l.hasNext();){const d=l.getNext();!u&&a(s,d)<=0&&(u=!0),u&&c<this.limit_&&a(d,o)<=0?c++:r=r.updateImmediateChild(d.name,Ke.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,i,r,s){let o;if(this.reverse_){const d=this.index_.getCompare();o=(h,f)=>d(f,h)}else o=this.index_.getCompare();const a=e;ue(a.numChildren()===this.limit_,"");const l=new gt(t,i),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(l);if(a.hasChild(t)){const d=a.getImmediateChild(t);let h=r.getChildAfterChild(this.index_,c,this.reverse_);for(;null!=h&&(h.name===t||a.hasChild(h.name));)h=r.getChildAfterChild(this.index_,h,this.reverse_);const f=null==h?1:o(h,l);if(u&&!i.isEmpty()&&f>=0)return null!=s&&s.trackChildChange(Wd(t,i,d)),a.updateImmediateChild(t,i);{null!=s&&s.trackChildChange(Gd(t,d));const _=a.updateImmediateChild(t,Ke.EMPTY_NODE);return null!=h&&this.rangedFilter_.matches(h)?(null!=s&&s.trackChildChange(lc(h.name,h.node)),_.updateImmediateChild(h.name,h.node)):_}}return i.isEmpty()?e:u&&o(c,l)>=0?(null!=s&&(s.trackChildChange(Gd(c.name,c.node)),s.trackChildChange(lc(t,i))),a.updateImmediateChild(t,i).updateImmediateChild(c.name,Ke.EMPTY_NODE)):e}}class Rw{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Jt}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return ue(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return ue(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Bs}hasEnd(){return this.endSet_}getIndexEndValue(){return ue(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return ue(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:is}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return ue(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Jt}copy(){const e=new Rw;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function nR(n){const e={};if(n.isDefault())return e;let t;return n.index_===Jt?t="$priority":n.index_===Dw?t="$value":n.index_===rs?t="$key":(ue(n.index_ instanceof Tw,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=Wn(t),n.startSet_&&(e.startAt=Wn(n.indexStartValue_),n.startNameSet_&&(e.startAt+=","+Wn(n.indexStartName_))),n.endSet_&&(e.endAt=Wn(n.indexEndValue_),n.endNameSet_&&(e.endAt+=","+Wn(n.indexEndName_))),n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function iR(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_)),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_)),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;""===t&&(t=n.isViewFromLeft()?"l":"r"),e.vf=t}return n.index_!==Jt&&(e.i=n.index_.toString()),e}class em extends k2{constructor(e,t,i,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=i,this.appCheckTokenProvider_=r,this.log_=Nd("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(ue(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,i,r){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const o=em.getListenId_(e,i),a={};this.listens_[o]=a;const l=nR(e._queryParams);this.restRequest_(s+".json",l,(c,u)=>{let d=u;if(404===c&&(d=null,c=null),null===c&&this.onDataUpdate_(s,d,!1,i),Zl(this.listens_,o)===a){let h;h=c?401===c?"permission_denied":"rest_error:"+c:"ok",r(h,null)}})}unlisten(e,t){const i=em.getListenId_(e,t);delete this.listens_[i]}get(e){const t=nR(e._queryParams),i=e._path.toString(),r=new Bp;return this.restRequest_(i+".json",t,(s,o)=>{let a=o;404===s&&(a=null,s=null),null===s?(this.onDataUpdate_(i,a,!1,null),r.resolve(a)):r.reject(new Error(a))}),r.promise}refreshAuthToken(e){}restRequest_(e,t={},i){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,s])=>{r&&r.accessToken&&(t.auth=r.accessToken),s&&s.token&&(t.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+function l9(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}(t);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(i&&4===a.readyState){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=Td(a.responseText)}catch(c){_i("Failed to parse JSON response for "+o+": "+a.responseText)}i(null,l)}else 401!==a.status&&404!==a.status&&_i("Got unsuccessful REST response for "+o+" Status: "+a.status),i(a.status);i=null}},a.open("GET",o,!0),a.send()})}}class Ij{constructor(){this.rootNode_=Ke.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function tm(){return{value:null,children:new Map}}function cc(n,e,t){if(dt(e))n.value=t,n.children.clear();else if(null!==n.value)n.value=n.value.updateChild(e,t);else{const i=ut(e);n.children.has(i)||n.children.set(i,tm()),cc(n.children.get(i),e=Wt(e),t)}}function Ow(n,e,t){null!==n.value?t(e,n.value):function Rj(n,e){n.children.forEach((t,i)=>{e(i,t)})}(n,(i,r)=>{Ow(r,new It(e.toString()+"/"+i),t)})}class Pj{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&$n(this.last_,(i,r)=>{t[i]=t[i]-r}),this.last_=e,t}}class Oj{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Pj(e);const i=1e4+2e4*Math.random();Od(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const e=this.statsListener_.get(),t={};let i=!1;$n(e,(r,s)=>{s>0&&ks(this.statsToReport_,r)&&(t[r]=s,i=!0)}),i&&this.server_.reportStats(t),Od(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var dr=(()=>{return(n=dr||(dr={}))[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",dr;var n})();function Bw(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}class nm{constructor(e,t,i){this.path=e,this.affectedTree=t,this.revert=i,this.type=dr.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(dt(this.path)){if(null!=this.affectedTree.value)return ue(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new It(e));return new nm(Dt(),t,this.revert)}}return ue(ut(this.path)===e,"operationForChild called for unrelated child."),new nm(Wt(this.path),this.affectedTree,this.revert)}}class $d{constructor(e,t){this.source=e,this.path=t,this.type=dr.LISTEN_COMPLETE}operationForChild(e){return dt(this.path)?new $d(this.source,Dt()):new $d(this.source,Wt(this.path))}}class xa{constructor(e,t,i){this.source=e,this.path=t,this.snap=i,this.type=dr.OVERWRITE}operationForChild(e){return dt(this.path)?new xa(this.source,Dt(),this.snap.getImmediateChild(e)):new xa(this.source,Wt(this.path),this.snap)}}class uc{constructor(e,t,i){this.source=e,this.path=t,this.children=i,this.type=dr.MERGE}operationForChild(e){if(dt(this.path)){const t=this.children.subtree(new It(e));return t.isEmpty()?null:t.value?new xa(this.source,Dt(),t.value):new uc(this.source,Dt(),t)}return ue(ut(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new uc(this.source,Wt(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class yo{constructor(e,t,i){this.node_=e,this.fullyInitialized_=t,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(dt(e))return this.isFullyInitialized()&&!this.filtered_;const t=ut(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class Fj{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function qd(n,e,t,i,r,s){const o=i.filter(a=>a.type===t);o.sort((a,l)=>function Vj(n,e,t){if(null==e.childName||null==t.childName)throw Kl("Should only compare child_ events.");const i=new gt(e.childName,e.snapshotNode),r=new gt(t.childName,t.snapshotNode);return n.index_.compare(i,r)}(n,a,l)),o.forEach(a=>{const l=function Bj(n,e,t){return"value"===e.type||"child_removed"===e.type||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}(n,a,s);r.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(l,n.query_))})})}function im(n,e){return{eventCache:n,serverCache:e}}function Yd(n,e,t,i){return im(new yo(e,t,i),n.serverCache)}function sR(n,e,t,i){return im(n.eventCache,new yo(e,t,i))}function rm(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Ca(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}let Vw;class Kt{constructor(e,t=(()=>(Vw||(Vw=new Ai(x7)),Vw))()){this.value=e,this.children=t}static fromObject(e){let t=new Kt(null);return $n(e,(i,r)=>{t=t.set(new It(i),r)}),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:Dt(),value:this.value};if(dt(e))return null;{const i=ut(e),r=this.children.get(i);if(null!==r){const s=r.findRootMostMatchingPathAndValue(Wt(e),t);return null!=s?{path:ln(new It(i),s.path),value:s.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(dt(e))return this;{const t=ut(e),i=this.children.get(t);return null!==i?i.subtree(Wt(e)):new Kt(null)}}set(e,t){if(dt(e))return new Kt(t,this.children);{const i=ut(e),s=(this.children.get(i)||new Kt(null)).set(Wt(e),t),o=this.children.insert(i,s);return new Kt(this.value,o)}}remove(e){if(dt(e))return this.children.isEmpty()?new Kt(null):new Kt(null,this.children);{const t=ut(e),i=this.children.get(t);if(i){const r=i.remove(Wt(e));let s;return s=r.isEmpty()?this.children.remove(t):this.children.insert(t,r),null===this.value&&s.isEmpty()?new Kt(null):new Kt(this.value,s)}return this}}get(e){if(dt(e))return this.value;{const t=ut(e),i=this.children.get(t);return i?i.get(Wt(e)):null}}setTree(e,t){if(dt(e))return t;{const i=ut(e),s=(this.children.get(i)||new Kt(null)).setTree(Wt(e),t);let o;return o=s.isEmpty()?this.children.remove(i):this.children.insert(i,s),new Kt(this.value,o)}}fold(e){return this.fold_(Dt(),e)}fold_(e,t){const i={};return this.children.inorderTraversal((r,s)=>{i[r]=s.fold_(ln(e,r),t)}),t(e,this.value,i)}findOnPath(e,t){return this.findOnPath_(e,Dt(),t)}findOnPath_(e,t,i){const r=!!this.value&&i(t,this.value);if(r)return r;if(dt(e))return null;{const s=ut(e),o=this.children.get(s);return o?o.findOnPath_(Wt(e),ln(t,s),i):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Dt(),t)}foreachOnPath_(e,t,i){if(dt(e))return this;{this.value&&i(t,this.value);const r=ut(e),s=this.children.get(r);return s?s.foreachOnPath_(Wt(e),ln(t,r),i):new Kt(null)}}foreach(e){this.foreach_(Dt(),e)}foreach_(e,t){this.children.inorderTraversal((i,r)=>{r.foreach_(ln(e,i),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,i)=>{i.value&&e(t,i.value)})}}class Rr{constructor(e){this.writeTree_=e}static empty(){return new Rr(new Kt(null))}}function Xd(n,e,t){if(dt(e))return new Rr(new Kt(t));{const i=n.writeTree_.findRootMostValueAndPath(e);if(null!=i){const r=i.path;let s=i.value;const o=yi(r,e);return s=s.updateChild(o,t),new Rr(n.writeTree_.set(r,s))}{const r=new Kt(t),s=n.writeTree_.setTree(e,r);return new Rr(s)}}}function Uw(n,e,t){let i=n;return $n(t,(r,s)=>{i=Xd(i,ln(e,r),s)}),i}function oR(n,e){if(dt(e))return Rr.empty();{const t=n.writeTree_.setTree(e,new Kt(null));return new Rr(t)}}function Hw(n,e){return null!=Ma(n,e)}function Ma(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return null!=t?n.writeTree_.get(t.path).getChild(yi(t.path,e)):null}function aR(n){const e=[],t=n.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(Jt,(i,r)=>{e.push(new gt(i,r))}):n.writeTree_.children.inorderTraversal((i,r)=>{null!=r.value&&e.push(new gt(i,r.value))}),e}function vo(n,e){if(dt(e))return n;{const t=Ma(n,e);return new Rr(null!=t?new Kt(t):n.writeTree_.subtree(e))}}function zw(n){return n.writeTree_.isEmpty()}function dc(n,e){return lR(Dt(),n.writeTree_,e)}function lR(n,e,t){if(null!=e.value)return t.updateChild(n,e.value);{let i=null;return e.children.inorderTraversal((r,s)=>{".priority"===r?(ue(null!==s.value,"Priority writes must always be leaf nodes"),i=s.value):t=lR(ln(n,r),s,t)}),!t.getChild(n).isEmpty()&&null!==i&&(t=t.updateChild(ln(n,".priority"),i)),t}}function sm(n,e){return fR(e,n)}function jj(n,e){if(n.snap)return ur(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&ur(ln(n.path,t),e))return!0;return!1}function qj(n){return n.visible}function cR(n,e,t){let i=Rr.empty();for(let r=0;r<n.length;++r){const s=n[r];if(e(s)){const o=s.path;let a;if(s.snap)ur(t,o)?(a=yi(t,o),i=Xd(i,a,s.snap)):ur(o,t)&&(a=yi(o,t),i=Xd(i,Dt(),s.snap.getChild(a)));else{if(!s.children)throw Kl("WriteRecord should have .snap or .children");if(ur(t,o))a=yi(t,o),i=Uw(i,a,s.children);else if(ur(o,t))if(a=yi(o,t),dt(a))i=Uw(i,Dt(),s.children);else{const l=Zl(s.children,ut(a));if(l){const c=l.getChild(Wt(a));i=Xd(i,Dt(),c)}}}}}return i}function uR(n,e,t,i,r){if(i||r){const s=vo(n.visibleWrites,e);return!r&&zw(s)?t:r||null!=t||Hw(s,Dt())?dc(cR(n.allWrites,function(c){return(c.visible||r)&&(!i||!~i.indexOf(c.writeId))&&(ur(c.path,e)||ur(e,c.path))},e),t||Ke.EMPTY_NODE):null}{const s=Ma(n.visibleWrites,e);if(null!=s)return s;{const o=vo(n.visibleWrites,e);return zw(o)?t:null!=t||Hw(o,Dt())?dc(o,t||Ke.EMPTY_NODE):null}}}function om(n,e,t,i){return uR(n.writeTree,n.treePath,e,t,i)}function Gw(n,e){return function Yj(n,e,t){let i=Ke.EMPTY_NODE;const r=Ma(n.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(Jt,(s,o)=>{i=i.updateImmediateChild(s,o)}),i;if(t){const s=vo(n.visibleWrites,e);return t.forEachChild(Jt,(o,a)=>{const l=dc(vo(s,new It(o)),a);i=i.updateImmediateChild(o,l)}),aR(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}return aR(vo(n.visibleWrites,e)).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}(n.writeTree,n.treePath,e)}function dR(n,e,t,i){return function Xj(n,e,t,i,r){ue(i||r,"Either existingEventSnap or existingServerSnap must exist");const s=ln(e,t);if(Hw(n.visibleWrites,s))return null;{const o=vo(n.visibleWrites,s);return zw(o)?r.getChild(t):dc(o,r.getChild(t))}}(n.writeTree,n.treePath,e,t,i)}function am(n,e){return function Jj(n,e){return Ma(n.visibleWrites,e)}(n.writeTree,ln(n.treePath,e))}function Ww(n,e,t){return function Qj(n,e,t,i){const r=ln(e,t),s=Ma(n.visibleWrites,r);return null!=s?s:i.isCompleteForChild(t)?dc(vo(n.visibleWrites,r),i.getNode().getImmediateChild(t)):null}(n.writeTree,n.treePath,e,t)}function hR(n,e){return fR(ln(n.treePath,e),n.writeTree)}function fR(n,e){return{treePath:n,writeTree:e}}class t${constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,i=e.childName;ue("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),ue(".priority"!==i,"Only non-priority child changes can be tracked.");const r=this.changeMap.get(i);if(r){const s=r.type;if("child_added"===t&&"child_removed"===s)this.changeMap.set(i,Wd(i,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===s)this.changeMap.delete(i);else if("child_removed"===t&&"child_changed"===s)this.changeMap.set(i,Gd(i,r.oldSnap));else if("child_changed"===t&&"child_added"===s)this.changeMap.set(i,lc(i,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==s)throw Kl("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(i,Wd(i,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}}const pR=new class n${getCompleteChild(e){return null}getChildAfterChild(e,t,i){return null}};class jw{constructor(e,t,i=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=i}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const i=null!=this.optCompleteServerCache_?new yo(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Ww(this.writes_,e,i)}}getChildAfterChild(e,t,i){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Ca(this.viewCache_),s=function e$(n,e,t,i,r,s){return function Kj(n,e,t,i,r,s,o){let a;const l=vo(n.visibleWrites,e),c=Ma(l,Dt());if(null!=c)a=c;else{if(null==t)return[];a=dc(l,t)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const u=[],d=o.getCompare(),h=s?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o);let f=h.getNext();for(;f&&u.length<r;)0!==d(f,i)&&u.push(f),f=h.getNext();return u}}(n.writeTree,n.treePath,e,t,i,r,s)}(this.writes_,r,t,1,i,e);return 0===s.length?null:s[0]}}function mR(n,e,t,i,r,s){const o=e.eventCache;if(null!=am(i,t))return e;{let a,l;if(dt(t))if(ue(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const c=Ca(e),d=Gw(i,c instanceof Ke?c:Ke.EMPTY_NODE);a=n.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{const c=om(i,Ca(e));a=n.filter.updateFullNode(e.eventCache.getNode(),c,s)}else{const c=ut(t);if(".priority"===c){ue(1===_o(t),"Can't have a priority with additional path components");const u=o.getNode();l=e.serverCache.getNode();const d=dR(i,t,u,l);a=null!=d?n.filter.updatePriority(u,d):o.getNode()}else{const u=Wt(t);let d;if(o.isCompleteForChild(c)){l=e.serverCache.getNode();const h=dR(i,t,o.getNode(),l);d=null!=h?o.getNode().getImmediateChild(c).updateChild(u,h):o.getNode().getImmediateChild(c)}else d=Ww(i,c,e.serverCache);a=null!=d?n.filter.updateChild(o.getNode(),c,d,u,r,s):o.getNode()}}return Yd(e,a,o.isFullyInitialized()||dt(t),n.filter.filtersNodes())}}function lm(n,e,t,i,r,s,o,a){const l=e.serverCache;let c;const u=o?n.filter:n.filter.getIndexedFilter();if(dt(t))c=u.updateFullNode(l.getNode(),i,null);else if(u.filtersNodes()&&!l.isFiltered()){const f=l.getNode().updateChild(t,i);c=u.updateFullNode(l.getNode(),f,null)}else{const f=ut(t);if(!l.isCompleteForPath(t)&&_o(t)>1)return e;const p=Wt(t),y=l.getNode().getImmediateChild(f).updateChild(p,i);c=".priority"===f?u.updatePriority(l.getNode(),y):u.updateChild(l.getNode(),f,y,p,pR,null)}const d=sR(e,c,l.isFullyInitialized()||dt(t),u.filtersNodes());return mR(n,d,t,r,new jw(r,d,s),a)}function $w(n,e,t,i,r,s,o){const a=e.eventCache;let l,c;const u=new jw(r,e,s);if(dt(t))c=n.filter.updateFullNode(e.eventCache.getNode(),i,o),l=Yd(e,c,!0,n.filter.filtersNodes());else{const d=ut(t);if(".priority"===d)c=n.filter.updatePriority(e.eventCache.getNode(),i),l=Yd(e,c,a.isFullyInitialized(),a.isFiltered());else{const h=Wt(t),f=a.getNode().getImmediateChild(d);let p;if(dt(h))p=i;else{const _=u.getCompleteChild(d);p=null!=_?".priority"===bw(h)&&_.getChild(H2(h)).isEmpty()?_:_.updateChild(h,i):Ke.EMPTY_NODE}l=f.equals(p)?e:Yd(e,n.filter.updateChild(a.getNode(),d,p,h,u,o),a.isFullyInitialized(),n.filter.filtersNodes())}}return l}function gR(n,e){return n.eventCache.isCompleteForChild(e)}function _R(n,e,t){return t.foreach((i,r)=>{e=e.updateChild(i,r)}),e}function qw(n,e,t,i,r,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c,l=e;c=dt(t)?i:new Kt(null).setTree(t,i);const u=e.serverCache.getNode();return c.children.inorderTraversal((d,h)=>{if(u.hasChild(d)){const p=_R(0,e.serverCache.getNode().getImmediateChild(d),h);l=lm(n,l,new It(d),p,r,s,o,a)}}),c.children.inorderTraversal((d,h)=>{const f=!e.serverCache.isCompleteForChild(d)&&void 0===h.value;if(!u.hasChild(d)&&!f){const _=_R(0,e.serverCache.getNode().getImmediateChild(d),h);l=lm(n,l,new It(d),_,r,s,o,a)}}),l}class d${constructor(e,t){this.query_=e,this.eventRegistrations_=[];const i=this.query_._queryParams,r=new Iw(i.getIndex()),s=function Sj(n){return n.loadsAllData()?new Iw(n.getIndex()):n.hasLimit()?new Mj(n):new jd(n)}(i);this.processor_=function i$(n){return{filter:n}}(s);const o=t.serverCache,a=t.eventCache,l=r.updateFullNode(Ke.EMPTY_NODE,o.getNode(),null),c=s.updateFullNode(Ke.EMPTY_NODE,a.getNode(),null),u=new yo(l,o.isFullyInitialized(),r.filtersNodes()),d=new yo(c,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=im(d,u),this.eventGenerator_=new Fj(this.query_)}get query(){return this.query_}}function p$(n,e){const t=Ca(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!dt(e)&&!t.getImmediateChild(ut(e)).isEmpty())?t.getChild(e):null}function yR(n){return 0===n.eventRegistrations_.length}function vR(n,e,t){const i=[];if(t){ue(null==e,"A cancel should cancel all event registrations.");const r=n.query._path;n.eventRegistrations_.forEach(s=>{const o=s.createCancelEvent(t,r);o&&i.push(o)})}if(e){let r=[];for(let s=0;s<n.eventRegistrations_.length;++s){const o=n.eventRegistrations_[s];if(o.matches(e)){if(e.hasAnyCallback()){r=r.concat(n.eventRegistrations_.slice(s+1));break}}else r.push(o)}n.eventRegistrations_=r}else n.eventRegistrations_=[];return i}function wR(n,e,t,i){e.type===dr.MERGE&&null!==e.source.queryId&&(ue(Ca(n.viewCache_),"We should always have a full cache before handling merges"),ue(rm(n.viewCache_),"Missing event cache, even though we have a server cache"));const r=n.viewCache_,s=function s$(n,e,t,i,r){const s=new t$;let o,a;if(t.type===dr.OVERWRITE){const c=t;c.source.fromUser?o=$w(n,e,c.path,c.snap,i,r,s):(ue(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!dt(c.path),o=lm(n,e,c.path,c.snap,i,r,a,s))}else if(t.type===dr.MERGE){const c=t;c.source.fromUser?o=function a$(n,e,t,i,r,s,o){let a=e;return i.foreach((l,c)=>{const u=ln(t,l);gR(e,ut(u))&&(a=$w(n,a,u,c,r,s,o))}),i.foreach((l,c)=>{const u=ln(t,l);gR(e,ut(u))||(a=$w(n,a,u,c,r,s,o))}),a}(n,e,c.path,c.children,i,r,s):(ue(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=qw(n,e,c.path,c.children,i,r,a,s))}else if(t.type===dr.ACK_USER_WRITE){const c=t;o=c.revert?function u$(n,e,t,i,r,s){let o;if(null!=am(i,t))return e;{const a=new jw(i,e,r),l=e.eventCache.getNode();let c;if(dt(t)||".priority"===ut(t)){let u;if(e.serverCache.isFullyInitialized())u=om(i,Ca(e));else{const d=e.serverCache.getNode();ue(d instanceof Ke,"serverChildren would be complete if leaf node"),u=Gw(i,d)}u=u,c=n.filter.updateFullNode(l,u,s)}else{const u=ut(t);let d=Ww(i,u,e.serverCache);null==d&&e.serverCache.isCompleteForChild(u)&&(d=l.getImmediateChild(u)),c=null!=d?n.filter.updateChild(l,u,d,Wt(t),a,s):e.eventCache.getNode().hasChild(u)?n.filter.updateChild(l,u,Ke.EMPTY_NODE,Wt(t),a,s):l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=om(i,Ca(e)),o.isLeafNode()&&(c=n.filter.updateFullNode(c,o,s)))}return o=e.serverCache.isFullyInitialized()||null!=am(i,Dt()),Yd(e,c,o,n.filter.filtersNodes())}}(n,e,c.path,i,r,s):function l$(n,e,t,i,r,s,o){if(null!=am(r,t))return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(null!=i.value){if(dt(t)&&l.isFullyInitialized()||l.isCompleteForPath(t))return lm(n,e,t,l.getNode().getChild(t),r,s,a,o);if(dt(t)){let c=new Kt(null);return l.getNode().forEachChild(rs,(u,d)=>{c=c.set(new It(u),d)}),qw(n,e,t,c,r,s,a,o)}return e}{let c=new Kt(null);return i.foreach((u,d)=>{const h=ln(t,u);l.isCompleteForPath(h)&&(c=c.set(u,l.getNode().getChild(h)))}),qw(n,e,t,c,r,s,a,o)}}(n,e,c.path,c.affectedTree,i,r,s)}else{if(t.type!==dr.LISTEN_COMPLETE)throw Kl("Unknown operation type: "+t.type);o=function c$(n,e,t,i,r){const s=e.serverCache;return mR(n,sR(e,s.getNode(),s.isFullyInitialized()||dt(t),s.isFiltered()),t,i,pR,r)}(n,e,t.path,i,s)}const l=s.getChanges();return function o$(n,e,t){const i=e.eventCache;if(i.isFullyInitialized()){const r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=rm(n);(t.length>0||!n.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&t.push(tR(rm(e)))}}(e,o,l),{viewCache:o,changes:l}}(n.processor_,r,e,t,i);return function r$(n,e){ue(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),ue(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}(n.processor_,s.viewCache),ue(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,bR(n,s.changes,s.viewCache.eventCache.getNode(),null)}function bR(n,e,t,i){return function kj(n,e,t,i){const r=[],s=[];return e.forEach(o=>{"child_changed"===o.type&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(function Cj(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}(o.childName,o.snapshotNode))}),qd(n,r,"child_removed",e,i,t),qd(n,r,"child_added",e,i,t),qd(n,r,"child_moved",s,i,t),qd(n,r,"child_changed",e,i,t),qd(n,r,"value",e,i,t),r}(n.eventGenerator_,e,t,i?[i]:n.eventRegistrations_)}let cm,dm;class xR{constructor(){this.views=new Map}}function Yw(n,e,t,i){const r=e.source.queryId;if(null!==r){const s=n.views.get(r);return ue(null!=s,"SyncTree gave us an op for an invalid query."),wR(s,e,t,i)}{let s=[];for(const o of n.views.values())s=s.concat(wR(o,e,t,i));return s}}function w$(n,e,t,i,r,s){const o=function CR(n,e,t,i,r){const o=n.views.get(e._queryIdentifier);if(!o){let a=om(t,r?i:null),l=!1;a?l=!0:i instanceof Ke?(a=Gw(t,i),l=!1):(a=Ke.EMPTY_NODE,l=!1);const c=im(new yo(a,l,!1),new yo(i,r,!1));return new d$(e,c)}return o}(n,e,i,r,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),function m$(n,e){n.eventRegistrations_.push(e)}(o,t),function g$(n,e){const t=n.viewCache_.eventCache,i=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(Jt,(s,o)=>{i.push(lc(s,o))}),t.isFullyInitialized()&&i.push(tR(t.getNode())),bR(n,i,t.getNode(),e)}(o,t)}function MR(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function wo(n,e){let t=null;for(const i of n.views.values())t=t||p$(i,e);return t}function SR(n,e){return e._queryParams.loadsAllData()?um(n):n.views.get(e._queryIdentifier)}function ER(n,e){return null!=SR(n,e)}function bo(n){return null!=um(n)}function um(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let M$=1;class TR{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Kt(null),this.pendingWriteTree_=function Zj(){return{visibleWrites:Rr.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Xw(n,e,t,i,r){return function Hj(n,e,t,i,r){ue(i>n.lastWriteId,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),n.allWrites.push({path:e,snap:t,writeId:i,visible:r}),r&&(n.visibleWrites=Xd(n.visibleWrites,e,t)),n.lastWriteId=i}(n.pendingWriteTree_,e,t,i,r),r?hc(n,new xa({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,t)):[]}function xo(n,e,t=!1){const i=function Gj(n,e){for(let t=0;t<n.allWrites.length;t++){const i=n.allWrites[t];if(i.writeId===e)return i}return null}(n.pendingWriteTree_,e);if(function Wj(n,e){const t=n.allWrites.findIndex(a=>a.writeId===e);ue(t>=0,"removeWrite called with nonexistent writeId.");const i=n.allWrites[t];n.allWrites.splice(t,1);let r=i.visible,s=!1,o=n.allWrites.length-1;for(;r&&o>=0;){const a=n.allWrites[o];a.visible&&(o>=t&&jj(a,i.path)?r=!1:ur(i.path,a.path)&&(s=!0)),o--}return!!r&&(s?(function $j(n){n.visibleWrites=cR(n.allWrites,qj,Dt()),n.lastWriteId=n.allWrites.length>0?n.allWrites[n.allWrites.length-1].writeId:-1}(n),!0):(i.snap?n.visibleWrites=oR(n.visibleWrites,i.path):$n(i.children,l=>{n.visibleWrites=oR(n.visibleWrites,ln(i.path,l))}),!0))}(n.pendingWriteTree_,e)){let s=new Kt(null);return null!=i.snap?s=s.set(Dt(),!0):$n(i.children,o=>{s=s.set(new It(o),!0)}),hc(n,new nm(i.path,s,t))}return[]}function Qd(n,e,t){return hc(n,new xa({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,t))}function Qw(n,e,t,i){const r=e._path,s=n.syncPointTree_.get(r);let o=[];if(s&&("default"===e._queryIdentifier||ER(s,e))){const a=function b$(n,e,t,i){const r=e._queryIdentifier,s=[];let o=[];const a=bo(n);if("default"===r)for(const[l,c]of n.views.entries())o=o.concat(vR(c,t,i)),yR(c)&&(n.views.delete(l),c.query._queryParams.loadsAllData()||s.push(c.query));else{const l=n.views.get(r);l&&(o=o.concat(vR(l,t,i)),yR(l)&&(n.views.delete(r),l.query._queryParams.loadsAllData()||s.push(l.query)))}return a&&!bo(n)&&s.push(new(function y$(){return ue(cm,"Reference.ts has not been loaded"),cm}())(e._repo,e._path)),{removed:s,events:o}}(s,e,t,i);(function v$(n){return 0===n.views.size})(s)&&(n.syncPointTree_=n.syncPointTree_.remove(r));const l=a.removed;o=a.events;const c=-1!==l.findIndex(d=>d._queryParams.loadsAllData()),u=n.syncPointTree_.findOnPath(r,(d,h)=>bo(h));if(c&&!u){const d=n.syncPointTree_.subtree(r);if(!d.isEmpty()){const h=function P$(n){return n.fold((e,t,i)=>{if(t&&bo(t))return[um(t)];{let r=[];return t&&(r=MR(t)),$n(i,(s,o)=>{r=r.concat(o)}),r}})}(d);for(let f=0;f<h.length;++f){const p=h[f],_=p.query,y=RR(n,p);n.listenProvider_.startListening(Jd(_),fm(n,_),y.hashFn,y.onComplete)}}}!u&&l.length>0&&!i&&(c?n.listenProvider_.stopListening(Jd(e),null):l.forEach(d=>{const h=n.queryToTagMap.get(pm(d));n.listenProvider_.stopListening(Jd(d),h)})),function N$(n,e){for(let t=0;t<e.length;++t){const i=e[t];if(!i._queryParams.loadsAllData()){const r=pm(i),s=n.queryToTagMap.get(r);n.queryToTagMap.delete(r),n.tagToQueryMap.delete(s)}}}(n,l)}return o}function DR(n,e,t){const i=e._path;let r=null,s=!1;n.syncPointTree_.foreachOnPath(i,(d,h)=>{const f=yi(d,i);r=r||wo(h,f),s=s||bo(h)});let a,o=n.syncPointTree_.get(i);o?(s=s||bo(o),r=r||wo(o,Dt())):(o=new xR,n.syncPointTree_=n.syncPointTree_.set(i,o)),null!=r?a=!0:(a=!1,r=Ke.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((h,f)=>{const p=wo(f,Dt());p&&(r=r.updateImmediateChild(h,p))}));const l=ER(o,e);if(!l&&!e._queryParams.loadsAllData()){const d=pm(e);ue(!n.queryToTagMap.has(d),"View does not exist, but we have a tag");const h=function L$(){return M$++}();n.queryToTagMap.set(d,h),n.tagToQueryMap.set(h,d)}let u=w$(o,e,t,sm(n.pendingWriteTree_,i),r,a);if(!l&&!s){const d=SR(o,e);u=u.concat(function O$(n,e,t){const i=e._path,r=fm(n,e),s=RR(n,t),o=n.listenProvider_.startListening(Jd(e),r,s.hashFn,s.onComplete),a=n.syncPointTree_.subtree(i);if(r)ue(!bo(a.value),"If we're adding a query, it shouldn't be shadowed");else{const l=a.fold((c,u,d)=>{if(!dt(c)&&u&&bo(u))return[um(u).query];{let h=[];return u&&(h=h.concat(MR(u).map(f=>f.query))),$n(d,(f,p)=>{h=h.concat(p)}),h}});for(let c=0;c<l.length;++c){const u=l[c];n.listenProvider_.stopListening(Jd(u),fm(n,u))}}return o}(n,e,d))}return u}function hm(n,e,t){const r=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,a)=>{const c=wo(a,yi(o,e));if(c)return c});return uR(r,e,s,t,!0)}function hc(n,e){return AR(e,n.syncPointTree_,null,sm(n.pendingWriteTree_,Dt()))}function AR(n,e,t,i){if(dt(n.path))return IR(n,e,t,i);{const r=e.get(Dt());null==t&&null!=r&&(t=wo(r,Dt()));let s=[];const o=ut(n.path),a=n.operationForChild(o),l=e.children.get(o);if(l&&a){const c=t?t.getImmediateChild(o):null,u=hR(i,o);s=s.concat(AR(a,l,c,u))}return r&&(s=s.concat(Yw(r,n,i,t))),s}}function IR(n,e,t,i){const r=e.get(Dt());null==t&&null!=r&&(t=wo(r,Dt()));let s=[];return e.children.inorderTraversal((o,a)=>{const l=t?t.getImmediateChild(o):null,c=hR(i,o),u=n.operationForChild(o);u&&(s=s.concat(IR(u,a,l,c)))}),r&&(s=s.concat(Yw(r,n,i,t))),s}function RR(n,e){const t=e.query,i=fm(n,t);return{hashFn:()=>(function h$(n){return n.viewCache_.serverCache.getNode()}(e)||Ke.EMPTY_NODE).hash(),onComplete:r=>{if("ok"===r)return i?function D$(n,e,t){const i=Jw(n,t);if(i){const r=Kw(i),s=r.path,o=r.queryId,a=yi(s,e);return Zw(n,s,new $d(Bw(o),a))}return[]}(n,t._path,i):function T$(n,e){return hc(n,new $d({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(n,t._path);{const s=function S7(n,e){let t="Unknown Error";"too_big"===n?t="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===n?t="Client doesn't have permission to access the desired data.":"unavailable"===n&&(t="The service is unavailable");const i=new Error(n+" at "+e._path.toString()+": "+t);return i.code=n.toUpperCase(),i}(r,t);return Qw(n,t,null,s)}}}}function fm(n,e){const t=pm(e);return n.queryToTagMap.get(t)}function pm(n){return n._path.toString()+"$"+n._queryIdentifier}function Jw(n,e){return n.tagToQueryMap.get(e)}function Kw(n){const e=n.indexOf("$");return ue(-1!==e&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new It(n.substr(0,e))}}function Zw(n,e,t){const i=n.syncPointTree_.get(e);return ue(i,"Missing sync point for query tag that we're tracking"),Yw(i,t,sm(n.pendingWriteTree_,e),null)}function Jd(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(function C$(){return ue(dm,"Reference.ts has not been loaded"),dm}())(n._repo,n._path):n}class eb{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new eb(t)}node(){return this.node_}}class tb{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=ln(this.path_,e);return new tb(this.syncTree_,t)}node(){return hm(this.syncTree_,this.path_)}}const PR=function(n,e,t){return n&&"object"==typeof n?(ue(".sv"in n,"Unexpected leaf node or priority contents"),"string"==typeof n[".sv"]?k$(n[".sv"],e,t):"object"==typeof n[".sv"]?B$(n[".sv"],e):void ue(!1,"Unexpected server value: "+JSON.stringify(n,null,2))):n},k$=function(n,e,t){if("timestamp"===n)return t.timestamp;ue(!1,"Unexpected server value: "+n)},B$=function(n,e,t){n.hasOwnProperty("increment")||ue(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const i=n.increment;"number"!=typeof i&&ue(!1,"Unexpected increment value: "+i);const r=e.node();if(ue(null!=r,"Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;const o=r.getValue();return"number"!=typeof o?i:o+i},nb=function(n,e,t){return ib(n,new eb(e),t)};function ib(n,e,t){const i=n.getPriority().val(),r=PR(i,e.getImmediateChild(".priority"),t);let s;if(n.isLeafNode()){const o=n,a=PR(o.getValue(),e,t);return a!==o.getValue()||r!==o.getPriority().val()?new sc(a,hn(r)):n}{const o=n;return s=o,r!==o.getPriority().val()&&(s=s.updatePriority(new sc(r))),o.forEachChild(Jt,(a,l)=>{const c=ib(l,e.getImmediateChild(a),t);c!==l&&(s=s.updateImmediateChild(a,c))}),s}}class rb{constructor(e="",t=null,i={children:{},childCount:0}){this.name=e,this.parent=t,this.node=i}}function mm(n,e){let t=e instanceof It?e:new It(e),i=n,r=ut(t);for(;null!==r;){const s=Zl(i.node.children,r)||{children:{},childCount:0};i=new rb(r,i,s),t=Wt(t),r=ut(t)}return i}function Sa(n){return n.node.value}function sb(n,e){n.node.value=e,ob(n)}function LR(n){return n.node.childCount>0}function gm(n,e){$n(n.node.children,(t,i)=>{e(new rb(t,n,i))})}function OR(n,e,t,i){t&&!i&&e(n),gm(n,r=>{OR(r,e,!0,i)}),t&&i&&e(n)}function Kd(n){return new It(null===n.parent?n.name:Kd(n.parent)+"/"+n.name)}function ob(n){null!==n.parent&&function H$(n,e,t){const i=function V$(n){return void 0===Sa(n)&&!LR(n)}(t),r=ks(n.node.children,e);i&&r?(delete n.node.children[e],n.node.childCount--,ob(n)):!i&&!r&&(n.node.children[e]=t.node,n.node.childCount++,ob(n))}(n.parent,n.name,n)}const z$=/[\[\].#$\/\u0000-\u001F\u007F]/,G$=/[\[\].#$\u0000-\u001F\u007F]/,ab=10485760,_m=function(n){return"string"==typeof n&&0!==n.length&&!z$.test(n)},FR=function(n){return"string"==typeof n&&0!==n.length&&!G$.test(n)},ss=function(n,e,t,i){i&&void 0===e||eh(ec(n,"value"),e,t)},eh=function(n,e,t){const i=t instanceof It?new ij(t,n):t;if(void 0===e)throw new Error(n+"contains undefined "+wa(i));if("function"==typeof e)throw new Error(n+"contains a function "+wa(i)+" with contents = "+e.toString());if(jp(e))throw new Error(n+"contains "+e.toString()+" "+wa(i));if("string"==typeof e&&e.length>ab/3&&zp(e)>ab)throw new Error(n+"contains a string greater than "+ab+" utf8 bytes "+wa(i)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let r=!1,s=!1;if($n(e,(o,a)=>{if(".value"===o)r=!0;else if(".priority"!==o&&".sv"!==o&&(s=!0,!_m(o)))throw new Error(n+" contains an invalid key ("+o+") "+wa(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function rj(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=zp(e),z2(n)})(i,o),eh(n,a,i),function sj(n){const e=n.parts_.pop();n.byteLength_-=zp(e),n.parts_.length>0&&(n.byteLength_-=1)}(i)}),r&&s)throw new Error(n+' contains ".value" child '+wa(i)+" in addition to actual children.")}},cb=function(n,e,t,i){if(!(i&&void 0===t||FR(t)))throw new Error(ec(n,e)+'was an invalid path = "'+t+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},os=function(n,e){if(".info"===ut(e))throw new Error(n+" failed = Can't modify data under /.info/")};class q${constructor(){this.eventLists_=[],this.recursionDepth_=0}}function ym(n,e){let t=null;for(let i=0;i<e.length;i++){const r=e[i],s=r.getPath();null!==t&&!xw(s,t.path)&&(n.eventLists_.push(t),t=null),null===t&&(t={events:[],path:s}),t.events.push(r)}t&&n.eventLists_.push(t)}function ub(n,e,t){ym(n,t),VR(n,i=>xw(i,e))}function hr(n,e,t){ym(n,t),VR(n,i=>ur(i,e)||ur(e,i))}function VR(n,e){n.recursionDepth_++;let t=!0;for(let i=0;i<n.eventLists_.length;i++){const r=n.eventLists_[i];r&&(e(r.path)?(Y$(n.eventLists_[i]),n.eventLists_[i]=null):t=!1)}t&&(n.eventLists_=[]),n.recursionDepth_--}function Y$(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(null!==t){n.events[e]=null;const i=t.getEventRunner();ya&&jn("event: "+t.toString()),ic(i)}}}class Q${constructor(e,t,i,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=i,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new q$,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=tm(),this.transactionQueueTree_=new rb,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function HR(n){const t=n.infoData_.getNode(new It(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function nh(n){return function(n){return(n=n||{}).timestamp=n.timestamp||(new Date).getTime(),n}({timestamp:HR(n)})}function zR(n,e,t,i,r){n.dataUpdateCount++;const s=new It(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(r)if(i){const l=Hp(t,c=>hn(c));o=function I$(n,e,t,i){const r=Jw(n,i);if(r){const s=Kw(r),o=s.path,a=s.queryId,l=yi(o,e),c=Kt.fromObject(t);return Zw(n,o,new uc(Bw(a),l,c))}return[]}(n.serverSyncTree_,s,l,r)}else{const l=hn(t);o=function A$(n,e,t,i){const r=Jw(n,i);if(null!=r){const s=Kw(r),o=s.path,a=s.queryId,l=yi(o,e);return Zw(n,o,new xa(Bw(a),l,t))}return[]}(n.serverSyncTree_,s,l,r)}else if(i){const l=Hp(t,c=>hn(c));o=function E$(n,e,t){const i=Kt.fromObject(t);return hc(n,new uc({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,i))}(n.serverSyncTree_,s,l)}else{const l=hn(t);o=Qd(n.serverSyncTree_,s,l)}let a=s;o.length>0&&(a=pc(n,s)),hr(n.eventQueue_,a,o)}function GR(n,e){db(n,"connected",e),!1===e&&function tq(n){fc(n,"onDisconnectEvents");const e=nh(n),t=tm();Ow(n.onDisconnect_,Dt(),(r,s)=>{const o=function(n,e,t,i){return ib(e,new tb(t,n),i)}(r,s,n.serverSyncTree_,e);cc(t,r,o)});let i=[];Ow(t,Dt(),(r,s)=>{i=i.concat(Qd(n.serverSyncTree_,r,s));const o=mb(n,r);pc(n,o)}),n.onDisconnect_=tm(),hr(n.eventQueue_,Dt(),i)}(n)}function db(n,e,t){const i=new It("/.info/"+e),r=hn(t);n.infoData_.updateSnapshot(i,r);const s=Qd(n.infoSyncTree_,i,r);hr(n.eventQueue_,i,s)}function vm(n){return n.nextWriteId_++}function hb(n,e,t,i,r){fc(n,"set",{path:e.toString(),value:t,priority:i});const s=nh(n),o=hn(t,i),a=hm(n.serverSyncTree_,e),l=nb(o,a,s),c=vm(n),u=Xw(n.serverSyncTree_,e,l,c,!0);ym(n.eventQueue_,u),n.server_.put(e.toString(),o.val(!0),(h,f)=>{const p="ok"===h;p||_i("set at "+e+" failed: "+h);const _=xo(n.serverSyncTree_,c,!p);hr(n.eventQueue_,e,_),function Co(n,e,t,i){e&&ic(()=>{if("ok"===t)e(null);else{const r=(t||"error").toUpperCase();let s=r;i&&(s+=": "+i);const o=new Error(s);o.code=r,e(o)}})}(0,r,h,f)});const d=mb(n,e);pc(n,d),hr(n.eventQueue_,d,[])}function fb(n,e,t){let i;i=".info"===ut(e._path)?Qw(n.infoSyncTree_,e,t):Qw(n.serverSyncTree_,e,t),ub(n.eventQueue_,e._path,i)}function fc(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),jn(t,...e)}function pb(n,e,t){return hm(n.serverSyncTree_,e,t)||Ke.EMPTY_NODE}function wm(n,e=n.transactionQueueTree_){if(e||bm(n,e),Sa(e)){const t=qR(n,e);ue(t.length>0,"Sending zero length transaction queue"),t.every(r=>0===r.status)&&function lq(n,e,t){const i=t.map(c=>c.currentWriteId),r=pb(n,e,i);let s=r;const o=r.hash();for(let c=0;c<t.length;c++){const u=t[c];ue(0===u.status,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const d=yi(e,u.path);s=s.updateChild(d,u.currentOutputSnapshotRaw)}const a=s.val(!0),l=e;n.server_.put(l.toString(),a,c=>{fc(n,"transaction put response",{path:l.toString(),status:c});let u=[];if("ok"===c){const d=[];for(let h=0;h<t.length;h++)t[h].status=2,u=u.concat(xo(n.serverSyncTree_,t[h].currentWriteId)),t[h].onComplete&&d.push(()=>t[h].onComplete(null,!0,t[h].currentOutputSnapshotResolved)),t[h].unwatcher();bm(n,mm(n.transactionQueueTree_,e)),wm(n,n.transactionQueueTree_),hr(n.eventQueue_,e,u);for(let h=0;h<d.length;h++)ic(d[h])}else{if("datastale"===c)for(let d=0;d<t.length;d++)t[d].status=3===t[d].status?4:0;else{_i("transaction at "+l.toString()+" failed: "+c);for(let d=0;d<t.length;d++)t[d].status=4,t[d].abortReason=c}pc(n,e)}},o)}(n,Kd(e),t)}else LR(e)&&gm(e,t=>{wm(n,t)})}function pc(n,e){const t=$R(n,e),i=Kd(t);return function cq(n,e,t){if(0===e.length)return;const i=[];let r=[];const o=e.filter(a=>0===a.status).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],c=yi(t,l.path);let d,u=!1;if(ue(null!==c,"rerunTransactionsUnderNode_: relativePath should not be null."),4===l.status)u=!0,d=l.abortReason,r=r.concat(xo(n.serverSyncTree_,l.currentWriteId,!0));else if(0===l.status)if(l.retryCount>=25)u=!0,d="maxretry",r=r.concat(xo(n.serverSyncTree_,l.currentWriteId,!0));else{const h=pb(n,l.path,o);l.currentInputSnapshot=h;const f=e[a].update(h.val());if(void 0!==f){eh("transaction failed: Data returned ",f,l.path);let p=hn(f);"object"==typeof f&&null!=f&&ks(f,".priority")||(p=p.updatePriority(h.getPriority()));const y=l.currentWriteId,g=nh(n),m=nb(p,h,g);l.currentOutputSnapshotRaw=p,l.currentOutputSnapshotResolved=m,l.currentWriteId=vm(n),o.splice(o.indexOf(y),1),r=r.concat(Xw(n.serverSyncTree_,l.path,m,l.currentWriteId,l.applyLocally)),r=r.concat(xo(n.serverSyncTree_,y,!0))}else u=!0,d="nodata",r=r.concat(xo(n.serverSyncTree_,l.currentWriteId,!0))}hr(n.eventQueue_,t,r),r=[],u&&(e[a].status=2,setTimeout(e[a].unwatcher,Math.floor(0)),e[a].onComplete&&i.push("nodata"===d?()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot):()=>e[a].onComplete(new Error(d),!1,null)))}bm(n,n.transactionQueueTree_);for(let a=0;a<i.length;a++)ic(i[a]);wm(n,n.transactionQueueTree_)}(n,qR(n,t),i),i}function $R(n,e){let t,i=n.transactionQueueTree_;for(t=ut(e);null!==t&&void 0===Sa(i);)i=mm(i,t),t=ut(e=Wt(e));return i}function qR(n,e){const t=[];return YR(n,e,t),t.sort((i,r)=>i.order-r.order),t}function YR(n,e,t){const i=Sa(e);if(i)for(let r=0;r<i.length;r++)t.push(i[r]);gm(e,r=>{YR(n,r,t)})}function bm(n,e){const t=Sa(e);if(t){let i=0;for(let r=0;r<t.length;r++)2!==t[r].status&&(t[i]=t[r],i++);t.length=i,sb(e,t.length>0?t:void 0)}gm(e,i=>{bm(n,i)})}function mb(n,e){const t=Kd($R(n,e)),i=mm(n.transactionQueueTree_,e);return function U$(n,e,t){let i=t?n:n.parent;for(;null!==i;){if(e(i))return!0;i=i.parent}}(i,r=>{gb(n,r)}),gb(n,i),OR(i,r=>{gb(n,r)}),t}function gb(n,e){const t=Sa(e);if(t){const i=[];let r=[],s=-1;for(let o=0;o<t.length;o++)3===t[o].status||(1===t[o].status?(ue(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(ue(0===t[o].status,"Unexpected transaction status in abort"),t[o].unwatcher(),r=r.concat(xo(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&i.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));-1===s?sb(e,void 0):t.length=s+1,hr(n.eventQueue_,Kd(e),r);for(let o=0;o<i.length;o++)ic(i[o])}}const _b=function(n,e){const t=hq(n),i=t.namespace;return"firebase.com"===t.domain&&ns(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||"undefined"===i)&&"localhost"!==t.domain&&ns("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&_i("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new pw(t.host,t.secure,i,e,"ws"===t.scheme||"wss"===t.scheme,"",i!==t.subdomain),path:new It(t.pathString)}},hq=function(n){let e="",t="",i="",r="",s="",o=!0,a="https",l=443;if("string"==typeof n){let c=n.indexOf("//");c>=0&&(a=n.substring(0,c-1),n=n.substring(c+2));let u=n.indexOf("/");-1===u&&(u=n.length);let d=n.indexOf("?");-1===d&&(d=n.length),e=n.substring(0,Math.min(u,d)),u<d&&(r=function uq(n){let e="";const t=n.split("/");for(let i=0;i<t.length;i++)if(t[i].length>0){let r=t[i];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch(s){}e+="/"+r}return e}(n.substring(u,d)));const h=function dq(n){const e={};"?"===n.charAt(0)&&(n=n.substring(1));for(const t of n.split("&")){if(0===t.length)continue;const i=t.split("=");2===i.length?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):_i(`Invalid query segment '${t}' in query '${n}'`)}return e}(n.substring(Math.min(n.length,d)));c=e.indexOf(":"),c>=0?(o="https"===a||"wss"===a,l=parseInt(e.substring(c+1),10)):c=e.length;const f=e.slice(0,c);if("localhost"===f.toLowerCase())t="localhost";else if(f.split(".").length<=2)t=f;else{const p=e.indexOf(".");i=e.substring(0,p).toLowerCase(),t=e.substring(p+1),s=i}"ns"in h&&(s=h.ns)}return{host:e,port:l,domain:t,subdomain:i,secure:o,scheme:a,pathString:r,namespace:s}};class XR{constructor(e,t,i,r){this.eventType=e,this.eventRegistration=t,this.snapshot=i,this.prevName=r}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Wn(this.snapshot.exportVal())}}class QR{constructor(e,t,i){this.eventRegistration=e,this.error=t,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class JR{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return ue(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class Xi{constructor(e,t,i,r){this._repo=e,this._path=t,this._queryParams=i,this._orderByCalled=r}get key(){return dt(this._path)?null:bw(this._path)}get ref(){return new Pr(this._repo,this._path)}get _queryIdentifier(){const e=iR(this._queryParams),t=dw(e);return"{}"===t?"default":t}get _queryObject(){return iR(this._queryParams)}isEqual(e){if(!((e=Dd(e))instanceof Xi))return!1;const t=this._repo===e._repo,i=xw(this._path,e._path);return t&&i&&this._queryIdentifier===e._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function tj(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)""!==n.pieces_[t]&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}(this._path)}}class Pr extends Xi{constructor(e,t){super(e,t,new Rw,!1)}get parent(){const e=H2(this._path);return null===e?null:new Pr(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class Ea{constructor(e,t,i){this._node=e,this.ref=t,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new It(e),i=mc(this.ref,e);return new Ea(this._node.getChild(t),i,Jt)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(i,r)=>e(new Ea(r,mc(this.ref,i),Jt)))}hasChild(e){const t=new It(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Ta(n,e){return(n=Dd(n))._checkNotDeleted("ref"),void 0!==e?mc(n._root,e):n._root}function mc(n,e){return null===ut((n=Dd(n))._path)?(t=e,t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),cb("child","path",t,!1)):cb("child","path",e,!1),new Pr(n._repo,ln(n._path,e));var t}function yb(n,e){n=Dd(n),os("push",n._path),ss("push",e,n._path,!0);const t=HR(n._repo),i=xj(t),r=mc(n,i),s=mc(n,i);let o;return o=null!=e?ih(s,e).then(()=>s):Promise.resolve(s),r.then=o.then.bind(o),r.catch=o.then.bind(o,void 0),r}function ih(n,e){n=Dd(n),os("set",n._path),ss("set",e,n._path,!1);const t=new Bp;return hb(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}class Mm{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const i=t._queryParams.getIndex();return new XR("value",this,new Ea(e.snapshotNode,new Pr(t._repo,t._path),i))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new QR(this,e,t):null}matches(e){return e instanceof Mm&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class Sm{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new QR(this,e,t):null}createEvent(e,t){ue(null!=e.childName,"Child events should have a childName.");const i=mc(new Pr(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new XR(e.type,this,new Ea(e.snapshotNode,i,r),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof Sm&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function vb(n,e,t,i){return function rh(n,e,t,i,r){let s;if("object"==typeof i&&(s=void 0,r=i),"function"==typeof i&&(s=i),r&&r.onlyOnce){const l=t,c=(u,d)=>{fb(n._repo,n,a),l(u,d)};c.userCallback=t.userCallback,c.context=t.context,t=c}const o=new JR(t,s||void 0),a="value"===e?new Mm(o):new Sm(e,o);return function sq(n,e,t){let i;i=".info"===ut(e._path)?DR(n.infoSyncTree_,e,t):DR(n.serverSyncTree_,e,t),ub(n.eventQueue_,e._path,i)}(n._repo,n,a),()=>fb(n._repo,n,a)}(n,"value",e,t,i)}(function _$(n){ue(!cm,"__referenceConstructor has already been defined"),cm=n})(Pr),function x$(n){ue(!dm,"__referenceConstructor has already been defined"),dm=n}(Pr);const wb={};function Sq(n,e,t,i,r){let s=i||n.options.databaseURL;void 0===s&&(n.options.projectId||ns("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),jn("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let l,c,o=_b(s,r),a=o.repoInfo;"undefined"!=typeof process&&(c=process.env.FIREBASE_DATABASE_EMULATOR_HOST),c?(l=!0,s=`http://${c}?ns=${a.namespace}`,o=_b(s,r),a=o.repoInfo):l=!o.repoInfo.secure;const u=r&&l?new Fd(Fd.OWNER):new A7(n.name,n.options,e);(function(n,e){const t=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!_m(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==t.length&&!function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),FR(n)}(t))throw new Error(ec(n,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')})("Invalid Firebase Database URL",o),dt(o.path)||ns("Database URL must point to the root of a Firebase Database (not including a child path).");const d=function Tq(n,e,t,i){let r=wb[e.name];r||(r={},wb[e.name]=r);let s=r[n.toURLString()];return s&&ns("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new Q$(n,false,t,i),r[n.toURLString()]=s,s}(a,n,u,new D7(n.name,t));return new Aq(d,n)}class Aq{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function J$(n,e,t){if(n.stats_=_w(n.repoInfo_),n.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)n.server_=new em(n.repoInfo_,(i,r,s,o)=>{zR(n,i,r,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>GR(n,!0),0);else{if(null!=t){if("object"!=typeof t)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Wn(t)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}n.persistentConnection_=new ba(n.repoInfo_,e,(i,r,s,o)=>{zR(n,i,r,s,o)},i=>{GR(n,i)},i=>{!function K$(n,e){$n(e,(t,i)=>{db(n,t,i)})}(n,i)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(i=>{n.server_.refreshAuthToken(i)}),n.appCheckProvider_.addTokenChangeListener(i=>{n.server_.refreshAppCheckToken(i.token)}),n.statsReporter_=function N7(n,e){const t=n.toString();return gw[t]||(gw[t]=e()),gw[t]}(n.repoInfo_,()=>new Oj(n.stats_,n.server_)),n.infoData_=new Ij,n.infoSyncTree_=new TR({startListening:(i,r,s,o)=>{let a=[];const l=n.infoData_.getNode(i._path);return l.isEmpty()||(a=Qd(n.infoSyncTree_,i._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),db(n,"connected",!1),n.serverSyncTree_=new TR({startListening:(i,r,s,o)=>(n.server_.listen(i,s,r,(a,l)=>{const c=o(a,l);hr(n.eventQueue_,i._path,c)}),[]),stopListening:(i,r)=>{n.server_.unlisten(i,r)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Pr(this._repo,Dt())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function Eq(n,e){const t=wb[e];(!t||t[n.key]!==n)&&ns(`Database ${e}(${n.repoInfo_}) has already been deleted.`),function jR(n){n.persistentConnection_&&n.persistentConnection_.interrupt("repo_interrupt")}(n),delete t[n.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&ns("Cannot call "+e+" on a deleted database.")}}ba.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)},ba.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)},function Rq(n){(function _7(n){lw=n})("9.6.10"),Wp(new Id("database",(e,{instanceIdentifier:t})=>Sq(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t),"PUBLIC").setMultipleInstances(!0)),tc(s2,"0.12.7",n),tc(s2,"0.12.7","esm2017")}();const tP_firebaseConfig={apiKey:"AIzaSyDfT5qnMc2BxK0-QnRmWzbnmXgsqFjqLcE",authDomain:"twgeostat.firebaseapp.com",databaseURL:"https://twgeostat-default-rtdb.firebaseio.com",projectId:"twgeostat",storageBucket:"twgeostat.appspot.com",messagingSenderId:"349482155640",appId:"1:349482155640:web:5dccc81340eff5b646f78d",measurementId:"G-W4SHBZF9SS"};function nP(...n){const e=JC(n),{args:t,keys:i}=mA(n),r=new en(s=>{const{length:o}=t;if(!o)return void s.complete();const a=new Array(o);let l=o,c=o;for(let u=0;u<o;u++){let d=!1;Br(t[u]).subscribe(new Mn(s,h=>{d||(d=!0,c--),a[u]=h},()=>l--,void 0,()=>{(!l||!d)&&(c||s.next(i?_A(i,a):a),s.complete())}))}});return e?r.pipe(gA(e)):r}const Ii=1001,Un=1003,_n=1006,Ia=1009,ah=1012,Ao=1015,wc=1016,bc=1020,vi=1023,Ra=1026,xc=1027,Cc=2400,Mc=2401,Io=3e3,cn=3001,lh=35044,ch=35048;class Ro{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const i=this._listeners[e.type];if(void 0!==i){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const Zn=[];for(let n=0;n<256;n++)Zn[n]=(n<16?"0":"")+n.toString(16);const Pa=Math.PI/180,uh=180/Math.PI;function Qi(){const n=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(Zn[255&n]+Zn[n>>8&255]+Zn[n>>16&255]+Zn[n>>24&255]+"-"+Zn[255&e]+Zn[e>>8&255]+"-"+Zn[e>>16&15|64]+Zn[e>>24&255]+"-"+Zn[63&t|128]+Zn[t>>8&255]+"-"+Zn[t>>16&255]+Zn[t>>24&255]+Zn[255&i]+Zn[i>>8&255]+Zn[i>>16&255]+Zn[i>>24&255]).toUpperCase()}function ei(n,e,t){return Math.max(e,Math.min(t,n))}function dh(n,e,t){return(1-t)*n+t*e}function Ob(n){return 0==(n&n-1)&&0!==n}function km(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}class j{constructor(e=0,t=0){this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,i){return void 0!==i&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}j.prototype.isVector2=!0;class qn{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,i,r,s,o,a,l,c){const u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=s,u[5]=l,u[6]=i,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],l=i[6],c=i[1],u=i[4],d=i[7],h=i[2],f=i[5],p=i[8],_=r[0],y=r[3],g=r[6],m=r[1],v=r[4],w=r[7],b=r[2],T=r[5],A=r[8];return s[0]=o*_+a*m+l*b,s[3]=o*y+a*v+l*T,s[6]=o*g+a*w+l*A,s[1]=c*_+u*m+d*b,s[4]=c*y+u*v+d*T,s[7]=c*g+u*w+d*A,s[2]=h*_+f*m+p*b,s[5]=h*y+f*v+p*T,s[8]=h*g+f*w+p*A,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t*o*u-t*a*c-i*s*u+i*a*l+r*s*c-r*o*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=u*o-a*c,h=a*l-u*s,f=c*s-o*l,p=t*d+i*h+r*f;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const _=1/p;return e[0]=d*_,e[1]=(r*c-u*i)*_,e[2]=(a*i-r*o)*_,e[3]=h*_,e[4]=(u*t-r*l)*_,e[5]=(r*s-a*t)*_,e[6]=f*_,e[7]=(i*l-c*t)*_,e[8]=(o*t-i*s)*_,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(i*l,i*c,-i*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){const i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=t,i[4]*=t,i[7]*=t,this}rotate(e){const t=Math.cos(e),i=Math.sin(e),r=this.elements,s=r[0],o=r[3],a=r[6],l=r[1],c=r[4],u=r[7];return r[0]=t*s+i*l,r[3]=t*o+i*c,r[6]=t*a+i*u,r[1]=-i*s+t*l,r[4]=-i*o+t*c,r[7]=-i*a+t*u,this}translate(e,t){const i=this.elements;return i[0]+=e*i[2],i[3]+=e*i[5],i[6]+=e*i[8],i[1]+=t*i[2],i[4]+=t*i[5],i[7]+=t*i[8],this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}function BP(n){for(let e=n.length-1;e>=0;--e)if(n[e]>65535)return!0;return!1}function hh(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}qn.prototype.isMatrix3=!0,Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const VP={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Nr={h:0,s:0,l:0},Bm={h:0,s:0,l:0};function Fb(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+6*(e-n)*(2/3-t):n}function Tc(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function kb(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}let Dc,me=(()=>{class n{constructor(t,i,r){return void 0===i&&void 0===r?this.set(t):this.setRGB(t,i,r)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this}setRGB(t,i,r){return this.r=t,this.g=i,this.b=r,this}setHSL(t,i,r){if(t=function Lb(n,e){return(n%e+e)%e}(t,1),i=ei(i,0,1),r=ei(r,0,1),0===i)this.r=this.g=this.b=r;else{const s=r<=.5?r*(1+i):r+i-r*i,o=2*r-s;this.r=Fb(o,s,t+1/3),this.g=Fb(o,s,t),this.b=Fb(o,s,t-1/3)}return this}setStyle(t){function i(s){void 0!==s&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let r;if(r=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let s;const a=r[2];switch(r[1]){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,i(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,i(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){const l=parseFloat(s[1])/360,c=parseInt(s[2],10)/100,u=parseInt(s[3],10)/100;return i(s[4]),this.setHSL(l,c,u)}}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(t)){const s=r[1],o=s.length;if(3===o)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,this;if(6===o)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this}setColorName(t){const i=VP[t.toLowerCase()];return void 0!==i?this.setHex(i):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=Tc(t.r),this.g=Tc(t.g),this.b=Tc(t.b),this}copyLinearToSRGB(t){return this.r=kb(t.r),this.g=kb(t.g),this.b=kb(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(t){const i=this.r,r=this.g,s=this.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let l,c;const u=(a+o)/2;if(a===o)l=0,c=0;else{const d=o-a;switch(c=u<=.5?d/(o+a):d/(2-o-a),o){case i:l=(r-s)/d+(r<s?6:0);break;case r:l=(s-i)/d+2;break;case s:l=(i-r)/d+4}l/=6}return t.h=l,t.s=c,t.l=u,t}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(t,i,r){return this.getHSL(Nr),Nr.h+=t,Nr.s+=i,Nr.l+=r,this.setHSL(Nr.h,Nr.s,Nr.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,i){return this.r=t.r+i.r,this.g=t.g+i.g,this.b=t.b+i.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,i){return this.r+=(t.r-this.r)*i,this.g+=(t.g-this.g)*i,this.b+=(t.b-this.b)*i,this}lerpColors(t,i,r){return this.r=t.r+(i.r-t.r)*r,this.g=t.g+(i.g-t.g)*r,this.b=t.b+(i.b-t.b)*r,this}lerpHSL(t,i){this.getHSL(Nr),t.getHSL(Bm);const r=dh(Nr.h,Bm.h,i),s=dh(Nr.s,Bm.s,i),o=dh(Nr.l,Bm.l,i);return this.setHSL(r,s,o),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,i=0){return this.r=t[i],this.g=t[i+1],this.b=t[i+2],this}toArray(t=[],i=0){return t[i]=this.r,t[i+1]=this.g,t[i+2]=this.b,t}fromBufferAttribute(t,i){return this.r=t.getX(i),this.g=t.getY(i),this.b=t.getZ(i),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}return n.NAMES=VP,n})();me.prototype.isColor=!0,me.prototype.r=1,me.prototype.g=1,me.prototype.b=1;class Na{static getDataURL(e){if(/^data:/i.test(e.src)||"undefined"==typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Dc&&(Dc=hh("canvas")),Dc.width=e.width,Dc.height=e.height;const i=Dc.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=Dc}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const t=hh("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=255*Tc(s[o]/255);return i.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t[i]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*Tc(t[i]/255)):Tc(t[i]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class Ac{constructor(e=null){this.uuid=Qi(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)s.push(Bb(r[o].isDataTexture?r[o].image:r[o]))}else s=Bb(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function Bb(n){return"undefined"!=typeof HTMLImageElement&&n instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&n instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&n instanceof ImageBitmap?Na.getDataURL(n):n.data?{data:Array.prototype.slice.call(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}Ac.prototype.isSource=!0;let $Y=0,Ri=(()=>{class n extends Ro{constructor(t=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,r=Ii,s=Ii,o=_n,a=1008,l=vi,c=Ia,u=1,d=Io){super(),Object.defineProperty(this,"id",{value:$Y++}),this.uuid=Qi(),this.name="",this.source=new Ac(t),this.mipmaps=[],this.mapping=i,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=u,this.format=l,this.internalFormat=null,this.type=c,this.offset=new j(0,0),this.repeat=new j(1,1),this.center=new j(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new qn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=d,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const i=void 0===t||"string"==typeof t;if(!i&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),i||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case 1e3:t.x=t.x-Math.floor(t.x);break;case Ii:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case 1e3:t.y=t.y-Math.floor(t.y);break;case Ii:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=300,n})();Ri.prototype.isTexture=!0;class Ft{constructor(e=0,t=0,i=0,r=1){this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const l=e.elements,c=l[0],u=l[4],d=l[8],h=l[1],f=l[5],p=l[9],_=l[2],y=l[6],g=l[10];if(Math.abs(u-h)<.01&&Math.abs(d-_)<.01&&Math.abs(p-y)<.01){if(Math.abs(u+h)<.1&&Math.abs(d+_)<.1&&Math.abs(p+y)<.1&&Math.abs(c+f+g-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const v=(c+1)/2,w=(f+1)/2,b=(g+1)/2,T=(u+h)/4,A=(d+_)/4,P=(p+y)/4;return v>w&&v>b?v<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(v),r=T/i,s=A/i):w>b?w<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(w),i=T/r,s=P/r):b<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(b),i=A/s,r=P/s),this.set(i,r,s,t),this}let m=Math.sqrt((y-p)*(y-p)+(d-_)*(d-_)+(h-u)*(h-u));return Math.abs(m)<.001&&(m=1),this.x=(y-p)/m,this.y=(d-_)/m,this.z=(h-u)/m,this.w=Math.acos((c+f+g-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,i){return void 0!==i&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}Ft.prototype.isVector4=!0;class Pi extends Ro{constructor(e,t,i={}){super(),this.width=e,this.height=t,this.depth=1,this.scissor=new Ft(0,0,e,t),this.scissorTest=!1,this.viewport=new Ft(0,0,e,t),this.texture=new Ri({width:e,height:t,depth:1},i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,this.texture.internalFormat=void 0!==i.internalFormat?i.internalFormat:null,this.texture.minFilter=void 0!==i.minFilter?i.minFilter:_n,this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0!==i.stencilBuffer&&i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null,this.samples=void 0!==i.samples?i.samples:0}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.image=Object.assign({},e.texture.image),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}Pi.prototype.isWebGLRenderTarget=!0;class fh extends Ri{constructor(e=null,t=1,i=1,r=1){super(null),this.image={data:e,width:t,height:i,depth:r},this.magFilter=Un,this.minFilter=Un,this.wrapR=Ii,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}fh.prototype.isDataArrayTexture=!0,class qY extends Pi{constructor(e,t,i){super(e,t),this.depth=i,this.texture=new fh(null,e,t,i),this.texture.isRenderTargetTexture=!0}}.prototype.isWebGLArrayRenderTarget=!0;class Vm extends Ri{constructor(e=null,t=1,i=1,r=1){super(null),this.image={data:e,width:t,height:i,depth:r},this.magFilter=Un,this.minFilter=Un,this.wrapR=Ii,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}Vm.prototype.isData3DTexture=!0,class YY extends Pi{constructor(e,t,i){super(e,t),this.depth=i,this.texture=new Vm(null,e,t,i),this.texture.isRenderTargetTexture=!0}}.prototype.isWebGL3DRenderTarget=!0,class XY extends Pi{constructor(e,t,i,r={}){super(e,t,r);const s=this.texture;this.texture=[];for(let o=0;o<i;o++)this.texture[o]=s.clone(),this.texture[o].isRenderTargetTexture=!0}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let r=0,s=this.texture.length;r<s;r++)this.texture[r].image.width=e,this.texture[r].image.height=t,this.texture[r].image.depth=i;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this.texture.length=0;for(let t=0,i=e.texture.length;t<i;t++)this.texture[t]=e.texture[t].clone();return this}}.prototype.isWebGLMultipleRenderTargets=!0;class Yn{constructor(e=0,t=0,i=0,r=1){this._x=e,this._y=t,this._z=i,this._w=r}static slerp(e,t,i,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),i.slerpQuaternions(e,t,r)}static slerpFlat(e,t,i,r,s,o,a){let l=i[r+0],c=i[r+1],u=i[r+2],d=i[r+3];const h=s[o+0],f=s[o+1],p=s[o+2],_=s[o+3];if(0===a)return e[t+0]=l,e[t+1]=c,e[t+2]=u,void(e[t+3]=d);if(1===a)return e[t+0]=h,e[t+1]=f,e[t+2]=p,void(e[t+3]=_);if(d!==_||l!==h||c!==f||u!==p){let y=1-a;const g=l*h+c*f+u*p+d*_,m=g>=0?1:-1,v=1-g*g;if(v>Number.EPSILON){const b=Math.sqrt(v),T=Math.atan2(b,g*m);y=Math.sin(y*T)/b,a=Math.sin(a*T)/b}const w=a*m;if(l=l*y+h*w,c=c*y+f*w,u=u*y+p*w,d=d*y+_*w,y===1-a){const b=1/Math.sqrt(l*l+c*c+u*u+d*d);l*=b,c*=b,u*=b,d*=b}}e[t]=l,e[t+1]=c,e[t+2]=u,e[t+3]=d}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],l=i[r+1],c=i[r+2],u=i[r+3],d=s[o],h=s[o+1],f=s[o+2],p=s[o+3];return e[t]=a*p+u*d+l*f-c*h,e[t+1]=l*p+u*h+c*d-a*f,e[t+2]=c*p+u*f+a*h-l*d,e[t+3]=u*p-a*d-l*h-c*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(i/2),u=a(r/2),d=a(s/2),h=l(i/2),f=l(r/2),p=l(s/2);switch(o){case"XYZ":this._x=h*u*d+c*f*p,this._y=c*f*d-h*u*p,this._z=c*u*p+h*f*d,this._w=c*u*d-h*f*p;break;case"YXZ":this._x=h*u*d+c*f*p,this._y=c*f*d-h*u*p,this._z=c*u*p-h*f*d,this._w=c*u*d+h*f*p;break;case"ZXY":this._x=h*u*d-c*f*p,this._y=c*f*d+h*u*p,this._z=c*u*p+h*f*d,this._w=c*u*d-h*f*p;break;case"ZYX":this._x=h*u*d-c*f*p,this._y=c*f*d+h*u*p,this._z=c*u*p-h*f*d,this._w=c*u*d+h*f*p;break;case"YZX":this._x=h*u*d+c*f*p,this._y=c*f*d+h*u*p,this._z=c*u*p-h*f*d,this._w=c*u*d-h*f*p;break;case"XZY":this._x=h*u*d-c*f*p,this._y=c*f*d-h*u*p,this._z=c*u*p+h*f*d,this._w=c*u*d+h*f*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],u=t[6],d=t[10],h=i+a+d;if(h>0){const f=.5/Math.sqrt(h+1);this._w=.25/f,this._x=(u-l)*f,this._y=(s-c)*f,this._z=(o-r)*f}else if(i>a&&i>d){const f=2*Math.sqrt(1+i-a-d);this._w=(u-l)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+c)/f}else if(a>d){const f=2*Math.sqrt(1+a-i-d);this._w=(s-c)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(l+u)/f}else{const f=2*Math.sqrt(1+d-i-a);this._w=(o-r)/f,this._x=(s+c)/f,this._y=(l+u)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(ei(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,u=t._w;return this._x=i*u+o*a+r*c-s*l,this._y=r*u+o*l+s*a-i*c,this._z=s*u+o*c+i*l-r*a,this._w=o*u-i*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const f=1-t;return this._w=f*o+t*this._w,this._x=f*i+t*this._x,this._y=f*r+t*this._y,this._z=f*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),u=Math.atan2(c,a),d=Math.sin((1-t)*u)/c,h=Math.sin(t*u)/c;return this._w=o*d+this._w*h,this._x=i*d+this._x*h,this._y=r*d+this._y*h,this._z=s*d+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(s),i*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}Yn.prototype.isQuaternion=!0;class C{constructor(e=0,t=0,i=0){this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(UP.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(UP.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=l*t+o*r-a*i,u=l*i+a*t-s*r,d=l*r+s*i-o*t,h=-s*t-o*i-a*r;return this.x=c*l+h*-s+u*-a-d*-o,this.y=u*l+h*-o+d*-s-c*-a,this.z=d*l+h*-a+c*-o-u*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return Vb.copy(this).projectOnVector(e),this.sub(Vb)}reflect(e){return this.sub(Vb.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(ei(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,i){return void 0!==i&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}C.prototype.isVector3=!0;const Vb=new C,UP=new Yn;class fr{constructor(e=new C(1/0,1/0,1/0),t=new C(-1/0,-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,i=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=e.length;l<c;l+=3){const u=e[l],d=e[l+1],h=e[l+2];u<t&&(t=u),d<i&&(i=d),h<r&&(r=h),u>s&&(s=u),d>o&&(o=d),h>a&&(a=h)}return this.min.set(t,i,r),this.max.set(s,o,a),this}setFromBufferAttribute(e){let t=1/0,i=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=e.count;l<c;l++){const u=e.getX(l),d=e.getY(l),h=e.getZ(l);u<t&&(t=u),d<i&&(i=d),h<r&&(r=h),u>s&&(s=u),d>o&&(o=d),h>a&&(a=h)}return this.min.set(t,i,r),this.max.set(s,o,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=La.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(void 0!==i)if(t&&null!=i.attributes&&void 0!==i.attributes.position){const s=i.attributes.position;for(let o=0,a=s.count;o<a;o++)La.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(La)}else null===i.boundingBox&&i.computeBoundingBox(),Ub.copy(i.boundingBox),Ub.applyMatrix4(e.matrixWorld),this.union(Ub);const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,La),La.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(ph),Um.subVectors(this.max,ph),Ic.subVectors(e.a,ph),Rc.subVectors(e.b,ph),Pc.subVectors(e.c,ph),Po.subVectors(Rc,Ic),No.subVectors(Pc,Rc),Oa.subVectors(Ic,Pc);let t=[0,-Po.z,Po.y,0,-No.z,No.y,0,-Oa.z,Oa.y,Po.z,0,-Po.x,No.z,0,-No.x,Oa.z,0,-Oa.x,-Po.y,Po.x,0,-No.y,No.x,0,-Oa.y,Oa.x,0];return!(!Hb(t,Ic,Rc,Pc,Um)||(t=[1,0,0,0,1,0,0,0,1],!Hb(t,Ic,Rc,Pc,Um)))&&(Hm.crossVectors(Po,No),t=[Hm.x,Hm.y,Hm.z],Hb(t,Ic,Rc,Pc,Um))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return La.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(La).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Hs[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Hs[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Hs[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Hs[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Hs[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Hs[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Hs[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Hs[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Hs)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}fr.prototype.isBox3=!0;const Hs=[new C,new C,new C,new C,new C,new C,new C,new C],La=new C,Ub=new fr,Ic=new C,Rc=new C,Pc=new C,Po=new C,No=new C,Oa=new C,ph=new C,Um=new C,Hm=new C,Fa=new C;function Hb(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){Fa.fromArray(n,s);const a=r.x*Math.abs(Fa.x)+r.y*Math.abs(Fa.y)+r.z*Math.abs(Fa.z),l=e.dot(Fa),c=t.dot(Fa),u=i.dot(Fa);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}const QY=new fr,HP=new C,zm=new C,zb=new C;class ka{constructor(e=new C,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):QY.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){zb.subVectors(e,this.center);const t=zb.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=.5*(i-this.radius);this.center.add(zb.multiplyScalar(r/i)),this.radius+=r}return this}union(e){return!0===this.center.equals(e.center)?zm.set(0,0,1).multiplyScalar(e.radius):zm.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(HP.copy(e.center).add(zm)),this.expandByPoint(HP.copy(e.center).sub(zm)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const zs=new C,Gb=new C,Gm=new C,Lo=new C,Wb=new C,Wm=new C,jb=new C;class Ba{constructor(e=new C,t=new C(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,zs)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(i).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=zs.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(zs.copy(this.direction).multiplyScalar(t).add(this.origin),zs.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){Gb.copy(e).add(t).multiplyScalar(.5),Gm.copy(t).sub(e).normalize(),Lo.copy(this.origin).sub(Gb);const s=.5*e.distanceTo(t),o=-this.direction.dot(Gm),a=Lo.dot(this.direction),l=-Lo.dot(Gm),c=Lo.lengthSq(),u=Math.abs(1-o*o);let d,h,f,p;if(u>0)if(d=o*l-a,h=o*a-l,p=s*u,d>=0)if(h>=-p)if(h<=p){const _=1/u;d*=_,h*=_,f=d*(d+o*h+2*a)+h*(o*d+h+2*l)+c}else h=s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*l)+c;else h=-s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*l)+c;else h<=-p?(d=Math.max(0,-(-o*s+a)),h=d>0?-s:Math.min(Math.max(-s,-l),s),f=-d*d+h*(h+2*l)+c):h<=p?(d=0,h=Math.min(Math.max(-s,-l),s),f=h*(h+2*l)+c):(d=Math.max(0,-(o*s+a)),h=d>0?s:Math.min(Math.max(-s,-l),s),f=-d*d+h*(h+2*l)+c);else h=o>0?-s:s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*l)+c;return i&&i.copy(this.direction).multiplyScalar(d).add(this.origin),r&&r.copy(Gm).multiplyScalar(h).add(Gb),f}intersectSphere(e,t){zs.subVectors(e.center,this.origin);const i=zs.dot(this.direction),r=zs.dot(zs)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return a<0&&l<0?null:this.at(a<0?l:a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,l;const c=1/this.direction.x,u=1/this.direction.y,d=1/this.direction.z,h=this.origin;return c>=0?(i=(e.min.x-h.x)*c,r=(e.max.x-h.x)*c):(i=(e.max.x-h.x)*c,r=(e.min.x-h.x)*c),u>=0?(s=(e.min.y-h.y)*u,o=(e.max.y-h.y)*u):(s=(e.max.y-h.y)*u,o=(e.min.y-h.y)*u),i>o||s>r||((s>i||i!=i)&&(i=s),(o<r||r!=r)&&(r=o),d>=0?(a=(e.min.z-h.z)*d,l=(e.max.z-h.z)*d):(a=(e.max.z-h.z)*d,l=(e.min.z-h.z)*d),i>l||a>r)||((a>i||i!=i)&&(i=a),(l<r||r!=r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return null!==this.intersectBox(e,zs)}intersectTriangle(e,t,i,r,s){Wb.subVectors(t,e),Wm.subVectors(i,e),jb.crossVectors(Wb,Wm);let a,o=this.direction.dot(jb);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}Lo.subVectors(this.origin,e);const l=a*this.direction.dot(Wm.crossVectors(Lo,Wm));if(l<0)return null;const c=a*this.direction.dot(Wb.cross(Lo));if(c<0||l+c>o)return null;const u=-a*Lo.dot(jb);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Pe{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,i,r,s,o,a,l,c,u,d,h,f,p,_,y){const g=this.elements;return g[0]=e,g[4]=t,g[8]=i,g[12]=r,g[1]=s,g[5]=o,g[9]=a,g[13]=l,g[2]=c,g[6]=u,g[10]=d,g[14]=h,g[3]=f,g[7]=p,g[11]=_,g[15]=y,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Pe).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/Nc.setFromMatrixColumn(e,0).length(),s=1/Nc.setFromMatrixColumn(e,1).length(),o=1/Nc.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),c=Math.sin(r),u=Math.cos(s),d=Math.sin(s);if("XYZ"===e.order){const h=o*u,f=o*d,p=a*u,_=a*d;t[0]=l*u,t[4]=-l*d,t[8]=c,t[1]=f+p*c,t[5]=h-_*c,t[9]=-a*l,t[2]=_-h*c,t[6]=p+f*c,t[10]=o*l}else if("YXZ"===e.order){const h=l*u,f=l*d,p=c*u,_=c*d;t[0]=h+_*a,t[4]=p*a-f,t[8]=o*c,t[1]=o*d,t[5]=o*u,t[9]=-a,t[2]=f*a-p,t[6]=_+h*a,t[10]=o*l}else if("ZXY"===e.order){const h=l*u,f=l*d,p=c*u,_=c*d;t[0]=h-_*a,t[4]=-o*d,t[8]=p+f*a,t[1]=f+p*a,t[5]=o*u,t[9]=_-h*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if("ZYX"===e.order){const h=o*u,f=o*d,p=a*u,_=a*d;t[0]=l*u,t[4]=p*c-f,t[8]=h*c+_,t[1]=l*d,t[5]=_*c+h,t[9]=f*c-p,t[2]=-c,t[6]=a*l,t[10]=o*l}else if("YZX"===e.order){const h=o*l,f=o*c,p=a*l,_=a*c;t[0]=l*u,t[4]=_-h*d,t[8]=p*d+f,t[1]=d,t[5]=o*u,t[9]=-a*u,t[2]=-c*u,t[6]=f*d+p,t[10]=h-_*d}else if("XZY"===e.order){const h=o*l,f=o*c,p=a*l,_=a*c;t[0]=l*u,t[4]=-d,t[8]=c*u,t[1]=h*d+_,t[5]=o*u,t[9]=f*d-p,t[2]=p*d-f,t[6]=a*u,t[10]=_*d+h}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(JY,e,KY)}lookAt(e,t,i){const r=this.elements;return Ji.subVectors(e,t),0===Ji.lengthSq()&&(Ji.z=1),Ji.normalize(),Oo.crossVectors(i,Ji),0===Oo.lengthSq()&&(1===Math.abs(i.z)?Ji.x+=1e-4:Ji.z+=1e-4,Ji.normalize(),Oo.crossVectors(i,Ji)),Oo.normalize(),jm.crossVectors(Ji,Oo),r[0]=Oo.x,r[4]=jm.x,r[8]=Ji.x,r[1]=Oo.y,r[5]=jm.y,r[9]=Ji.y,r[2]=Oo.z,r[6]=jm.z,r[10]=Ji.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],l=i[8],c=i[12],u=i[1],d=i[5],h=i[9],f=i[13],p=i[2],_=i[6],y=i[10],g=i[14],m=i[3],v=i[7],w=i[11],b=i[15],T=r[0],A=r[4],P=r[8],z=r[12],N=r[1],x=r[5],D=r[9],L=r[13],O=r[2],U=r[6],B=r[10],q=r[14],F=r[3],Z=r[7],oe=r[11],ae=r[15];return s[0]=o*T+a*N+l*O+c*F,s[4]=o*A+a*x+l*U+c*Z,s[8]=o*P+a*D+l*B+c*oe,s[12]=o*z+a*L+l*q+c*ae,s[1]=u*T+d*N+h*O+f*F,s[5]=u*A+d*x+h*U+f*Z,s[9]=u*P+d*D+h*B+f*oe,s[13]=u*z+d*L+h*q+f*ae,s[2]=p*T+_*N+y*O+g*F,s[6]=p*A+_*x+y*U+g*Z,s[10]=p*P+_*D+y*B+g*oe,s[14]=p*z+_*L+y*q+g*ae,s[3]=m*T+v*N+w*O+b*F,s[7]=m*A+v*x+w*U+b*Z,s[11]=m*P+v*D+w*B+b*oe,s[15]=m*z+v*L+w*q+b*ae,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],u=e[2],d=e[6],h=e[10],f=e[14];return e[3]*(+s*l*d-r*c*d-s*a*h+i*c*h+r*a*f-i*l*f)+e[7]*(+t*l*f-t*c*h+s*o*h-r*o*f+r*c*u-s*l*u)+e[11]*(+t*c*d-t*a*f-s*o*d+i*o*f+s*a*u-i*c*u)+e[15]*(-r*a*u-t*l*d+t*a*h+r*o*d-i*o*h+i*l*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=e[9],h=e[10],f=e[11],p=e[12],_=e[13],y=e[14],g=e[15],m=d*y*c-_*h*c+_*l*f-a*y*f-d*l*g+a*h*g,v=p*h*c-u*y*c-p*l*f+o*y*f+u*l*g-o*h*g,w=u*_*c-p*d*c+p*a*f-o*_*f-u*a*g+o*d*g,b=p*d*l-u*_*l-p*a*h+o*_*h+u*a*y-o*d*y,T=t*m+i*v+r*w+s*b;if(0===T)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const A=1/T;return e[0]=m*A,e[1]=(_*h*s-d*y*s-_*r*f+i*y*f+d*r*g-i*h*g)*A,e[2]=(a*y*s-_*l*s+_*r*c-i*y*c-a*r*g+i*l*g)*A,e[3]=(d*l*s-a*h*s-d*r*c+i*h*c+a*r*f-i*l*f)*A,e[4]=v*A,e[5]=(u*y*s-p*h*s+p*r*f-t*y*f-u*r*g+t*h*g)*A,e[6]=(p*l*s-o*y*s-p*r*c+t*y*c+o*r*g-t*l*g)*A,e[7]=(o*h*s-u*l*s+u*r*c-t*h*c-o*r*f+t*l*f)*A,e[8]=w*A,e[9]=(p*d*s-u*_*s-p*i*f+t*_*f+u*i*g-t*d*g)*A,e[10]=(o*_*s-p*a*s+p*i*c-t*_*c-o*i*g+t*a*g)*A,e[11]=(u*a*s-o*d*s-u*i*c+t*d*c+o*i*f-t*a*f)*A,e[12]=b*A,e[13]=(u*_*r-p*d*r+p*i*h-t*_*h-u*i*y+t*d*y)*A,e[14]=(p*a*r-o*_*r-p*i*l+t*_*l+o*i*y-t*a*y)*A,e[15]=(o*d*r-u*a*r+u*i*l-t*d*l-o*i*h+t*a*h)*A,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,l=e.z,c=s*o,u=s*a;return this.set(c*o+i,c*a-r*l,c*l+r*a,0,c*a+r*l,u*a+i,u*l-r*o,0,c*l-r*a,u*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,u=o+o,d=a+a,h=s*c,f=s*u,p=s*d,_=o*u,y=o*d,g=a*d,m=l*c,v=l*u,w=l*d,b=i.x,T=i.y,A=i.z;return r[0]=(1-(_+g))*b,r[1]=(f+w)*b,r[2]=(p-v)*b,r[3]=0,r[4]=(f-w)*T,r[5]=(1-(h+g))*T,r[6]=(y+m)*T,r[7]=0,r[8]=(p+v)*A,r[9]=(y-m)*A,r[10]=(1-(h+_))*A,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=Nc.set(r[0],r[1],r[2]).length();const o=Nc.set(r[4],r[5],r[6]).length(),a=Nc.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],Lr.copy(this);const c=1/s,u=1/o,d=1/a;return Lr.elements[0]*=c,Lr.elements[1]*=c,Lr.elements[2]*=c,Lr.elements[4]*=u,Lr.elements[5]*=u,Lr.elements[6]*=u,Lr.elements[8]*=d,Lr.elements[9]*=d,Lr.elements[10]*=d,t.setFromRotationMatrix(Lr),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const a=this.elements,c=2*s/(i-r),u=(t+e)/(t-e),d=(i+r)/(i-r),h=-(o+s)/(o-s),f=-2*o*s/(o-s);return a[0]=2*s/(t-e),a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=c,a[9]=d,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,i,r,s,o){const a=this.elements,l=1/(t-e),c=1/(i-r),u=1/(o-s),d=(t+e)*l,h=(i+r)*c,f=(o+s)*u;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-d,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}Pe.prototype.isMatrix4=!0;const Nc=new C,Lr=new Pe,JY=new C(0,0,0),KY=new C(1,1,1),Oo=new C,jm=new C,Ji=new C,zP=new Pe,GP=new Yn;class Va{constructor(e=0,t=0,i=0,r=Va.DefaultOrder){this._x=e,this._y=t,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,r=this._order){return this._x=e,this._y=t,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const r=e.elements,s=r[0],o=r[4],a=r[8],l=r[1],c=r[5],u=r[9],d=r[2],h=r[6],f=r[10];switch(t){case"XYZ":this._y=Math.asin(ei(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,f),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(h,c),this._z=0);break;case"YXZ":this._x=Math.asin(-ei(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,f),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-d,s),this._z=0);break;case"ZXY":this._x=Math.asin(ei(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-d,f),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-ei(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(h,f),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(ei(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-d,s)):(this._x=0,this._y=Math.atan2(a,f));break;case"XZY":this._z=Math.asin(-ei(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(h,c),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-u,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===i&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return zP.makeRotationFromQuaternion(e),this.setFromRotationMatrix(zP,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return GP.setFromEuler(this),this.setFromQuaternion(GP,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}Va.prototype.isEuler=!0,Va.DefaultOrder="XYZ",Va.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class $b{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let ZY=0;const WP=new C,Lc=new Yn,Gs=new Pe,$m=new C,mh=new C,eX=new C,tX=new Yn,jP=new C(1,0,0),$P=new C(0,1,0),qP=new C(0,0,1),nX={type:"added"},YP={type:"removed"};class Rt extends Ro{constructor(){super(),Object.defineProperty(this,"id",{value:ZY++}),this.uuid=Qi(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Rt.DefaultUp.clone();const e=new C,t=new Va,i=new Yn,r=new C(1,1,1);t._onChange(function s(){i.setFromEuler(t,!1)}),i._onChange(function o(){t.setFromQuaternion(i,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Pe},normalMatrix:{value:new qn}}),this.matrix=new Pe,this.matrixWorld=new Pe,this.matrixAutoUpdate=Rt.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new $b,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Lc.setFromAxisAngle(e,t),this.quaternion.multiply(Lc),this}rotateOnWorldAxis(e,t){return Lc.setFromAxisAngle(e,t),this.quaternion.premultiply(Lc),this}rotateX(e){return this.rotateOnAxis(jP,e)}rotateY(e){return this.rotateOnAxis($P,e)}rotateZ(e){return this.rotateOnAxis(qP,e)}translateOnAxis(e,t){return WP.copy(e).applyQuaternion(this.quaternion),this.position.add(WP.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(jP,e)}translateY(e){return this.translateOnAxis($P,e)}translateZ(e){return this.translateOnAxis(qP,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(Gs.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?$m.copy(e):$m.set(e,t,i);const r=this.parent;this.updateWorldMatrix(!0,!1),mh.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Gs.lookAt(mh,$m,this.up):Gs.lookAt($m,mh,this.up),this.quaternion.setFromRotationMatrix(Gs),r&&(Gs.extractRotation(r.matrixWorld),Lc.setFromRotationMatrix(Gs),this.quaternion.premultiply(Lc.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(nX)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(YP)),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(YP)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),Gs.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),Gs.multiply(e.parent.matrixWorld)),e.applyMatrix4(Gs),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,r=this.children.length;i<r;i++){const o=this.children[i].getObjectByProperty(e,t);if(void 0!==o)return o}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(mh,e,eX),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(mh,tX,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].updateMatrixWorld(e)}updateWorldMatrix(e,t){const i=this.parent;if(!0===e&&null!==i&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=void 0===e||"string"==typeof e,i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};function s(a,l){return void 0===a[l.uuid]&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){const l=a.shapes;if(Array.isArray(l))for(let c=0,u=l.length;c<u;c++)s(e.shapes,l[c]);else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const a=[];for(let l=0,c=this.material.length;l<c;l++)a.push(s(e.materials,this.material[l]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++)r.animations.push(s(e.animations,this.animations[a]))}if(t){const a=o(e.geometries),l=o(e.materials),c=o(e.textures),u=o(e.images),d=o(e.shapes),h=o(e.skeletons),f=o(e.animations),p=o(e.nodes);a.length>0&&(i.geometries=a),l.length>0&&(i.materials=l),c.length>0&&(i.textures=c),u.length>0&&(i.images=u),d.length>0&&(i.shapes=d),h.length>0&&(i.skeletons=h),f.length>0&&(i.animations=f),p.length>0&&(i.nodes=p)}return i.object=r,i;function o(a){const l=[];for(const c in a){const u=a[c];delete u.metadata,l.push(u)}return l}}clone(e){return(new this.constructor).copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let i=0;i<e.children.length;i++)this.add(e.children[i].clone());return this}}Rt.DefaultUp=new C(0,1,0),Rt.DefaultMatrixAutoUpdate=!0,Rt.prototype.isObject3D=!0;const Or=new C,Ws=new C,qb=new C,js=new C,Oc=new C,Fc=new C,XP=new C,Yb=new C,Xb=new C,Qb=new C;class Rn{constructor(e=new C,t=new C,i=new C){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),Or.subVectors(e,t),r.cross(Or);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){Or.subVectors(r,t),Ws.subVectors(i,t),qb.subVectors(e,t);const o=Or.dot(Or),a=Or.dot(Ws),l=Or.dot(qb),c=Ws.dot(Ws),u=Ws.dot(qb),d=o*c-a*a;if(0===d)return s.set(-2,-1,-1);const h=1/d,f=(c*l-a*u)*h,p=(o*u-a*l)*h;return s.set(1-f-p,p,f)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,js),js.x>=0&&js.y>=0&&js.x+js.y<=1}static getUV(e,t,i,r,s,o,a,l){return this.getBarycoord(e,t,i,r,js),l.set(0,0),l.addScaledVector(s,js.x),l.addScaledVector(o,js.y),l.addScaledVector(a,js.z),l}static isFrontFacing(e,t,i,r){return Or.subVectors(i,t),Ws.subVectors(e,t),Or.cross(Ws).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Or.subVectors(this.c,this.b),Ws.subVectors(this.a,this.b),.5*Or.cross(Ws).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Rn.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Rn.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,s){return Rn.getUV(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return Rn.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Rn.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;Oc.subVectors(r,i),Fc.subVectors(s,i),Yb.subVectors(e,i);const l=Oc.dot(Yb),c=Fc.dot(Yb);if(l<=0&&c<=0)return t.copy(i);Xb.subVectors(e,r);const u=Oc.dot(Xb),d=Fc.dot(Xb);if(u>=0&&d<=u)return t.copy(r);const h=l*d-u*c;if(h<=0&&l>=0&&u<=0)return o=l/(l-u),t.copy(i).addScaledVector(Oc,o);Qb.subVectors(e,s);const f=Oc.dot(Qb),p=Fc.dot(Qb);if(p>=0&&f<=p)return t.copy(s);const _=f*c-l*p;if(_<=0&&c>=0&&p<=0)return a=c/(c-p),t.copy(i).addScaledVector(Fc,a);const y=u*p-f*d;if(y<=0&&d-u>=0&&f-p>=0)return XP.subVectors(s,r),a=(d-u)/(d-u+(f-p)),t.copy(r).addScaledVector(XP,a);const g=1/(y+_+h);return o=_*g,a=h*g,t.copy(i).addScaledVector(Oc,o).addScaledVector(Fc,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let iX=0;class Pn extends Ro{constructor(){super(),Object.defineProperty(this,"id",{value:iX++}),this.uuid=Qi(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const i=e[t];if(void 0===i){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if("shading"===t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===i;continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),0!==this.side&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(i.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=this.flatShading),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(null!==t){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}Pn.prototype.isMaterial=!0,Pn.fromType=function(){return null};class $s extends Pn{constructor(e){super(),this.type="MeshBasicMaterial",this.color=new me(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}$s.prototype.isMeshBasicMaterial=!0;const Zt=new C,qm=new j;class Ut{constructor(e,t,i){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===i,this.usage=lh,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const t=this.array;let i=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),o=new me),t[i++]=o.r,t[i++]=o.g,t[i++]=o.b}return this}copyVector2sArray(e){const t=this.array;let i=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),o=new j),t[i++]=o.x,t[i++]=o.y}return this}copyVector3sArray(e){const t=this.array;let i=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),o=new C),t[i++]=o.x,t[i++]=o.y,t[i++]=o.z}return this}copyVector4sArray(e){const t=this.array;let i=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),o=new Ft),t[i++]=o.x,t[i++]=o.y,t[i++]=o.z,t[i++]=o.w}return this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)qm.fromBufferAttribute(this,t),qm.applyMatrix3(e),this.setXY(t,qm.x,qm.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)Zt.fromBufferAttribute(this,t),Zt.applyMatrix3(e),this.setXYZ(t,Zt.x,Zt.y,Zt.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)Zt.x=this.getX(t),Zt.y=this.getY(t),Zt.z=this.getZ(t),Zt.applyMatrix4(e),this.setXYZ(t,Zt.x,Zt.y,Zt.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Zt.x=this.getX(t),Zt.y=this.getY(t),Zt.z=this.getZ(t),Zt.applyNormalMatrix(e),this.setXYZ(t,Zt.x,Zt.y,Zt.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Zt.x=this.getX(t),Zt.y=this.getY(t),Zt.z=this.getZ(t),Zt.transformDirection(e),this.setXYZ(t,Zt.x,Zt.y,Zt.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==lh&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}Ut.prototype.isBufferAttribute=!0;class Jb extends Ut{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class Kb extends Ut{constructor(e,t,i){super(new Uint32Array(e),t,i)}}(class cX extends Ut{constructor(e,t,i){super(new Uint16Array(e),t,i)}}).prototype.isFloat16BufferAttribute=!0;class De extends Ut{constructor(e,t,i){super(new Float32Array(e),t,i)}}let dX=0;const pr=new Pe,Zb=new Rt,kc=new C,Ki=new fr,gh=new fr,Xn=new C;class Ve extends Ro{constructor(){super(),Object.defineProperty(this,"id",{value:dX++}),this.uuid=Qi(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(BP(e)?Kb:Jb)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const s=(new qn).getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return pr.makeRotationFromQuaternion(e),this.applyMatrix4(pr),this}rotateX(e){return pr.makeRotationX(e),this.applyMatrix4(pr),this}rotateY(e){return pr.makeRotationY(e),this.applyMatrix4(pr),this}rotateZ(e){return pr.makeRotationZ(e),this.applyMatrix4(pr),this}translate(e,t,i){return pr.makeTranslation(e,t,i),this.applyMatrix4(pr),this}scale(e,t,i){return pr.makeScale(e,t,i),this.applyMatrix4(pr),this}lookAt(e){return Zb.lookAt(e),Zb.updateMatrix(),this.applyMatrix4(Zb.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(kc).negate(),this.translate(kc.x,kc.y,kc.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new De(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new fr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new C(-1/0,-1/0,-1/0),new C(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++)Ki.setFromBufferAttribute(t[i]),this.morphTargetsRelative?(Xn.addVectors(this.boundingBox.min,Ki.min),this.boundingBox.expandByPoint(Xn),Xn.addVectors(this.boundingBox.max,Ki.max),this.boundingBox.expandByPoint(Xn)):(this.boundingBox.expandByPoint(Ki.min),this.boundingBox.expandByPoint(Ki.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new ka);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new C,1/0);if(e){const i=this.boundingSphere.center;if(Ki.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)gh.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(Xn.addVectors(Ki.min,gh.min),Ki.expandByPoint(Xn),Xn.addVectors(Ki.max,gh.max),Ki.expandByPoint(Xn)):(Ki.expandByPoint(gh.min),Ki.expandByPoint(gh.max));Ki.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)Xn.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(Xn));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let c=0,u=a.count;c<u;c++)Xn.fromBufferAttribute(a,c),l&&(kc.fromBufferAttribute(e,c),Xn.add(kc)),r=Math.max(r,i.distanceToSquared(Xn))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Ut(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],u=[];for(let N=0;N<a;N++)c[N]=new C,u[N]=new C;const d=new C,h=new C,f=new C,p=new j,_=new j,y=new j,g=new C,m=new C;function v(N,x,D){d.fromArray(r,3*N),h.fromArray(r,3*x),f.fromArray(r,3*D),p.fromArray(o,2*N),_.fromArray(o,2*x),y.fromArray(o,2*D),h.sub(d),f.sub(d),_.sub(p),y.sub(p);const L=1/(_.x*y.y-y.x*_.y);!isFinite(L)||(g.copy(h).multiplyScalar(y.y).addScaledVector(f,-_.y).multiplyScalar(L),m.copy(f).multiplyScalar(_.x).addScaledVector(h,-y.x).multiplyScalar(L),c[N].add(g),c[x].add(g),c[D].add(g),u[N].add(m),u[x].add(m),u[D].add(m))}let w=this.groups;0===w.length&&(w=[{start:0,count:i.length}]);for(let N=0,x=w.length;N<x;++N){const D=w[N],L=D.start;for(let U=L,B=L+D.count;U<B;U+=3)v(i[U+0],i[U+1],i[U+2])}const b=new C,T=new C,A=new C,P=new C;function z(N){A.fromArray(s,3*N),P.copy(A);const x=c[N];b.copy(x),b.sub(A.multiplyScalar(A.dot(x))).normalize(),T.crossVectors(P,x);const L=T.dot(u[N])<0?-1:1;l[4*N]=b.x,l[4*N+1]=b.y,l[4*N+2]=b.z,l[4*N+3]=L}for(let N=0,x=w.length;N<x;++N){const D=w[N],L=D.start;for(let U=L,B=L+D.count;U<B;U+=3)z(i[U+0]),z(i[U+1]),z(i[U+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new Ut(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let h=0,f=i.count;h<f;h++)i.setXYZ(h,0,0,0);const r=new C,s=new C,o=new C,a=new C,l=new C,c=new C,u=new C,d=new C;if(e)for(let h=0,f=e.count;h<f;h+=3){const p=e.getX(h+0),_=e.getX(h+1),y=e.getX(h+2);r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,_),o.fromBufferAttribute(t,y),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),a.fromBufferAttribute(i,p),l.fromBufferAttribute(i,_),c.fromBufferAttribute(i,y),a.add(u),l.add(u),c.add(u),i.setXYZ(p,a.x,a.y,a.z),i.setXYZ(_,l.x,l.y,l.z),i.setXYZ(y,c.x,c.y,c.z)}else for(let h=0,f=t.count;h<f;h+=3)r.fromBufferAttribute(t,h+0),s.fromBufferAttribute(t,h+1),o.fromBufferAttribute(t,h+2),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),i.setXYZ(h+0,u.x,u.y,u.z),i.setXYZ(h+1,u.x,u.y,u.z),i.setXYZ(h+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(e,t){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const i=this.attributes;for(const r in i){if(void 0===e.attributes[r])continue;const o=i[r].array,a=e.attributes[r],l=a.array,c=a.itemSize*t,u=Math.min(l.length,o.length-c);for(let d=0,h=c;d<u;d++,h++)o[h]=l[d]}return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)Xn.fromBufferAttribute(e,t),Xn.normalize(),e.setXYZ(t,Xn.x,Xn.y,Xn.z)}toNonIndexed(){function e(a,l){const c=a.array,u=a.itemSize,d=a.normalized,h=new c.constructor(l.length*u);let f=0,p=0;for(let _=0,y=l.length;_<y;_++){f=a.isInterleavedBufferAttribute?l[_]*a.data.stride+a.offset:l[_]*u;for(let g=0;g<u;g++)h[p++]=c[f++]}return new Ut(h,u,d)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Ve,i=this.index.array,r=this.attributes;for(const a in r){const c=e(r[a],i);t.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let u=0,d=c.length;u<d;u++){const f=e(c[u],i);l.push(f)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const l=this.parameters;for(const c in l)void 0!==l[c]&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i)e.data.attributes[l]=i[l].toJSON(e.data);const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let d=0,h=c.length;d<h;d++)u.push(c[d].toJSON(e.data));u.length>0&&(r[l]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone(t));const r=e.attributes;for(const c in r)this.setAttribute(c,r[c].clone(t));const s=e.morphAttributes;for(const c in s){const u=[],d=s[c];for(let h=0,f=d.length;h<f;h++)u.push(d[h].clone(t));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,u=o.length;c<u;c++){const d=o[c];this.addGroup(d.start,d.count,d.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const l=e.boundingSphere;return null!==l&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}Ve.prototype.isBufferGeometry=!0;const QP=new Pe,Bc=new Ba,ex=new ka,Fo=new C,ko=new C,Bo=new C,tx=new C,nx=new C,ix=new C,Ym=new C,Xm=new C,Qm=new C,Jm=new j,Km=new j,Zm=new j,rx=new C,eg=new C;class nn extends Rt{constructor(e=new Ve,t=new $s){super(),this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(e,t){const i=this.geometry,r=this.material,s=this.matrixWorld;if(void 0===r||(null===i.boundingSphere&&i.computeBoundingSphere(),ex.copy(i.boundingSphere),ex.applyMatrix4(s),!1===e.ray.intersectsSphere(ex))||(QP.copy(s).invert(),Bc.copy(e.ray).applyMatrix4(QP),null!==i.boundingBox&&!1===Bc.intersectsBox(i.boundingBox)))return;let o;if(i.isBufferGeometry){const a=i.index,l=i.attributes.position,c=i.morphAttributes.position,u=i.morphTargetsRelative,d=i.attributes.uv,h=i.attributes.uv2,f=i.groups,p=i.drawRange;if(null!==a)if(Array.isArray(r))for(let _=0,y=f.length;_<y;_++){const g=f[_],m=r[g.materialIndex];for(let b=Math.max(g.start,p.start),T=Math.min(a.count,Math.min(g.start+g.count,p.start+p.count));b<T;b+=3){const A=a.getX(b),P=a.getX(b+1),z=a.getX(b+2);o=tg(this,m,e,Bc,l,c,u,d,h,A,P,z),o&&(o.faceIndex=Math.floor(b/3),o.face.materialIndex=g.materialIndex,t.push(o))}}else for(let g=Math.max(0,p.start),m=Math.min(a.count,p.start+p.count);g<m;g+=3){const v=a.getX(g),w=a.getX(g+1),b=a.getX(g+2);o=tg(this,r,e,Bc,l,c,u,d,h,v,w,b),o&&(o.faceIndex=Math.floor(g/3),t.push(o))}else if(void 0!==l)if(Array.isArray(r))for(let _=0,y=f.length;_<y;_++){const g=f[_],m=r[g.materialIndex];for(let b=Math.max(g.start,p.start),T=Math.min(l.count,Math.min(g.start+g.count,p.start+p.count));b<T;b+=3)o=tg(this,m,e,Bc,l,c,u,d,h,b,b+1,b+2),o&&(o.faceIndex=Math.floor(b/3),o.face.materialIndex=g.materialIndex,t.push(o))}else for(let g=Math.max(0,p.start),m=Math.min(l.count,p.start+p.count);g<m;g+=3)o=tg(this,r,e,Bc,l,c,u,d,h,g,g+1,g+2),o&&(o.faceIndex=Math.floor(g/3),t.push(o))}else i.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function tg(n,e,t,i,r,s,o,a,l,c,u,d){Fo.fromBufferAttribute(r,c),ko.fromBufferAttribute(r,u),Bo.fromBufferAttribute(r,d);const h=n.morphTargetInfluences;if(s&&h){Ym.set(0,0,0),Xm.set(0,0,0),Qm.set(0,0,0);for(let p=0,_=s.length;p<_;p++){const y=h[p],g=s[p];0!==y&&(tx.fromBufferAttribute(g,c),nx.fromBufferAttribute(g,u),ix.fromBufferAttribute(g,d),o?(Ym.addScaledVector(tx,y),Xm.addScaledVector(nx,y),Qm.addScaledVector(ix,y)):(Ym.addScaledVector(tx.sub(Fo),y),Xm.addScaledVector(nx.sub(ko),y),Qm.addScaledVector(ix.sub(Bo),y)))}Fo.add(Ym),ko.add(Xm),Bo.add(Qm)}n.isSkinnedMesh&&(n.boneTransform(c,Fo),n.boneTransform(u,ko),n.boneTransform(d,Bo));const f=function hX(n,e,t,i,r,s,o,a){let l;if(l=1===e.side?i.intersectTriangle(o,s,r,!0,a):i.intersectTriangle(r,s,o,2!==e.side,a),null===l)return null;eg.copy(a),eg.applyMatrix4(n.matrixWorld);const c=t.ray.origin.distanceTo(eg);return c<t.near||c>t.far?null:{distance:c,point:eg.clone(),object:n}}(n,e,t,i,Fo,ko,Bo,rx);if(f){a&&(Jm.fromBufferAttribute(a,c),Km.fromBufferAttribute(a,u),Zm.fromBufferAttribute(a,d),f.uv=Rn.getUV(rx,Fo,ko,Bo,Jm,Km,Zm,new j)),l&&(Jm.fromBufferAttribute(l,c),Km.fromBufferAttribute(l,u),Zm.fromBufferAttribute(l,d),f.uv2=Rn.getUV(rx,Fo,ko,Bo,Jm,Km,Zm,new j));const p={a:c,b:u,c:d,normal:new C,materialIndex:0};Rn.getNormal(Fo,ko,Bo,p.normal),f.face=p}return f}nn.prototype.isMesh=!0;class Vo extends Ve{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],u=[],d=[];let h=0,f=0;function p(_,y,g,m,v,w,b,T,A,P,z){const N=w/A,x=b/P,D=w/2,L=b/2,O=T/2,U=A+1,B=P+1;let q=0,F=0;const Z=new C;for(let oe=0;oe<B;oe++){const ae=oe*x-L;for(let ce=0;ce<U;ce++)Z[_]=(ce*N-D)*m,Z[y]=ae*v,Z[g]=O,c.push(Z.x,Z.y,Z.z),Z[_]=0,Z[y]=0,Z[g]=T>0?1:-1,u.push(Z.x,Z.y,Z.z),d.push(ce/A),d.push(1-oe/P),q+=1}for(let oe=0;oe<P;oe++)for(let ae=0;ae<A;ae++){const Oe=h+ae+U*(oe+1),xt=h+(ae+1)+U*(oe+1),He=h+(ae+1)+U*oe;l.push(h+ae+U*oe,Oe,He),l.push(Oe,xt,He),F+=6}a.addGroup(f,F,z),f+=F,h+=q}p("z","y","x",-1,-1,i,t,e,o,s,0),p("z","y","x",1,-1,i,t,-e,o,s,1),p("x","z","y",1,1,e,i,t,r,o,2),p("x","z","y",1,-1,e,i,-t,r,o,3),p("x","y","z",1,-1,e,t,i,r,s,4),p("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new De(c,3)),this.setAttribute("normal",new De(u,3)),this.setAttribute("uv",new De(d,2))}static fromJSON(e){return new Vo(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Vc(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];e[t][i]=r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.clone():Array.isArray(r)?r.slice():r}}return e}function ai(n){const e={};for(let t=0;t<n.length;t++){const i=Vc(n[t]);for(const r in i)e[r]=i[r]}return e}const fX={clone:Vc,merge:ai};class Fr extends Pn{constructor(e){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Vc(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;t.uniforms[r]=o&&o.isTexture?{type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?{type:"c",value:o.getHex()}:o&&o.isVector2?{type:"v2",value:o.toArray()}:o&&o.isVector3?{type:"v3",value:o.toArray()}:o&&o.isVector4?{type:"v4",value:o.toArray()}:o&&o.isMatrix3?{type:"m3",value:o.toArray()}:o&&o.isMatrix4?{type:"m4",value:o.toArray()}:{value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const i={};for(const r in this.extensions)!0===this.extensions[r]&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}Fr.prototype.isShaderMaterial=!0;class ng extends Rt{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new Pe,this.projectionMatrix=new Pe,this.projectionMatrixInverse=new Pe}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}ng.prototype.isCamera=!0;class Hn extends ng{constructor(e=50,t=1,i=.1,r=2e3){super(),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*uh*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Pa*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*uh*Math.atan(Math.tan(.5*Pa*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Pa*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*i/c,r*=o.width/l,i*=o.height/c}const a=this.filmOffset;0!==a&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}Hn.prototype.isPerspectiveCamera=!0;class sx extends Rt{constructor(e,t,i){if(super(),this.type="CubeCamera",!0!==i.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=i;const r=new Hn(90,1,e,t);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new C(1,0,0)),this.add(r);const s=new Hn(90,1,e,t);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new C(-1,0,0)),this.add(s);const o=new Hn(90,1,e,t);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(new C(0,1,0)),this.add(o);const a=new Hn(90,1,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new C(0,-1,0)),this.add(a);const l=new Hn(90,1,e,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new C(0,0,1)),this.add(l);const c=new Hn(90,1,e,t);c.layers=this.layers,c.up.set(0,-1,0),c.lookAt(new C(0,0,-1)),this.add(c)}update(e,t){null===this.parent&&this.updateMatrixWorld();const i=this.renderTarget,[r,s,o,a,l,c]=this.children,u=e.xr.enabled,d=e.getRenderTarget();e.xr.enabled=!1;const h=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,r),e.setRenderTarget(i,1),e.render(t,s),e.setRenderTarget(i,2),e.render(t,o),e.setRenderTarget(i,3),e.render(t,a),e.setRenderTarget(i,4),e.render(t,l),i.texture.generateMipmaps=h,e.setRenderTarget(i,5),e.render(t,c),e.setRenderTarget(d),e.xr.enabled=u,i.texture.needsPMREMUpdate=!0}}class _h extends Ri{constructor(e,t,i,r,s,o,a,l,c,u){super(e=void 0!==e?e:[],t=void 0!==t?t:301,i,r,s,o,a,l,c,u),this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}_h.prototype.isCubeTexture=!0;class ox extends Pi{constructor(e,t={}){super(e,e,t);const i={width:e,height:e,depth:1};this.texture=new _h([i,i,i,i,i,i],t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:_n}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.format=vi,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new Vo(5,5,5),s=new Fr({name:"CubemapFromEquirect",uniforms:Vc(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:1,blending:0});s.uniforms.tEquirect.value=t;const o=new nn(r,s),a=t.minFilter;return 1008===t.minFilter&&(t.minFilter=_n),new sx(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}ox.prototype.isWebGLCubeRenderTarget=!0;const ax=new C,gX=new C,_X=new qn;class qs{constructor(e=new C(1,0,0),t=0){this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=ax.subVectors(i,t).cross(gX.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const i=e.delta(ax),r=this.normal.dot(i);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(i).multiplyScalar(s).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||_X.getNormalMatrix(e),r=this.coplanarPoint(ax).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}qs.prototype.isPlane=!0;const zc=new ka,ig=new C;class rg{constructor(e=new qs,t=new qs,i=new qs,r=new qs,s=new qs,o=new qs){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e){const t=this.planes,i=e.elements,r=i[0],s=i[1],o=i[2],a=i[3],l=i[4],c=i[5],u=i[6],d=i[7],h=i[8],f=i[9],p=i[10],_=i[11],y=i[12],g=i[13],m=i[14],v=i[15];return t[0].setComponents(a-r,d-l,_-h,v-y).normalize(),t[1].setComponents(a+r,d+l,_+h,v+y).normalize(),t[2].setComponents(a+s,d+c,_+f,v+g).normalize(),t[3].setComponents(a-s,d-c,_-f,v-g).normalize(),t[4].setComponents(a-o,d-u,_-p,v-m).normalize(),t[5].setComponents(a+o,d+u,_+p,v+m).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),zc.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(zc)}intersectsSprite(e){return zc.center.set(0,0,0),zc.radius=.7071067811865476,zc.applyMatrix4(e.matrixWorld),this.intersectsSphere(zc)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(ig.x=r.normal.x>0?e.max.x:e.min.x,ig.y=r.normal.y>0?e.max.y:e.min.y,ig.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(ig)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function JP(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function yX(n,e){const t=e.isWebGL2,i=new WeakMap;return{get:function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)},remove:function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const u=i.get(c);u&&(n.deleteBuffer(u.buffer),i.delete(c))},update:function l(c,u){if(c.isGLBufferAttribute){const h=i.get(c);return void((!h||h.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version}))}c.isInterleavedBufferAttribute&&(c=c.data);const d=i.get(c);void 0===d?i.set(c,function r(c,u){const d=c.array,h=c.usage,f=n.createBuffer();let p;if(n.bindBuffer(u,f),n.bufferData(u,d,h),c.onUploadCallback(),d instanceof Float32Array)p=5126;else if(d instanceof Uint16Array)if(c.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");p=5131}else p=5123;else if(d instanceof Int16Array)p=5122;else if(d instanceof Uint32Array)p=5125;else if(d instanceof Int32Array)p=5124;else if(d instanceof Int8Array)p=5120;else if(d instanceof Uint8Array)p=5121;else{if(!(d instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);p=5121}return{buffer:f,type:p,bytesPerElement:d.BYTES_PER_ELEMENT,version:c.version}}(c,u)):d.version<c.version&&(function s(c,u,d){const h=u.array,f=u.updateRange;n.bindBuffer(d,c),-1===f.count?n.bufferSubData(d,0,h):(t?n.bufferSubData(d,f.offset*h.BYTES_PER_ELEMENT,h,f.offset,f.count):n.bufferSubData(d,f.offset*h.BYTES_PER_ELEMENT,h.subarray(f.offset,f.offset+f.count)),f.count=-1)}(d.buffer,c,u),d.version=c.version)}}}class Gc extends Ve{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),l=Math.floor(r),c=a+1,u=l+1,d=e/a,h=t/l,f=[],p=[],_=[],y=[];for(let g=0;g<u;g++){const m=g*h-o;for(let v=0;v<c;v++)p.push(v*d-s,-m,0),_.push(0,0,1),y.push(v/a),y.push(1-g/l)}for(let g=0;g<l;g++)for(let m=0;m<a;m++){const w=m+c*(g+1),b=m+1+c*(g+1),T=m+1+c*g;f.push(m+c*g,w,T),f.push(w,b,T)}this.setIndex(f),this.setAttribute("position",new De(p,3)),this.setAttribute("normal",new De(_,3)),this.setAttribute("uv",new De(y,2))}static fromJSON(e){return new Gc(e.width,e.height,e.widthSegments,e.heightSegments)}}const wt={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 ) + 0.5;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec;\n\t\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\t\treflectVec = reflect( - viewDir, normal );\n\t\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\t#else\n\t\t\t\treflectVec = refract( - viewDir, normal, refractionRatio );\n\t\t\t#endif\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tlightMapIrradiance *= PI;\n\t#endif\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ]\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform vec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tfloat texelIndex = float( vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset );\n\t\t\tfloat y = floor( texelIndex / morphTargetsTextureSize.x );\n\t\t\tfloat x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tvec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );\n\t\t\treturn texture( morphTargetsTexture, morphUV );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},ge={common:{diffuse:{value:new me(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new qn},uv2Transform:{value:new qn},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new j(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new me(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new me(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new qn}},sprite:{diffuse:{value:new me(16777215)},opacity:{value:1},center:{value:new j(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new qn}}},as={basic:{uniforms:ai([ge.common,ge.specularmap,ge.envmap,ge.aomap,ge.lightmap,ge.fog]),vertexShader:wt.meshbasic_vert,fragmentShader:wt.meshbasic_frag},lambert:{uniforms:ai([ge.common,ge.specularmap,ge.envmap,ge.aomap,ge.lightmap,ge.emissivemap,ge.fog,ge.lights,{emissive:{value:new me(0)}}]),vertexShader:wt.meshlambert_vert,fragmentShader:wt.meshlambert_frag},phong:{uniforms:ai([ge.common,ge.specularmap,ge.envmap,ge.aomap,ge.lightmap,ge.emissivemap,ge.bumpmap,ge.normalmap,ge.displacementmap,ge.fog,ge.lights,{emissive:{value:new me(0)},specular:{value:new me(1118481)},shininess:{value:30}}]),vertexShader:wt.meshphong_vert,fragmentShader:wt.meshphong_frag},standard:{uniforms:ai([ge.common,ge.envmap,ge.aomap,ge.lightmap,ge.emissivemap,ge.bumpmap,ge.normalmap,ge.displacementmap,ge.roughnessmap,ge.metalnessmap,ge.fog,ge.lights,{emissive:{value:new me(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:wt.meshphysical_vert,fragmentShader:wt.meshphysical_frag},toon:{uniforms:ai([ge.common,ge.aomap,ge.lightmap,ge.emissivemap,ge.bumpmap,ge.normalmap,ge.displacementmap,ge.gradientmap,ge.fog,ge.lights,{emissive:{value:new me(0)}}]),vertexShader:wt.meshtoon_vert,fragmentShader:wt.meshtoon_frag},matcap:{uniforms:ai([ge.common,ge.bumpmap,ge.normalmap,ge.displacementmap,ge.fog,{matcap:{value:null}}]),vertexShader:wt.meshmatcap_vert,fragmentShader:wt.meshmatcap_frag},points:{uniforms:ai([ge.points,ge.fog]),vertexShader:wt.points_vert,fragmentShader:wt.points_frag},dashed:{uniforms:ai([ge.common,ge.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:wt.linedashed_vert,fragmentShader:wt.linedashed_frag},depth:{uniforms:ai([ge.common,ge.displacementmap]),vertexShader:wt.depth_vert,fragmentShader:wt.depth_frag},normal:{uniforms:ai([ge.common,ge.bumpmap,ge.normalmap,ge.displacementmap,{opacity:{value:1}}]),vertexShader:wt.meshnormal_vert,fragmentShader:wt.meshnormal_frag},sprite:{uniforms:ai([ge.sprite,ge.fog]),vertexShader:wt.sprite_vert,fragmentShader:wt.sprite_frag},background:{uniforms:{uvTransform:{value:new qn},t2D:{value:null}},vertexShader:wt.background_vert,fragmentShader:wt.background_frag},cube:{uniforms:ai([ge.envmap,{opacity:{value:1}}]),vertexShader:wt.cube_vert,fragmentShader:wt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:wt.equirect_vert,fragmentShader:wt.equirect_frag},distanceRGBA:{uniforms:ai([ge.common,ge.displacementmap,{referencePosition:{value:new C},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:wt.distanceRGBA_vert,fragmentShader:wt.distanceRGBA_frag},shadow:{uniforms:ai([ge.lights,ge.fog,{color:{value:new me(0)},opacity:{value:1}}]),vertexShader:wt.shadow_vert,fragmentShader:wt.shadow_frag}};function pJ(n,e,t,i,r,s){const o=new me(0);let l,c,a=!0===r?0:1,u=null,d=0,h=null;function p(_,y){t.buffers.color.setClear(_.r,_.g,_.b,y,s)}return{getClearColor:function(){return o},setClearColor:function(_,y=1){o.set(_),a=y,p(o,a)},getClearAlpha:function(){return a},setClearAlpha:function(_){a=_,p(o,a)},render:function f(_,y){let g=!1,m=!0===y.isScene?y.background:null;m&&m.isTexture&&(m=e.get(m));const v=n.xr,w=v.getSession&&v.getSession();w&&"additive"===w.environmentBlendMode&&(m=null),null===m?p(o,a):m&&m.isColor&&(p(m,1),g=!0),(n.autoClear||g)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),m&&(m.isCubeTexture||306===m.mapping)?(void 0===c&&(c=new nn(new Vo(1,1,1),new Fr({name:"BackgroundCubeMaterial",uniforms:Vc(as.cube.uniforms),vertexShader:as.cube.vertexShader,fragmentShader:as.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(b,T,A){this.matrixWorld.copyPosition(A.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(c)),c.material.uniforms.envMap.value=m,c.material.uniforms.flipEnvMap.value=m.isCubeTexture&&!1===m.isRenderTargetTexture?-1:1,(u!==m||d!==m.version||h!==n.toneMapping)&&(c.material.needsUpdate=!0,u=m,d=m.version,h=n.toneMapping),_.unshift(c,c.geometry,c.material,0,0,null)):m&&m.isTexture&&(void 0===l&&(l=new nn(new Gc(2,2),new Fr({name:"BackgroundMaterial",uniforms:Vc(as.background.uniforms),vertexShader:as.background.vertexShader,fragmentShader:as.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(l)),l.material.uniforms.t2D.value=m,!0===m.matrixAutoUpdate&&m.updateMatrix(),l.material.uniforms.uvTransform.value.copy(m.matrix),(u!==m||d!==m.version||h!==n.toneMapping)&&(l.material.needsUpdate=!0,u=m,d=m.version,h=n.toneMapping),_.unshift(l,l.geometry,l.material,0,0,null))}}}function mJ(n,e,t,i){const r=n.getParameter(34921),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||null!==s,a={},l=_(null);let c=l;function h(L){return i.isWebGL2?n.bindVertexArray(L):s.bindVertexArrayOES(L)}function f(L){return i.isWebGL2?n.deleteVertexArray(L):s.deleteVertexArrayOES(L)}function _(L){const O=[],U=[],B=[];for(let q=0;q<r;q++)O[q]=0,U[q]=0,B[q]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:O,enabledAttributes:U,attributeDivisors:B,object:L,attributes:{},index:null}}function m(){const L=c.newAttributes;for(let O=0,U=L.length;O<U;O++)L[O]=0}function v(L){w(L,0)}function w(L,O){const B=c.enabledAttributes,q=c.attributeDivisors;c.newAttributes[L]=1,0===B[L]&&(n.enableVertexAttribArray(L),B[L]=1),q[L]!==O&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](L,O),q[L]=O)}function b(){const L=c.newAttributes,O=c.enabledAttributes;for(let U=0,B=O.length;U<B;U++)O[U]!==L[U]&&(n.disableVertexAttribArray(U),O[U]=0)}function T(L,O,U,B,q,F){!0!==i.isWebGL2||5124!==U&&5125!==U?n.vertexAttribPointer(L,O,U,B,q,F):n.vertexAttribIPointer(L,O,U,q,F)}function x(){D(),c!==l&&(c=l,h(c.object))}function D(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function u(L,O,U,B,q){let F=!1;if(o){const Z=function p(L,O,U){const B=!0===U.wireframe;let q=a[L.id];void 0===q&&(q={},a[L.id]=q);let F=q[O.id];void 0===F&&(F={},q[O.id]=F);let Z=F[B];return void 0===Z&&(Z=_(function d(){return i.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}()),F[B]=Z),Z}(B,U,O);c!==Z&&(c=Z,h(c.object)),F=function y(L,O){const U=c.attributes,B=L.attributes;let q=0;for(const F in B){const Z=U[F],oe=B[F];if(void 0===Z||Z.attribute!==oe||Z.data!==oe.data)return!0;q++}return c.attributesNum!==q||c.index!==O}(B,q),F&&function g(L,O){const U={},B=L.attributes;let q=0;for(const F in B){const Z=B[F],oe={};oe.attribute=Z,Z.data&&(oe.data=Z.data),U[F]=oe,q++}c.attributes=U,c.attributesNum=q,c.index=O}(B,q)}else{const Z=!0===O.wireframe;(c.geometry!==B.id||c.program!==U.id||c.wireframe!==Z)&&(c.geometry=B.id,c.program=U.id,c.wireframe=Z,F=!0)}!0===L.isInstancedMesh&&(F=!0),null!==q&&t.update(q,34963),F&&(function A(L,O,U,B){if(!1===i.isWebGL2&&(L.isInstancedMesh||B.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;m();const q=B.attributes,F=U.getAttributes(),Z=O.defaultAttributeValues;for(const oe in F){const ae=F[oe];if(ae.location>=0){let ce=q[oe];if(void 0===ce&&("instanceMatrix"===oe&&L.instanceMatrix&&(ce=L.instanceMatrix),"instanceColor"===oe&&L.instanceColor&&(ce=L.instanceColor)),void 0!==ce){const Oe=ce.normalized,xt=ce.itemSize,He=t.get(ce);if(void 0===He)continue;const J=He.buffer,St=He.type,et=He.bytesPerElement;if(ce.isInterleavedBufferAttribute){const Ae=ce.data,Ie=Ae.stride,_t=ce.offset;if(Ae.isInstancedInterleavedBuffer){for(let G=0;G<ae.locationSize;G++)w(ae.location+G,Ae.meshPerAttribute);!0!==L.isInstancedMesh&&void 0===B._maxInstanceCount&&(B._maxInstanceCount=Ae.meshPerAttribute*Ae.count)}else for(let G=0;G<ae.locationSize;G++)v(ae.location+G);n.bindBuffer(34962,J);for(let G=0;G<ae.locationSize;G++)T(ae.location+G,xt/ae.locationSize,St,Oe,Ie*et,(_t+xt/ae.locationSize*G)*et)}else{if(ce.isInstancedBufferAttribute){for(let Ae=0;Ae<ae.locationSize;Ae++)w(ae.location+Ae,ce.meshPerAttribute);!0!==L.isInstancedMesh&&void 0===B._maxInstanceCount&&(B._maxInstanceCount=ce.meshPerAttribute*ce.count)}else for(let Ae=0;Ae<ae.locationSize;Ae++)v(ae.location+Ae);n.bindBuffer(34962,J);for(let Ae=0;Ae<ae.locationSize;Ae++)T(ae.location+Ae,xt/ae.locationSize,St,Oe,xt*et,xt/ae.locationSize*Ae*et)}}else if(void 0!==Z){const Oe=Z[oe];if(void 0!==Oe)switch(Oe.length){case 2:n.vertexAttrib2fv(ae.location,Oe);break;case 3:n.vertexAttrib3fv(ae.location,Oe);break;case 4:n.vertexAttrib4fv(ae.location,Oe);break;default:n.vertexAttrib1fv(ae.location,Oe)}}}}b()}(L,O,U,B),null!==q&&n.bindBuffer(34963,t.get(q).buffer))},reset:x,resetDefaultState:D,dispose:function P(){x();for(const L in a){const O=a[L];for(const U in O){const B=O[U];for(const q in B)f(B[q].object),delete B[q];delete O[U]}delete a[L]}},releaseStatesOfGeometry:function z(L){if(void 0===a[L.id])return;const O=a[L.id];for(const U in O){const B=O[U];for(const q in B)f(B[q].object),delete B[q];delete O[U]}delete a[L.id]},releaseStatesOfProgram:function N(L){for(const O in a){const U=a[O];if(void 0===U[L.id])continue;const B=U[L.id];for(const q in B)f(B[q].object),delete B[q];delete U[L.id]}},initAttributes:m,enableAttribute:v,disableUnusedAttributes:b}}function gJ(n,e,t,i){const r=i.isWebGL2;let s;this.setMode=function o(c){s=c},this.render=function a(c,u){n.drawArrays(s,c,u),t.update(u,s,1)},this.renderInstances=function l(c,u,d){if(0===d)return;let h,f;if(r)h=n,f="drawArraysInstanced";else if(h=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",null===h)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[f](s,c,u,d),t.update(u,s,d)}}function _J(n,e,t){let i;function s(A){if("highp"===A){if(n.getShaderPrecisionFormat(35633,36338).precision>0&&n.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";A="mediump"}return"mediump"===A&&n.getShaderPrecisionFormat(35633,36337).precision>0&&n.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o="undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&n instanceof WebGL2ComputeRenderingContext;let a=void 0!==t.precision?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),u=!0===t.logarithmicDepthBuffer,d=n.getParameter(34930),h=n.getParameter(35660),f=n.getParameter(3379),p=n.getParameter(34076),_=n.getParameter(34921),y=n.getParameter(36347),g=n.getParameter(36348),m=n.getParameter(36349),v=h>0,w=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:function r(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const A=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(A.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:s,precision:a,logarithmicDepthBuffer:u,maxTextures:d,maxVertexTextures:h,maxTextureSize:f,maxCubemapSize:p,maxAttributes:_,maxVertexUniforms:y,maxVaryings:g,maxFragmentUniforms:m,vertexTextures:v,floatFragmentTextures:w,floatVertexTextures:v&&w,maxSamples:o?n.getParameter(36183):0}}function yJ(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new qs,a=new qn,l={value:null,needsUpdate:!1};function c(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function u(d,h,f,p){const _=null!==d?d.length:0;let y=null;if(0!==_){if(y=l.value,!0!==p||null===y){const g=f+4*_,m=h.matrixWorldInverse;a.getNormalMatrix(m),(null===y||y.length<g)&&(y=new Float32Array(g));for(let v=0,w=f;v!==_;++v,w+=4)o.copy(d[v]).applyMatrix4(m,a),o.normal.toArray(y,w),y[w+3]=o.constant}l.value=y,l.needsUpdate=!0}return e.numPlanes=_,e.numIntersection=0,y}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(d,h,f){const p=0!==d.length||h||0!==i||r;return r=h,t=u(d,f,0),i=d.length,p},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1,c()},this.setState=function(d,h,f){const p=d.clippingPlanes,_=d.clipIntersection,y=d.clipShadows,g=n.get(d);if(!r||null===p||0===p.length||s&&!y)s?u(null):c();else{const m=s?0:i,v=4*m;let w=g.clippingState||null;l.value=w,w=u(p,h,v,f);for(let b=0;b!==v;++b)w[b]=t[b];g.clippingState=w,this.numIntersection=_?this.numPlanes:0,this.numPlanes+=m}}}function vJ(n){let e=new WeakMap;function t(o,a){return 303===a?o.mapping=301:304===a&&(o.mapping=302),o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);void 0!==l&&(e.delete(a),l.dispose())}return{get:function i(o){if(o&&o.isTexture&&!1===o.isRenderTargetTexture){const a=o.mapping;if(303===a||304===a){if(e.has(o))return t(e.get(o).texture,o.mapping);{const l=o.image;if(l&&l.height>0){const c=new ox(l.height/2);return c.fromEquirectangularTexture(n,o),e.set(o,c),o.addEventListener("dispose",r),t(c.texture,o.mapping)}return null}}}return o},dispose:function s(){e=new WeakMap}}}as.physical={uniforms:ai([as.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new j(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new me(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new j},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new me(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new me(1,1,1)},specularColorMap:{value:null}}]),vertexShader:wt.meshphysical_vert,fragmentShader:wt.meshphysical_frag};class yh extends ng{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,l=r-t;if(null!==this.view&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}yh.prototype.isOrthographicCamera=!0;const KP=[.125,.215,.35,.446,.526,.582],lx=new yh,ZP=new me;let cx=null;const Ha=(1+Math.sqrt(5))/2,jc=1/Ha,e3=[new C(1,1,1),new C(-1,1,1),new C(1,1,-1),new C(-1,1,-1),new C(0,Ha,jc),new C(0,Ha,-jc),new C(jc,0,Ha),new C(-jc,0,Ha),new C(Ha,jc,0),new C(-Ha,jc,0)];class t3{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){cx=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=r3(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=i3(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(cx),e.scissorTest=!1,sg(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(301===e.mapping||302===e.mapping?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),cx=this._renderer.getRenderTarget();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize-32,i={magFilter:_n,minFilter:_n,generateMipmaps:!1,type:wc,format:vi,encoding:Io,depthBuffer:!1},r=n3(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=n3(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function wJ(n){const e=[],t=[],i=[];let r=n;const s=n-4+1+KP.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>n-4?l=KP[o-n+4-1]:0===o&&(l=0),i.push(l);const c=1/(a-1),u=-c/2,d=1+c/2,h=[u,u,d,u,d,d,u,u,d,d,u,d],f=6,p=6,_=3,y=2,g=1,m=new Float32Array(_*p*f),v=new Float32Array(y*p*f),w=new Float32Array(g*p*f);for(let T=0;T<f;T++){const A=T%3*2/3-1,P=T>2?0:-1;m.set([A,P,0,A+2/3,P,0,A+2/3,P+1,0,A,P,0,A+2/3,P+1,0,A,P+1,0],_*p*T),v.set(h,y*p*T),w.set([T,T,T,T,T,T],g*p*T)}const b=new Ve;b.setAttribute("position",new Ut(m,_)),b.setAttribute("uv",new Ut(v,y)),b.setAttribute("faceIndex",new Ut(w,g)),e.push(b),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}(s)),this._blurMaterial=function bJ(n,e,t){const i=new Float32Array(20),r=new C(0,1,0);return new Fr({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new nn(this._lodPlanes[0],e);this._renderer.compile(t,lx)}_sceneToCubeUV(e,t,i,r){const a=new Hn(90,1,t,i),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],u=this._renderer,d=u.autoClear,h=u.toneMapping;u.getClearColor(ZP),u.toneMapping=0,u.autoClear=!1;const f=new $s({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),p=new nn(new Vo,f);let _=!1;const y=e.background;y?y.isColor&&(f.color.copy(y),e.background=null,_=!0):(f.color.copy(ZP),_=!0);for(let g=0;g<6;g++){const m=g%3;0===m?(a.up.set(0,l[g],0),a.lookAt(c[g],0,0)):1===m?(a.up.set(0,0,l[g]),a.lookAt(0,c[g],0)):(a.up.set(0,l[g],0),a.lookAt(0,0,c[g]));const v=this._cubeSize;sg(r,m*v,g>2?v:0,v,v),u.setRenderTarget(r),_&&u.render(p,a),u.render(e,a)}p.geometry.dispose(),p.material.dispose(),u.toneMapping=h,u.autoClear=d,e.background=y}_textureToCubeUV(e,t){const i=this._renderer,r=301===e.mapping||302===e.mapping;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=r3()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=i3());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new nn(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const l=this._cubeSize;sg(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(o,lx)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,s,e3[(r-1)%e3.length])}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const l=this._renderer,c=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const d=new nn(this._lodPlanes[r],c),h=c.uniforms,f=this._sizeLods[i]-1,p=isFinite(s)?Math.PI/(2*f):2*Math.PI/39,_=s/p,y=isFinite(s)?1+Math.floor(3*_):20;y>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${y} samples when the maximum is set to 20`);const g=[];let m=0;for(let A=0;A<20;++A){const P=A/_,z=Math.exp(-P*P/2);g.push(z),0===A?m+=z:A<y&&(m+=2*z)}for(let A=0;A<g.length;A++)g[A]=g[A]/m;h.envMap.value=e.texture,h.samples.value=y,h.weights.value=g,h.latitudinal.value="latitudinal"===o,a&&(h.poleAxis.value=a);const{_lodMax:v}=this;h.dTheta.value=p,h.mipInt.value=v-i;const w=this._sizeLods[r];sg(t,3*w*(r>v-4?r-v+4:0),4*(this._cubeSize-w),3*w,2*w),l.setRenderTarget(t),l.render(d,lx)}}function n3(n,e,t){const i=new Pi(n,e,t);return i.texture.mapping=306,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function sg(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function i3(){return new Fr({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function r3(){return new Fr({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function xJ(n){let e=new WeakMap,t=null;function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);void 0!==c&&(e.delete(l),c.dispose())}return{get:function i(a){if(a&&a.isTexture){const l=a.mapping,c=303===l||304===l,u=301===l||302===l;if(c||u){if(a.isRenderTargetTexture&&!0===a.needsPMREMUpdate){a.needsPMREMUpdate=!1;let d=e.get(a);return null===t&&(t=new t3(n)),d=c?t.fromEquirectangular(a,d):t.fromCubemap(a,d),e.set(a,d),d.texture}if(e.has(a))return e.get(a).texture;{const d=a.image;if(c&&d&&d.height>0||u&&d&&function r(a){let l=0;for(let u=0;u<6;u++)void 0!==a[u]&&l++;return 6===l}(d)){null===t&&(t=new t3(n));const h=c?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,h),a.addEventListener("dispose",s),h.texture}return null}}}return a},dispose:function o(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function CJ(n){const e={};function t(i){if(void 0!==e[i])return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return null!==t(i)},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return null===r&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function MJ(n,e,t,i){const r={},s=new WeakMap;function o(d){const h=d.target;null!==h.index&&e.remove(h.index);for(const p in h.attributes)e.remove(h.attributes[p]);h.removeEventListener("dispose",o),delete r[h.id];const f=s.get(h);f&&(e.remove(f),s.delete(h)),i.releaseStatesOfGeometry(h),!0===h.isInstancedBufferGeometry&&delete h._maxInstanceCount,t.memory.geometries--}function c(d){const h=[],f=d.index,p=d.attributes.position;let _=0;if(null!==f){const m=f.array;_=f.version;for(let v=0,w=m.length;v<w;v+=3){const b=m[v+0],T=m[v+1],A=m[v+2];h.push(b,T,T,A,A,b)}}else{_=p.version;for(let v=0,w=p.array.length/3-1;v<w;v+=3){const b=v+0,T=v+1,A=v+2;h.push(b,T,T,A,A,b)}}const y=new(BP(h)?Kb:Jb)(h,1);y.version=_;const g=s.get(d);g&&e.remove(g),s.set(d,y)}return{get:function a(d,h){return!0===r[h.id]||(h.addEventListener("dispose",o),r[h.id]=!0,t.memory.geometries++),h},update:function l(d){const h=d.attributes;for(const p in h)e.update(h[p],34962);const f=d.morphAttributes;for(const p in f){const _=f[p];for(let y=0,g=_.length;y<g;y++)e.update(_[y],34962)}},getWireframeAttribute:function u(d){const h=s.get(d);if(h){const f=d.index;null!==f&&h.version<f.version&&c(d)}else c(d);return s.get(d)}}}function SJ(n,e,t,i){const r=i.isWebGL2;let s,a,l;this.setMode=function o(h){s=h},this.setIndex=function c(h){a=h.type,l=h.bytesPerElement},this.render=function u(h,f){n.drawElements(s,f,a,h*l),t.update(f,s,1)},this.renderInstances=function d(h,f,p){if(0===p)return;let _,y;if(r)_=n,y="drawElementsInstanced";else if(_=e.get("ANGLE_instanced_arrays"),y="drawElementsInstancedANGLE",null===_)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");_[y](s,f,a,h*l,p),t.update(f,s,p)}}function EJ(n){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function i(s,o,a){switch(t.calls++,o){case 4:t.triangles+=a*(s/3);break;case 1:t.lines+=a*(s/2);break;case 3:t.lines+=a*(s-1);break;case 2:t.lines+=a*s;break;case 0:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o)}}}}function TJ(n,e){return n[0]-e[0]}function DJ(n,e){return Math.abs(e[1])-Math.abs(n[1])}function dx(n,e){let t=1;const i=e.isInterleavedBufferAttribute?e.data.array:e.array;i instanceof Int8Array?t=127:i instanceof Int16Array?t=32767:i instanceof Int32Array?t=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",i),n.divideScalar(t)}function AJ(n,e,t){const i={},r=new Float32Array(8),s=new WeakMap,o=new Ft,a=[];for(let c=0;c<8;c++)a[c]=[c,0];return{update:function l(c,u,d,h){const f=c.morphTargetInfluences;if(!0===e.isWebGL2){const p=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,_=void 0!==p?p.length:0;let y=s.get(u);if(void 0===y||y.count!==_){let U=function(){L.dispose(),s.delete(u),u.removeEventListener("dispose",U)};void 0!==y&&y.texture.dispose();const v=void 0!==u.morphAttributes.position,w=void 0!==u.morphAttributes.normal,b=void 0!==u.morphAttributes.color,T=u.morphAttributes.position||[],A=u.morphAttributes.normal||[],P=u.morphAttributes.color||[];let z=0;!0===v&&(z=1),!0===w&&(z=2),!0===b&&(z=3);let N=u.attributes.position.count*z,x=1;N>e.maxTextureSize&&(x=Math.ceil(N/e.maxTextureSize),N=e.maxTextureSize);const D=new Float32Array(N*x*4*_),L=new fh(D,N,x,_);L.format=vi,L.type=Ao,L.needsUpdate=!0;const O=4*z;for(let B=0;B<_;B++){const q=T[B],F=A[B],Z=P[B],oe=N*x*4*B;for(let ae=0;ae<q.count;ae++){const ce=ae*O;!0===v&&(o.fromBufferAttribute(q,ae),!0===q.normalized&&dx(o,q),D[oe+ce+0]=o.x,D[oe+ce+1]=o.y,D[oe+ce+2]=o.z,D[oe+ce+3]=0),!0===w&&(o.fromBufferAttribute(F,ae),!0===F.normalized&&dx(o,F),D[oe+ce+4]=o.x,D[oe+ce+5]=o.y,D[oe+ce+6]=o.z,D[oe+ce+7]=0),!0===b&&(o.fromBufferAttribute(Z,ae),!0===Z.normalized&&dx(o,F),D[oe+ce+8]=o.x,D[oe+ce+9]=o.y,D[oe+ce+10]=o.z,D[oe+ce+11]=4===Z.itemSize?o.w:1)}}y={count:_,texture:L,size:new j(N,x)},s.set(u,y),u.addEventListener("dispose",U)}let g=0;for(let v=0;v<f.length;v++)g+=f[v];const m=u.morphTargetsRelative?1:1-g;h.getUniforms().setValue(n,"morphTargetBaseInfluence",m),h.getUniforms().setValue(n,"morphTargetInfluences",f),h.getUniforms().setValue(n,"morphTargetsTexture",y.texture,t),h.getUniforms().setValue(n,"morphTargetsTextureSize",y.size)}else{const p=void 0===f?0:f.length;let _=i[u.id];if(void 0===_||_.length!==p){_=[];for(let w=0;w<p;w++)_[w]=[w,0];i[u.id]=_}for(let w=0;w<p;w++){const b=_[w];b[0]=w,b[1]=f[w]}_.sort(DJ);for(let w=0;w<8;w++)w<p&&_[w][1]?(a[w][0]=_[w][0],a[w][1]=_[w][1]):(a[w][0]=Number.MAX_SAFE_INTEGER,a[w][1]=0);a.sort(TJ);const y=u.morphAttributes.position,g=u.morphAttributes.normal;let m=0;for(let w=0;w<8;w++){const b=a[w],T=b[0],A=b[1];T!==Number.MAX_SAFE_INTEGER&&A?(y&&u.getAttribute("morphTarget"+w)!==y[T]&&u.setAttribute("morphTarget"+w,y[T]),g&&u.getAttribute("morphNormal"+w)!==g[T]&&u.setAttribute("morphNormal"+w,g[T]),r[w]=A,m+=A):(y&&!0===u.hasAttribute("morphTarget"+w)&&u.deleteAttribute("morphTarget"+w),g&&!0===u.hasAttribute("morphNormal"+w)&&u.deleteAttribute("morphNormal"+w),r[w]=0)}const v=u.morphTargetsRelative?1:1-m;h.getUniforms().setValue(n,"morphTargetBaseInfluence",v),h.getUniforms().setValue(n,"morphTargetInfluences",r)}}}}function IJ(n,e,t,i){let r=new WeakMap;function a(l){const c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),null!==c.instanceColor&&t.remove(c.instanceColor)}return{update:function s(l){const c=i.render.frame,d=e.get(l,l.geometry);return r.get(d)!==c&&(e.update(d),r.set(d,c)),l.isInstancedMesh&&(!1===l.hasEventListener("dispose",a)&&l.addEventListener("dispose",a),t.update(l.instanceMatrix,34962),null!==l.instanceColor&&t.update(l.instanceColor,34962)),d},dispose:function o(){r=new WeakMap}}}const s3=new Ri,o3=new fh,a3=new Vm,l3=new _h,c3=[],u3=[],d3=new Float32Array(16),h3=new Float32Array(9),f3=new Float32Array(4);function $c(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=c3[r];if(void 0===s&&(s=new Float32Array(r),c3[r]=s),0!==e){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function wi(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function li(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function og(n,e){let t=u3[e];void 0===t&&(t=new Int32Array(e),u3[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function RJ(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function PJ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(wi(t,e))return;n.uniform2fv(this.addr,e),li(t,e)}}function NJ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(wi(t,e))return;n.uniform3fv(this.addr,e),li(t,e)}}function LJ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(wi(t,e))return;n.uniform4fv(this.addr,e),li(t,e)}}function OJ(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(wi(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),li(t,e)}else{if(wi(t,i))return;f3.set(i),n.uniformMatrix2fv(this.addr,!1,f3),li(t,i)}}function FJ(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(wi(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),li(t,e)}else{if(wi(t,i))return;h3.set(i),n.uniformMatrix3fv(this.addr,!1,h3),li(t,i)}}function kJ(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(wi(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),li(t,e)}else{if(wi(t,i))return;d3.set(i),n.uniformMatrix4fv(this.addr,!1,d3),li(t,i)}}function BJ(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function VJ(n,e){const t=this.cache;wi(t,e)||(n.uniform2iv(this.addr,e),li(t,e))}function UJ(n,e){const t=this.cache;wi(t,e)||(n.uniform3iv(this.addr,e),li(t,e))}function HJ(n,e){const t=this.cache;wi(t,e)||(n.uniform4iv(this.addr,e),li(t,e))}function zJ(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function GJ(n,e){const t=this.cache;wi(t,e)||(n.uniform2uiv(this.addr,e),li(t,e))}function WJ(n,e){const t=this.cache;wi(t,e)||(n.uniform3uiv(this.addr,e),li(t,e))}function jJ(n,e){const t=this.cache;wi(t,e)||(n.uniform4uiv(this.addr,e),li(t,e))}function $J(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2D(e||s3,r)}function qJ(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||a3,r)}function YJ(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||l3,r)}function XJ(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||o3,r)}function JJ(n,e){n.uniform1fv(this.addr,e)}function KJ(n,e){const t=$c(e,this.size,2);n.uniform2fv(this.addr,t)}function ZJ(n,e){const t=$c(e,this.size,3);n.uniform3fv(this.addr,t)}function eK(n,e){const t=$c(e,this.size,4);n.uniform4fv(this.addr,t)}function tK(n,e){const t=$c(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function nK(n,e){const t=$c(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function iK(n,e){const t=$c(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function rK(n,e){n.uniform1iv(this.addr,e)}function sK(n,e){n.uniform2iv(this.addr,e)}function oK(n,e){n.uniform3iv(this.addr,e)}function aK(n,e){n.uniform4iv(this.addr,e)}function lK(n,e){n.uniform1uiv(this.addr,e)}function cK(n,e){n.uniform2uiv(this.addr,e)}function uK(n,e){n.uniform3uiv(this.addr,e)}function dK(n,e){n.uniform4uiv(this.addr,e)}function hK(n,e,t){const i=e.length,r=og(t,i);n.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)t.setTexture2D(e[s]||s3,r[s])}function fK(n,e,t){const i=e.length,r=og(t,i);n.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)t.setTexture3D(e[s]||a3,r[s])}function pK(n,e,t){const i=e.length,r=og(t,i);n.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)t.setTextureCube(e[s]||l3,r[s])}function mK(n,e,t){const i=e.length,r=og(t,i);n.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)t.setTexture2DArray(e[s]||o3,r[s])}function _K(n,e,t){this.id=n,this.addr=t,this.cache=[],this.setValue=function QJ(n){switch(n){case 5126:return RJ;case 35664:return PJ;case 35665:return NJ;case 35666:return LJ;case 35674:return OJ;case 35675:return FJ;case 35676:return kJ;case 5124:case 35670:return BJ;case 35667:case 35671:return VJ;case 35668:case 35672:return UJ;case 35669:case 35673:return HJ;case 5125:return zJ;case 36294:return GJ;case 36295:return WJ;case 36296:return jJ;case 35678:case 36198:case 36298:case 36306:case 35682:return $J;case 35679:case 36299:case 36307:return qJ;case 35680:case 36300:case 36308:case 36293:return YJ;case 36289:case 36303:case 36311:case 36292:return XJ}}(e.type)}function p3(n,e,t){this.id=n,this.addr=t,this.cache=[],this.size=e.size,this.setValue=function gK(n){switch(n){case 5126:return JJ;case 35664:return KJ;case 35665:return ZJ;case 35666:return eK;case 35674:return tK;case 35675:return nK;case 35676:return iK;case 5124:case 35670:return rK;case 35667:case 35671:return sK;case 35668:case 35672:return oK;case 35669:case 35673:return aK;case 5125:return lK;case 36294:return cK;case 36295:return uK;case 36296:return dK;case 35678:case 36198:case 36298:case 36306:case 35682:return hK;case 35679:case 36299:case 36307:return fK;case 35680:case 36300:case 36308:case 36293:return pK;case 36289:case 36303:case 36311:case 36292:return mK}}(e.type)}function m3(n){this.id=n,this.seq=[],this.map={}}p3.prototype.updateCache=function(n){const e=this.cache;n instanceof Float32Array&&e.length!==n.length&&(this.cache=new Float32Array(n.length)),li(e,n)},m3.prototype.setValue=function(n,e,t){const i=this.seq;for(let r=0,s=i.length;r!==s;++r){const o=i[r];o.setValue(n,e[o.id],t)}};const hx=/(\w+)(\])?(\[|\.)?/g;function g3(n,e){n.seq.push(e),n.map[e.id]=e}function yK(n,e,t){const i=n.name,r=i.length;for(hx.lastIndex=0;;){const s=hx.exec(i),o=hx.lastIndex;let a=s[1];const c=s[3];if("]"===s[2]&&(a|=0),void 0===c||"["===c&&o+2===r){g3(t,void 0===c?new _K(a,n,e):new p3(a,n,e));break}{let d=t.map[a];void 0===d&&(d=new m3(a),g3(t,d)),t=d}}}function Uo(n,e){this.seq=[],this.map={};const t=n.getProgramParameter(e,35718);for(let i=0;i<t;++i){const r=n.getActiveUniform(e,i);yK(r,n.getUniformLocation(e,r.name),this)}}function _3(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}Uo.prototype.setValue=function(n,e,t,i){const r=this.map[e];void 0!==r&&r.setValue(n,t,i)},Uo.prototype.setOptional=function(n,e,t){const i=e[t];void 0!==i&&this.setValue(n,t,i)},Uo.upload=function(n,e,t,i){for(let r=0,s=e.length;r!==s;++r){const o=e[r],a=t[o.id];!1!==a.needsUpdate&&o.setValue(n,a.value,i)}},Uo.seqWithValue=function(n,e){const t=[];for(let i=0,r=n.length;i!==r;++i){const s=n[i];s.id in e&&t.push(s)}return t};let vK=0;function y3(n,e,t){const i=n.getShaderParameter(e,35713),r=n.getShaderInfoLog(e).trim();return i&&""===r?"":t.toUpperCase()+"\n\n"+r+"\n\n"+function wK(n){const e=n.split("\n");for(let t=0;t<e.length;t++)e[t]=t+1+": "+e[t];return e.join("\n")}(n.getShaderSource(e))}function xK(n,e){const t=function bK(n){switch(n){case Io:return["Linear","( value )"];case cn:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",n),["Linear","( value )"]}}(e);return"vec4 "+n+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function CK(n,e){let t;switch(e){case 1:t="Linear";break;case 2:t="Reinhard";break;case 3:t="OptimizedCineon";break;case 4:t="ACESFilmic";break;case 5:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function vh(n){return""!==n}function v3(n,e){return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function w3(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const TK=/^[ \t]*#include +<([\w\d./]+)>/gm;function fx(n){return n.replace(TK,DK)}function DK(n,e){const t=wt[e];if(void 0===t)throw new Error("Can not resolve #include <"+e+">");return fx(t)}const AK=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,IK=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function b3(n){return n.replace(IK,x3).replace(AK,RK)}function RK(n,e,t,i){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),x3(0,e,t,i)}function x3(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function C3(n){let e="precision "+n.precision+" float;\nprecision "+n.precision+" int;";return"highp"===n.precision?e+="\n#define HIGH_PRECISION":"mediump"===n.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===n.precision&&(e+="\n#define LOW_PRECISION"),e}function kK(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=function PK(n){let e="SHADOWMAP_TYPE_BASIC";return 1===n.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===n.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===n.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(t),c=function NK(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:case 307:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),u=function LK(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case 302:case 307:e="ENVMAP_MODE_REFRACTION"}return e}(t),d=function OK(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(t),h=function FK(n){const e=n.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e/32+1)+3,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}(t),f=t.isWebGL2?"":function MK(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.tangentSpaceNormalMap||n.clearcoatNormalMap||n.flatShading||"physical"===n.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(vh).join("\n")}(t),p=function SK(n){const e=[];for(const t in n){const i=n[t];!1!==i&&e.push("#define "+t+" "+i)}return e.join("\n")}(s),_=r.createProgram();let y,g,m=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(y=[p].filter(vh).join("\n"),y.length>0&&(y+="\n"),g=[f,p].filter(vh).join("\n"),g.length>0&&(g+="\n")):(y=[C3(t),"#define SHADER_NAME "+t.shaderName,p,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define MAX_BONES "+t.maxBones,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.useVertexTexture?"#define BONE_TEXTURE":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(vh).join("\n"),g=[f,C3(t),"#define SHADER_NAME "+t.shaderName,p,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+u:"",t.envMap?"#define "+d:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==t.toneMapping?"#define TONE_MAPPING":"",0!==t.toneMapping?wt.tonemapping_pars_fragment:"",0!==t.toneMapping?CK("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",wt.encodings_pars_fragment,xK("linearToOutputTexel",t.outputEncoding),t.depthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(vh).join("\n")),o=fx(o),o=v3(o,t),o=w3(o,t),a=fx(a),a=v3(a,t),a=w3(a,t),o=b3(o),a=b3(a),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(m="#version 300 es\n",y=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+y,g=["#define varying in","300 es"===t.glslVersion?"":"layout(location = 0) out highp vec4 pc_fragColor;","300 es"===t.glslVersion?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+g);const w=m+g+a,b=_3(r,35633,m+y+o),T=_3(r,35632,w);if(r.attachShader(_,b),r.attachShader(_,T),void 0!==t.index0AttributeName?r.bindAttribLocation(_,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(_,0,"position"),r.linkProgram(_),n.debug.checkShaderErrors){const z=r.getProgramInfoLog(_).trim(),N=r.getShaderInfoLog(b).trim(),x=r.getShaderInfoLog(T).trim();let D=!0,L=!0;if(!1===r.getProgramParameter(_,35714)){D=!1;const O=y3(r,b,"vertex"),U=y3(r,T,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(_,35715)+"\n\nProgram Info Log: "+z+"\n"+O+"\n"+U)}else""!==z?console.warn("THREE.WebGLProgram: Program Info Log:",z):(""===N||""===x)&&(L=!1);L&&(this.diagnostics={runnable:D,programLog:z,vertexShader:{log:N,prefix:y},fragmentShader:{log:x,prefix:g}})}let A,P;return r.deleteShader(b),r.deleteShader(T),this.getUniforms=function(){return void 0===A&&(A=new Uo(r,_)),A},this.getAttributes=function(){return void 0===P&&(P=function EK(n,e){const t={},i=n.getProgramParameter(e,35721);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;35674===s.type&&(a=2),35675===s.type&&(a=3),35676===s.type&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}(r,_)),P},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(_),this.program=void 0},this.name=t.shaderName,this.id=vK++,this.cacheKey=e,this.usedTimes=1,this.program=_,this.vertexShader=b,this.fragmentShader=T,this}let BK=0;class VK{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(s)&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;return!1===t.has(e)&&t.set(e,new Set),t.get(e)}_getShaderStage(e){const t=this.shaderCache;if(!1===t.has(e)){const i=new UK;t.set(e,i)}return t.get(e)}}class UK{constructor(){this.id=BK++,this.usedTimes=0}}function HK(n,e,t,i,r,s,o){const a=new $b,l=new VK,c=[],u=r.isWebGL2,d=r.logarithmicDepthBuffer,h=r.floatVertexTextures,f=r.maxVertexUniforms,p=r.vertexTextures;let _=r.precision;const y={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function m(x,D,L,O,U){const B=O.fog,q=U.geometry,Z=(x.isMeshStandardMaterial?t:e).get(x.envMap||(x.isMeshStandardMaterial?O.environment:null)),oe=!Z||306!==Z.mapping&&307!==Z.mapping?null:Z.image.height,ae=y[x.type],ce=U.isSkinnedMesh?function g(x){const L=x.skeleton.bones;if(h)return 1024;{const U=Math.floor((f-20)/4),B=Math.min(U,L.length);return B<L.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+L.length+" bones. This GPU supports "+B+"."),0):B}}(U):0;null!==x.precision&&(_=r.getMaxPrecision(x.precision),_!==x.precision&&console.warn("THREE.WebGLProgram.getParameters:",x.precision,"not supported, using",_,"instead."));const Oe=q.morphAttributes.position||q.morphAttributes.normal||q.morphAttributes.color,xt=void 0!==Oe?Oe.length:0;let J,St,et,Ae,He=0;if(void 0!==q.morphAttributes.position&&(He=1),void 0!==q.morphAttributes.normal&&(He=2),void 0!==q.morphAttributes.color&&(He=3),ae){const de=as[ae];J=de.vertexShader,St=de.fragmentShader}else J=x.vertexShader,St=x.fragmentShader,l.update(x),et=l.getVertexShaderID(x),Ae=l.getFragmentShaderID(x);const Ie=n.getRenderTarget(),G=x.clearcoat>0;return{isWebGL2:u,shaderID:ae,shaderName:x.type,vertexShader:J,fragmentShader:St,defines:x.defines,customVertexShaderID:et,customFragmentShaderID:Ae,isRawShaderMaterial:!0===x.isRawShaderMaterial,glslVersion:x.glslVersion,precision:_,instancing:!0===U.isInstancedMesh,instancingColor:!0===U.isInstancedMesh&&null!==U.instanceColor,supportsVertexTextures:p,outputEncoding:null===Ie?n.outputEncoding:!0===Ie.isXRRenderTarget?Ie.texture.encoding:Io,map:!!x.map,matcap:!!x.matcap,envMap:!!Z,envMapMode:Z&&Z.mapping,envMapCubeUVHeight:oe,lightMap:!!x.lightMap,aoMap:!!x.aoMap,emissiveMap:!!x.emissiveMap,bumpMap:!!x.bumpMap,normalMap:!!x.normalMap,objectSpaceNormalMap:1===x.normalMapType,tangentSpaceNormalMap:0===x.normalMapType,decodeVideoTexture:!!x.map&&!0===x.map.isVideoTexture&&x.map.encoding===cn,clearcoat:G,clearcoatMap:G&&!!x.clearcoatMap,clearcoatRoughnessMap:G&&!!x.clearcoatRoughnessMap,clearcoatNormalMap:G&&!!x.clearcoatNormalMap,displacementMap:!!x.displacementMap,roughnessMap:!!x.roughnessMap,metalnessMap:!!x.metalnessMap,specularMap:!!x.specularMap,specularIntensityMap:!!x.specularIntensityMap,specularColorMap:!!x.specularColorMap,opaque:!1===x.transparent&&1===x.blending,alphaMap:!!x.alphaMap,alphaTest:x.alphaTest>0,gradientMap:!!x.gradientMap,sheen:x.sheen>0,sheenColorMap:!!x.sheenColorMap,sheenRoughnessMap:!!x.sheenRoughnessMap,transmission:x.transmission>0,transmissionMap:!!x.transmissionMap,thicknessMap:!!x.thicknessMap,combine:x.combine,vertexTangents:!!x.normalMap&&!!q.attributes.tangent,vertexColors:x.vertexColors,vertexAlphas:!0===x.vertexColors&&!!q.attributes.color&&4===q.attributes.color.itemSize,vertexUvs:!!(x.map||x.bumpMap||x.normalMap||x.specularMap||x.alphaMap||x.emissiveMap||x.roughnessMap||x.metalnessMap||x.clearcoatMap||x.clearcoatRoughnessMap||x.clearcoatNormalMap||x.displacementMap||x.transmissionMap||x.thicknessMap||x.specularIntensityMap||x.specularColorMap||x.sheenColorMap||x.sheenRoughnessMap),uvsVertexOnly:!(x.map||x.bumpMap||x.normalMap||x.specularMap||x.alphaMap||x.emissiveMap||x.roughnessMap||x.metalnessMap||x.clearcoatNormalMap||x.transmission>0||x.transmissionMap||x.thicknessMap||x.specularIntensityMap||x.specularColorMap||x.sheen>0||x.sheenColorMap||x.sheenRoughnessMap||!x.displacementMap),fog:!!B,useFog:x.fog,fogExp2:B&&B.isFogExp2,flatShading:!!x.flatShading,sizeAttenuation:x.sizeAttenuation,logarithmicDepthBuffer:d,skinning:!0===U.isSkinnedMesh&&ce>0,maxBones:ce,useVertexTexture:h,morphTargets:void 0!==q.morphAttributes.position,morphNormals:void 0!==q.morphAttributes.normal,morphColors:void 0!==q.morphAttributes.color,morphTargetsCount:xt,morphTextureStride:He,numDirLights:D.directional.length,numPointLights:D.point.length,numSpotLights:D.spot.length,numRectAreaLights:D.rectArea.length,numHemiLights:D.hemi.length,numDirLightShadows:D.directionalShadowMap.length,numPointLightShadows:D.pointShadowMap.length,numSpotLightShadows:D.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:x.dithering,shadowMapEnabled:n.shadowMap.enabled&&L.length>0,shadowMapType:n.shadowMap.type,toneMapping:x.toneMapped?n.toneMapping:0,physicallyCorrectLights:n.physicallyCorrectLights,premultipliedAlpha:x.premultipliedAlpha,doubleSided:2===x.side,flipSided:1===x.side,depthPacking:void 0!==x.depthPacking&&x.depthPacking,index0AttributeName:x.index0AttributeName,extensionDerivatives:x.extensions&&x.extensions.derivatives,extensionFragDepth:x.extensions&&x.extensions.fragDepth,extensionDrawBuffers:x.extensions&&x.extensions.drawBuffers,extensionShaderTextureLOD:x.extensions&&x.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),customProgramCacheKey:x.customProgramCacheKey()}},getProgramCacheKey:function v(x){const D=[];if(x.shaderID?D.push(x.shaderID):(D.push(x.customVertexShaderID),D.push(x.customFragmentShaderID)),void 0!==x.defines)for(const L in x.defines)D.push(L),D.push(x.defines[L]);return!1===x.isRawShaderMaterial&&(function w(x,D){x.push(D.precision),x.push(D.outputEncoding),x.push(D.envMapMode),x.push(D.envMapCubeUVHeight),x.push(D.combine),x.push(D.vertexUvs),x.push(D.fogExp2),x.push(D.sizeAttenuation),x.push(D.maxBones),x.push(D.morphTargetsCount),x.push(D.morphAttributeCount),x.push(D.numDirLights),x.push(D.numPointLights),x.push(D.numSpotLights),x.push(D.numHemiLights),x.push(D.numRectAreaLights),x.push(D.numDirLightShadows),x.push(D.numPointLightShadows),x.push(D.numSpotLightShadows),x.push(D.shadowMapType),x.push(D.toneMapping),x.push(D.numClippingPlanes),x.push(D.numClipIntersection)}(D,x),function b(x,D){a.disableAll(),D.isWebGL2&&a.enable(0),D.supportsVertexTextures&&a.enable(1),D.instancing&&a.enable(2),D.instancingColor&&a.enable(3),D.map&&a.enable(4),D.matcap&&a.enable(5),D.envMap&&a.enable(6),D.lightMap&&a.enable(7),D.aoMap&&a.enable(8),D.emissiveMap&&a.enable(9),D.bumpMap&&a.enable(10),D.normalMap&&a.enable(11),D.objectSpaceNormalMap&&a.enable(12),D.tangentSpaceNormalMap&&a.enable(13),D.clearcoat&&a.enable(14),D.clearcoatMap&&a.enable(15),D.clearcoatRoughnessMap&&a.enable(16),D.clearcoatNormalMap&&a.enable(17),D.displacementMap&&a.enable(18),D.specularMap&&a.enable(19),D.roughnessMap&&a.enable(20),D.metalnessMap&&a.enable(21),D.gradientMap&&a.enable(22),D.alphaMap&&a.enable(23),D.alphaTest&&a.enable(24),D.vertexColors&&a.enable(25),D.vertexAlphas&&a.enable(26),D.vertexUvs&&a.enable(27),D.vertexTangents&&a.enable(28),D.uvsVertexOnly&&a.enable(29),D.fog&&a.enable(30),x.push(a.mask),a.disableAll(),D.useFog&&a.enable(0),D.flatShading&&a.enable(1),D.logarithmicDepthBuffer&&a.enable(2),D.skinning&&a.enable(3),D.useVertexTexture&&a.enable(4),D.morphTargets&&a.enable(5),D.morphNormals&&a.enable(6),D.morphColors&&a.enable(7),D.premultipliedAlpha&&a.enable(8),D.shadowMapEnabled&&a.enable(9),D.physicallyCorrectLights&&a.enable(10),D.doubleSided&&a.enable(11),D.flipSided&&a.enable(12),D.depthPacking&&a.enable(13),D.dithering&&a.enable(14),D.specularIntensityMap&&a.enable(15),D.specularColorMap&&a.enable(16),D.transmission&&a.enable(17),D.transmissionMap&&a.enable(18),D.thicknessMap&&a.enable(19),D.sheen&&a.enable(20),D.sheenColorMap&&a.enable(21),D.sheenRoughnessMap&&a.enable(22),D.decodeVideoTexture&&a.enable(23),D.opaque&&a.enable(24),x.push(a.mask)}(D,x),D.push(n.outputEncoding)),D.push(x.customProgramCacheKey),D.join()},getUniforms:function T(x){const D=y[x.type];let L;return L=D?fX.clone(as[D].uniforms):x.uniforms,L},acquireProgram:function A(x,D){let L;for(let O=0,U=c.length;O<U;O++){const B=c[O];if(B.cacheKey===D){L=B,++L.usedTimes;break}}return void 0===L&&(L=new kK(n,D,x,s),c.push(L)),L},releaseProgram:function P(x){if(0==--x.usedTimes){const D=c.indexOf(x);c[D]=c[c.length-1],c.pop(),x.destroy()}},releaseShaderCache:function z(x){l.remove(x)},programs:c,dispose:function N(){l.dispose()}}}function zK(){let n=new WeakMap;return{get:function e(s){let o=n.get(s);return void 0===o&&(o={},n.set(s,o)),o},remove:function t(s){n.delete(s)},update:function i(s,o,a){n.get(s)[o]=a},dispose:function r(){n=new WeakMap}}}function GK(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function M3(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function S3(){const n=[];let e=0;const t=[],i=[],r=[];function o(d,h,f,p,_,y){let g=n[e];return void 0===g?(g={id:d.id,object:d,geometry:h,material:f,groupOrder:p,renderOrder:d.renderOrder,z:_,group:y},n[e]=g):(g.id=d.id,g.object=d,g.geometry=h,g.material=f,g.groupOrder=p,g.renderOrder=d.renderOrder,g.z=_,g.group=y),e++,g}return{opaque:t,transmissive:i,transparent:r,init:function s(){e=0,t.length=0,i.length=0,r.length=0},push:function a(d,h,f,p,_,y){const g=o(d,h,f,p,_,y);f.transmission>0?i.push(g):!0===f.transparent?r.push(g):t.push(g)},unshift:function l(d,h,f,p,_,y){const g=o(d,h,f,p,_,y);f.transmission>0?i.unshift(g):!0===f.transparent?r.unshift(g):t.unshift(g)},finish:function u(){for(let d=e,h=n.length;d<h;d++){const f=n[d];if(null===f.id)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}},sort:function c(d,h){t.length>1&&t.sort(d||GK),i.length>1&&i.sort(h||M3),r.length>1&&r.sort(h||M3)}}}function WK(){let n=new WeakMap;return{get:function e(i,r){let s;return!1===n.has(i)?(s=new S3,n.set(i,[s])):r>=n.get(i).length?(s=new S3,n.get(i).push(s)):s=n.get(i)[r],s},dispose:function t(){n=new WeakMap}}}function jK(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new C,color:new me};break;case"SpotLight":t={position:new C,direction:new C,color:new me,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new C,color:new me,distance:0,decay:0};break;case"HemisphereLight":t={direction:new C,skyColor:new me,groundColor:new me};break;case"RectAreaLight":t={color:new me,position:new C,halfWidth:new C,halfHeight:new C}}return n[e.id]=t,t}}}let qK=0;function YK(n,e){return(e.castShadow?1:0)-(n.castShadow?1:0)}function XK(n,e){const t=new jK,i=function $K(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new j};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new j,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let u=0;u<9;u++)r.probe.push(new C);const s=new C,o=new Pe,a=new Pe;return{setup:function l(u,d){let h=0,f=0,p=0;for(let z=0;z<9;z++)r.probe[z].set(0,0,0);let _=0,y=0,g=0,m=0,v=0,w=0,b=0,T=0;u.sort(YK);const A=!0!==d?Math.PI:1;for(let z=0,N=u.length;z<N;z++){const x=u[z],D=x.color,L=x.intensity,O=x.distance,U=x.shadow&&x.shadow.map?x.shadow.map.texture:null;if(x.isAmbientLight)h+=D.r*L*A,f+=D.g*L*A,p+=D.b*L*A;else if(x.isLightProbe)for(let B=0;B<9;B++)r.probe[B].addScaledVector(x.sh.coefficients[B],L);else if(x.isDirectionalLight){const B=t.get(x);if(B.color.copy(x.color).multiplyScalar(x.intensity*A),x.castShadow){const q=x.shadow,F=i.get(x);F.shadowBias=q.bias,F.shadowNormalBias=q.normalBias,F.shadowRadius=q.radius,F.shadowMapSize=q.mapSize,r.directionalShadow[_]=F,r.directionalShadowMap[_]=U,r.directionalShadowMatrix[_]=x.shadow.matrix,w++}r.directional[_]=B,_++}else if(x.isSpotLight){const B=t.get(x);if(B.position.setFromMatrixPosition(x.matrixWorld),B.color.copy(D).multiplyScalar(L*A),B.distance=O,B.coneCos=Math.cos(x.angle),B.penumbraCos=Math.cos(x.angle*(1-x.penumbra)),B.decay=x.decay,x.castShadow){const q=x.shadow,F=i.get(x);F.shadowBias=q.bias,F.shadowNormalBias=q.normalBias,F.shadowRadius=q.radius,F.shadowMapSize=q.mapSize,r.spotShadow[g]=F,r.spotShadowMap[g]=U,r.spotShadowMatrix[g]=x.shadow.matrix,T++}r.spot[g]=B,g++}else if(x.isRectAreaLight){const B=t.get(x);B.color.copy(D).multiplyScalar(L),B.halfWidth.set(.5*x.width,0,0),B.halfHeight.set(0,.5*x.height,0),r.rectArea[m]=B,m++}else if(x.isPointLight){const B=t.get(x);if(B.color.copy(x.color).multiplyScalar(x.intensity*A),B.distance=x.distance,B.decay=x.decay,x.castShadow){const q=x.shadow,F=i.get(x);F.shadowBias=q.bias,F.shadowNormalBias=q.normalBias,F.shadowRadius=q.radius,F.shadowMapSize=q.mapSize,F.shadowCameraNear=q.camera.near,F.shadowCameraFar=q.camera.far,r.pointShadow[y]=F,r.pointShadowMap[y]=U,r.pointShadowMatrix[y]=x.shadow.matrix,b++}r.point[y]=B,y++}else if(x.isHemisphereLight){const B=t.get(x);B.skyColor.copy(x.color).multiplyScalar(L*A),B.groundColor.copy(x.groundColor).multiplyScalar(L*A),r.hemi[v]=B,v++}}m>0&&(e.isWebGL2||!0===n.has("OES_texture_float_linear")?(r.rectAreaLTC1=ge.LTC_FLOAT_1,r.rectAreaLTC2=ge.LTC_FLOAT_2):!0===n.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=ge.LTC_HALF_1,r.rectAreaLTC2=ge.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=h,r.ambient[1]=f,r.ambient[2]=p;const P=r.hash;(P.directionalLength!==_||P.pointLength!==y||P.spotLength!==g||P.rectAreaLength!==m||P.hemiLength!==v||P.numDirectionalShadows!==w||P.numPointShadows!==b||P.numSpotShadows!==T)&&(r.directional.length=_,r.spot.length=g,r.rectArea.length=m,r.point.length=y,r.hemi.length=v,r.directionalShadow.length=w,r.directionalShadowMap.length=w,r.pointShadow.length=b,r.pointShadowMap.length=b,r.spotShadow.length=T,r.spotShadowMap.length=T,r.directionalShadowMatrix.length=w,r.pointShadowMatrix.length=b,r.spotShadowMatrix.length=T,P.directionalLength=_,P.pointLength=y,P.spotLength=g,P.rectAreaLength=m,P.hemiLength=v,P.numDirectionalShadows=w,P.numPointShadows=b,P.numSpotShadows=T,r.version=qK++)},setupView:function c(u,d){let h=0,f=0,p=0,_=0,y=0;const g=d.matrixWorldInverse;for(let m=0,v=u.length;m<v;m++){const w=u[m];if(w.isDirectionalLight){const b=r.directional[h];b.direction.setFromMatrixPosition(w.matrixWorld),s.setFromMatrixPosition(w.target.matrixWorld),b.direction.sub(s),b.direction.transformDirection(g),h++}else if(w.isSpotLight){const b=r.spot[p];b.position.setFromMatrixPosition(w.matrixWorld),b.position.applyMatrix4(g),b.direction.setFromMatrixPosition(w.matrixWorld),s.setFromMatrixPosition(w.target.matrixWorld),b.direction.sub(s),b.direction.transformDirection(g),p++}else if(w.isRectAreaLight){const b=r.rectArea[_];b.position.setFromMatrixPosition(w.matrixWorld),b.position.applyMatrix4(g),a.identity(),o.copy(w.matrixWorld),o.premultiply(g),a.extractRotation(o),b.halfWidth.set(.5*w.width,0,0),b.halfHeight.set(0,.5*w.height,0),b.halfWidth.applyMatrix4(a),b.halfHeight.applyMatrix4(a),_++}else if(w.isPointLight){const b=r.point[f];b.position.setFromMatrixPosition(w.matrixWorld),b.position.applyMatrix4(g),f++}else if(w.isHemisphereLight){const b=r.hemi[y];b.direction.setFromMatrixPosition(w.matrixWorld),b.direction.transformDirection(g),b.direction.normalize(),y++}}},state:r}}function E3(n,e){const t=new XK(n,e),i=[],r=[];return{init:function s(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:function l(d){t.setup(i,d)},setupLightsView:function c(d){t.setupView(i,d)},pushLight:function o(d){i.push(d)},pushShadow:function a(d){r.push(d)}}}function QK(n,e){let t=new WeakMap;return{get:function i(s,o=0){let a;return!1===t.has(s)?(a=new E3(n,e),t.set(s,[a])):o>=t.get(s).length?(a=new E3(n,e),t.get(s).push(a)):a=t.get(s)[o],a},dispose:function r(){t=new WeakMap}}}class px extends Pn{constructor(e){super(),this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}px.prototype.isMeshDepthMaterial=!0;class mx extends Pn{constructor(e){super(),this.type="MeshDistanceMaterial",this.referencePosition=new C,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function T3(n,e,t){let i=new rg;const r=new j,s=new j,o=new Ft,a=new px({depthPacking:3201}),l=new mx,c={},u=t.maxTextureSize,d={0:1,1:0,2:2},h=new Fr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new j},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=h.clone();f.defines.HORIZONTAL_PASS=1;const p=new Ve;p.setAttribute("position",new Ut(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const _=new nn(p,h),y=this;function g(w,b){const T=e.update(_);h.defines.VSM_SAMPLES!==w.blurSamples&&(h.defines.VSM_SAMPLES=w.blurSamples,f.defines.VSM_SAMPLES=w.blurSamples,h.needsUpdate=!0,f.needsUpdate=!0),h.uniforms.shadow_pass.value=w.map.texture,h.uniforms.resolution.value=w.mapSize,h.uniforms.radius.value=w.radius,n.setRenderTarget(w.mapPass),n.clear(),n.renderBufferDirect(b,null,T,h,_,null),f.uniforms.shadow_pass.value=w.mapPass.texture,f.uniforms.resolution.value=w.mapSize,f.uniforms.radius.value=w.radius,n.setRenderTarget(w.map),n.clear(),n.renderBufferDirect(b,null,T,f,_,null)}function m(w,b,T,A,P,z){let N=null;const x=!0===T.isPointLight?w.customDistanceMaterial:w.customDepthMaterial;if(N=void 0!==x?x:!0===T.isPointLight?l:a,n.localClippingEnabled&&!0===b.clipShadows&&0!==b.clippingPlanes.length||b.displacementMap&&0!==b.displacementScale||b.alphaMap&&b.alphaTest>0){const D=N.uuid,L=b.uuid;let O=c[D];void 0===O&&(O={},c[D]=O);let U=O[L];void 0===U&&(U=N.clone(),O[L]=U),N=U}return N.visible=b.visible,N.wireframe=b.wireframe,N.side=3===z?null!==b.shadowSide?b.shadowSide:b.side:null!==b.shadowSide?b.shadowSide:d[b.side],N.alphaMap=b.alphaMap,N.alphaTest=b.alphaTest,N.clipShadows=b.clipShadows,N.clippingPlanes=b.clippingPlanes,N.clipIntersection=b.clipIntersection,N.displacementMap=b.displacementMap,N.displacementScale=b.displacementScale,N.displacementBias=b.displacementBias,N.wireframeLinewidth=b.wireframeLinewidth,N.linewidth=b.linewidth,!0===T.isPointLight&&!0===N.isMeshDistanceMaterial&&(N.referencePosition.setFromMatrixPosition(T.matrixWorld),N.nearDistance=A,N.farDistance=P),N}function v(w,b,T,A,P){if(!1===w.visible)return;if(w.layers.test(b.layers)&&(w.isMesh||w.isLine||w.isPoints)&&(w.castShadow||w.receiveShadow&&3===P)&&(!w.frustumCulled||i.intersectsObject(w))){w.modelViewMatrix.multiplyMatrices(T.matrixWorldInverse,w.matrixWorld);const x=e.update(w),D=w.material;if(Array.isArray(D)){const L=x.groups;for(let O=0,U=L.length;O<U;O++){const B=L[O],q=D[B.materialIndex];if(q&&q.visible){const F=m(w,q,A,T.near,T.far,P);n.renderBufferDirect(T,null,x,F,w,B)}}}else if(D.visible){const L=m(w,D,A,T.near,T.far,P);n.renderBufferDirect(T,null,x,L,w,null)}}const N=w.children;for(let x=0,D=N.length;x<D;x++)v(N[x],b,T,A,P)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(w,b,T){if(!1===y.enabled||!1===y.autoUpdate&&!1===y.needsUpdate||0===w.length)return;const A=n.getRenderTarget(),P=n.getActiveCubeFace(),z=n.getActiveMipmapLevel(),N=n.state;N.setBlending(0),N.buffers.color.setClear(1,1,1,1),N.buffers.depth.setTest(!0),N.setScissorTest(!1);for(let x=0,D=w.length;x<D;x++){const L=w[x],O=L.shadow;if(void 0===O){console.warn("THREE.WebGLShadowMap:",L,"has no shadow.");continue}if(!1===O.autoUpdate&&!1===O.needsUpdate)continue;r.copy(O.mapSize);const U=O.getFrameExtents();if(r.multiply(U),s.copy(O.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/U.x),r.x=s.x*U.x,O.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/U.y),r.y=s.y*U.y,O.mapSize.y=s.y)),null===O.map&&!O.isPointLightShadow&&3===this.type){const q={minFilter:_n,magFilter:_n,format:vi};O.map=new Pi(r.x,r.y,q),O.map.texture.name=L.name+".shadowMap",O.mapPass=new Pi(r.x,r.y,q),O.camera.updateProjectionMatrix()}null===O.map&&(O.map=new Pi(r.x,r.y,{minFilter:Un,magFilter:Un,format:vi}),O.map.texture.name=L.name+".shadowMap",O.camera.updateProjectionMatrix()),n.setRenderTarget(O.map),n.clear();const B=O.getViewportCount();for(let q=0;q<B;q++){const F=O.getViewport(q);o.set(s.x*F.x,s.y*F.y,s.x*F.z,s.y*F.w),N.viewport(o),O.updateMatrices(L,q),i=O.getFrustum(),v(b,T,O.camera,L,this.type)}!O.isPointLightShadow&&3===this.type&&g(O,T),O.needsUpdate=!1}y.needsUpdate=!1,n.setRenderTarget(A,P,z)}}function ZK(n,e,t){const i=t.isWebGL2,a=new function r(){let I=!1;const xe=new Ft;let ye=null;const qe=new Ft(0,0,0,0);return{setMask:function(fe){ye!==fe&&!I&&(n.colorMask(fe,fe,fe,fe),ye=fe)},setLocked:function(fe){I=fe},setClear:function(fe,re,Ze,Et,xi){!0===xi&&(fe*=Et,re*=Et,Ze*=Et),xe.set(fe,re,Ze,Et),!1===qe.equals(xe)&&(n.clearColor(fe,re,Ze,Et),qe.copy(xe))},reset:function(){I=!1,ye=null,qe.set(-1,0,0,0)}}},l=new function s(){let I=!1,xe=null,ye=null,qe=null;return{setTest:function(fe){fe?He(2929):J(2929)},setMask:function(fe){xe!==fe&&!I&&(n.depthMask(fe),xe=fe)},setFunc:function(fe){if(ye!==fe){if(fe)switch(fe){case 0:n.depthFunc(512);break;case 1:n.depthFunc(519);break;case 2:n.depthFunc(513);break;case 3:default:n.depthFunc(515);break;case 4:n.depthFunc(514);break;case 5:n.depthFunc(518);break;case 6:n.depthFunc(516);break;case 7:n.depthFunc(517)}else n.depthFunc(515);ye=fe}},setLocked:function(fe){I=fe},setClear:function(fe){qe!==fe&&(n.clearDepth(fe),qe=fe)},reset:function(){I=!1,xe=null,ye=null,qe=null}}},c=new function o(){let I=!1,xe=null,ye=null,qe=null,fe=null,re=null,Ze=null,Et=null,xi=null;return{setTest:function($t){I||($t?He(2960):J(2960))},setMask:function($t){xe!==$t&&!I&&(n.stencilMask($t),xe=$t)},setFunc:function($t,hs,fs){(ye!==$t||qe!==hs||fe!==fs)&&(n.stencilFunc($t,hs,fs),ye=$t,qe=hs,fe=fs)},setOp:function($t,hs,fs){(re!==$t||Ze!==hs||Et!==fs)&&(n.stencilOp($t,hs,fs),re=$t,Ze=hs,Et=fs)},setLocked:function($t){I=$t},setClear:function($t){xi!==$t&&(n.clearStencil($t),xi=$t)},reset:function(){I=!1,xe=null,ye=null,qe=null,fe=null,re=null,Ze=null,Et=null,xi=null}}};let u={},d={},h=new WeakMap,f=[],p=null,_=!1,y=null,g=null,m=null,v=null,w=null,b=null,T=null,A=!1,P=null,z=null,N=null,x=null,D=null;const L=n.getParameter(35661);let O=!1,U=0;const B=n.getParameter(7938);-1!==B.indexOf("WebGL")?(U=parseFloat(/^WebGL (\d)/.exec(B)[1]),O=U>=1):-1!==B.indexOf("OpenGL ES")&&(U=parseFloat(/^OpenGL ES (\d)/.exec(B)[1]),O=U>=2);let q=null,F={};const Z=n.getParameter(3088),oe=n.getParameter(2978),ae=(new Ft).fromArray(Z),ce=(new Ft).fromArray(oe);function Oe(I,xe,ye){const qe=new Uint8Array(4),fe=n.createTexture();n.bindTexture(I,fe),n.texParameteri(I,10241,9728),n.texParameteri(I,10240,9728);for(let re=0;re<ye;re++)n.texImage2D(xe+re,0,6408,1,1,0,6408,5121,qe);return fe}const xt={};function He(I){!0!==u[I]&&(n.enable(I),u[I]=!0)}function J(I){!1!==u[I]&&(n.disable(I),u[I]=!1)}xt[3553]=Oe(3553,3553,1),xt[34067]=Oe(34067,34069,6),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),He(2929),l.setFunc(3),de(!1),Te(1),He(2884),G(0);const Ie={100:32774,101:32778,102:32779};if(i)Ie[103]=32775,Ie[104]=32776;else{const I=e.get("EXT_blend_minmax");null!==I&&(Ie[103]=I.MIN_EXT,Ie[104]=I.MAX_EXT)}const _t={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function G(I,xe,ye,qe,fe,re,Ze,Et){if(0!==I){if(!1===_&&(He(3042),_=!0),5===I)fe=fe||xe,re=re||ye,Ze=Ze||qe,(xe!==g||fe!==w)&&(n.blendEquationSeparate(Ie[xe],Ie[fe]),g=xe,w=fe),(ye!==m||qe!==v||re!==b||Ze!==T)&&(n.blendFuncSeparate(_t[ye],_t[qe],_t[re],_t[Ze]),m=ye,v=qe,b=re,T=Ze),y=I,A=null;else if(I!==y||Et!==A){if((100!==g||100!==w)&&(n.blendEquation(32774),g=100,w=100),Et)switch(I){case 1:n.blendFuncSeparate(1,771,1,771);break;case 2:n.blendFunc(1,1);break;case 3:n.blendFuncSeparate(0,769,0,1);break;case 4:n.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",I)}else switch(I){case 1:n.blendFuncSeparate(770,771,1,771);break;case 2:n.blendFunc(770,1);break;case 3:n.blendFuncSeparate(0,769,0,1);break;case 4:n.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",I)}m=null,v=null,b=null,T=null,y=I,A=Et}}else!0===_&&(J(3042),_=!1)}function de(I){P!==I&&(n.frontFace(I?2304:2305),P=I)}function Te(I){0!==I?(He(2884),I!==z&&n.cullFace(1===I?1029:2===I?1028:1032)):J(2884),z=I}function ze(I,xe,ye){I?(He(32823),(x!==xe||D!==ye)&&(n.polygonOffset(xe,ye),x=xe,D=ye)):J(32823)}function ot(I){void 0===I&&(I=33984+L-1),q!==I&&(n.activeTexture(I),q=I)}return{buffers:{color:a,depth:l,stencil:c},enable:He,disable:J,bindFramebuffer:function St(I,xe){return d[I]!==xe&&(n.bindFramebuffer(I,xe),d[I]=xe,i&&(36009===I&&(d[36160]=xe),36160===I&&(d[36009]=xe)),!0)},drawBuffers:function et(I,xe){let ye=f,qe=!1;if(I)if(ye=h.get(xe),void 0===ye&&(ye=[],h.set(xe,ye)),I.isWebGLMultipleRenderTargets){const fe=I.texture;if(ye.length!==fe.length||36064!==ye[0]){for(let re=0,Ze=fe.length;re<Ze;re++)ye[re]=36064+re;ye.length=fe.length,qe=!0}}else 36064!==ye[0]&&(ye[0]=36064,qe=!0);else 1029!==ye[0]&&(ye[0]=1029,qe=!0);qe&&(t.isWebGL2?n.drawBuffers(ye):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(ye))},useProgram:function Ae(I){return p!==I&&(n.useProgram(I),p=I,!0)},setBlending:G,setMaterial:function se(I,xe){2===I.side?J(2884):He(2884);let ye=1===I.side;xe&&(ye=!ye),de(ye),1===I.blending&&!1===I.transparent?G(0):G(I.blending,I.blendEquation,I.blendSrc,I.blendDst,I.blendEquationAlpha,I.blendSrcAlpha,I.blendDstAlpha,I.premultipliedAlpha),l.setFunc(I.depthFunc),l.setTest(I.depthTest),l.setMask(I.depthWrite),a.setMask(I.colorWrite);const qe=I.stencilWrite;c.setTest(qe),qe&&(c.setMask(I.stencilWriteMask),c.setFunc(I.stencilFunc,I.stencilRef,I.stencilFuncMask),c.setOp(I.stencilFail,I.stencilZFail,I.stencilZPass)),ze(I.polygonOffset,I.polygonOffsetFactor,I.polygonOffsetUnits),!0===I.alphaToCoverage?He(32926):J(32926)},setFlipSided:de,setCullFace:Te,setLineWidth:function we(I){I!==N&&(O&&n.lineWidth(I),N=I)},setPolygonOffset:ze,setScissorTest:function Le(I){I?He(3089):J(3089)},activeTexture:ot,bindTexture:function jt(I,xe){null===q&&ot();let ye=F[q];void 0===ye&&(ye={type:void 0,texture:void 0},F[q]=ye),(ye.type!==I||ye.texture!==xe)&&(n.bindTexture(I,xe||xt[I]),ye.type=I,ye.texture=xe)},unbindTexture:function E(){const I=F[q];void 0!==I&&void 0!==I.type&&(n.bindTexture(I.type,null),I.type=void 0,I.texture=void 0)},compressedTexImage2D:function M(){try{n.compressedTexImage2D.apply(n,arguments)}catch(I){console.error("THREE.WebGLState:",I)}},texImage2D:function Q(){try{n.texImage2D.apply(n,arguments)}catch(I){console.error("THREE.WebGLState:",I)}},texImage3D:function R(){try{n.texImage3D.apply(n,arguments)}catch(I){console.error("THREE.WebGLState:",I)}},texStorage2D:function Se(){try{n.texStorage2D.apply(n,arguments)}catch(I){console.error("THREE.WebGLState:",I)}},texStorage3D:function Fe(){try{n.texStorage3D.apply(n,arguments)}catch(I){console.error("THREE.WebGLState:",I)}},texSubImage2D:function X(){try{n.texSubImage2D.apply(n,arguments)}catch(I){console.error("THREE.WebGLState:",I)}},texSubImage3D:function ee(){try{n.texSubImage3D.apply(n,arguments)}catch(I){console.error("THREE.WebGLState:",I)}},compressedTexSubImage2D:function he(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(I){console.error("THREE.WebGLState:",I)}},scissor:function le(I){!1===ae.equals(I)&&(n.scissor(I.x,I.y,I.z,I.w),ae.copy(I))},viewport:function Ce(I){!1===ce.equals(I)&&(n.viewport(I.x,I.y,I.z,I.w),ce.copy(I))},reset:function _e(){n.disable(3042),n.disable(2884),n.disable(2929),n.disable(32823),n.disable(3089),n.disable(2960),n.disable(32926),n.blendEquation(32774),n.blendFunc(1,0),n.blendFuncSeparate(1,0,1,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(513),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(519,0,4294967295),n.stencilOp(7680,7680,7680),n.clearStencil(0),n.cullFace(1029),n.frontFace(2305),n.polygonOffset(0,0),n.activeTexture(33984),n.bindFramebuffer(36160,null),!0===i&&(n.bindFramebuffer(36009,null),n.bindFramebuffer(36008,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),u={},q=null,F={},d={},h=new WeakMap,f=[],p=null,_=!1,y=null,g=null,m=null,v=null,w=null,b=null,T=null,A=!1,P=null,z=null,N=null,x=null,D=null,ae.set(0,0,n.canvas.width,n.canvas.height),ce.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),c.reset()}}}function eZ(n,e,t,i,r,s,o){const a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,u=r.maxTextureSize,d=r.maxSamples,h=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=new WeakMap;let p;const _=new WeakMap;let y=!1;try{y="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(E){}function g(E,M){return y?new OffscreenCanvas(E,M):hh("canvas")}function m(E,M,X,ee){let he=1;if((E.width>ee||E.height>ee)&&(he=ee/Math.max(E.width,E.height)),he<1||!0===M){if("undefined"!=typeof HTMLImageElement&&E instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&E instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&E instanceof ImageBitmap){const Se=M?km:Math.floor,Fe=Se(he*E.width),Q=Se(he*E.height);void 0===p&&(p=g(Fe,Q));const R=X?g(Fe,Q):p;return R.width=Fe,R.height=Q,R.getContext("2d").drawImage(E,0,0,Fe,Q),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+E.width+"x"+E.height+") to ("+Fe+"x"+Q+")."),R}return"data"in E&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+E.width+"x"+E.height+")."),E}return E}function v(E){return Ob(E.width)&&Ob(E.height)}function b(E,M){return E.generateMipmaps&&M&&E.minFilter!==Un&&E.minFilter!==_n}function T(E){n.generateMipmap(E)}function A(E,M,X,ee,he=!1){if(!1===a)return M;if(null!==E){if(void 0!==n[E])return n[E];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+E+"'")}let Se=M;return 6403===M&&(5126===X&&(Se=33326),5131===X&&(Se=33325),5121===X&&(Se=33321)),33319===M&&(5126===X&&(Se=33328),5131===X&&(Se=33327),5121===X&&(Se=33323)),6408===M&&(5126===X&&(Se=34836),5131===X&&(Se=34842),5121===X&&(Se=ee===cn&&!1===he?35907:32856),32819===X&&(Se=32854),32820===X&&(Se=32855)),(33325===Se||33326===Se||33327===Se||33328===Se||34842===Se||34836===Se)&&e.get("EXT_color_buffer_float"),Se}function P(E,M,X){return!0===b(E,X)||E.isFramebufferTexture&&E.minFilter!==Un&&E.minFilter!==_n?Math.log2(Math.max(M.width,M.height))+1:void 0!==E.mipmaps&&E.mipmaps.length>0?E.mipmaps.length:E.isCompressedTexture&&Array.isArray(E.image)?M.mipmaps.length:1}function z(E){return E===Un||1004===E||1005===E?9728:9729}function N(E){const M=E.target;M.removeEventListener("dispose",N),function D(E){const M=i.get(E);if(void 0===M.__webglInit)return;const X=E.source,ee=_.get(X);if(ee){const he=ee[M.__cacheKey];he.usedTimes--,0===he.usedTimes&&L(E),0===Object.keys(ee).length&&_.delete(X)}i.remove(E)}(M),M.isVideoTexture&&f.delete(M)}function x(E){const M=E.target;M.removeEventListener("dispose",x),function O(E){const M=E.texture,X=i.get(E),ee=i.get(M);if(void 0!==ee.__webglTexture&&(n.deleteTexture(ee.__webglTexture),o.memory.textures--),E.depthTexture&&E.depthTexture.dispose(),E.isWebGLCubeRenderTarget)for(let he=0;he<6;he++)n.deleteFramebuffer(X.__webglFramebuffer[he]),X.__webglDepthbuffer&&n.deleteRenderbuffer(X.__webglDepthbuffer[he]);else n.deleteFramebuffer(X.__webglFramebuffer),X.__webglDepthbuffer&&n.deleteRenderbuffer(X.__webglDepthbuffer),X.__webglMultisampledFramebuffer&&n.deleteFramebuffer(X.__webglMultisampledFramebuffer),X.__webglColorRenderbuffer&&n.deleteRenderbuffer(X.__webglColorRenderbuffer),X.__webglDepthRenderbuffer&&n.deleteRenderbuffer(X.__webglDepthRenderbuffer);if(E.isWebGLMultipleRenderTargets)for(let he=0,Se=M.length;he<Se;he++){const Fe=i.get(M[he]);Fe.__webglTexture&&(n.deleteTexture(Fe.__webglTexture),o.memory.textures--),i.remove(M[he])}i.remove(M),i.remove(E)}(M)}function L(E){const M=i.get(E);n.deleteTexture(M.__webglTexture),delete _.get(E.source)[M.__cacheKey],o.memory.textures--}let U=0;function Z(E,M){const X=i.get(E);if(E.isVideoTexture&&function ot(E){const M=o.render.frame;f.get(E)!==M&&(f.set(E,M),E.update())}(E),!1===E.isRenderTargetTexture&&E.version>0&&X.__version!==E.version){const ee=E.image;if(null===ee)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==ee.complete)return void St(X,E,M);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.activeTexture(33984+M),t.bindTexture(3553,X.__webglTexture)}const Oe={1e3:10497,[Ii]:33071,1002:33648},xt={[Un]:9728,1004:9984,1005:9986,[_n]:9729,1007:9985,1008:9987};function He(E,M,X){if(X?(n.texParameteri(E,10242,Oe[M.wrapS]),n.texParameteri(E,10243,Oe[M.wrapT]),(32879===E||35866===E)&&n.texParameteri(E,32882,Oe[M.wrapR]),n.texParameteri(E,10240,xt[M.magFilter]),n.texParameteri(E,10241,xt[M.minFilter])):(n.texParameteri(E,10242,33071),n.texParameteri(E,10243,33071),(32879===E||35866===E)&&n.texParameteri(E,32882,33071),(M.wrapS!==Ii||M.wrapT!==Ii)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(E,10240,z(M.magFilter)),n.texParameteri(E,10241,z(M.minFilter)),M.minFilter!==Un&&M.minFilter!==_n&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const ee=e.get("EXT_texture_filter_anisotropic");if(M.type===Ao&&!1===e.has("OES_texture_float_linear")||!1===a&&M.type===wc&&!1===e.has("OES_texture_half_float_linear"))return;(M.anisotropy>1||i.get(M).__currentAnisotropy)&&(n.texParameterf(E,ee.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(M.anisotropy,r.getMaxAnisotropy())),i.get(M).__currentAnisotropy=M.anisotropy)}}function J(E,M){let X=!1;void 0===E.__webglInit&&(E.__webglInit=!0,M.addEventListener("dispose",N));const ee=M.source;let he=_.get(ee);void 0===he&&(he={},_.set(ee,he));const Se=function F(E){const M=[];return M.push(E.wrapS),M.push(E.wrapT),M.push(E.magFilter),M.push(E.minFilter),M.push(E.anisotropy),M.push(E.internalFormat),M.push(E.format),M.push(E.type),M.push(E.generateMipmaps),M.push(E.premultiplyAlpha),M.push(E.flipY),M.push(E.unpackAlignment),M.push(E.encoding),M.join()}(M);if(Se!==E.__cacheKey){void 0===he[Se]&&(he[Se]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,X=!0),he[Se].usedTimes++;const Fe=he[E.__cacheKey];void 0!==Fe&&(he[E.__cacheKey].usedTimes--,0===Fe.usedTimes&&L(M)),E.__cacheKey=Se,E.__webglTexture=he[Se].texture}return X}function St(E,M,X){let ee=3553;M.isDataArrayTexture&&(ee=35866),M.isData3DTexture&&(ee=32879);const he=J(E,M),Se=M.source;if(t.activeTexture(33984+X),t.bindTexture(ee,E.__webglTexture),Se.version!==Se.__currentVersion||!0===he){n.pixelStorei(37440,M.flipY),n.pixelStorei(37441,M.premultiplyAlpha),n.pixelStorei(3317,M.unpackAlignment),n.pixelStorei(37443,0);const Fe=function w(E){return!a&&(E.wrapS!==Ii||E.wrapT!==Ii||E.minFilter!==Un&&E.minFilter!==_n)}(M)&&!1===v(M.image);let Q=m(M.image,Fe,!1,u);Q=jt(M,Q);const R=v(Q)||a,le=s.convert(M.format,M.encoding);let I,Ce=s.convert(M.type),_e=A(M.internalFormat,le,Ce,M.encoding,M.isVideoTexture);He(ee,M,R);const xe=M.mipmaps,ye=a&&!0!==M.isVideoTexture,qe=void 0===E.__version,fe=P(M,Q,R);if(M.isDepthTexture)_e=6402,a?_e=M.type===Ao?36012:1014===M.type?33190:M.type===bc?35056:33189:M.type===Ao&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),M.format===Ra&&6402===_e&&M.type!==ah&&1014!==M.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),M.type=ah,Ce=s.convert(M.type)),M.format===xc&&6402===_e&&(_e=34041,M.type!==bc&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),M.type=bc,Ce=s.convert(M.type))),ye&&qe?t.texStorage2D(3553,1,_e,Q.width,Q.height):t.texImage2D(3553,0,_e,Q.width,Q.height,0,le,Ce,null);else if(M.isDataTexture)if(xe.length>0&&R){ye&&qe&&t.texStorage2D(3553,fe,_e,xe[0].width,xe[0].height);for(let re=0,Ze=xe.length;re<Ze;re++)I=xe[re],ye?t.texSubImage2D(3553,re,0,0,I.width,I.height,le,Ce,I.data):t.texImage2D(3553,re,_e,I.width,I.height,0,le,Ce,I.data);M.generateMipmaps=!1}else ye?(qe&&t.texStorage2D(3553,fe,_e,Q.width,Q.height),t.texSubImage2D(3553,0,0,0,Q.width,Q.height,le,Ce,Q.data)):t.texImage2D(3553,0,_e,Q.width,Q.height,0,le,Ce,Q.data);else if(M.isCompressedTexture){ye&&qe&&t.texStorage2D(3553,fe,_e,xe[0].width,xe[0].height);for(let re=0,Ze=xe.length;re<Ze;re++)I=xe[re],M.format!==vi?null!==le?ye?t.compressedTexSubImage2D(3553,re,0,0,I.width,I.height,le,I.data):t.compressedTexImage2D(3553,re,_e,I.width,I.height,0,I.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ye?t.texSubImage2D(3553,re,0,0,I.width,I.height,le,Ce,I.data):t.texImage2D(3553,re,_e,I.width,I.height,0,le,Ce,I.data)}else if(M.isDataArrayTexture)ye?(qe&&t.texStorage3D(35866,fe,_e,Q.width,Q.height,Q.depth),t.texSubImage3D(35866,0,0,0,0,Q.width,Q.height,Q.depth,le,Ce,Q.data)):t.texImage3D(35866,0,_e,Q.width,Q.height,Q.depth,0,le,Ce,Q.data);else if(M.isData3DTexture)ye?(qe&&t.texStorage3D(32879,fe,_e,Q.width,Q.height,Q.depth),t.texSubImage3D(32879,0,0,0,0,Q.width,Q.height,Q.depth,le,Ce,Q.data)):t.texImage3D(32879,0,_e,Q.width,Q.height,Q.depth,0,le,Ce,Q.data);else if(M.isFramebufferTexture)ye&&qe?t.texStorage2D(3553,fe,_e,Q.width,Q.height):t.texImage2D(3553,0,_e,Q.width,Q.height,0,le,Ce,null);else if(xe.length>0&&R){ye&&qe&&t.texStorage2D(3553,fe,_e,xe[0].width,xe[0].height);for(let re=0,Ze=xe.length;re<Ze;re++)I=xe[re],ye?t.texSubImage2D(3553,re,0,0,le,Ce,I):t.texImage2D(3553,re,_e,le,Ce,I);M.generateMipmaps=!1}else ye?(qe&&t.texStorage2D(3553,fe,_e,Q.width,Q.height),t.texSubImage2D(3553,0,0,0,le,Ce,Q)):t.texImage2D(3553,0,_e,le,Ce,Q);b(M,R)&&T(ee),Se.__currentVersion=Se.version,M.onUpdate&&M.onUpdate(M)}E.__version=M.version}function Ae(E,M,X,ee,he){const Se=s.convert(X.format,X.encoding),Fe=s.convert(X.type),Q=A(X.internalFormat,Se,Fe,X.encoding);i.get(M).__hasExternalTextures||(32879===he||35866===he?t.texImage3D(he,0,Q,M.width,M.height,M.depth,0,Se,Fe,null):t.texImage2D(he,0,Q,M.width,M.height,0,Se,Fe,null)),t.bindFramebuffer(36160,E),Le(M)?h.framebufferTexture2DMultisampleEXT(36160,ee,he,i.get(X).__webglTexture,0,ze(M)):n.framebufferTexture2D(36160,ee,he,i.get(X).__webglTexture,0),t.bindFramebuffer(36160,null)}function Ie(E,M,X){if(n.bindRenderbuffer(36161,E),M.depthBuffer&&!M.stencilBuffer){let ee=33189;if(X||Le(M)){const he=M.depthTexture;he&&he.isDepthTexture&&(he.type===Ao?ee=36012:1014===he.type&&(ee=33190));const Se=ze(M);Le(M)?h.renderbufferStorageMultisampleEXT(36161,Se,ee,M.width,M.height):n.renderbufferStorageMultisample(36161,Se,ee,M.width,M.height)}else n.renderbufferStorage(36161,ee,M.width,M.height);n.framebufferRenderbuffer(36160,36096,36161,E)}else if(M.depthBuffer&&M.stencilBuffer){const ee=ze(M);X&&!1===Le(M)?n.renderbufferStorageMultisample(36161,ee,35056,M.width,M.height):Le(M)?h.renderbufferStorageMultisampleEXT(36161,ee,35056,M.width,M.height):n.renderbufferStorage(36161,34041,M.width,M.height),n.framebufferRenderbuffer(36160,33306,36161,E)}else{const ee=!0===M.isWebGLMultipleRenderTargets?M.texture[0]:M.texture,he=s.convert(ee.format,ee.encoding),Se=s.convert(ee.type),Fe=A(ee.internalFormat,he,Se,ee.encoding),Q=ze(M);X&&!1===Le(M)?n.renderbufferStorageMultisample(36161,Q,Fe,M.width,M.height):Le(M)?h.renderbufferStorageMultisampleEXT(36161,Q,Fe,M.width,M.height):n.renderbufferStorage(36161,Fe,M.width,M.height)}n.bindRenderbuffer(36161,null)}function G(E){const M=i.get(E),X=!0===E.isWebGLCubeRenderTarget;if(E.depthTexture&&!M.__autoAllocateDepthBuffer){if(X)throw new Error("target.depthTexture not supported in Cube render targets");!function _t(E,M){if(M&&M.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,E),!M.depthTexture||!M.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(M.depthTexture).__webglTexture||M.depthTexture.image.width!==M.width||M.depthTexture.image.height!==M.height)&&(M.depthTexture.image.width=M.width,M.depthTexture.image.height=M.height,M.depthTexture.needsUpdate=!0),Z(M.depthTexture,0);const ee=i.get(M.depthTexture).__webglTexture,he=ze(M);if(M.depthTexture.format===Ra)Le(M)?h.framebufferTexture2DMultisampleEXT(36160,36096,3553,ee,0,he):n.framebufferTexture2D(36160,36096,3553,ee,0);else{if(M.depthTexture.format!==xc)throw new Error("Unknown depthTexture format");Le(M)?h.framebufferTexture2DMultisampleEXT(36160,33306,3553,ee,0,he):n.framebufferTexture2D(36160,33306,3553,ee,0)}}(M.__webglFramebuffer,E)}else if(X){M.__webglDepthbuffer=[];for(let ee=0;ee<6;ee++)t.bindFramebuffer(36160,M.__webglFramebuffer[ee]),M.__webglDepthbuffer[ee]=n.createRenderbuffer(),Ie(M.__webglDepthbuffer[ee],E,!1)}else t.bindFramebuffer(36160,M.__webglFramebuffer),M.__webglDepthbuffer=n.createRenderbuffer(),Ie(M.__webglDepthbuffer,E,!1);t.bindFramebuffer(36160,null)}function ze(E){return Math.min(d,E.samples)}function Le(E){const M=i.get(E);return a&&E.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==M.__useRenderToTexture}function jt(E,M){const X=E.encoding,ee=E.format,he=E.type;return!0===E.isCompressedTexture||!0===E.isVideoTexture||1035===E.format||X!==Io&&(X===cn?!1===a?!0===e.has("EXT_sRGB")&&ee===vi?(E.format=1035,E.minFilter=_n,E.generateMipmaps=!1):M=Na.sRGBToLinear(M):(ee!==vi||he!==Ia)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",X)),M}this.allocateTextureUnit=function q(){const E=U;return E>=l&&console.warn("THREE.WebGLTextures: Trying to use "+E+" texture units while this GPU supports only "+l),U+=1,E},this.resetTextureUnits=function B(){U=0},this.setTexture2D=Z,this.setTexture2DArray=function oe(E,M){const X=i.get(E);E.version>0&&X.__version!==E.version?St(X,E,M):(t.activeTexture(33984+M),t.bindTexture(35866,X.__webglTexture))},this.setTexture3D=function ae(E,M){const X=i.get(E);E.version>0&&X.__version!==E.version?St(X,E,M):(t.activeTexture(33984+M),t.bindTexture(32879,X.__webglTexture))},this.setTextureCube=function ce(E,M){const X=i.get(E);E.version>0&&X.__version!==E.version?function et(E,M,X){if(6!==M.image.length)return;const ee=J(E,M),he=M.source;if(t.activeTexture(33984+X),t.bindTexture(34067,E.__webglTexture),he.version!==he.__currentVersion||!0===ee){n.pixelStorei(37440,M.flipY),n.pixelStorei(37441,M.premultiplyAlpha),n.pixelStorei(3317,M.unpackAlignment),n.pixelStorei(37443,0);const Se=M.isCompressedTexture||M.image[0].isCompressedTexture,Fe=M.image[0]&&M.image[0].isDataTexture,Q=[];for(let re=0;re<6;re++)Q[re]=Se||Fe?Fe?M.image[re].image:M.image[re]:m(M.image[re],!1,!0,c),Q[re]=jt(M,Q[re]);const R=Q[0],le=v(R)||a,Ce=s.convert(M.format,M.encoding),_e=s.convert(M.type),I=A(M.internalFormat,Ce,_e,M.encoding),xe=a&&!0!==M.isVideoTexture,ye=void 0===E.__version;let fe,qe=P(M,R,le);if(He(34067,M,le),Se){xe&&ye&&t.texStorage2D(34067,qe,I,R.width,R.height);for(let re=0;re<6;re++){fe=Q[re].mipmaps;for(let Ze=0;Ze<fe.length;Ze++){const Et=fe[Ze];M.format!==vi?null!==Ce?xe?t.compressedTexSubImage2D(34069+re,Ze,0,0,Et.width,Et.height,Ce,Et.data):t.compressedTexImage2D(34069+re,Ze,I,Et.width,Et.height,0,Et.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):xe?t.texSubImage2D(34069+re,Ze,0,0,Et.width,Et.height,Ce,_e,Et.data):t.texImage2D(34069+re,Ze,I,Et.width,Et.height,0,Ce,_e,Et.data)}}}else{fe=M.mipmaps,xe&&ye&&(fe.length>0&&qe++,t.texStorage2D(34067,qe,I,Q[0].width,Q[0].height));for(let re=0;re<6;re++)if(Fe){xe?t.texSubImage2D(34069+re,0,0,0,Q[re].width,Q[re].height,Ce,_e,Q[re].data):t.texImage2D(34069+re,0,I,Q[re].width,Q[re].height,0,Ce,_e,Q[re].data);for(let Ze=0;Ze<fe.length;Ze++){const xi=fe[Ze].image[re].image;xe?t.texSubImage2D(34069+re,Ze+1,0,0,xi.width,xi.height,Ce,_e,xi.data):t.texImage2D(34069+re,Ze+1,I,xi.width,xi.height,0,Ce,_e,xi.data)}}else{xe?t.texSubImage2D(34069+re,0,0,0,Ce,_e,Q[re]):t.texImage2D(34069+re,0,I,Ce,_e,Q[re]);for(let Ze=0;Ze<fe.length;Ze++){const Et=fe[Ze];xe?t.texSubImage2D(34069+re,Ze+1,0,0,Ce,_e,Et.image[re]):t.texImage2D(34069+re,Ze+1,I,Ce,_e,Et.image[re])}}}b(M,le)&&T(34067),he.__currentVersion=he.version,M.onUpdate&&M.onUpdate(M)}E.__version=M.version}(X,E,M):(t.activeTexture(33984+M),t.bindTexture(34067,X.__webglTexture))},this.rebindTextures=function se(E,M,X){const ee=i.get(E);void 0!==M&&Ae(ee.__webglFramebuffer,E,E.texture,36064,3553),void 0!==X&&G(E)},this.setupRenderTarget=function de(E){const M=E.texture,X=i.get(E),ee=i.get(M);E.addEventListener("dispose",x),!0!==E.isWebGLMultipleRenderTargets&&(void 0===ee.__webglTexture&&(ee.__webglTexture=n.createTexture()),ee.__version=M.version,o.memory.textures++);const he=!0===E.isWebGLCubeRenderTarget,Se=!0===E.isWebGLMultipleRenderTargets,Fe=v(E)||a;if(he){X.__webglFramebuffer=[];for(let Q=0;Q<6;Q++)X.__webglFramebuffer[Q]=n.createFramebuffer()}else if(X.__webglFramebuffer=n.createFramebuffer(),Se)if(r.drawBuffers){const Q=E.texture;for(let R=0,le=Q.length;R<le;R++){const Ce=i.get(Q[R]);void 0===Ce.__webglTexture&&(Ce.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(a&&E.samples>0&&!1===Le(E)){X.__webglMultisampledFramebuffer=n.createFramebuffer(),X.__webglColorRenderbuffer=n.createRenderbuffer(),n.bindRenderbuffer(36161,X.__webglColorRenderbuffer);const Q=s.convert(M.format,M.encoding),R=s.convert(M.type),le=A(M.internalFormat,Q,R,M.encoding),Ce=ze(E);n.renderbufferStorageMultisample(36161,Ce,le,E.width,E.height),t.bindFramebuffer(36160,X.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064,36161,X.__webglColorRenderbuffer),n.bindRenderbuffer(36161,null),E.depthBuffer&&(X.__webglDepthRenderbuffer=n.createRenderbuffer(),Ie(X.__webglDepthRenderbuffer,E,!0)),t.bindFramebuffer(36160,null)}if(he){t.bindTexture(34067,ee.__webglTexture),He(34067,M,Fe);for(let Q=0;Q<6;Q++)Ae(X.__webglFramebuffer[Q],E,M,36064,34069+Q);b(M,Fe)&&T(34067),t.unbindTexture()}else if(Se){const Q=E.texture;for(let R=0,le=Q.length;R<le;R++){const Ce=Q[R],_e=i.get(Ce);t.bindTexture(3553,_e.__webglTexture),He(3553,Ce,Fe),Ae(X.__webglFramebuffer,E,Ce,36064+R,3553),b(Ce,Fe)&&T(3553)}t.unbindTexture()}else{let Q=3553;(E.isWebGL3DRenderTarget||E.isWebGLArrayRenderTarget)&&(a?Q=E.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(Q,ee.__webglTexture),He(Q,M,Fe),Ae(X.__webglFramebuffer,E,M,36064,Q),b(M,Fe)&&T(Q),t.unbindTexture()}E.depthBuffer&&G(E)},this.updateRenderTargetMipmap=function Te(E){const M=v(E)||a,X=!0===E.isWebGLMultipleRenderTargets?E.texture:[E.texture];for(let ee=0,he=X.length;ee<he;ee++){const Se=X[ee];if(b(Se,M)){const Fe=E.isWebGLCubeRenderTarget?34067:3553,Q=i.get(Se).__webglTexture;t.bindTexture(Fe,Q),T(Fe),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function we(E){if(a&&E.samples>0&&!1===Le(E)){const M=E.width,X=E.height;let ee=16384;const he=[36064],Se=E.stencilBuffer?33306:36096;E.depthBuffer&&he.push(Se);const Fe=i.get(E),Q=void 0!==Fe.__ignoreDepthValues&&Fe.__ignoreDepthValues;!1===Q&&(E.depthBuffer&&(ee|=256),E.stencilBuffer&&(ee|=1024)),t.bindFramebuffer(36008,Fe.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,Fe.__webglFramebuffer),!0===Q&&(n.invalidateFramebuffer(36008,[Se]),n.invalidateFramebuffer(36009,[Se])),n.blitFramebuffer(0,0,M,X,0,0,M,X,ee,9728),n.invalidateFramebuffer(36008,he),t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,Fe.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=G,this.setupFrameBufferTexture=Ae,this.useMultisampledRTT=Le}function tZ(n,e,t){const i=t.isWebGL2;return{convert:function r(s,o=null){let a;if(s===Ia)return 5121;if(1017===s)return 32819;if(1018===s)return 32820;if(1010===s)return 5120;if(1011===s)return 5122;if(s===ah)return 5123;if(1013===s)return 5124;if(1014===s)return 5125;if(s===Ao)return 5126;if(s===wc)return i?5131:(a=e.get("OES_texture_half_float"),null!==a?a.HALF_FLOAT_OES:null);if(1021===s)return 6406;if(s===vi)return 6408;if(1024===s)return 6409;if(1025===s)return 6410;if(s===Ra)return 6402;if(s===xc)return 34041;if(1028===s)return 6403;if(1022===s)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(1035===s)return a=e.get("EXT_sRGB"),null!==a?a.SRGB_ALPHA_EXT:null;if(1029===s)return 36244;if(1030===s)return 33319;if(1031===s)return 33320;if(1033===s)return 36249;if(33776===s||33777===s||33778===s||33779===s)if(o===cn){if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(33776===s)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=e.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(33776===s)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===s||35841===s||35842===s||35843===s){if(a=e.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(35840===s)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===s)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===s)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===s)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===s)return a=e.get("WEBGL_compressed_texture_etc1"),null!==a?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===s||37496===s){if(a=e.get("WEBGL_compressed_texture_etc"),null===a)return null;if(37492===s)return o===cn?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(37496===s)return o===cn?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(37808===s||37809===s||37810===s||37811===s||37812===s||37813===s||37814===s||37815===s||37816===s||37817===s||37818===s||37819===s||37820===s||37821===s){if(a=e.get("WEBGL_compressed_texture_astc"),null===a)return null;if(37808===s)return o===cn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===s)return o===cn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===s)return o===cn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===s)return o===cn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===s)return o===cn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===s)return o===cn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===s)return o===cn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===s)return o===cn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===s)return o===cn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===s)return o===cn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===s)return o===cn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===s)return o===cn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===s)return o===cn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===s)return o===cn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===s){if(a=e.get("EXT_texture_compression_bptc"),null===a)return null;if(36492===s)return o===cn?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}return s===bc?i?34042:(a=e.get("WEBGL_depth_texture"),null!==a?a.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}mx.prototype.isMeshDistanceMaterial=!0;class D3 extends Hn{constructor(e=[]){super(),this.cameras=e}}D3.prototype.isArrayCamera=!0;class za extends Rt{constructor(){super(),this.type="Group"}}za.prototype.isGroup=!0;const nZ={type:"move"};class gx{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new za,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new za,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new C,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new C),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new za,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new C,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new C),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState)if(null!==a&&(r=t.getPose(e.targetRaySpace,i),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(nZ))),c&&e.hand){o=!0;for(const _ of e.hand.values()){const y=t.getJointPose(_,i);if(void 0===c.joints[_.jointName]){const m=new za;m.matrixAutoUpdate=!1,m.visible=!1,c.joints[_.jointName]=m,c.add(m)}const g=c.joints[_.jointName];null!==y&&(g.matrix.fromArray(y.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.jointRadius=y.radius),g.visible=null!==y}const h=c.joints["index-finger-tip"].position.distanceTo(c.joints["thumb-tip"].position),f=.02,p=.005;c.inputState.pinching&&h>f+p?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&h<=f-p&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==l&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),null!==s&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));return null!==a&&(a.visible=null!==r),null!==l&&(l.visible=null!==s),null!==c&&(c.visible=null!==o),this}}class A3 extends Ri{constructor(e,t,i,r,s,o,a,l,c,u){if((u=void 0!==u?u:Ra)!==Ra&&u!==xc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&u===Ra&&(i=ah),void 0===i&&u===xc&&(i=bc),super(null,r,s,o,a,l,u,i,c),this.image={width:e,height:t},this.magFilter=void 0!==a?a:Un,this.minFilter=void 0!==l?l:Un,this.flipY=!1,this.generateMipmaps=!1}}A3.prototype.isDepthTexture=!0;class iZ extends Ro{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",l=null,c=null,u=null,d=null,h=null;const f=t.getContextAttributes();let p=null,_=null;const y=[],g=new Map,m=new Hn;m.layers.enable(1),m.viewport=new Ft;const v=new Hn;v.layers.enable(2),v.viewport=new Ft;const w=[m,v],b=new D3;b.layers.enable(1),b.layers.enable(2);let T=null,A=null;function P(F){const Z=g.get(F.inputSource);Z&&Z.dispatchEvent({type:F.type,data:F.inputSource})}function z(){g.forEach(function(F,Z){F.disconnect(Z)}),g.clear(),T=null,A=null,e.setRenderTarget(p),d=null,u=null,c=null,r=null,_=null,q.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function N(F){const Z=r.inputSources;for(let oe=0;oe<y.length;oe++)g.set(Z[oe],y[oe]);for(let oe=0;oe<F.removed.length;oe++){const ae=F.removed[oe],ce=g.get(ae);ce&&(ce.dispatchEvent({type:"disconnected",data:ae}),g.delete(ae))}for(let oe=0;oe<F.added.length;oe++){const ae=F.added[oe],ce=g.get(ae);ce&&ce.dispatchEvent({type:"connected",data:ae})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(F){let Z=y[F];return void 0===Z&&(Z=new gx,y[F]=Z),Z.getTargetRaySpace()},this.getControllerGrip=function(F){let Z=y[F];return void 0===Z&&(Z=new gx,y[F]=Z),Z.getGripSpace()},this.getHand=function(F){let Z=y[F];return void 0===Z&&(Z=new gx,y[F]=Z),Z.getHandSpace()},this.setFramebufferScaleFactor=function(F){s=F,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(F){a=F,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return o},this.getBaseLayer=function(){return null!==u?u:d},this.getBinding=function(){return c},this.getFrame=function(){return h},this.getSession=function(){return r},this.setSession=function(){var F=Je(function*(Z){if(r=Z,null!==r){if(p=e.getRenderTarget(),r.addEventListener("select",P),r.addEventListener("selectstart",P),r.addEventListener("selectend",P),r.addEventListener("squeeze",P),r.addEventListener("squeezestart",P),r.addEventListener("squeezeend",P),r.addEventListener("end",z),r.addEventListener("inputsourceschange",N),!0!==f.xrCompatible&&(yield t.makeXRCompatible()),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)d=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||f.antialias,alpha:f.alpha,depth:f.depth,stencil:f.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:d}),_=new Pi(d.framebufferWidth,d.framebufferHeight,{format:vi,type:Ia,encoding:e.outputEncoding});else{let oe=null,ae=null,ce=null;f.depth&&(ce=f.stencil?35056:33190,oe=f.stencil?xc:Ra,ae=f.stencil?bc:ah);const Oe={colorFormat:e.outputEncoding===cn?35907:32856,depthFormat:ce,scaleFactor:s};c=new XRWebGLBinding(r,t),u=c.createProjectionLayer(Oe),r.updateRenderState({layers:[u]}),_=new Pi(u.textureWidth,u.textureHeight,{format:vi,type:Ia,depthTexture:new A3(u.textureWidth,u.textureHeight,ae,void 0,void 0,void 0,void 0,void 0,void 0,oe),stencilBuffer:f.stencil,encoding:e.outputEncoding,samples:f.antialias?4:0}),e.properties.get(_).__ignoreDepthValues=u.ignoreDepthValues}_.isXRRenderTarget=!0,this.setFoveation(1),o=yield r.requestReferenceSpace(a),q.setContext(r),q.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function(Z){return F.apply(this,arguments)}}();const x=new C,D=new C;function O(F,Z){null===Z?F.matrixWorld.copy(F.matrix):F.matrixWorld.multiplyMatrices(Z.matrixWorld,F.matrix),F.matrixWorldInverse.copy(F.matrixWorld).invert()}this.updateCamera=function(F){if(null===r)return;b.near=v.near=m.near=F.near,b.far=v.far=m.far=F.far,(T!==b.near||A!==b.far)&&(r.updateRenderState({depthNear:b.near,depthFar:b.far}),T=b.near,A=b.far);const Z=F.parent,oe=b.cameras;O(b,Z);for(let ce=0;ce<oe.length;ce++)O(oe[ce],Z);b.matrixWorld.decompose(b.position,b.quaternion,b.scale),F.position.copy(b.position),F.quaternion.copy(b.quaternion),F.scale.copy(b.scale),F.matrix.copy(b.matrix),F.matrixWorld.copy(b.matrixWorld);const ae=F.children;for(let ce=0,Oe=ae.length;ce<Oe;ce++)ae[ce].updateMatrixWorld(!0);2===oe.length?function L(F,Z,oe){x.setFromMatrixPosition(Z.matrixWorld),D.setFromMatrixPosition(oe.matrixWorld);const ae=x.distanceTo(D),ce=Z.projectionMatrix.elements,Oe=oe.projectionMatrix.elements,xt=ce[14]/(ce[10]-1),He=ce[14]/(ce[10]+1),J=(ce[9]+1)/ce[5],St=(ce[9]-1)/ce[5],et=(ce[8]-1)/ce[0],Ae=(Oe[8]+1)/Oe[0],Ie=xt*et,_t=xt*Ae,G=ae/(-et+Ae),se=G*-et;Z.matrixWorld.decompose(F.position,F.quaternion,F.scale),F.translateX(se),F.translateZ(G),F.matrixWorld.compose(F.position,F.quaternion,F.scale),F.matrixWorldInverse.copy(F.matrixWorld).invert();const de=xt+G,Te=He+G;F.projectionMatrix.makePerspective(Ie-se,_t+(ae-se),J*He/Te*de,St*He/Te*de,de,Te)}(b,m,v):b.projectionMatrix.copy(m.projectionMatrix)},this.getCamera=function(){return b},this.getFoveation=function(){return null!==u?u.fixedFoveation:null!==d?d.fixedFoveation:void 0},this.setFoveation=function(F){null!==u&&(u.fixedFoveation=F),null!==d&&void 0!==d.fixedFoveation&&(d.fixedFoveation=F)};let U=null;const q=new JP;q.setAnimationLoop(function B(F,Z){if(l=Z.getViewerPose(o),h=Z,null!==l){const ae=l.views;null!==d&&(e.setRenderTargetFramebuffer(_,d.framebuffer),e.setRenderTarget(_));let ce=!1;ae.length!==b.cameras.length&&(b.cameras.length=0,ce=!0);for(let Oe=0;Oe<ae.length;Oe++){const xt=ae[Oe];let He=null;if(null!==d)He=d.getViewport(xt);else{const St=c.getViewSubImage(u,xt);He=St.viewport,0===Oe&&(e.setRenderTargetTextures(_,St.colorTexture,u.ignoreDepthValues?void 0:St.depthStencilTexture),e.setRenderTarget(_))}const J=w[Oe];J.matrix.fromArray(xt.transform.matrix),J.projectionMatrix.fromArray(xt.projectionMatrix),J.viewport.set(He.x,He.y,He.width,He.height),0===Oe&&b.matrix.copy(J.matrix),!0===ce&&b.cameras.push(J)}}const oe=r.inputSources;for(let ae=0;ae<y.length;ae++)y[ae].update(oe[ae],Z,o);U&&U(F,Z),h=null}),this.setAnimationLoop=function(F){U=F},this.dispose=function(){}}}function rZ(n){function i(g,m){g.opacity.value=m.opacity,m.color&&g.diffuse.value.copy(m.color),m.emissive&&g.emissive.value.copy(m.emissive).multiplyScalar(m.emissiveIntensity),m.map&&(g.map.value=m.map),m.alphaMap&&(g.alphaMap.value=m.alphaMap),m.specularMap&&(g.specularMap.value=m.specularMap),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest);const v=n.get(m).envMap;let w,b;v&&(g.envMap.value=v,g.flipEnvMap.value=v.isCubeTexture&&!1===v.isRenderTargetTexture?-1:1,g.reflectivity.value=m.reflectivity,g.ior.value=m.ior,g.refractionRatio.value=m.refractionRatio),m.lightMap&&(g.lightMap.value=m.lightMap,g.lightMapIntensity.value=m.lightMapIntensity),m.aoMap&&(g.aoMap.value=m.aoMap,g.aoMapIntensity.value=m.aoMapIntensity),m.map?w=m.map:m.specularMap?w=m.specularMap:m.displacementMap?w=m.displacementMap:m.normalMap?w=m.normalMap:m.bumpMap?w=m.bumpMap:m.roughnessMap?w=m.roughnessMap:m.metalnessMap?w=m.metalnessMap:m.alphaMap?w=m.alphaMap:m.emissiveMap?w=m.emissiveMap:m.clearcoatMap?w=m.clearcoatMap:m.clearcoatNormalMap?w=m.clearcoatNormalMap:m.clearcoatRoughnessMap?w=m.clearcoatRoughnessMap:m.specularIntensityMap?w=m.specularIntensityMap:m.specularColorMap?w=m.specularColorMap:m.transmissionMap?w=m.transmissionMap:m.thicknessMap?w=m.thicknessMap:m.sheenColorMap?w=m.sheenColorMap:m.sheenRoughnessMap&&(w=m.sheenRoughnessMap),void 0!==w&&(w.isWebGLRenderTarget&&(w=w.texture),!0===w.matrixAutoUpdate&&w.updateMatrix(),g.uvTransform.value.copy(w.matrix)),m.aoMap?b=m.aoMap:m.lightMap&&(b=m.lightMap),void 0!==b&&(b.isWebGLRenderTarget&&(b=b.texture),!0===b.matrixAutoUpdate&&b.updateMatrix(),g.uv2Transform.value.copy(b.matrix))}function d(g,m){g.roughness.value=m.roughness,g.metalness.value=m.metalness,m.roughnessMap&&(g.roughnessMap.value=m.roughnessMap),m.metalnessMap&&(g.metalnessMap.value=m.metalnessMap),m.emissiveMap&&(g.emissiveMap.value=m.emissiveMap),m.bumpMap&&(g.bumpMap.value=m.bumpMap,g.bumpScale.value=m.bumpScale,1===m.side&&(g.bumpScale.value*=-1)),m.normalMap&&(g.normalMap.value=m.normalMap,g.normalScale.value.copy(m.normalScale),1===m.side&&g.normalScale.value.negate()),m.displacementMap&&(g.displacementMap.value=m.displacementMap,g.displacementScale.value=m.displacementScale,g.displacementBias.value=m.displacementBias),n.get(m).envMap&&(g.envMapIntensity.value=m.envMapIntensity)}return{refreshFogUniforms:function e(g,m){g.fogColor.value.copy(m.color),m.isFog?(g.fogNear.value=m.near,g.fogFar.value=m.far):m.isFogExp2&&(g.fogDensity.value=m.density)},refreshMaterialUniforms:function t(g,m,v,w,b){m.isMeshBasicMaterial?i(g,m):m.isMeshLambertMaterial?(i(g,m),function l(g,m){m.emissiveMap&&(g.emissiveMap.value=m.emissiveMap)}(g,m)):m.isMeshToonMaterial?(i(g,m),function u(g,m){m.gradientMap&&(g.gradientMap.value=m.gradientMap),m.emissiveMap&&(g.emissiveMap.value=m.emissiveMap),m.bumpMap&&(g.bumpMap.value=m.bumpMap,g.bumpScale.value=m.bumpScale,1===m.side&&(g.bumpScale.value*=-1)),m.normalMap&&(g.normalMap.value=m.normalMap,g.normalScale.value.copy(m.normalScale),1===m.side&&g.normalScale.value.negate()),m.displacementMap&&(g.displacementMap.value=m.displacementMap,g.displacementScale.value=m.displacementScale,g.displacementBias.value=m.displacementBias)}(g,m)):m.isMeshPhongMaterial?(i(g,m),function c(g,m){g.specular.value.copy(m.specular),g.shininess.value=Math.max(m.shininess,1e-4),m.emissiveMap&&(g.emissiveMap.value=m.emissiveMap),m.bumpMap&&(g.bumpMap.value=m.bumpMap,g.bumpScale.value=m.bumpScale,1===m.side&&(g.bumpScale.value*=-1)),m.normalMap&&(g.normalMap.value=m.normalMap,g.normalScale.value.copy(m.normalScale),1===m.side&&g.normalScale.value.negate()),m.displacementMap&&(g.displacementMap.value=m.displacementMap,g.displacementScale.value=m.displacementScale,g.displacementBias.value=m.displacementBias)}(g,m)):m.isMeshStandardMaterial?(i(g,m),m.isMeshPhysicalMaterial?function h(g,m,v){d(g,m),g.ior.value=m.ior,m.sheen>0&&(g.sheenColor.value.copy(m.sheenColor).multiplyScalar(m.sheen),g.sheenRoughness.value=m.sheenRoughness,m.sheenColorMap&&(g.sheenColorMap.value=m.sheenColorMap),m.sheenRoughnessMap&&(g.sheenRoughnessMap.value=m.sheenRoughnessMap)),m.clearcoat>0&&(g.clearcoat.value=m.clearcoat,g.clearcoatRoughness.value=m.clearcoatRoughness,m.clearcoatMap&&(g.clearcoatMap.value=m.clearcoatMap),m.clearcoatRoughnessMap&&(g.clearcoatRoughnessMap.value=m.clearcoatRoughnessMap),m.clearcoatNormalMap&&(g.clearcoatNormalScale.value.copy(m.clearcoatNormalScale),g.clearcoatNormalMap.value=m.clearcoatNormalMap,1===m.side&&g.clearcoatNormalScale.value.negate())),m.transmission>0&&(g.transmission.value=m.transmission,g.transmissionSamplerMap.value=v.texture,g.transmissionSamplerSize.value.set(v.width,v.height),m.transmissionMap&&(g.transmissionMap.value=m.transmissionMap),g.thickness.value=m.thickness,m.thicknessMap&&(g.thicknessMap.value=m.thicknessMap),g.attenuationDistance.value=m.attenuationDistance,g.attenuationColor.value.copy(m.attenuationColor)),g.specularIntensity.value=m.specularIntensity,g.specularColor.value.copy(m.specularColor),m.specularIntensityMap&&(g.specularIntensityMap.value=m.specularIntensityMap),m.specularColorMap&&(g.specularColorMap.value=m.specularColorMap)}(g,m,b):d(g,m)):m.isMeshMatcapMaterial?(i(g,m),function f(g,m){m.matcap&&(g.matcap.value=m.matcap),m.bumpMap&&(g.bumpMap.value=m.bumpMap,g.bumpScale.value=m.bumpScale,1===m.side&&(g.bumpScale.value*=-1)),m.normalMap&&(g.normalMap.value=m.normalMap,g.normalScale.value.copy(m.normalScale),1===m.side&&g.normalScale.value.negate()),m.displacementMap&&(g.displacementMap.value=m.displacementMap,g.displacementScale.value=m.displacementScale,g.displacementBias.value=m.displacementBias)}(g,m)):m.isMeshDepthMaterial?(i(g,m),function p(g,m){m.displacementMap&&(g.displacementMap.value=m.displacementMap,g.displacementScale.value=m.displacementScale,g.displacementBias.value=m.displacementBias)}(g,m)):m.isMeshDistanceMaterial?(i(g,m),function _(g,m){m.displacementMap&&(g.displacementMap.value=m.displacementMap,g.displacementScale.value=m.displacementScale,g.displacementBias.value=m.displacementBias),g.referencePosition.value.copy(m.referencePosition),g.nearDistance.value=m.nearDistance,g.farDistance.value=m.farDistance}(g,m)):m.isMeshNormalMaterial?(i(g,m),function y(g,m){m.bumpMap&&(g.bumpMap.value=m.bumpMap,g.bumpScale.value=m.bumpScale,1===m.side&&(g.bumpScale.value*=-1)),m.normalMap&&(g.normalMap.value=m.normalMap,g.normalScale.value.copy(m.normalScale),1===m.side&&g.normalScale.value.negate()),m.displacementMap&&(g.displacementMap.value=m.displacementMap,g.displacementScale.value=m.displacementScale,g.displacementBias.value=m.displacementBias)}(g,m)):m.isLineBasicMaterial?(function r(g,m){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity}(g,m),m.isLineDashedMaterial&&function s(g,m){g.dashSize.value=m.dashSize,g.totalSize.value=m.dashSize+m.gapSize,g.scale.value=m.scale}(g,m)):m.isPointsMaterial?function o(g,m,v,w){let b;g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.size.value=m.size*v,g.scale.value=.5*w,m.map&&(g.map.value=m.map),m.alphaMap&&(g.alphaMap.value=m.alphaMap),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest),m.map?b=m.map:m.alphaMap&&(b=m.alphaMap),void 0!==b&&(!0===b.matrixAutoUpdate&&b.updateMatrix(),g.uvTransform.value.copy(b.matrix))}(g,m,v,w):m.isSpriteMaterial?function a(g,m){let v;g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.rotation.value=m.rotation,m.map&&(g.map.value=m.map),m.alphaMap&&(g.alphaMap.value=m.alphaMap),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest),m.map?v=m.map:m.alphaMap&&(v=m.alphaMap),void 0!==v&&(!0===v.matrixAutoUpdate&&v.updateMatrix(),g.uvTransform.value.copy(v.matrix))}(g,m):m.isShadowMaterial?(g.color.value.copy(m.color),g.opacity.value=m.opacity):m.isShaderMaterial&&(m.uniformsNeedUpdate=!1)}}}function Pt(n={}){const e=void 0!==n.canvas?n.canvas:function sZ(){const n=hh("canvas");return n.style.display="block",n}(),t=void 0!==n.context?n.context:null,i=void 0===n.depth||n.depth,r=void 0===n.stencil||n.stencil,s=void 0!==n.antialias&&n.antialias,o=void 0===n.premultipliedAlpha||n.premultipliedAlpha,a=void 0!==n.preserveDrawingBuffer&&n.preserveDrawingBuffer,l=void 0!==n.powerPreference?n.powerPreference:"default",c=void 0!==n.failIfMajorPerformanceCaveat&&n.failIfMajorPerformanceCaveat;let u;u=void 0!==n.context?t.getContextAttributes().alpha:void 0!==n.alpha&&n.alpha;let d=null,h=null;const f=[],p=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Io,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1;const _=this;let y=!1,g=0,m=0,v=null,w=-1,b=null;const T=new Ft,A=new Ft;let P=null,z=e.width,N=e.height,x=1,D=null,L=null;const O=new Ft(0,0,z,N),U=new Ft(0,0,z,N);let B=!1;const q=new rg;let F=!1,Z=!1,oe=null;const ae=new Pe,ce=new j,Oe=new C,xt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function He(){return null===v?x:1}let et,Ae,Ie,_t,G,se,de,Te,we,ze,Le,ot,jt,E,M,X,ee,he,Se,Fe,Q,R,le,J=t;function St(S,k){for(let W=0;W<S.length;W++){const K=e.getContext(S[W],k);if(null!==K)return K}return null}try{const S={alpha:!0,depth:i,stencil:r,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:a,powerPreference:l,failIfMajorPerformanceCaveat:c};if("setAttribute"in e&&e.setAttribute("data-engine","three.js r138"),e.addEventListener("webglcontextlost",I,!1),e.addEventListener("webglcontextrestored",xe,!1),null===J){const k=["webgl2","webgl","experimental-webgl"];if(!0===_.isWebGL1Renderer&&k.shift(),J=St(k,S),null===J)throw St(k)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===J.getShaderPrecisionFormat&&(J.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(S){throw console.error("THREE.WebGLRenderer: "+S.message),S}function Ce(){et=new CJ(J),Ae=new _J(J,et,n),et.init(Ae),R=new tZ(J,et,Ae),Ie=new ZK(J,et,Ae),_t=new EJ(J),G=new zK,se=new eZ(J,et,Ie,G,Ae,R,_t),de=new vJ(_),Te=new xJ(_),we=new yX(J,Ae),le=new mJ(J,et,we,Ae),ze=new MJ(J,we,_t,le),Le=new IJ(J,ze,we,_t),Se=new AJ(J,Ae,se),X=new yJ(G),ot=new HK(_,de,Te,et,Ae,le,X),jt=new rZ(G),E=new WK,M=new QK(et,Ae),he=new pJ(_,de,Ie,Le,u,o),ee=new T3(_,Le,Ae),Fe=new gJ(J,et,_t,Ae),Q=new SJ(J,et,_t,Ae),_t.programs=ot.programs,_.capabilities=Ae,_.extensions=et,_.properties=G,_.renderLists=E,_.shadowMap=ee,_.state=Ie,_.info=_t}Ce();const _e=new iZ(_,J);function I(S){S.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),y=!0}function xe(){console.log("THREE.WebGLRenderer: Context Restored."),y=!1;const S=_t.autoReset,k=ee.enabled,W=ee.autoUpdate,H=ee.needsUpdate,K=ee.type;Ce(),_t.autoReset=S,ee.enabled=k,ee.autoUpdate=W,ee.needsUpdate=H,ee.type=K}function ye(S){const k=S.target;k.removeEventListener("dispose",ye),function qe(S){(function fe(S){const k=G.get(S).programs;void 0!==k&&(k.forEach(function(W){ot.releaseProgram(W)}),S.isShaderMaterial&&ot.releaseShaderCache(S))})(S),G.remove(S)}(k)}this.xr=_e,this.getContext=function(){return J},this.getContextAttributes=function(){return J.getContextAttributes()},this.forceContextLoss=function(){const S=et.get("WEBGL_lose_context");S&&S.loseContext()},this.forceContextRestore=function(){const S=et.get("WEBGL_lose_context");S&&S.restoreContext()},this.getPixelRatio=function(){return x},this.setPixelRatio=function(S){void 0!==S&&(x=S,this.setSize(z,N,!1))},this.getSize=function(S){return S.set(z,N)},this.setSize=function(S,k,W){_e.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(z=S,N=k,e.width=Math.floor(S*x),e.height=Math.floor(k*x),!1!==W&&(e.style.width=S+"px",e.style.height=k+"px"),this.setViewport(0,0,S,k))},this.getDrawingBufferSize=function(S){return S.set(z*x,N*x).floor()},this.setDrawingBufferSize=function(S,k,W){z=S,N=k,x=W,e.width=Math.floor(S*W),e.height=Math.floor(k*W),this.setViewport(0,0,S,k)},this.getCurrentViewport=function(S){return S.copy(T)},this.getViewport=function(S){return S.copy(O)},this.setViewport=function(S,k,W,H){S.isVector4?O.set(S.x,S.y,S.z,S.w):O.set(S,k,W,H),Ie.viewport(T.copy(O).multiplyScalar(x).floor())},this.getScissor=function(S){return S.copy(U)},this.setScissor=function(S,k,W,H){S.isVector4?U.set(S.x,S.y,S.z,S.w):U.set(S,k,W,H),Ie.scissor(A.copy(U).multiplyScalar(x).floor())},this.getScissorTest=function(){return B},this.setScissorTest=function(S){Ie.setScissorTest(B=S)},this.setOpaqueSort=function(S){D=S},this.setTransparentSort=function(S){L=S},this.getClearColor=function(S){return S.copy(he.getClearColor())},this.setClearColor=function(){he.setClearColor.apply(he,arguments)},this.getClearAlpha=function(){return he.getClearAlpha()},this.setClearAlpha=function(){he.setClearAlpha.apply(he,arguments)},this.clear=function(S=!0,k=!0,W=!0){let H=0;S&&(H|=16384),k&&(H|=256),W&&(H|=1024),J.clear(H)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",I,!1),e.removeEventListener("webglcontextrestored",xe,!1),E.dispose(),M.dispose(),G.dispose(),de.dispose(),Te.dispose(),Le.dispose(),le.dispose(),ot.dispose(),_e.dispose(),_e.removeEventListener("sessionstart",Et),_e.removeEventListener("sessionend",xi),oe&&(oe.dispose(),oe=null),$t.stop()},this.renderBufferDirect=function(S,k,W,H,K,Ye){null===k&&(k=xt);const at=K.isMesh&&K.matrixWorld.determinant()<0,yt=function iie(S,k,W,H,K){!0!==k.isScene&&(k=xt),se.resetTextureUnits();const Ye=k.fog,yt=null===v?_.outputEncoding:!0===v.isXRRenderTarget?v.texture.encoding:Io,ht=(H.isMeshStandardMaterial?Te:de).get(H.envMap||(H.isMeshStandardMaterial?k.environment:null)),kt=!0===H.vertexColors&&!!W.attributes.color&&4===W.attributes.color.itemSize,Tt=!!H.normalMap&&!!W.attributes.tangent,At=!!W.morphAttributes.position,vn=!!W.morphAttributes.normal,tl=!!W.morphAttributes.color,cu=H.toneMapped?_.toneMapping:0,uu=W.morphAttributes.position||W.morphAttributes.normal||W.morphAttributes.color,ps=void 0!==uu?uu.length:0,Nt=G.get(H),du=h.state.lights;!0!==F||!0!==Z&&S===b||X.setState(H,S,S===b&&H.id===w);let Nn=!1;H.version===Nt.__version?(Nt.needsLights&&Nt.lightsStateVersion!==du.state.version||Nt.outputEncoding!==yt||K.isInstancedMesh&&!1===Nt.instancing||!K.isInstancedMesh&&!0===Nt.instancing||K.isSkinnedMesh&&!1===Nt.skinning||!K.isSkinnedMesh&&!0===Nt.skinning||Nt.envMap!==ht||H.fog&&Nt.fog!==Ye||void 0!==Nt.numClippingPlanes&&(Nt.numClippingPlanes!==X.numPlanes||Nt.numIntersection!==X.numIntersection)||Nt.vertexAlphas!==kt||Nt.vertexTangents!==Tt||Nt.morphTargets!==At||Nt.morphNormals!==vn||Nt.morphColors!==tl||Nt.toneMapping!==cu||!0===Ae.isWebGL2&&Nt.morphTargetsCount!==ps)&&(Nn=!0):(Nn=!0,Nt.__version=H.version);let ms=Nt.currentProgram;!0===Nn&&(ms=SC(H,k,K));let Qo=!1,jh=!1,EC=!1;const ui=ms.getUniforms(),$h=Nt.uniforms;if(Ie.useProgram(ms.program)&&(Qo=!0,jh=!0,EC=!0),H.id!==w&&(w=H.id,jh=!0),Qo||b!==S){if(ui.setValue(J,"projectionMatrix",S.projectionMatrix),Ae.logarithmicDepthBuffer&&ui.setValue(J,"logDepthBufFC",2/(Math.log(S.far+1)/Math.LN2)),b!==S&&(b=S,jh=!0,EC=!0),H.isShaderMaterial||H.isMeshPhongMaterial||H.isMeshToonMaterial||H.isMeshStandardMaterial||H.envMap){const kr=ui.map.cameraPosition;void 0!==kr&&kr.setValue(J,Oe.setFromMatrixPosition(S.matrixWorld))}(H.isMeshPhongMaterial||H.isMeshToonMaterial||H.isMeshLambertMaterial||H.isMeshBasicMaterial||H.isMeshStandardMaterial||H.isShaderMaterial)&&ui.setValue(J,"isOrthographic",!0===S.isOrthographicCamera),(H.isMeshPhongMaterial||H.isMeshToonMaterial||H.isMeshLambertMaterial||H.isMeshBasicMaterial||H.isMeshStandardMaterial||H.isShaderMaterial||H.isShadowMaterial||K.isSkinnedMesh)&&ui.setValue(J,"viewMatrix",S.matrixWorldInverse)}if(K.isSkinnedMesh){ui.setOptional(J,K,"bindMatrix"),ui.setOptional(J,K,"bindMatrixInverse");const kr=K.skeleton;kr&&(Ae.floatVertexTextures?(null===kr.boneTexture&&kr.computeBoneTexture(),ui.setValue(J,"boneTexture",kr.boneTexture,se),ui.setValue(J,"boneTextureSize",kr.boneTextureSize)):ui.setOptional(J,kr,"boneMatrices"))}const TC=W.morphAttributes;return(void 0!==TC.position||void 0!==TC.normal||void 0!==TC.color&&!0===Ae.isWebGL2)&&Se.update(K,W,H,ms),(jh||Nt.receiveShadow!==K.receiveShadow)&&(Nt.receiveShadow=K.receiveShadow,ui.setValue(J,"receiveShadow",K.receiveShadow)),jh&&(ui.setValue(J,"toneMappingExposure",_.toneMappingExposure),Nt.needsLights&&function rie(S,k){S.ambientLightColor.needsUpdate=k,S.lightProbe.needsUpdate=k,S.directionalLights.needsUpdate=k,S.directionalLightShadows.needsUpdate=k,S.pointLights.needsUpdate=k,S.pointLightShadows.needsUpdate=k,S.spotLights.needsUpdate=k,S.spotLightShadows.needsUpdate=k,S.rectAreaLights.needsUpdate=k,S.hemisphereLights.needsUpdate=k}($h,EC),Ye&&H.fog&&jt.refreshFogUniforms($h,Ye),jt.refreshMaterialUniforms($h,H,x,N,oe),Uo.upload(J,Nt.uniformsList,$h,se)),H.isShaderMaterial&&!0===H.uniformsNeedUpdate&&(Uo.upload(J,Nt.uniformsList,$h,se),H.uniformsNeedUpdate=!1),H.isSpriteMaterial&&ui.setValue(J,"center",K.center),ui.setValue(J,"modelViewMatrix",K.modelViewMatrix),ui.setValue(J,"normalMatrix",K.normalMatrix),ui.setValue(J,"modelMatrix",K.matrixWorld),ms}(S,k,W,H,K);Ie.setMaterial(H,at);let ht=W.index;const kt=W.attributes.position;if(null===ht){if(void 0===kt||0===kt.count)return}else if(0===ht.count)return;let Tt=1;!0===H.wireframe&&(ht=ze.getWireframeAttribute(W),Tt=2),le.setup(K,H,yt,W,ht);let At,vn=Fe;null!==ht&&(At=we.get(ht),vn=Q,vn.setIndex(At));const tl=null!==ht?ht.count:kt.count,cu=W.drawRange.start*Tt,uu=W.drawRange.count*Tt,ps=null!==Ye?Ye.start*Tt:0,Nt=null!==Ye?Ye.count*Tt:1/0,du=Math.max(cu,ps),Nn=Math.min(tl,cu+uu,ps+Nt)-1,ms=Math.max(0,Nn-du+1);if(0!==ms){if(K.isMesh)!0===H.wireframe?(Ie.setLineWidth(H.wireframeLinewidth*He()),vn.setMode(1)):vn.setMode(4);else if(K.isLine){let Qo=H.linewidth;void 0===Qo&&(Qo=1),Ie.setLineWidth(Qo*He()),vn.setMode(K.isLineSegments?1:K.isLineLoop?2:3)}else K.isPoints?vn.setMode(0):K.isSprite&&vn.setMode(4);if(K.isInstancedMesh)vn.renderInstances(du,ms,K.count);else if(W.isInstancedBufferGeometry){const Qo=Math.min(W.instanceCount,W._maxInstanceCount);vn.renderInstances(du,ms,Qo)}else vn.render(du,ms)}},this.compile=function(S,k){h=M.get(S),h.init(),p.push(h),S.traverseVisible(function(W){W.isLight&&W.layers.test(k.layers)&&(h.pushLight(W),W.castShadow&&h.pushShadow(W))}),h.setupLights(_.physicallyCorrectLights),S.traverse(function(W){const H=W.material;if(H)if(Array.isArray(H))for(let K=0;K<H.length;K++)SC(H[K],S,W);else SC(H,S,W)}),p.pop(),h=null};let re=null;function Et(){$t.stop()}function xi(){$t.start()}const $t=new JP;function hs(S,k,W,H){if(!1===S.visible)return;if(S.layers.test(k.layers))if(S.isGroup)W=S.renderOrder;else if(S.isLOD)!0===S.autoUpdate&&S.update(k);else if(S.isLight)h.pushLight(S),S.castShadow&&h.pushShadow(S);else if(S.isSprite){if(!S.frustumCulled||q.intersectsSprite(S)){H&&Oe.setFromMatrixPosition(S.matrixWorld).applyMatrix4(ae);const at=Le.update(S),yt=S.material;yt.visible&&d.push(S,at,yt,W,Oe.z,null)}}else if((S.isMesh||S.isLine||S.isPoints)&&(S.isSkinnedMesh&&S.skeleton.frame!==_t.render.frame&&(S.skeleton.update(),S.skeleton.frame=_t.render.frame),!S.frustumCulled||q.intersectsObject(S))){H&&Oe.setFromMatrixPosition(S.matrixWorld).applyMatrix4(ae);const at=Le.update(S),yt=S.material;if(Array.isArray(yt)){const ht=at.groups;for(let kt=0,Tt=ht.length;kt<Tt;kt++){const At=ht[kt],vn=yt[At.materialIndex];vn&&vn.visible&&d.push(S,at,vn,W,Oe.z,At)}}else yt.visible&&d.push(S,at,yt,W,Oe.z,null)}const Ye=S.children;for(let at=0,yt=Ye.length;at<yt;at++)hs(Ye[at],k,W,H)}function fs(S,k,W,H){const K=S.opaque,Ye=S.transmissive,at=S.transparent;h.setupLightsView(W),Ye.length>0&&function tie(S,k,W){const H=Ae.isWebGL2;null===oe&&(oe=new Pi(1,1,{generateMipmaps:!0,type:null!==R.convert(wc)?wc:Ia,minFilter:1008,samples:H&&!0===s?4:0})),_.getDrawingBufferSize(ce),H?oe.setSize(ce.x,ce.y):oe.setSize(km(ce.x),km(ce.y));const K=_.getRenderTarget();_.setRenderTarget(oe),_.clear();const Ye=_.toneMapping;_.toneMapping=0,a_(S,k,W),_.toneMapping=Ye,se.updateMultisampleRenderTarget(oe),se.updateRenderTargetMipmap(oe),_.setRenderTarget(K)}(K,k,W),H&&Ie.viewport(T.copy(H)),K.length>0&&a_(K,k,W),Ye.length>0&&a_(Ye,k,W),at.length>0&&a_(at,k,W),Ie.buffers.depth.setTest(!0),Ie.buffers.depth.setMask(!0),Ie.buffers.color.setMask(!0),Ie.setPolygonOffset(!1)}function a_(S,k,W){const H=!0===k.isScene?k.overrideMaterial:null;for(let K=0,Ye=S.length;K<Ye;K++){const at=S[K],yt=at.object,ht=at.geometry,kt=null===H?at.material:H,Tt=at.group;yt.layers.test(W.layers)&&nie(yt,k,W,ht,kt,Tt)}}function nie(S,k,W,H,K,Ye){S.onBeforeRender(_,k,W,H,K,Ye),S.modelViewMatrix.multiplyMatrices(W.matrixWorldInverse,S.matrixWorld),S.normalMatrix.getNormalMatrix(S.modelViewMatrix),K.onBeforeRender(_,k,W,H,S,Ye),!0===K.transparent&&2===K.side?(K.side=1,K.needsUpdate=!0,_.renderBufferDirect(W,k,H,K,S,Ye),K.side=0,K.needsUpdate=!0,_.renderBufferDirect(W,k,H,K,S,Ye),K.side=2):_.renderBufferDirect(W,k,H,K,S,Ye),S.onAfterRender(_,k,W,H,K,Ye)}function SC(S,k,W){!0!==k.isScene&&(k=xt);const H=G.get(S),K=h.state.lights,at=K.state.version,yt=ot.getParameters(S,K.state,h.state.shadowsArray,k,W),ht=ot.getProgramCacheKey(yt);let kt=H.programs;H.environment=S.isMeshStandardMaterial?k.environment:null,H.fog=k.fog,H.envMap=(S.isMeshStandardMaterial?Te:de).get(S.envMap||H.environment),void 0===kt&&(S.addEventListener("dispose",ye),kt=new Map,H.programs=kt);let Tt=kt.get(ht);if(void 0!==Tt){if(H.currentProgram===Tt&&H.lightsStateVersion===at)return _O(S,yt),Tt}else yt.uniforms=ot.getUniforms(S),S.onBuild(W,yt,_),S.onBeforeCompile(yt,_),Tt=ot.acquireProgram(yt,ht),kt.set(ht,Tt),H.uniforms=yt.uniforms;const At=H.uniforms;(!S.isShaderMaterial&&!S.isRawShaderMaterial||!0===S.clipping)&&(At.clippingPlanes=X.uniform),_O(S,yt),H.needsLights=function sie(S){return S.isMeshLambertMaterial||S.isMeshToonMaterial||S.isMeshPhongMaterial||S.isMeshStandardMaterial||S.isShadowMaterial||S.isShaderMaterial&&!0===S.lights}(S),H.lightsStateVersion=at,H.needsLights&&(At.ambientLightColor.value=K.state.ambient,At.lightProbe.value=K.state.probe,At.directionalLights.value=K.state.directional,At.directionalLightShadows.value=K.state.directionalShadow,At.spotLights.value=K.state.spot,At.spotLightShadows.value=K.state.spotShadow,At.rectAreaLights.value=K.state.rectArea,At.ltc_1.value=K.state.rectAreaLTC1,At.ltc_2.value=K.state.rectAreaLTC2,At.pointLights.value=K.state.point,At.pointLightShadows.value=K.state.pointShadow,At.hemisphereLights.value=K.state.hemi,At.directionalShadowMap.value=K.state.directionalShadowMap,At.directionalShadowMatrix.value=K.state.directionalShadowMatrix,At.spotShadowMap.value=K.state.spotShadowMap,At.spotShadowMatrix.value=K.state.spotShadowMatrix,At.pointShadowMap.value=K.state.pointShadowMap,At.pointShadowMatrix.value=K.state.pointShadowMatrix);const vn=Tt.getUniforms(),tl=Uo.seqWithValue(vn.seq,At);return H.currentProgram=Tt,H.uniformsList=tl,Tt}function _O(S,k){const W=G.get(S);W.outputEncoding=k.outputEncoding,W.instancing=k.instancing,W.skinning=k.skinning,W.morphTargets=k.morphTargets,W.morphNormals=k.morphNormals,W.morphColors=k.morphColors,W.morphTargetsCount=k.morphTargetsCount,W.numClippingPlanes=k.numClippingPlanes,W.numIntersection=k.numClipIntersection,W.vertexAlphas=k.vertexAlphas,W.vertexTangents=k.vertexTangents,W.toneMapping=k.toneMapping}$t.setAnimationLoop(function Ze(S){re&&re(S)}),"undefined"!=typeof window&&$t.setContext(window),this.setAnimationLoop=function(S){re=S,_e.setAnimationLoop(S),null===S?$t.stop():$t.start()},_e.addEventListener("sessionstart",Et),_e.addEventListener("sessionend",xi),this.render=function(S,k){if(void 0===k||!0===k.isCamera){if(!0!==y){if(!0===S.autoUpdate&&S.updateMatrixWorld(),null===k.parent&&k.updateMatrixWorld(),!0===_e.enabled&&!0===_e.isPresenting&&(!0===_e.cameraAutoUpdate&&_e.updateCamera(k),k=_e.getCamera()),!0===S.isScene&&S.onBeforeRender(_,S,k,v),h=M.get(S,p.length),h.init(),p.push(h),ae.multiplyMatrices(k.projectionMatrix,k.matrixWorldInverse),q.setFromProjectionMatrix(ae),Z=this.localClippingEnabled,F=X.init(this.clippingPlanes,Z,k),d=E.get(S,f.length),d.init(),f.push(d),hs(S,k,0,_.sortObjects),d.finish(),!0===_.sortObjects&&d.sort(D,L),!0===F&&X.beginShadows(),ee.render(h.state.shadowsArray,S,k),!0===F&&X.endShadows(),!0===this.info.autoReset&&this.info.reset(),he.render(d,S),h.setupLights(_.physicallyCorrectLights),k.isArrayCamera){const H=k.cameras;for(let K=0,Ye=H.length;K<Ye;K++){const at=H[K];fs(d,S,at,at.viewport)}}else fs(d,S,k);null!==v&&(se.updateMultisampleRenderTarget(v),se.updateRenderTargetMipmap(v)),!0===S.isScene&&S.onAfterRender(_,S,k),le.resetDefaultState(),w=-1,b=null,p.pop(),h=p.length>0?p[p.length-1]:null,f.pop(),d=f.length>0?f[f.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return g},this.getActiveMipmapLevel=function(){return m},this.getRenderTarget=function(){return v},this.setRenderTargetTextures=function(S,k,W){G.get(S.texture).__webglTexture=k,G.get(S.depthTexture).__webglTexture=W;const H=G.get(S);H.__hasExternalTextures=!0,H.__hasExternalTextures&&(H.__autoAllocateDepthBuffer=void 0===W,H.__autoAllocateDepthBuffer||!0===et.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),H.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(S,k){const W=G.get(S);W.__webglFramebuffer=k,W.__useDefaultFramebuffer=void 0===k},this.setRenderTarget=function(S,k=0,W=0){v=S,g=k,m=W;let H=!0;if(S){const ht=G.get(S);void 0!==ht.__useDefaultFramebuffer?(Ie.bindFramebuffer(36160,null),H=!1):void 0===ht.__webglFramebuffer?se.setupRenderTarget(S):ht.__hasExternalTextures&&se.rebindTextures(S,G.get(S.texture).__webglTexture,G.get(S.depthTexture).__webglTexture)}let K=null,Ye=!1,at=!1;if(S){const ht=S.texture;(ht.isData3DTexture||ht.isDataArrayTexture)&&(at=!0);const kt=G.get(S).__webglFramebuffer;S.isWebGLCubeRenderTarget?(K=kt[k],Ye=!0):K=Ae.isWebGL2&&S.samples>0&&!1===se.useMultisampledRTT(S)?G.get(S).__webglMultisampledFramebuffer:kt,T.copy(S.viewport),A.copy(S.scissor),P=S.scissorTest}else T.copy(O).multiplyScalar(x).floor(),A.copy(U).multiplyScalar(x).floor(),P=B;if(Ie.bindFramebuffer(36160,K)&&Ae.drawBuffers&&H&&Ie.drawBuffers(S,K),Ie.viewport(T),Ie.scissor(A),Ie.setScissorTest(P),Ye){const ht=G.get(S.texture);J.framebufferTexture2D(36160,36064,34069+k,ht.__webglTexture,W)}else if(at){const ht=G.get(S.texture);J.framebufferTextureLayer(36160,36064,ht.__webglTexture,W||0,k||0)}w=-1},this.readRenderTargetPixels=function(S,k,W,H,K,Ye,at){if(!S||!S.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let yt=G.get(S).__webglFramebuffer;if(S.isWebGLCubeRenderTarget&&void 0!==at&&(yt=yt[at]),yt){Ie.bindFramebuffer(36160,yt);try{const ht=S.texture,kt=ht.format,Tt=ht.type;if(kt!==vi&&R.convert(kt)!==J.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const At=Tt===wc&&(et.has("EXT_color_buffer_half_float")||Ae.isWebGL2&&et.has("EXT_color_buffer_float"));if(!(Tt===Ia||R.convert(Tt)===J.getParameter(35738)||Tt===Ao&&(Ae.isWebGL2||et.has("OES_texture_float")||et.has("WEBGL_color_buffer_float"))||At))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===J.checkFramebufferStatus(36160)?k>=0&&k<=S.width-H&&W>=0&&W<=S.height-K&&J.readPixels(k,W,H,K,R.convert(kt),R.convert(Tt),Ye):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const ht=null!==v?G.get(v).__webglFramebuffer:null;Ie.bindFramebuffer(36160,ht)}}},this.copyFramebufferToTexture=function(S,k,W=0){if(!0!==k.isFramebufferTexture)return void console.error("THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture.");const H=Math.pow(2,-W),K=Math.floor(k.image.width*H),Ye=Math.floor(k.image.height*H);se.setTexture2D(k,0),J.copyTexSubImage2D(3553,W,0,0,S.x,S.y,K,Ye),Ie.unbindTexture()},this.copyTextureToTexture=function(S,k,W,H=0){const K=k.image.width,Ye=k.image.height,at=R.convert(W.format),yt=R.convert(W.type);se.setTexture2D(W,0),J.pixelStorei(37440,W.flipY),J.pixelStorei(37441,W.premultiplyAlpha),J.pixelStorei(3317,W.unpackAlignment),k.isDataTexture?J.texSubImage2D(3553,H,S.x,S.y,K,Ye,at,yt,k.image.data):k.isCompressedTexture?J.compressedTexSubImage2D(3553,H,S.x,S.y,k.mipmaps[0].width,k.mipmaps[0].height,at,k.mipmaps[0].data):J.texSubImage2D(3553,H,S.x,S.y,at,yt,k.image),0===H&&W.generateMipmaps&&J.generateMipmap(3553),Ie.unbindTexture()},this.copyTextureToTexture3D=function(S,k,W,H,K=0){if(_.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Ye=S.max.x-S.min.x+1,at=S.max.y-S.min.y+1,yt=S.max.z-S.min.z+1,ht=R.convert(H.format),kt=R.convert(H.type);let Tt;if(H.isData3DTexture)se.setTexture3D(H,0),Tt=32879;else{if(!H.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");se.setTexture2DArray(H,0),Tt=35866}J.pixelStorei(37440,H.flipY),J.pixelStorei(37441,H.premultiplyAlpha),J.pixelStorei(3317,H.unpackAlignment);const At=J.getParameter(3314),vn=J.getParameter(32878),tl=J.getParameter(3316),cu=J.getParameter(3315),uu=J.getParameter(32877),ps=W.isCompressedTexture?W.mipmaps[0]:W.image;J.pixelStorei(3314,ps.width),J.pixelStorei(32878,ps.height),J.pixelStorei(3316,S.min.x),J.pixelStorei(3315,S.min.y),J.pixelStorei(32877,S.min.z),W.isDataTexture||W.isData3DTexture?J.texSubImage3D(Tt,K,k.x,k.y,k.z,Ye,at,yt,ht,kt,ps.data):W.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),J.compressedTexSubImage3D(Tt,K,k.x,k.y,k.z,Ye,at,yt,ht,ps.data)):J.texSubImage3D(Tt,K,k.x,k.y,k.z,Ye,at,yt,ht,kt,ps),J.pixelStorei(3314,At),J.pixelStorei(32878,vn),J.pixelStorei(3316,tl),J.pixelStorei(3315,cu),J.pixelStorei(32877,uu),0===K&&H.generateMipmaps&&J.generateMipmap(Tt),Ie.unbindTexture()},this.initTexture=function(S){se.setTexture2D(S,0),Ie.unbindTexture()},this.resetState=function(){g=0,m=0,v=null,Ie.reset(),le.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Pt.prototype.isWebGLRenderer=!0,class oZ extends Pt{}.prototype.isWebGL1Renderer=!0;class ag{constructor(e,t=25e-5){this.name="",this.color=new me(e),this.density=t}clone(){return new ag(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}ag.prototype.isFogExp2=!0;class lg{constructor(e,t=1,i=1e3){this.name="",this.color=new me(e),this.near=t,this.far=i}clone(){return new lg(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}lg.prototype.isFog=!0;class wh extends Rt{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}wh.prototype.isScene=!0;class qc{constructor(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=lh,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Qi()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Qi()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Qi()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}qc.prototype.isInterleavedBuffer=!0;const xn=new C;class Ga{constructor(e,t,i,r=!1){this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=!0===r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)xn.x=this.getX(t),xn.y=this.getY(t),xn.z=this.getZ(t),xn.applyMatrix4(e),this.setXYZ(t,xn.x,xn.y,xn.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)xn.x=this.getX(t),xn.y=this.getY(t),xn.z=this.getZ(t),xn.applyNormalMatrix(e),this.setXYZ(t,xn.x,xn.y,xn.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)xn.x=this.getX(t),xn.y=this.getY(t),xn.z=this.getZ(t),xn.transformDirection(e),this.setXYZ(t,xn.x,xn.y,xn.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,i){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new Ut(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Ga(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}Ga.prototype.isInterleavedBufferAttribute=!0;class _x extends Pn{constructor(e){super(),this.type="SpriteMaterial",this.color=new me(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}let Yc;_x.prototype.isSpriteMaterial=!0;const bh=new C,Xc=new C,Qc=new C,Jc=new j,xh=new j,I3=new Pe,cg=new C,Ch=new C,ug=new C,R3=new j,yx=new j,P3=new j;function dg(n,e,t,i,r,s){Jc.subVectors(n,t).addScalar(.5).multiply(i),void 0!==r?(xh.x=s*Jc.x-r*Jc.y,xh.y=r*Jc.x+s*Jc.y):xh.copy(Jc),n.copy(e),n.x+=xh.x,n.y+=xh.y,n.applyMatrix4(I3)}(class vx extends Rt{constructor(e){if(super(),this.type="Sprite",void 0===Yc){Yc=new Ve;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new qc(t,5);Yc.setIndex([0,1,2,0,2,3]),Yc.setAttribute("position",new Ga(i,3,0,!1)),Yc.setAttribute("uv",new Ga(i,2,3,!1))}this.geometry=Yc,this.material=void 0!==e?e:new _x,this.center=new j(.5,.5)}raycast(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Xc.setFromMatrixScale(this.matrixWorld),I3.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Qc.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Xc.multiplyScalar(-Qc.z);const i=this.material.rotation;let r,s;0!==i&&(s=Math.cos(i),r=Math.sin(i));const o=this.center;dg(cg.set(-.5,-.5,0),Qc,o,Xc,r,s),dg(Ch.set(.5,-.5,0),Qc,o,Xc,r,s),dg(ug.set(.5,.5,0),Qc,o,Xc,r,s),R3.set(0,0),yx.set(1,0),P3.set(1,1);let a=e.ray.intersectTriangle(cg,Ch,ug,!1,bh);if(null===a&&(dg(Ch.set(-.5,.5,0),Qc,o,Xc,r,s),yx.set(0,1),a=e.ray.intersectTriangle(cg,ug,Ch,!1,bh),null===a))return;const l=e.ray.origin.distanceTo(bh);l<e.near||l>e.far||t.push({distance:l,point:bh.clone(),uv:Rn.getUV(bh,cg,Ch,ug,R3,yx,P3,new j),face:null,object:this})}copy(e){return super.copy(e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}).prototype.isSprite=!0;const L3=new C,O3=new Ft,F3=new Ft,lZ=new C,k3=new Pe;class wx extends nn{constructor(e,t){super(e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Pe,this.bindMatrixInverse=new Pe}copy(e){return super.copy(e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Ft,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.x=t.getX(i),e.y=t.getY(i),e.z=t.getZ(i),e.w=t.getW(i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const i=this.skeleton,r=this.geometry;O3.fromBufferAttribute(r.attributes.skinIndex,e),F3.fromBufferAttribute(r.attributes.skinWeight,e),L3.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=F3.getComponent(s);if(0!==o){const a=O3.getComponent(s);k3.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(lZ.copy(L3).applyMatrix4(k3),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}wx.prototype.isSkinnedMesh=!0;(class bx extends Rt{constructor(){super(),this.type="Bone"}}).prototype.isBone=!0;(class Kc extends Ri{constructor(e=null,t=1,i=1,r,s,o,a,l,c=Un,u=Un,d,h){super(null,o,a,l,c,u,r,s,d,h),this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}).prototype.isDataTexture=!0;class Zc extends Ut{constructor(e,t,i,r=1){"number"==typeof i&&(r=i,i=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,t,i),this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}Zc.prototype.isInstancedBufferAttribute=!0;const V3=new Pe,U3=new Pe,fg=[],Mh=new nn;(class H3 extends nn{constructor(e,t,i){super(e,t),this.instanceMatrix=new Zc(new Float32Array(16*i),16),this.instanceColor=null,this.count=i,this.frustumCulled=!1}copy(e){return super.copy(e),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const i=this.matrixWorld,r=this.count;if(Mh.geometry=this.geometry,Mh.material=this.material,void 0!==Mh.material)for(let s=0;s<r;s++){this.getMatrixAt(s,V3),U3.multiplyMatrices(i,V3),Mh.matrixWorld=U3,Mh.raycast(e,fg);for(let o=0,a=fg.length;o<a;o++){const l=fg[o];l.instanceId=s,l.object=this,t.push(l)}fg.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new Zc(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}).prototype.isInstancedMesh=!0;class Qn extends Pn{constructor(e){super(),this.type="LineBasicMaterial",this.color=new me(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this}}Qn.prototype.isLineBasicMaterial=!0;const z3=new C,G3=new C,W3=new Pe,Cx=new Ba,pg=new ka;class Wa extends Rt{constructor(e=new Ve,t=new Qn){super(),this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)z3.fromBufferAttribute(t,r-1),G3.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=z3.distanceTo(G3);e.setAttribute("lineDistance",new De(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),pg.copy(i.boundingSphere),pg.applyMatrix4(r),pg.radius+=s,!1===e.ray.intersectsSphere(pg))return;W3.copy(r).invert(),Cx.copy(e.ray).applyMatrix4(W3);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=new C,u=new C,d=new C,h=new C,f=this.isLineSegments?2:1;if(i.isBufferGeometry){const p=i.index,y=i.attributes.position;if(null!==p)for(let v=Math.max(0,o.start),w=Math.min(p.count,o.start+o.count)-1;v<w;v+=f){const b=p.getX(v),T=p.getX(v+1);if(c.fromBufferAttribute(y,b),u.fromBufferAttribute(y,T),Cx.distanceSqToSegment(c,u,h,d)>l)continue;h.applyMatrix4(this.matrixWorld);const P=e.ray.origin.distanceTo(h);P<e.near||P>e.far||t.push({distance:P,point:d.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}else for(let v=Math.max(0,o.start),w=Math.min(y.count,o.start+o.count)-1;v<w;v+=f){if(c.fromBufferAttribute(y,v),u.fromBufferAttribute(y,v+1),Cx.distanceSqToSegment(c,u,h,d)>l)continue;h.applyMatrix4(this.matrixWorld);const T=e.ray.origin.distanceTo(h);T<e.near||T>e.far||t.push({distance:T,point:d.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}else i.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}Wa.prototype.isLine=!0;const j3=new C,$3=new C;class Ys extends Wa{constructor(e,t){super(e,t),this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)j3.fromBufferAttribute(t,r),$3.fromBufferAttribute(t,r+1),i[r]=0===r?0:i[r-1],i[r+1]=i[r]+j3.distanceTo($3);e.setAttribute("lineDistance",new De(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}Ys.prototype.isLineSegments=!0;(class q3 extends Wa{constructor(e,t){super(e,t),this.type="LineLoop"}}).prototype.isLineLoop=!0;class eu extends Pn{constructor(e){super(),this.type="PointsMaterial",this.color=new me(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this}}eu.prototype.isPointsMaterial=!0;const Y3=new Pe,Mx=new Ba,mg=new ka,gg=new C;function X3(n,e,t,i,r,s,o){const a=Mx.distanceSqToPoint(n);if(a<t){const l=new C;Mx.closestPointToPoint(n,l),l.applyMatrix4(i);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}(class _g extends Rt{constructor(e=new Ve,t=new eu){super(),this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),mg.copy(i.boundingSphere),mg.applyMatrix4(r),mg.radius+=s,!1===e.ray.intersectsSphere(mg))return;Y3.copy(r).invert(),Mx.copy(e.ray).applyMatrix4(Y3);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a;if(i.isBufferGeometry){const c=i.index,d=i.attributes.position;if(null!==c)for(let p=Math.max(0,o.start),_=Math.min(c.count,o.start+o.count);p<_;p++){const y=c.getX(p);gg.fromBufferAttribute(d,y),X3(gg,y,l,r,e,t,this)}else for(let p=Math.max(0,o.start),_=Math.min(d.count,o.start+o.count);p<_;p++)gg.fromBufferAttribute(d,p),X3(gg,p,l,r,e,t,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}).prototype.isPoints=!0,class uZ extends Ri{constructor(e,t,i,r,s,o,a,l,c){super(e,t,i,r,s,o,a,l,c),this.minFilter=void 0!==o?o:_n,this.magFilter=void 0!==s?s:_n,this.generateMipmaps=!1;const u=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(function d(){u.needsUpdate=!0,e.requestVideoFrameCallback(d)})}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e==0&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}.prototype.isVideoTexture=!0,class dZ extends Ri{constructor(e,t,i){super({width:e,height:t}),this.format=i,this.magFilter=Un,this.minFilter=Un,this.generateMipmaps=!1,this.needsUpdate=!0}}.prototype.isFramebufferTexture=!0;(class Q3 extends Ri{constructor(e,t,i,r,s,o,a,l,c,u,d,h){super(null,o,a,l,c,u,r,s,d,h),this.image={width:t,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}).prototype.isCompressedTexture=!0,class hZ extends Ri{constructor(e,t,i,r,s,o,a,l,c){super(e,t,i,r,s,o,a,l,c),this.needsUpdate=!0}}.prototype.isCanvasTexture=!0;class Sh extends Ve{constructor(e=1,t=8,i=0,r=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:r},t=Math.max(3,t);const s=[],o=[],a=[],l=[],c=new C,u=new j;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let d=0,h=3;d<=t;d++,h+=3){const f=i+d/t*r;c.x=e*Math.cos(f),c.y=e*Math.sin(f),o.push(c.x,c.y,c.z),a.push(0,0,1),u.x=(o[h]/e+1)/2,u.y=(o[h+1]/e+1)/2,l.push(u.x,u.y)}for(let d=1;d<=t;d++)s.push(d,d+1,0);this.setIndex(s),this.setAttribute("position",new De(o,3)),this.setAttribute("normal",new De(a,3)),this.setAttribute("uv",new De(l,2))}static fromJSON(e){return new Sh(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class ja extends Ve{constructor(e=1,t=1,i=1,r=8,s=1,o=!1,a=0,l=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const c=this;r=Math.floor(r),s=Math.floor(s);const u=[],d=[],h=[],f=[];let p=0;const _=[],y=i/2;let g=0;function v(w){const b=p,T=new j,A=new C;let P=0;const z=!0===w?e:t,N=!0===w?1:-1;for(let D=1;D<=r;D++)d.push(0,y*N,0),h.push(0,N,0),f.push(.5,.5),p++;const x=p;for(let D=0;D<=r;D++){const O=D/r*l+a,U=Math.cos(O),B=Math.sin(O);A.x=z*B,A.y=y*N,A.z=z*U,d.push(A.x,A.y,A.z),h.push(0,N,0),T.x=.5*U+.5,T.y=.5*B*N+.5,f.push(T.x,T.y),p++}for(let D=0;D<r;D++){const L=b+D,O=x+D;!0===w?u.push(O,O+1,L):u.push(O+1,O,L),P+=3}c.addGroup(g,P,!0===w?1:2),g+=P}(function m(){const w=new C,b=new C;let T=0;const A=(t-e)/i;for(let P=0;P<=s;P++){const z=[],N=P/s,x=N*(t-e)+e;for(let D=0;D<=r;D++){const L=D/r,O=L*l+a,U=Math.sin(O),B=Math.cos(O);b.x=x*U,b.y=-N*i+y,b.z=x*B,d.push(b.x,b.y,b.z),w.set(U,A,B).normalize(),h.push(w.x,w.y,w.z),f.push(L,1-N),z.push(p++)}_.push(z)}for(let P=0;P<r;P++)for(let z=0;z<s;z++){const x=_[z+1][P],D=_[z+1][P+1],L=_[z][P+1];u.push(_[z][P],x,L),u.push(x,D,L),T+=6}c.addGroup(g,T,0),g+=T})(),!1===o&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(u),this.setAttribute("position",new De(d,3)),this.setAttribute("normal",new De(h,3)),this.setAttribute("uv",new De(f,2))}static fromJSON(e){return new ja(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}const wg=new C,bg=new C,Sx=new C,xg=new Rn;class Ex extends Ve{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){const r=Math.pow(10,4),s=Math.cos(Pa*t),o=e.getIndex(),a=e.getAttribute("position"),l=o?o.count:a.count,c=[0,0,0],u=["a","b","c"],d=new Array(3),h={},f=[];for(let p=0;p<l;p+=3){o?(c[0]=o.getX(p),c[1]=o.getX(p+1),c[2]=o.getX(p+2)):(c[0]=p,c[1]=p+1,c[2]=p+2);const{a:_,b:y,c:g}=xg;if(_.fromBufferAttribute(a,c[0]),y.fromBufferAttribute(a,c[1]),g.fromBufferAttribute(a,c[2]),xg.getNormal(Sx),d[0]=`${Math.round(_.x*r)},${Math.round(_.y*r)},${Math.round(_.z*r)}`,d[1]=`${Math.round(y.x*r)},${Math.round(y.y*r)},${Math.round(y.z*r)}`,d[2]=`${Math.round(g.x*r)},${Math.round(g.y*r)},${Math.round(g.z*r)}`,d[0]!==d[1]&&d[1]!==d[2]&&d[2]!==d[0])for(let m=0;m<3;m++){const v=(m+1)%3,w=d[m],b=d[v],T=xg[u[m]],A=xg[u[v]],P=`${w}_${b}`,z=`${b}_${w}`;z in h&&h[z]?(Sx.dot(h[z].normal)<=s&&(f.push(T.x,T.y,T.z),f.push(A.x,A.y,A.z)),h[z]=null):P in h||(h[P]={index0:c[m],index1:c[v],normal:Sx.clone()})}}for(const p in h)if(h[p]){const{index0:_,index1:y}=h[p];wg.fromBufferAttribute(a,_),bg.fromBufferAttribute(a,y),f.push(wg.x,wg.y,wg.z),f.push(bg.x,bg.y,bg.z)}this.setAttribute("position",new De(f,3))}}}class mr{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),s+=i.distanceTo(r),t.push(s),r=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const i=this.getLengths();let r=0;const s=i.length;let o;o=t||e*i[s-1];let c,a=0,l=s-1;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),c=i[r]-o,c<0)a=r+1;else{if(!(c>0)){l=r;break}l=r-1}if(r=l,i[r]===o)return r/(s-1);const u=i[r];return(r+(o-u)/(i[r+1]-u))/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),l=t||(o.isVector2?new j:new C);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){const i=new C,r=[],s=[],o=[],a=new C,l=new Pe;for(let f=0;f<=e;f++)r[f]=this.getTangentAt(f/e,new C);s[0]=new C,o[0]=new C;let c=Number.MAX_VALUE;const u=Math.abs(r[0].x),d=Math.abs(r[0].y),h=Math.abs(r[0].z);u<=c&&(c=u,i.set(1,0,0)),d<=c&&(c=d,i.set(0,1,0)),h<=c&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let f=1;f<=e;f++){if(s[f]=s[f-1].clone(),o[f]=o[f-1].clone(),a.crossVectors(r[f-1],r[f]),a.length()>Number.EPSILON){a.normalize();const p=Math.acos(ei(r[f-1].dot(r[f]),-1,1));s[f].applyMatrix4(l.makeRotationAxis(a,p))}o[f].crossVectors(r[f],s[f])}if(!0===t){let f=Math.acos(ei(s[0].dot(s[e]),-1,1));f/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(f=-f);for(let p=1;p<=e;p++)s[p].applyMatrix4(l.makeRotationAxis(r[p],f*p)),o[p].crossVectors(r[p],s[p])}return{tangents:r,normals:s,binormals:o}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Cg extends mr{constructor(e=0,t=0,i=1,r=1,s=0,o=2*Math.PI,a=!1,l=0){super(),this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,t){const i=t||new j,r=2*Math.PI;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(s=o?0:r),!0===this.aClockwise&&!o&&(s===r?s=-r:s-=r);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){const u=Math.cos(this.aRotation),d=Math.sin(this.aRotation),h=l-this.aX,f=c-this.aY;l=h*u-f*d+this.aX,c=h*d+f*u+this.aY}return i.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}Cg.prototype.isEllipseCurve=!0;class J3 extends Cg{constructor(e,t,i,r,s,o){super(e,t,i,i,r,s,o),this.type="ArcCurve"}}function Tx(){let n=0,e=0,t=0,i=0;function r(s,o,a,l){n=s,e=a,t=-3*s+3*o-2*a-l,i=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){r(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,u,d){let h=(o-s)/c-(a-s)/(c+u)+(a-o)/u,f=(a-o)/u-(l-o)/(u+d)+(l-a)/d;h*=u,f*=u,r(o,a,h,f)},calc:function(s){const o=s*s;return n+e*s+t*o+i*(o*s)}}}J3.prototype.isArcCurve=!0;const Mg=new C,Dx=new Tx,Ax=new Tx,Ix=new Tx;class K3 extends mr{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(e,t=new C){const i=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let c,u,a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:0===l&&a===s-1&&(a=s-2,l=1),this.closed||a>0?c=r[(a-1)%s]:(Mg.subVectors(r[0],r[1]).add(r[0]),c=Mg);const d=r[a%s],h=r[(a+1)%s];if(this.closed||a+2<s?u=r[(a+2)%s]:(Mg.subVectors(r[s-1],r[s-2]).add(r[s-1]),u=Mg),"centripetal"===this.curveType||"chordal"===this.curveType){const f="chordal"===this.curveType?.5:.25;let p=Math.pow(c.distanceToSquared(d),f),_=Math.pow(d.distanceToSquared(h),f),y=Math.pow(h.distanceToSquared(u),f);_<1e-4&&(_=1),p<1e-4&&(p=_),y<1e-4&&(y=_),Dx.initNonuniformCatmullRom(c.x,d.x,h.x,u.x,p,_,y),Ax.initNonuniformCatmullRom(c.y,d.y,h.y,u.y,p,_,y),Ix.initNonuniformCatmullRom(c.z,d.z,h.z,u.z,p,_,y)}else"catmullrom"===this.curveType&&(Dx.initCatmullRom(c.x,d.x,h.x,u.x,this.tension),Ax.initCatmullRom(c.y,d.y,h.y,u.y,this.tension),Ix.initCatmullRom(c.z,d.z,h.z,u.z,this.tension));return i.set(Dx.calc(l),Ax.calc(l),Ix.calc(l)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++)this.points.push(e.points[t].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++)e.points.push(this.points[t].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push((new C).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function Z3(n,e,t,i,r){const s=.5*(i-e),o=.5*(r-t),a=n*n;return(2*t-2*i+s+o)*(n*a)+(-3*t+3*i-2*s-o)*a+s*n+t}function Eh(n,e,t,i){return function fZ(n,e){const t=1-n;return t*t*e}(n,e)+function pZ(n,e){return 2*(1-n)*n*e}(n,t)+function mZ(n,e){return n*n*e}(n,i)}function Th(n,e,t,i,r){return function gZ(n,e){const t=1-n;return t*t*t*e}(n,e)+function _Z(n,e){const t=1-n;return 3*t*t*n*e}(n,t)+function yZ(n,e){return 3*(1-n)*n*n*e}(n,i)+function vZ(n,e){return n*n*n*e}(n,r)}K3.prototype.isCatmullRomCurve3=!0;class Rx extends mr{constructor(e=new j,t=new j,i=new j,r=new j){super(),this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new j){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(Th(e,r.x,s.x,o.x,a.x),Th(e,r.y,s.y,o.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}Rx.prototype.isCubicBezierCurve=!0;class eN extends mr{constructor(e=new C,t=new C,i=new C,r=new C){super(),this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new C){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(Th(e,r.x,s.x,o.x,a.x),Th(e,r.y,s.y,o.y,a.y),Th(e,r.z,s.z,o.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}eN.prototype.isCubicBezierCurve3=!0;class Sg extends mr{constructor(e=new j,t=new j){super(),this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new j){const i=t;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){const i=t||new j;return i.copy(this.v2).sub(this.v1).normalize(),i}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Sg.prototype.isLineCurve=!0;class Px extends mr{constructor(e=new j,t=new j,i=new j){super(),this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new j){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(Eh(e,r.x,s.x,o.x),Eh(e,r.y,s.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Px.prototype.isQuadraticBezierCurve=!0;class Nx extends mr{constructor(e=new C,t=new C,i=new C){super(),this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new C){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(Eh(e,r.x,s.x,o.x),Eh(e,r.y,s.y,o.y),Eh(e,r.z,s.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Nx.prototype.isQuadraticBezierCurve3=!0;class Lx extends mr{constructor(e=[]){super(),this.type="SplineCurve",this.points=e}getPoint(e,t=new j){const i=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,l=r[0===o?o:o-1],c=r[o],u=r[o>r.length-2?r.length-1:o+1],d=r[o>r.length-3?r.length-1:o+2];return i.set(Z3(a,l.x,c.x,u.x,d.x),Z3(a,l.y,c.y,u.y,d.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++)this.points.push(e.points[t].clone());return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++)e.points.push(this.points[t].toArray());return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push((new j).fromArray(r))}return this}}Lx.prototype.isSplineCurve=!0;var Ox=Object.freeze({__proto__:null,ArcCurve:J3,CatmullRomCurve3:K3,CubicBezierCurve:Rx,CubicBezierCurve3:eN,EllipseCurve:Cg,LineCurve:Sg,LineCurve3:class wZ extends mr{constructor(e=new C,t=new C){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=e,this.v2=t}getPoint(e,t=new C){const i=t;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},QuadraticBezierCurve:Px,QuadraticBezierCurve3:Nx,SplineCurve:Lx});class bZ extends mr{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Sg(t,e))}getPoint(e,t){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const o=r[s]-i,a=this.curves[s],l=a.getLength();return a.getPointAt(0===l?0:1-o/l,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let i=0,r=this.curves.length;i<r;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],l=o.getPoints(o.isEllipseCurve?2*e:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e);for(let c=0;c<l.length;c++){const u=l[c];i&&i.equals(u)||(t.push(u),i=u)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++)this.curves.push(e.curves[t].clone());return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++)e.curves.push(this.curves[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push((new Ox[r.type]).fromJSON(r))}return this}}class Eg extends bZ{constructor(e){super(),this.type="Path",this.currentPoint=new j,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const i=new Sg(this.currentPoint.clone(),new j(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){const s=new Px(this.currentPoint.clone(),new j(e,t),new j(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,s,o){const a=new Rx(this.currentPoint.clone(),new j(e,t),new j(i,r),new j(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),i=new Lx(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,s,o){return this.absarc(e+this.currentPoint.x,t+this.currentPoint.y,i,r,s,o),this}absarc(e,t,i,r,s,o){return this.absellipse(e,t,i,i,r,s,o),this}ellipse(e,t,i,r,s,o,a,l){return this.absellipse(e+this.currentPoint.x,t+this.currentPoint.y,i,r,s,o,a,l),this}absellipse(e,t,i,r,s,o,a,l){const c=new Cg(e,t,i,r,s,o,a,l);if(this.curves.length>0){const d=c.getPoint(0);d.equals(this.currentPoint)||this.lineTo(d.x,d.y)}this.curves.push(c);const u=c.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class ls extends Eg{constructor(e){super(e),this.uuid=Qi(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++)this.holes.push(e.holes[t].clone());return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++)e.holes.push(this.holes[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push((new Eg).fromJSON(r))}return this}}function tN(n,e,t,i,r){let s,o;if(r===function BZ(n,e,t,i){let r=0;for(let s=e,o=t-i;s<t;s+=i)r+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return r}(n,e,t,i)>0)for(s=e;s<t;s+=i)o=rN(s,n[s],n[s+1],o);else for(s=t-i;s>=e;s-=i)o=rN(s,n[s],n[s+1],o);return o&&Tg(o,o.next)&&(Ih(o),o=o.next),o}function zo(n,e){if(!n)return n;e||(e=n);let i,t=n;do{if(i=!1,t.steiner||!Tg(t,t.next)&&0!==fn(t.prev,t,t.next))t=t.next;else{if(Ih(t),t=e=t.prev,t===t.next)break;i=!0}}while(i||t!==e);return e}function Dh(n,e,t,i,r,s,o){if(!n)return;!o&&s&&function PZ(n,e,t,i){let r=n;do{null===r.z&&(r.z=Fx(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,function NZ(n){let e,t,i,r,s,o,a,l,c=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,i=t,a=0,e=0;e<c&&(a++,i=i.nextZ,i);e++);for(l=c;a>0||l>0&&i;)0!==a&&(0===l||!i||t.z<=i.z)?(r=t,t=t.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;t=i}s.nextZ=null,c*=2}while(o>1)}(r)}(n,i,r,s);let l,c,a=n;for(;n.prev!==n.next;)if(l=n.prev,c=n.next,s?MZ(n,i,r,s):CZ(n))e.push(l.i/t),e.push(n.i/t),e.push(c.i/t),Ih(n),n=c.next,a=c.next;else if((n=c)===a){o?1===o?Dh(n=SZ(zo(n),e,t),e,t,i,r,s,2):2===o&&EZ(n,e,t,i,r,s):Dh(zo(n),e,t,i,r,s,1);break}}function CZ(n){const e=n.prev,t=n,i=n.next;if(fn(e,t,i)>=0)return!1;let r=n.next.next;for(;r!==n.prev;){if(tu(e.x,e.y,t.x,t.y,i.x,i.y,r.x,r.y)&&fn(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function MZ(n,e,t,i){const r=n.prev,s=n,o=n.next;if(fn(r,s,o)>=0)return!1;const c=r.x>s.x?r.x>o.x?r.x:o.x:s.x>o.x?s.x:o.x,u=r.y>s.y?r.y>o.y?r.y:o.y:s.y>o.y?s.y:o.y,d=Fx(r.x<s.x?r.x<o.x?r.x:o.x:s.x<o.x?s.x:o.x,r.y<s.y?r.y<o.y?r.y:o.y:s.y<o.y?s.y:o.y,e,t,i),h=Fx(c,u,e,t,i);let f=n.prevZ,p=n.nextZ;for(;f&&f.z>=d&&p&&p.z<=h;){if(f!==n.prev&&f!==n.next&&tu(r.x,r.y,s.x,s.y,o.x,o.y,f.x,f.y)&&fn(f.prev,f,f.next)>=0||(f=f.prevZ,p!==n.prev&&p!==n.next&&tu(r.x,r.y,s.x,s.y,o.x,o.y,p.x,p.y)&&fn(p.prev,p,p.next)>=0))return!1;p=p.nextZ}for(;f&&f.z>=d;){if(f!==n.prev&&f!==n.next&&tu(r.x,r.y,s.x,s.y,o.x,o.y,f.x,f.y)&&fn(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;p&&p.z<=h;){if(p!==n.prev&&p!==n.next&&tu(r.x,r.y,s.x,s.y,o.x,o.y,p.x,p.y)&&fn(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function SZ(n,e,t){let i=n;do{const r=i.prev,s=i.next.next;!Tg(r,s)&&nN(r,i,i.next,s)&&Ah(r,s)&&Ah(s,r)&&(e.push(r.i/t),e.push(i.i/t),e.push(s.i/t),Ih(i),Ih(i.next),i=n=s),i=i.next}while(i!==n);return zo(i)}function EZ(n,e,t,i,r,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&OZ(o,a)){let l=iN(o,a);return o=zo(o,o.next),l=zo(l,l.next),Dh(o,e,t,i,r,s),void Dh(l,e,t,i,r,s)}a=a.next}o=o.next}while(o!==n)}function DZ(n,e){return n.x-e.x}function AZ(n,e){if(e=function IZ(n,e){let t=e;const i=n.x,r=n.y;let o,s=-1/0;do{if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const h=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(h<=i&&h>s){if(s=h,h===i){if(r===t.y)return t;if(r===t.next.y)return t.next}o=t.x<t.next.x?t:t.next}}t=t.next}while(t!==e);if(!o)return null;if(i===s)return o;const a=o,l=o.x,c=o.y;let d,u=1/0;t=o;do{i>=t.x&&t.x>=l&&i!==t.x&&tu(r<c?i:s,r,l,c,r<c?s:i,r,t.x,t.y)&&(d=Math.abs(r-t.y)/(i-t.x),Ah(t,n)&&(d<u||d===u&&(t.x>o.x||t.x===o.x&&RZ(o,t)))&&(o=t,u=d)),t=t.next}while(t!==a);return o}(n,e),e){const t=iN(e,n);zo(e,e.next),zo(t,t.next)}}function RZ(n,e){return fn(n.prev,n,e.prev)<0&&fn(e.next,n,n.next)<0}function Fx(n,e,t,i,r){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=32767*(n-t)*r)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function LZ(n){let e=n,t=n;do{(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next}while(e!==n);return t}function tu(n,e,t,i,r,s,o,a){return(r-o)*(e-a)-(n-o)*(s-a)>=0&&(n-o)*(i-a)-(t-o)*(e-a)>=0&&(t-o)*(s-a)-(r-o)*(i-a)>=0}function OZ(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!function FZ(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&nN(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}(n,e)&&(Ah(n,e)&&Ah(e,n)&&function kZ(n,e){let t=n,i=!1;const r=(n.x+e.x)/2,s=(n.y+e.y)/2;do{t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next}while(t!==n);return i}(n,e)&&(fn(n.prev,n,e.prev)||fn(n,e.prev,e))||Tg(n,e)&&fn(n.prev,n,n.next)>0&&fn(e.prev,e,e.next)>0)}function fn(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function Tg(n,e){return n.x===e.x&&n.y===e.y}function nN(n,e,t,i){const r=Ag(fn(n,e,t)),s=Ag(fn(n,e,i)),o=Ag(fn(t,i,n)),a=Ag(fn(t,i,e));return!!(r!==s&&o!==a||0===r&&Dg(n,t,e)||0===s&&Dg(n,i,e)||0===o&&Dg(t,n,i)||0===a&&Dg(t,e,i))}function Dg(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function Ag(n){return n>0?1:n<0?-1:0}function Ah(n,e){return fn(n.prev,n,n.next)<0?fn(n,e,n.next)>=0&&fn(n,n.prev,e)>=0:fn(n,e,n.prev)<0||fn(n,n.next,e)<0}function iN(n,e){const t=new kx(n.i,n.x,n.y),i=new kx(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function rN(n,e,t,i){const r=new kx(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Ih(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function kx(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Xs{static area(e){const t=e.length;let i=0;for(let r=t-1,s=0;s<t;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return.5*i}static isClockWise(e){return Xs.area(e)<0}static triangulateShape(e,t){const i=[],r=[],s=[];sN(e),oN(i,e);let o=e.length;t.forEach(sN);for(let l=0;l<t.length;l++)r.push(o),o+=t[l].length,oN(i,t[l]);const a=function(n,e,t=2){const i=e&&e.length,r=i?e[0]*t:n.length;let s=tN(n,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,u,d,h,f;if(i&&(s=function TZ(n,e,t,i){const r=[];let s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*i,l=s<o-1?e[s+1]*i:n.length,c=tN(n,a,l,i,!1),c===c.next&&(c.steiner=!0),r.push(LZ(c));for(r.sort(DZ),s=0;s<r.length;s++)AZ(r[s],t),t=zo(t,t.next);return t}(n,e,s,t)),n.length>80*t){a=c=n[0],l=u=n[1];for(let p=t;p<r;p+=t)d=n[p],h=n[p+1],d<a&&(a=d),h<l&&(l=h),d>c&&(c=d),h>u&&(u=h);f=Math.max(c-a,u-l),f=0!==f?1/f:0}return Dh(s,o,t,a,l,f),o}(i,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function sN(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function oN(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class Go extends Ve{constructor(e=new ls([new j(.5,.5),new j(-.5,.5),new j(-.5,-.5),new j(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let a=0,l=e.length;a<l;a++)o(e[a]);function o(a){const l=[],c=void 0!==t.curveSegments?t.curveSegments:12,u=void 0!==t.steps?t.steps:1;let d=void 0!==t.depth?t.depth:1,h=void 0===t.bevelEnabled||t.bevelEnabled,f=void 0!==t.bevelThickness?t.bevelThickness:.2,p=void 0!==t.bevelSize?t.bevelSize:f-.1,_=void 0!==t.bevelOffset?t.bevelOffset:0,y=void 0!==t.bevelSegments?t.bevelSegments:3;const g=t.extrudePath,m=void 0!==t.UVGenerator?t.UVGenerator:VZ;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),d=t.amount);let v,b,T,A,P,w=!1;g&&(v=g.getSpacedPoints(u),w=!0,h=!1,b=g.computeFrenetFrames(u,!1),T=new C,A=new C,P=new C),h||(y=0,f=0,p=0,_=0);const z=a.extractPoints(c);let N=z.shape;const x=z.holes;if(!Xs.isClockWise(N)){N=N.reverse();for(let G=0,se=x.length;G<se;G++){const de=x[G];Xs.isClockWise(de)&&(x[G]=de.reverse())}}const L=Xs.triangulateShape(N,x),O=N;for(let G=0,se=x.length;G<se;G++)N=N.concat(x[G]);function U(G,se,de){return se||console.error("THREE.ExtrudeGeometry: vec does not exist"),se.clone().multiplyScalar(de).add(G)}const B=N.length,q=L.length;function F(G,se,de){let Te,we,ze;const Le=G.x-se.x,ot=G.y-se.y,jt=de.x-G.x,E=de.y-G.y,M=Le*Le+ot*ot;if(Math.abs(Le*E-ot*jt)>Number.EPSILON){const ee=Math.sqrt(M),he=Math.sqrt(jt*jt+E*E),Se=se.x-ot/ee,Fe=se.y+Le/ee,le=((de.x-E/he-Se)*E-(de.y+jt/he-Fe)*jt)/(Le*E-ot*jt);Te=Se+Le*le-G.x,we=Fe+ot*le-G.y;const Ce=Te*Te+we*we;if(Ce<=2)return new j(Te,we);ze=Math.sqrt(Ce/2)}else{let ee=!1;Le>Number.EPSILON?jt>Number.EPSILON&&(ee=!0):Le<-Number.EPSILON?jt<-Number.EPSILON&&(ee=!0):Math.sign(ot)===Math.sign(E)&&(ee=!0),ee?(Te=-ot,we=Le,ze=Math.sqrt(M)):(Te=Le,we=ot,ze=Math.sqrt(M/2))}return new j(Te/ze,we/ze)}const Z=[];for(let G=0,se=O.length,de=se-1,Te=G+1;G<se;G++,de++,Te++)de===se&&(de=0),Te===se&&(Te=0),Z[G]=F(O[G],O[de],O[Te]);const oe=[];let ae,ce=Z.concat();for(let G=0,se=x.length;G<se;G++){const de=x[G];ae=[];for(let Te=0,we=de.length,ze=we-1,Le=Te+1;Te<we;Te++,ze++,Le++)ze===we&&(ze=0),Le===we&&(Le=0),ae[Te]=F(de[Te],de[ze],de[Le]);oe.push(ae),ce=ce.concat(ae)}for(let G=0;G<y;G++){const se=G/y,de=f*Math.cos(se*Math.PI/2),Te=p*Math.sin(se*Math.PI/2)+_;for(let we=0,ze=O.length;we<ze;we++){const Le=U(O[we],Z[we],Te);St(Le.x,Le.y,-de)}for(let we=0,ze=x.length;we<ze;we++){const Le=x[we];ae=oe[we];for(let ot=0,jt=Le.length;ot<jt;ot++){const E=U(Le[ot],ae[ot],Te);St(E.x,E.y,-de)}}}const Oe=p+_;for(let G=0;G<B;G++){const se=h?U(N[G],ce[G],Oe):N[G];w?(A.copy(b.normals[0]).multiplyScalar(se.x),T.copy(b.binormals[0]).multiplyScalar(se.y),P.copy(v[0]).add(A).add(T),St(P.x,P.y,P.z)):St(se.x,se.y,0)}for(let G=1;G<=u;G++)for(let se=0;se<B;se++){const de=h?U(N[se],ce[se],Oe):N[se];w?(A.copy(b.normals[G]).multiplyScalar(de.x),T.copy(b.binormals[G]).multiplyScalar(de.y),P.copy(v[G]).add(A).add(T),St(P.x,P.y,P.z)):St(de.x,de.y,d/u*G)}for(let G=y-1;G>=0;G--){const se=G/y,de=f*Math.cos(se*Math.PI/2),Te=p*Math.sin(se*Math.PI/2)+_;for(let we=0,ze=O.length;we<ze;we++){const Le=U(O[we],Z[we],Te);St(Le.x,Le.y,d+de)}for(let we=0,ze=x.length;we<ze;we++){const Le=x[we];ae=oe[we];for(let ot=0,jt=Le.length;ot<jt;ot++){const E=U(Le[ot],ae[ot],Te);w?St(E.x,E.y+v[u-1].y,v[u-1].x+de):St(E.x,E.y,d+de)}}}function J(G,se){let de=G.length;for(;--de>=0;){const Te=de;let we=de-1;we<0&&(we=G.length-1);for(let ze=0,Le=u+2*y;ze<Le;ze++){const ot=B*ze,jt=B*(ze+1);Ae(se+Te+ot,se+we+ot,se+we+jt,se+Te+jt)}}}function St(G,se,de){l.push(G),l.push(se),l.push(de)}function et(G,se,de){Ie(G),Ie(se),Ie(de);const Te=r.length/3,we=m.generateTopUV(i,r,Te-3,Te-2,Te-1);_t(we[0]),_t(we[1]),_t(we[2])}function Ae(G,se,de,Te){Ie(G),Ie(se),Ie(Te),Ie(se),Ie(de),Ie(Te);const we=r.length/3,ze=m.generateSideWallUV(i,r,we-6,we-3,we-2,we-1);_t(ze[0]),_t(ze[1]),_t(ze[3]),_t(ze[1]),_t(ze[2]),_t(ze[3])}function Ie(G){r.push(l[3*G+0]),r.push(l[3*G+1]),r.push(l[3*G+2])}function _t(G){s.push(G.x),s.push(G.y)}(function xt(){const G=r.length/3;if(h){let se=0,de=B*se;for(let Te=0;Te<q;Te++){const we=L[Te];et(we[2]+de,we[1]+de,we[0]+de)}se=u+2*y,de=B*se;for(let Te=0;Te<q;Te++){const we=L[Te];et(we[0]+de,we[1]+de,we[2]+de)}}else{for(let se=0;se<q;se++){const de=L[se];et(de[2],de[1],de[0])}for(let se=0;se<q;se++){const de=L[se];et(de[0]+B*u,de[1]+B*u,de[2]+B*u)}}i.addGroup(G,r.length/3-G,0)})(),function He(){const G=r.length/3;let se=0;J(O,se),se+=O.length;for(let de=0,Te=x.length;de<Te;de++){const we=x[de];J(we,se),se+=we.length}i.addGroup(G,r.length/3-G,1)}()}this.setAttribute("position",new De(r,3)),this.setAttribute("uv",new De(s,2)),this.computeVertexNormals()}toJSON(){const e=super.toJSON();return function UZ(n,e,t){if(t.shapes=[],Array.isArray(n))for(let i=0,r=n.length;i<r;i++)t.shapes.push(n[i].uuid);else t.shapes.push(n.uuid);return void 0!==e.extrudePath&&(t.options.extrudePath=e.extrudePath.toJSON()),t}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const i=[];for(let s=0,o=e.shapes.length;s<o;s++)i.push(t[e.shapes[s]]);const r=e.options.extrudePath;return void 0!==r&&(e.options.extrudePath=(new Ox[r.type]).fromJSON(r)),new Go(i,e.options)}}const VZ={generateTopUV:function(n,e,t,i,r){const a=e[3*i],l=e[3*i+1],c=e[3*r],u=e[3*r+1];return[new j(e[3*t],e[3*t+1]),new j(a,l),new j(c,u)]},generateSideWallUV:function(n,e,t,i,r,s){const o=e[3*t],a=e[3*t+1],l=e[3*t+2],c=e[3*i],u=e[3*i+1],d=e[3*i+2],h=e[3*r],f=e[3*r+1],p=e[3*r+2],_=e[3*s],y=e[3*s+1],g=e[3*s+2];return Math.abs(a-u)<Math.abs(o-c)?[new j(o,1-l),new j(c,1-d),new j(h,1-p),new j(_,1-g)]:[new j(a,1-l),new j(u,1-d),new j(f,1-p),new j(y,1-g)]}};class nu extends Ve{constructor(e=new ls([new j(0,.5),new j(-.5,-.5),new j(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const i=[],r=[],s=[],o=[];let a=0,l=0;if(!1===Array.isArray(e))c(e);else for(let u=0;u<e.length;u++)c(e[u]),this.addGroup(a,l,u),a+=l,l=0;function c(u){const d=r.length/3,h=u.extractPoints(t);let f=h.shape;const p=h.holes;!1===Xs.isClockWise(f)&&(f=f.reverse());for(let y=0,g=p.length;y<g;y++){const m=p[y];!0===Xs.isClockWise(m)&&(p[y]=m.reverse())}const _=Xs.triangulateShape(f,p);for(let y=0,g=p.length;y<g;y++)f=f.concat(p[y]);for(let y=0,g=f.length;y<g;y++){const m=f[y];r.push(m.x,m.y,0),s.push(0,0,1),o.push(m.x,m.y)}for(let y=0,g=_.length;y<g;y++){const m=_[y];i.push(m[0]+d,m[1]+d,m[2]+d),l+=3}}this.setIndex(i),this.setAttribute("position",new De(r,3)),this.setAttribute("normal",new De(s,3)),this.setAttribute("uv",new De(o,2))}toJSON(){const e=super.toJSON();return function HZ(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,i=n.length;t<i;t++)e.shapes.push(n[t].uuid);else e.shapes.push(n.uuid);return e}(this.parameters.shapes,e)}static fromJSON(e,t){const i=[];for(let r=0,s=e.shapes.length;r<s;r++)i.push(t[e.shapes[r]]);return new nu(i,e.curveSegments)}}class Ph extends Ve{constructor(e=1,t=32,i=16,r=0,s=2*Math.PI,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const l=Math.min(o+a,Math.PI);let c=0;const u=[],d=new C,h=new C,f=[],p=[],_=[],y=[];for(let g=0;g<=i;g++){const m=[],v=g/i;let w=0;0==g&&0==o?w=.5/t:g==i&&l==Math.PI&&(w=-.5/t);for(let b=0;b<=t;b++){const T=b/t;d.x=-e*Math.cos(r+T*s)*Math.sin(o+v*a),d.y=e*Math.cos(o+v*a),d.z=e*Math.sin(r+T*s)*Math.sin(o+v*a),p.push(d.x,d.y,d.z),h.copy(d).normalize(),_.push(h.x,h.y,h.z),y.push(T+w,1-v),m.push(c++)}u.push(m)}for(let g=0;g<i;g++)for(let m=0;m<t;m++){const v=u[g][m+1],w=u[g][m],b=u[g+1][m],T=u[g+1][m+1];(0!==g||o>0)&&f.push(v,w,T),(g!==i-1||l<Math.PI)&&f.push(w,b,T)}this.setIndex(f),this.setAttribute("position",new De(p,3)),this.setAttribute("normal",new De(_,3)),this.setAttribute("uv",new De(y,2))}static fromJSON(e){return new Ph(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class uN extends Pn{constructor(e){super(),this.type="ShadowMaterial",this.color=new me(0),this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this}}uN.prototype.isShadowMaterial=!0;class dN extends Fr{constructor(e){super(e),this.type="RawShaderMaterial"}}dN.prototype.isRawShaderMaterial=!0;class kg extends Pn{constructor(e){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new me(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new me(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new j(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}kg.prototype.isMeshStandardMaterial=!0;class hN extends kg{constructor(e){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new j(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return ei(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.sheenColor=new me(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new me(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new me(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}hN.prototype.isMeshPhysicalMaterial=!0;class iu extends Pn{constructor(e){super(),this.type="MeshPhongMaterial",this.color=new me(16777215),this.specular=new me(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new me(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new j(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}iu.prototype.isMeshPhongMaterial=!0;class fN extends Pn{constructor(e){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new me(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new me(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new j(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}fN.prototype.isMeshToonMaterial=!0;class pN extends Pn{constructor(e){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new j(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}pN.prototype.isMeshNormalMaterial=!0;class mN extends Pn{constructor(e){super(),this.type="MeshLambertMaterial",this.color=new me(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new me(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}mN.prototype.isMeshLambertMaterial=!0;class gN extends Pn{constructor(e){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new me(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new j(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this}}gN.prototype.isMeshMatcapMaterial=!0;class _N extends Qn{constructor(e){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}_N.prototype.isLineDashedMaterial=!0;const zZ={ShadowMaterial:uN,SpriteMaterial:_x,RawShaderMaterial:dN,ShaderMaterial:Fr,PointsMaterial:eu,MeshPhysicalMaterial:hN,MeshStandardMaterial:kg,MeshPhongMaterial:iu,MeshToonMaterial:fN,MeshNormalMaterial:pN,MeshLambertMaterial:mN,MeshDepthMaterial:px,MeshDistanceMaterial:mx,MeshBasicMaterial:$s,MeshMatcapMaterial:gN,LineDashedMaterial:_N,LineBasicMaterial:Qn,Material:Pn};Pn.fromType=function(n){return new zZ[n]};const un={arraySlice:function(n,e,t){return un.isTypedArray(n)?new n.constructor(n.subarray(e,void 0!==t?t:n.length)):n.slice(e,t)},convertArray:function(n,e,t){return!n||!t&&n.constructor===e?n:"number"==typeof e.BYTES_PER_ELEMENT?new e(n):Array.prototype.slice.call(n)},isTypedArray:function(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)},getKeyframeOrder:function(n){const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(function e(r,s){return n[r]-n[s]}),i},sortedArray:function(n,e,t){const i=n.length,r=new n.constructor(i);for(let s=0,o=0;o!==i;++s){const a=t[s]*e;for(let l=0;l!==e;++l)r[o++]=n[a+l]}return r},flattenJSON:function(n,e,t,i){let r=1,s=n[0];for(;void 0!==s&&void 0===s[i];)s=n[r++];if(void 0===s)return;let o=s[i];if(void 0!==o)if(Array.isArray(o))do{o=s[i],void 0!==o&&(e.push(s.time),t.push.apply(t,o)),s=n[r++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[i],void 0!==o&&(e.push(s.time),o.toArray(t,t.length)),s=n[r++]}while(void 0!==s);else do{o=s[i],void 0!==o&&(e.push(s.time),t.push(o)),s=n[r++]}while(void 0!==s)},subclip:function(n,e,t,i,r=30){const s=n.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const c=s.tracks[l],u=c.getValueSize(),d=[],h=[];for(let f=0;f<c.times.length;++f){const p=c.times[f]*r;if(!(p<t||p>=i)){d.push(c.times[f]);for(let _=0;_<u;++_)h.push(c.values[f*u+_])}}0!==d.length&&(c.times=un.convertArray(d,c.times.constructor),c.values=un.convertArray(h,c.values.constructor),o.push(c))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s},makeClipAdditive:function(n,e=0,t=n,i=30){i<=0&&(i=30);const r=t.tracks.length,s=e/i;for(let o=0;o<r;++o){const a=t.tracks[o],l=a.ValueTypeName;if("bool"===l||"string"===l)continue;const c=n.tracks.find(function(g){return g.name===a.name&&g.ValueTypeName===l});if(void 0===c)continue;let u=0;const d=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=d/3);let h=0;const f=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(h=f/3);const p=a.times.length-1;let _;if(s<=a.times[0])_=un.arraySlice(a.values,u,d-u);else if(s>=a.times[p]){const g=p*d+u;_=un.arraySlice(a.values,g,g+d-u)}else{const g=a.createInterpolant(),m=u,v=d-u;g.evaluate(s),_=un.arraySlice(g.resultBuffer,m,v)}"quaternion"===l&&(new Yn).fromArray(_).normalize().conjugate().toArray(_);const y=c.times.length;for(let g=0;g<y;++g){const m=g*f+h;if("quaternion"===l)Yn.multiplyQuaternionsFlat(c.values,m,_,0,c.values,m);else{const v=f-2*h;for(let w=0;w<v;++w)c.values[m+w]-=_[w]}}}return n.blendMode=2501,n}};class Wo{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(void 0===r){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.afterEnd_(i-1,e,s)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(e>=s)break e;{const a=t[1];e<a&&(i=2,s=a);for(let l=i-2;;){if(void 0===s)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(i===l)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0}}for(;i<o;){const a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],void 0===s)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(void 0===r)return i=t.length,this._cachedIndex=i,this.afterEnd_(i-1,s,e)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}Wo.prototype.beforeStart_=Wo.prototype.copySampleValue_,Wo.prototype.afterEnd_=Wo.prototype.copySampleValue_;class GZ extends Wo{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Cc,endingEnd:Cc}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case Mc:s=e,a=2*t-i;break;case 2402:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(void 0===l)switch(this.getSettings_().endingEnd){case Mc:o=e,l=2*i-t;break;case 2402:o=1,l=i+r[1]-r[0];break;default:o=e-1,l=t}const c=.5*(i-t),u=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(l-i),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=this._offsetPrev,d=this._offsetNext,h=this._weightPrev,f=this._weightNext,p=(i-t)/(r-t),_=p*p,y=_*p,g=-h*y+2*h*_-h*p,m=(1+h)*y+(-1.5-2*h)*_+(-.5+h)*p+1,v=(-1-f)*y+(1.5+f)*_+.5*p,w=f*y-f*_;for(let b=0;b!==a;++b)s[b]=g*o[u+b]+m*o[c+b]+v*o[l+b]+w*o[d+b];return s}}class yN extends Wo{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=(i-t)/(r-t),d=1-u;for(let h=0;h!==a;++h)s[h]=o[c+h]*d+o[l+h]*u;return s}}class WZ extends Wo{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class cs{constructor(e,t,i,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=un.convertArray(t,this.TimeBufferType),this.values=un.convertArray(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:un.convertArray(e.times,Array),values:un.convertArray(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new WZ(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new yN(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new GZ(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;-1!==o&&i[o]>t;)--o;if(++o,0!==s||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=un.arraySlice(i,s,o),this.values=un.arraySlice(this.values,s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=i[a];if("number"==typeof l&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(null!==o&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(void 0!==r&&un.isTypedArray(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=un.arraySlice(this.times),t=un.arraySlice(this.values),i=this.getValueSize(),r=2302===this.getInterpolation(),s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a];if(c!==e[a+1]&&(1!==a||c!==e[0]))if(r)l=!0;else{const d=a*i,h=d-i,f=d+i;for(let p=0;p!==i;++p){const _=t[d+p];if(_!==t[h+p]||_!==t[f+p]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const d=a*i,h=o*i;for(let f=0;f!==i;++f)t[h+f]=t[d+f]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,l=o*i,c=0;c!==i;++c)t[l+c]=t[a+c];++o}return o!==e.length?(this.times=un.arraySlice(e,0,o),this.values=un.arraySlice(t,0,o*i)):(this.times=e,this.values=t),this}clone(){const e=un.arraySlice(this.times,0),t=un.arraySlice(this.values,0),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}cs.prototype.TimeBufferType=Float32Array,cs.prototype.ValueBufferType=Float32Array,cs.prototype.DefaultInterpolation=2301;class ru extends cs{}ru.prototype.ValueTypeName="bool",ru.prototype.ValueBufferType=Array,ru.prototype.DefaultInterpolation=2300,ru.prototype.InterpolantFactoryMethodLinear=void 0,ru.prototype.InterpolantFactoryMethodSmooth=void 0;class vN extends cs{}vN.prototype.ValueTypeName="color";class Bg extends cs{}Bg.prototype.ValueTypeName="number";class jZ extends Wo{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(i-t)/(r-t);let c=e*a;for(let u=c+a;c!==u;c+=4)Yn.slerpFlat(s,0,o,c-a,o,c,l);return s}}class Nh extends cs{InterpolantFactoryMethodLinear(e){return new jZ(this.times,this.values,this.getValueSize(),e)}}Nh.prototype.ValueTypeName="quaternion",Nh.prototype.DefaultInterpolation=2301,Nh.prototype.InterpolantFactoryMethodSmooth=void 0;class su extends cs{}su.prototype.ValueTypeName="string",su.prototype.ValueBufferType=Array,su.prototype.DefaultInterpolation=2300,su.prototype.InterpolantFactoryMethodLinear=void 0,su.prototype.InterpolantFactoryMethodSmooth=void 0;class Vg extends cs{}Vg.prototype.ValueTypeName="vector";class Ug{constructor(e,t=-1,i,r=2500){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=Qi(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)t.push(qZ(i[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)t.push(cs.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);const u=un.getKeyframeOrder(l);l=un.sortedArray(l,1,u),c=un.sortedArray(c,1,u),!r&&0===l[0]&&(l.push(s),c.push(c[0])),o.push(new Bg(".morphTargetInfluences["+t[a].name+"]",l,c).scale(1/i))}return new this(e,-1,o)}static findByName(e,t){let i=e;if(!Array.isArray(e)){const r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const c=e[a],u=c.name.match(s);if(u&&u.length>1){const d=u[1];let h=r[d];h||(r[d]=h=[]),h.push(c)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,i));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(d,h,f,p,_){if(0!==f.length){const y=[],g=[];un.flattenJSON(f,y,g,p),0!==y.length&&_.push(new d(h,y,g))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let d=0;d<c.length;d++){const h=c[d].keys;if(h&&0!==h.length)if(h[0].morphTargets){const f={};let p;for(p=0;p<h.length;p++)if(h[p].morphTargets)for(let _=0;_<h[p].morphTargets.length;_++)f[h[p].morphTargets[_]]=-1;for(const _ in f){const y=[],g=[];for(let m=0;m!==h[p].morphTargets.length;++m){const v=h[p];y.push(v.time),g.push(v.morphTarget===_?1:0)}r.push(new Bg(".morphTargetInfluence["+_+"]",y,g))}l=f.length*o}else{const f=".bones["+t[d].name+"]";i(Vg,f+".position",h,"pos",r),i(Nh,f+".quaternion",h,"rot",r),i(Vg,f+".scale",h,"scl",r)}}return 0===r.length?null:new this(s,l,r,a)}resetDuration(){let t=0;for(let i=0,r=this.tracks.length;i!==r;++i){const s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function qZ(n){if(void 0===n.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function $Z(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Bg;case"vector":case"vector2":case"vector3":case"vector4":return Vg;case"color":return vN;case"quaternion":return Nh;case"bool":case"boolean":return ru;case"string":return su}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}(n.type);if(void 0===n.times){const t=[],i=[];un.flattenJSON(n.keys,t,i,"value"),n.times=t,n.values=i}return void 0!==e.parse?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const ou={enabled:!1,files:{},add:function(n,e){!1!==this.enabled&&(this.files[n]=e)},get:function(n){if(!1!==this.enabled)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};const YZ=new class wN{constructor(e,t,i){const r=this;let l,s=!1,o=0,a=0;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(u){a++,!1===s&&void 0!==r.onStart&&r.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,void 0!==r.onProgress&&r.onProgress(u,o,a),o===a&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(u){void 0!==r.onError&&r.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,d){return c.push(u,d),this},this.removeHandler=function(u){const d=c.indexOf(u);return-1!==d&&c.splice(d,2),this},this.getHandler=function(u){for(let d=0,h=c.length;d<h;d+=2){const f=c[d],p=c[d+1];if(f.global&&(f.lastIndex=0),f.test(u))return p}return null}}};class jo{constructor(e){this.manager=void 0!==e?e:YZ,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise(function(r,s){i.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const Qs={};class Js extends jo{constructor(e){super(e)}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=ou.get(e);if(void 0!==s)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(void 0!==Qs[e])return void Qs[e].push({onLoad:t,onProgress:i,onError:r});Qs[e]=[],Qs[e].push({onLoad:t,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(200===c.status||0===c.status){if(0===c.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===c.body||void 0===c.body.getReader)return c;const u=Qs[e],d=c.body.getReader(),h=c.headers.get("Content-Length"),f=h?parseInt(h):0,p=0!==f;let _=0;const y=new ReadableStream({start(g){!function m(){d.read().then(({done:v,value:w})=>{if(v)g.close();else{_+=w.byteLength;const b=new ProgressEvent("progress",{lengthComputable:p,loaded:_,total:f});for(let T=0,A=u.length;T<A;T++){const P=u[T];P.onProgress&&P.onProgress(b)}g.enqueue(w),m()}})}()}});return new Response(y)}throw Error(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(u=>(new DOMParser).parseFromString(u,a));case"json":return c.json();default:if(void 0===a)return c.text();{const d=/charset="?([^;"\s]*)"?/i.exec(a),h=d&&d[1]?d[1].toLowerCase():void 0,f=new TextDecoder(h);return c.arrayBuffer().then(p=>f.decode(p))}}}).then(c=>{ou.add(e,c);const u=Qs[e];delete Qs[e];for(let d=0,h=u.length;d<h;d++){const f=u[d];f.onLoad&&f.onLoad(c)}}).catch(c=>{const u=Qs[e];if(void 0===u)throw this.manager.itemError(e),c;delete Qs[e];for(let d=0,h=u.length;d<h;d++){const f=u[d];f.onError&&f.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Hg extends jo{constructor(e){super(e)}load(e,t,i,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=ou.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=hh("img");function l(){u(),ou.add(e,this),t&&t(this),s.manager.itemEnd(e)}function c(d){u(),r&&r(d),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class XZ extends jo{constructor(e){super(e)}load(e,t,i,r){const s=new _h,o=new Hg(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(c){o.load(e[c],function(u){s.images[c]=u,a++,6===a&&(s.needsUpdate=!0,t&&t(s))},void 0,r)}for(let c=0;c<e.length;++c)l(c);return s}}class bN extends jo{constructor(e){super(e)}load(e,t,i,r){const s=new Ri,o=new Hg(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,void 0!==t&&t(s)},i,r),s}}class us extends Rt{constructor(e,t=1){super(),this.type="Light",this.color=new me(e),this.intensity=t}dispose(){}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}us.prototype.isLight=!0;(class xN extends us{constructor(e,t,i){super(e,i),this.type="HemisphereLight",this.position.copy(Rt.DefaultUp),this.updateMatrix(),this.groundColor=new me(t)}copy(e){return us.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}).prototype.isHemisphereLight=!0;const CN=new Pe,MN=new C,SN=new C;class Bx{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new j(512,512),this.map=null,this.mapPass=null,this.matrix=new Pe,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new rg,this._frameExtents=new j(1,1),this._viewportCount=1,this._viewports=[new Ft(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;MN.setFromMatrixPosition(e.matrixWorld),t.position.copy(MN),SN.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(SN),t.updateMatrixWorld(),CN.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(CN),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(t.projectionMatrix),i.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class EN extends Bx{constructor(){super(new Hn(50,1,.5,500)),this.focus=1}updateMatrices(e){const t=this.camera,i=2*uh*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}EN.prototype.isSpotLightShadow=!0;(class TN extends us{constructor(e,t,i=0,r=Math.PI/3,s=0,o=1){super(e,t),this.type="SpotLight",this.position.copy(Rt.DefaultUp),this.updateMatrix(),this.target=new Rt,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.shadow=new EN}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}).prototype.isSpotLight=!0;const DN=new Pe,Lh=new C,Vx=new C;class AN extends Bx{constructor(){super(new Hn(90,1,.5,500)),this._frameExtents=new j(4,2),this._viewportCount=6,this._viewports=[new Ft(2,1,1,1),new Ft(0,1,1,1),new Ft(3,1,1,1),new Ft(1,1,1,1),new Ft(3,0,1,1),new Ft(1,0,1,1)],this._cubeDirections=[new C(1,0,0),new C(-1,0,0),new C(0,0,1),new C(0,0,-1),new C(0,1,0),new C(0,-1,0)],this._cubeUps=[new C(0,1,0),new C(0,1,0),new C(0,1,0),new C(0,1,0),new C(0,0,1),new C(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),Lh.setFromMatrixPosition(e.matrixWorld),i.position.copy(Lh),Vx.copy(i.position),Vx.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(Vx),i.updateMatrixWorld(),r.makeTranslation(-Lh.x,-Lh.y,-Lh.z),DN.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(DN)}}AN.prototype.isPointLightShadow=!0;class Ux extends us{constructor(e,t,i=0,r=1){super(e,t),this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new AN}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}Ux.prototype.isPointLight=!0;class IN extends Bx{constructor(){super(new yh(-5,5,5,-5,.5,500))}}IN.prototype.isDirectionalLightShadow=!0;(class RN extends us{constructor(e,t){super(e,t),this.type="DirectionalLight",this.position.copy(Rt.DefaultUp),this.updateMatrix(),this.target=new Rt,this.shadow=new IN}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}).prototype.isDirectionalLight=!0;class Hx extends us{constructor(e,t){super(e,t),this.type="AmbientLight"}}Hx.prototype.isAmbientLight=!0;(class PN extends us{constructor(e,t,i=10,r=10){super(e,t),this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}).prototype.isRectAreaLight=!0;class NN{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new C)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*i),t.addScaledVector(o[4],i*r*1.092548),t.addScaledVector(o[5],r*s*1.092548),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],i*s*1.092548),t.addScaledVector(o[8],.546274*(i*i-r*r)),t}getIrradianceAt(e,t){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],1.023328*r),t.addScaledVector(o[2],1.023328*s),t.addScaledVector(o[3],1.023328*i),t.addScaledVector(o[4],.858086*i*r),t.addScaledVector(o[5],.858086*r*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],.858086*i*s),t.addScaledVector(o[8],.429043*(i*i-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,t+3*r);return this}toArray(e=[],t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,t+3*r);return e}static getBasisAt(e,t){const i=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*i,t[4]=1.092548*i*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*i*s,t[8]=.546274*(i*i-r*r)}}NN.prototype.isSphericalHarmonics3=!0;class zg extends us{constructor(e=new NN,t=1){super(void 0,t),this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}zg.prototype.isLightProbe=!0;let Gg;(class LN extends Ve{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}).prototype.isInstancedBufferGeometry=!0,class eee extends jo{constructor(e){super(e),"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=ou.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){ou.add(e,l),t&&t(l),s.manager.itemEnd(e)}).catch(function(l){r&&r(l),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}.prototype.isImageBitmapLoader=!0;class tee extends jo{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new Js(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{const l=a.slice(0);(void 0===Gg&&(Gg=new(window.AudioContext||window.webkitAudioContext)),Gg).decodeAudioData(l,function(u){t(u)})}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}}(class nee extends zg{constructor(e,t,i=1){super(void 0,i);const r=(new me).set(e),s=(new me).set(t),o=new C(r.r,r.g,r.b),a=new C(s.r,s.g,s.b),l=Math.sqrt(Math.PI),c=l*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(l),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(c)}}).prototype.isHemisphereLightProbe=!0,class iee extends zg{constructor(e,t=1){super(void 0,t);const i=(new me).set(e);this.sh.coefficients[0].set(i.r,i.g,i.b).multiplyScalar(2*Math.sqrt(Math.PI))}}.prototype.isAmbientLightProbe=!0;class cee{constructor(e,t,i){let r,s,o;switch(this.binding=e,this.valueSize=i,t){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*i),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*i);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*i)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const i=this.buffer,r=this.valueSize,s=e*r+r;let o=this.cumulativeWeight;if(0===o){for(let a=0;a!==r;++a)i[s+a]=i[a];o=t}else o+=t,this._mixBufferRegion(i,s,0,t/o,r);this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,i=this.valueSize,r=i*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,i=this.buffer,r=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1&&this._mixBufferRegion(i,r,t*this._origIndex,1-s,t),o>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*t,1,t);for(let l=t,c=t+t;l!==c;++l)if(i[l]!==i[l+t]){a.setValue(i,r);break}}saveOriginalState(){const t=this.buffer,i=this.valueSize,r=i*this._origIndex;this.binding.getValue(t,r);for(let s=i,o=r;s!==o;++s)t[s]=t[r+s%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let i=e;i<t;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[t+i]=this.buffer[e+i]}_select(e,t,i,r,s){if(r>=.5)for(let o=0;o!==s;++o)e[t+o]=e[i+o]}_slerp(e,t,i,r){Yn.slerpFlat(e,t,e,t,e,i,r)}_slerpAdditive(e,t,i,r,s){const o=this._workIndex*s;Yn.multiplyQuaternionsFlat(e,o,e,t,e,i),Yn.slerpFlat(e,t,e,t,e,o,r)}_lerp(e,t,i,r,s){const o=1-r;for(let a=0;a!==s;++a){const l=t+a;e[l]=e[l]*o+e[i+a]*r}}_lerpAdditive(e,t,i,r,s){for(let o=0;o!==s;++o){const a=t+o;e[a]=e[a]+e[i+o]*r}}}const Gx="\\[\\]\\.:\\/",uee=new RegExp("["+Gx+"]","g"),Wx="[^"+Gx+"]",dee="[^"+Gx.replace("\\.","")+"]",hee=/((?:WC+[\/:])*)/.source.replace("WC",Wx),fee=/(WCOD+)?/.source.replace("WCOD",dee),pee=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Wx),mee=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Wx),gee=new RegExp("^"+hee+fee+pee+mee+"$"),_ee=["material","materials","bones"];class yee{constructor(e,t,i){const r=i||rn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}let rn=(()=>{class n{constructor(t,i,r){this.path=i,this.parsedPath=r||n.parseTrackName(i),this.node=n.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,r){return t&&t.isAnimationObjectGroup?new n.Composite(t,i,r):new n(t,i,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(uee,"")}static parseTrackName(t){const i=gee.exec(t);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const o=r.nodeName.substring(s+1);-1!==_ee.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,i){if(void 0===i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(i);if(void 0!==r)return r}if(t.children){const r=function(o){for(let a=0;a<o.length;a++){const l=o[a];if(l.name===i||l.uuid===i)return l;const c=r(l.children);if(c)return c}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[i++]=r[s]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,r=i.objectName,s=i.propertyName;let o=i.propertyIndex;if(t||(t=n.findNode(this.rootNode,i.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(r){let u=i.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let d=0;d<t.length;d++)if(t[d].name===u){u=d;break}break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==u){if(void 0===t[u])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[u]}}const a=t[s];if(void 0===a)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i.nodeName+"."+s+" but it wasn't found.",t);let l=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===s){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else void 0!==a.fromArray&&void 0!==a.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=yee,n})();rn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},rn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},rn.prototype.GetterByBindingType=[rn.prototype._getValue_direct,rn.prototype._getValue_array,rn.prototype._getValue_arrayElement,rn.prototype._getValue_toArray],rn.prototype.SetterByBindingTypeAndVersioning=[[rn.prototype._setValue_direct,rn.prototype._setValue_direct_setNeedsUpdate,rn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[rn.prototype._setValue_array,rn.prototype._setValue_array_setNeedsUpdate,rn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[rn.prototype._setValue_arrayElement,rn.prototype._setValue_arrayElement_setNeedsUpdate,rn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[rn.prototype._setValue_fromArray,rn.prototype._setValue_fromArray_setNeedsUpdate,rn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class wee{constructor(e,t,i=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=i,this.blendMode=r;const s=t.tracks,o=s.length,a=new Array(o),l={endingStart:Cc,endingEnd:Cc};for(let c=0;c!==o;++c){const u=s[c].createInterpolant(null);a[c]=u,u.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){const r=this._clip.duration,s=e._clip.duration,a=r/s;e.warp(1,s/r,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,i){return e.crossFadeFrom(this,t,i)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,i){const r=this._mixer,s=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;null===a&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,c=a.sampleValues;return l[0]=s,l[1]=s+i,c[0]=e/o,c[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,i,r){if(!this.enabled)return void this._updateWeight(e);const s=this._startTime;if(null!==s){const l=(e-s)*i;if(l<0||0===i)return;this._startTime=null,t=i*l}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const l=this._interpolants,c=this._propertyBindings;if(2501===this.blendMode)for(let u=0,d=l.length;u!==d;++u)l[u].evaluate(o),c[u].accumulateAdditive(a);else for(let u=0,d=l.length;u!==d;++u)l[u].evaluate(o),c[u].accumulate(r,a)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const i=this._weightInterpolant;if(null!==i){const r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const i=this._timeScaleInterpolant;null!==i&&(t*=i.evaluate(e)[0],e>i.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,i=this.loop;let r=this.time+e,s=this._loopCount;const o=2202===i;if(0===e)return-1===s?r:o&&1==(1&s)?t-r:r;if(2200===i){-1===s&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===s&&(e>=0?(s=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),r>=t||r<0){const a=Math.floor(r/t);r-=t*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===l){const c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&1==(1&s))return t-r}return r}_setEndings(e,t,i){const r=this._interpolantSettings;i?(r.endingStart=Mc,r.endingEnd=Mc):(r.endingStart=e?this.zeroSlopeAtStart?Mc:Cc:2402,r.endingEnd=t?this.zeroSlopeAtEnd?Mc:Cc:2402)}_scheduleFading(e,t,i){const r=this._mixer,s=r.time;let o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=t,a[1]=s+e,l[1]=i,this}}(class bee extends Ro{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const i=e._localRoot||this._root,r=e._clip.tracks,s=r.length,o=e._propertyBindings,a=e._interpolants,l=i.uuid,c=this._bindingsByRootAndName;let u=c[l];void 0===u&&(u={},c[l]=u);for(let d=0;d!==s;++d){const h=r[d],f=h.name;let p=u[f];if(void 0!==p)++p.referenceCount,o[d]=p;else{if(p=o[d],void 0!==p){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,l,f));continue}p=new cee(rn.create(i,f,t&&t._propertyBindings[d].binding.parsedPath),h.ValueTypeName,h.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,l,f),o[d]=p}a[d].resultBuffer=p.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const i=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,i)}const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];0==--s.useCount&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,i){const r=this._actions,s=this._actionsByClip;let o=s[t];if(void 0===o)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[i]=e}_removeInactiveAction(e){const t=this._actions,i=t[t.length-1],r=e._cacheIndex;i._cacheIndex=r,t[r]=i,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,c=l[l.length-1],u=e._byClipCacheIndex;c._byClipCacheIndex=u,l[u]=c,l.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===l.length&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];0==--s.referenceCount&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,i=e._cacheIndex,r=this._nActiveActions++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackAction(e){const t=this._actions,i=e._cacheIndex,r=--this._nActiveActions,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_addInactiveBinding(e,t,i){const r=this._bindingsByRootAndName,s=this._bindings;let o=r[t];void 0===o&&(o={},r[t]=o),o[i]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,i=e.binding,r=i.rootNode.uuid,s=i.path,o=this._bindingsByRootAndName,a=o[r],l=t[t.length-1],c=e._cacheIndex;l._cacheIndex=c,t[c]=l,t.pop(),delete a[s],0===Object.keys(a).length&&delete o[r]}_lendBinding(e){const t=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackBinding(e){const t=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let i=e[t];return void 0===i&&(i=new yN(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),i.__cacheIndex=t,e[t]=i),i}_takeBackControlInterpolant(e){const t=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=t[r];e.__cacheIndex=r,t[r]=e,s.__cacheIndex=i,t[i]=s}clipAction(e,t,i){const r=t||this._root,s=r.uuid;let o="string"==typeof e?Ug.findByName(r,e):e;const a=null!==o?o.uuid:e,l=this._actionsByClip[a];let c=null;if(void 0===i&&(i=null!==o?o.blendMode:2500),void 0!==l){const d=l.actionByRoot[s];if(void 0!==d&&d.blendMode===i)return d;c=l.knownActions[0],null===o&&(o=c._clip)}if(null===o)return null;const u=new wee(this,o,t,i);return this._bindAction(u,c),this._addInactiveAction(u,a,s),u}existingAction(e,t){const i=t||this._root,r=i.uuid,s="string"==typeof e?Ug.findByName(i,e):e,a=this._actionsByClip[s?s.uuid:e];return void 0!==a&&a.actionByRoot[r]||null}stopAllAction(){const e=this._actions;for(let i=this._nActiveActions-1;i>=0;--i)e[i].stop();return this}update(e){const t=this._actions,i=this._nActiveActions,r=this.time+=e*=this.timeScale,s=Math.sign(e),o=this._accuIndex^=1;for(let c=0;c!==i;++c)t[c]._update(r,e,s,o);const a=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)a[c].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,i=e.uuid,r=this._actionsByClip,s=r[i];if(void 0!==s){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const c=o[a];this._deactivateAction(c);const u=c._cacheIndex,d=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,d._cacheIndex=u,t[u]=d,t.pop(),this._removeInactiveBindingsForAction(c)}delete r[i]}}uncacheRoot(e){const t=e.uuid,i=this._actionsByClip;for(const o in i){const l=i[o].actionByRoot[t];void 0!==l&&(this._deactivateAction(l),this._removeInactiveAction(l))}const s=this._bindingsByRootAndName[t];if(void 0!==s)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const i=this.existingAction(e,t);null!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}}).prototype._controlInterpolantsResultBuffer=new Float32Array(1);class jx{constructor(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new jx(void 0===this.value.clone?this.value:this.value.clone())}}(class xee extends qc{constructor(e,t,i=1){super(e,t),this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}).prototype.isInstancedInterleavedBuffer=!0;class GN{constructor(e,t,i=0,r=1/0){this.ray=new Ba(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new $b,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,i=[]){return $x(e,this,i,t),i.sort(WN),i}intersectObjects(e,t=!0,i=[]){for(let r=0,s=e.length;r<s;r++)$x(e[r],this,i,t);return i.sort(WN),i}}function WN(n,e){return n.distance-e.distance}function $x(n,e,t,i){if(n.layers.test(e.layers)&&n.raycast(e,t),!0===i){const r=n.children;for(let s=0,o=r.length;s<o;s++)$x(r[s],e,t,!0)}}class jN{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(ei(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}const $N=new j;class Oh{constructor(e=new j(1/0,1/0),t=new j(-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=$N.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return $N.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}Oh.prototype.isBox2=!0;const $o=new C,jg=new Pe,qx=new Pe;function XN(n){const e=[];!0===n.isBone&&e.push(n);for(let t=0;t<n.children.length;t++)e.push.apply(e,XN(n.children[t]));return e}class Eee extends nn{constructor(e,t,i){super(new Ph(t,4,2),new $s({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.light.updateMatrixWorld(),this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const tL=new Float32Array(1);new Int32Array(tL.buffer),mr.create=function(n,e){return console.log("THREE.Curve.create() has been deprecated"),n.prototype=Object.create(mr.prototype),n.prototype.constructor=n,n.prototype.getPoint=e,n},Eg.prototype.fromPoints=function(n){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(n)},class Dee extends Ys{constructor(e=10,t=10,i=4473924,r=8947848){i=new me(i),r=new me(r);const s=t/2,o=e/t,a=e/2,l=[],c=[];for(let h=0,f=0,p=-a;h<=t;h++,p+=o){l.push(-a,0,p,a,0,p),l.push(p,0,-a,p,0,a);const _=h===s?i:r;_.toArray(c,f),f+=3,_.toArray(c,f),f+=3,_.toArray(c,f),f+=3,_.toArray(c,f),f+=3}const u=new Ve;u.setAttribute("position",new De(l,3)),u.setAttribute("color",new De(c,3)),super(u,new Qn({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},class See extends Ys{constructor(e){const t=XN(e),i=new Ve,r=[],s=[],o=new me(0,0,1),a=new me(0,1,0);for(let c=0;c<t.length;c++){const u=t[c];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}i.setAttribute("position",new De(r,3)),i.setAttribute("color",new De(s,3)),super(i,new Qn({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,i=this.geometry,r=i.getAttribute("position");qx.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<t.length;s++){const a=t[s];a.parent&&a.parent.isBone&&(jg.multiplyMatrices(qx,a.matrixWorld),$o.setFromMatrixPosition(jg),r.setXYZ(o,$o.x,$o.y,$o.z),jg.multiplyMatrices(qx,a.parent.matrixWorld),$o.setFromMatrixPosition(jg),r.setXYZ(o+1,$o.x,$o.y,$o.z),o+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},jo.prototype.extractUrlBase=function(n){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),class zx{static decodeText(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch(i){return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}.extractUrlBase(n)},jo.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Oh.prototype.center=function(n){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(n)},Oh.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Oh.prototype.isIntersectionBox=function(n){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(n)},Oh.prototype.size=function(n){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(n)},fr.prototype.center=function(n){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(n)},fr.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},fr.prototype.isIntersectionBox=function(n){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(n)},fr.prototype.isIntersectionSphere=function(n){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(n)},fr.prototype.size=function(n){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(n)},Va.prototype.toVector3=function(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")},ka.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},rg.prototype.setFromMatrix=function(n){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(n)},qn.prototype.flattenToArrayOffset=function(n,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(n,e)},qn.prototype.multiplyVector3=function(n){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),n.applyMatrix3(this)},qn.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},qn.prototype.applyToBufferAttribute=function(n){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),n.applyMatrix3(this)},qn.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},qn.prototype.getInverse=function(n){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(n).invert()},Pe.prototype.extractPosition=function(n){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(n)},Pe.prototype.flattenToArrayOffset=function(n,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(n,e)},Pe.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new C).setFromMatrixColumn(this,3)},Pe.prototype.setRotationFromQuaternion=function(n){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(n)},Pe.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},Pe.prototype.multiplyVector3=function(n){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),n.applyMatrix4(this)},Pe.prototype.multiplyVector4=function(n){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),n.applyMatrix4(this)},Pe.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},Pe.prototype.rotateAxis=function(n){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),n.transformDirection(this)},Pe.prototype.crossVector=function(n){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),n.applyMatrix4(this)},Pe.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},Pe.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},Pe.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},Pe.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},Pe.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},Pe.prototype.applyToBufferAttribute=function(n){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),n.applyMatrix4(this)},Pe.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},Pe.prototype.makeFrustum=function(n,e,t,i,r,s){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(n,e,i,t,r,s)},Pe.prototype.getInverse=function(n){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(n).invert()},qs.prototype.isIntersectionLine=function(n){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(n)},Yn.prototype.multiplyVector3=function(n){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),n.applyQuaternion(this)},Yn.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},Ba.prototype.isIntersectionBox=function(n){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(n)},Ba.prototype.isIntersectionPlane=function(n){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(n)},Ba.prototype.isIntersectionSphere=function(n){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(n)},Rn.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},Rn.prototype.barycoordFromPoint=function(n,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(n,e)},Rn.prototype.midpoint=function(n){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(n)},Rn.prototypenormal=function(n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(n)},Rn.prototype.plane=function(n){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(n)},Rn.barycoordFromPoint=function(n,e,t,i,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Rn.getBarycoord(n,e,t,i,r)},Rn.normal=function(n,e,t,i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Rn.getNormal(n,e,t,i)},ls.prototype.extractAllPoints=function(n){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(n)},ls.prototype.extrude=function(n){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Go(this,n)},ls.prototype.makeGeometry=function(n){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new nu(this,n)},j.prototype.fromAttribute=function(n,e,t){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(n,e,t)},j.prototype.distanceToManhattan=function(n){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(n)},j.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},C.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},C.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},C.prototype.getPositionFromMatrix=function(n){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(n)},C.prototype.getScaleFromMatrix=function(n){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(n)},C.prototype.getColumnFromMatrix=function(n,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,n)},C.prototype.applyProjection=function(n){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(n)},C.prototype.fromAttribute=function(n,e,t){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(n,e,t)},C.prototype.distanceToManhattan=function(n){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(n)},C.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Ft.prototype.fromAttribute=function(n,e,t){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(n,e,t)},Ft.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Rt.prototype.getChildByName=function(n){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(n)},Rt.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},Rt.prototype.translate=function(n,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,n)},Rt.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},Rt.prototype.applyMatrix=function(n){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(n)},Object.defineProperties(Rt.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(n){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=n}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),nn.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(nn.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),wx.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Hn.prototype.setLens=function(n,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(n)},Object.defineProperties(us.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(n){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=n}},shadowCameraLeft:{set:function(n){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=n}},shadowCameraRight:{set:function(n){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=n}},shadowCameraTop:{set:function(n){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=n}},shadowCameraBottom:{set:function(n){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=n}},shadowCameraNear:{set:function(n){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=n}},shadowCameraFar:{set:function(n){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=n}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(n){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=n}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(n){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=n}},shadowMapHeight:{set:function(n){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=n}}}),Object.defineProperties(Ut.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===ch},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(ch)}}}),Ut.prototype.setDynamic=function(n){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===n?ch:lh),this},Ut.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},Ut.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Ve.prototype.addIndex=function(n){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(n)},Ve.prototype.addAttribute=function(n,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===n?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(n,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(n,new Ut(arguments[1],arguments[2])))},Ve.prototype.addDrawCall=function(n,e,t){void 0!==t&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(n,e)},Ve.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},Ve.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},Ve.prototype.removeAttribute=function(n){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(n)},Ve.prototype.applyMatrix=function(n){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(n)},Object.defineProperties(Ve.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),qc.prototype.setDynamic=function(n){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===n?ch:lh),this},qc.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Go.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},Go.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},Go.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},wh.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},jx.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(Pn.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new me}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(n){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(n){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=n}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(Fr.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(n){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=n}}}),Pt.prototype.clearTarget=function(n,e,t,i){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(n),this.clear(e,t,i)},Pt.prototype.animate=function(n){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(n)},Pt.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},Pt.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},Pt.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},Pt.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},Pt.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},Pt.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},Pt.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},Pt.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},Pt.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},Pt.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},Pt.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},Pt.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},Pt.prototype.enableScissorTest=function(n){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(n)},Pt.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},Pt.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},Pt.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},Pt.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},Pt.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},Pt.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},Pt.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},Pt.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},Pt.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},Pt.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(Pt.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(n){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=n}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(n){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=n}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(n){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===n?cn:Io}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}},gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}}),Object.defineProperties(T3.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Pi.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(n){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=n}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(n){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=n}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(n){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=n}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(n){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=n}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(n){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=n}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(n){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=n}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(n){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=n}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(n){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=n}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(n){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=n}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(n){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=n}}}),class oee extends Rt{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}.prototype.load=function(n){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const e=this;return(new tee).load(n,function(i){e.setBuffer(i)}),this},sx.prototype.updateCubeMap=function(n,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(n,e)},sx.prototype.clear=function(n,e,t,i){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(n,e,t,i)},Na.crossOrigin=void 0,Na.loadTexture=function(n,e,t,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const r=new bN;r.setCrossOrigin(this.crossOrigin);const s=r.load(n,t,void 0,i);return e&&(s.mapping=e),s},Na.loadTextureCube=function(n,e,t,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const r=new XZ;r.setCrossOrigin(this.crossOrigin);const s=r.load(n,t,void 0,i);return e&&(s.mapping=e),s},Na.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Na.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"138"}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="138");let nL=(()=>{class n{constructor(t){this.httpClient=t,this.getPinLonLat=(i="1vRdclyzCMhaoO23Xv81zbfmcLZQ9sKFrOwlkZFmozXM")=>this.httpClient.get(`https://docs.google.com/spreadsheets/d/${i}/gviz/tq?`,{responseType:"text"}).pipe(this.convertTalbeToGoogleSheetPins,this.convertAddressToMockGeoencoding,this.convertGeoencodingToLonLat),this.convertTalbeToGoogleSheetPins=tt(i=>{i=this.removeExtraText(i);const o=JSON.parse(i).table.rows.filter((l,c)=>{var u;return"\u843d\u9ede\u540d\u7a31"!==(null===(u=l.c[0])||void 0===u?void 0:u.v)});return this.formatingPointData(o)}),this.formatingPointData=i=>i.map((r,s)=>{let o="",a="";return r.c&&(o=r.c[0].v,a=r.c[1].v),{id:s,title:o,address:a}}),this.removeExtraText=i=>i.replace("/*O_o*/\ngoogle.visualization.Query.setResponse(","").replace(");",""),this.convertAddressToMockGeoencoding=tt(i=>i.map((r,s)=>({geoencodingRaw:[{results:[{address_components:[{long_name:"2F",short_name:"2F",types:["subpremise"]},{long_name:"188\u865f",short_name:"188\u865f",types:["street_number"]},{long_name:"\u6210\u529f\u8def\u56db\u6bb5",short_name:"\u6210\u529f\u8def\u56db\u6bb5",types:["route"]},{long_name:"\u5167\u6e56\u91cc",short_name:"\u5167\u6e56\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u5167\u6e56\u5340",short_name:"\u5167\u6e56\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u53f0\u5317\u5e02",short_name:"\u53f0\u5317\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"114",short_name:"114",types:["postal_code"]}],formatted_address:"114\u53f0\u7063\u53f0\u5317\u5e02\u5167\u6e56\u5340\u6210\u529f\u8def\u56db\u6bb5188\u865f2F",geometry:{location:{lat:25.0839162,lng:121.5943353},location_type:"ROOFTOP",viewport:{northeast:{lat:25.0851984802915,lng:121.5957423302915},southwest:{lat:25.0825005197085,lng:121.5930443697085}}},place_id:"ChIJOwc1We2sQjQRJlsN6Ykwf0Q",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"\u865f 6 \u6a13",short_name:"\u865f 6 \u6a13",types:["subpremise"]},{long_name:"17",short_name:"17",types:["street_number"]},{long_name:"\u677e\u667a\u8def",short_name:"\u677e\u667a\u8def",types:["route"]},{long_name:"\u897f\u6751\u91cc",short_name:"\u897f\u6751\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u4fe1\u7fa9\u5340",short_name:"\u4fe1\u7fa9\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u53f0\u5317\u5e02",short_name:"\u53f0\u5317\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"110",short_name:"110",types:["postal_code"]}],formatted_address:"110\u53f0\u7063\u53f0\u5317\u5e02\u4fe1\u7fa9\u5340\u677e\u667a\u8def17\u865f\u865f 6 \u6a13",geometry:{location:{lat:25.0344052,lng:121.567424},location_type:"ROOFTOP",viewport:{northeast:{lat:25.0357532802915,lng:121.5688362302915},southwest:{lat:25.0330553197085,lng:121.5661382697085}}},place_id:"ChIJldoY77CrQjQRdgH_ne33Lho",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"\u53f0\u5317\u5e02",short_name:"\u53f0\u5317\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]}],formatted_address:"\u53f0\u7063\u53f0\u5317\u5e02",geometry:{bounds:{northeast:{lat:25.2103038,lng:121.6659421},southwest:{lat:24.9605084,lng:121.4570603}},location:{lat:25.0329636,lng:121.5654268},location_type:"APPROXIMATE",viewport:{northeast:{lat:25.2103038,lng:121.6659421},southwest:{lat:24.9605084,lng:121.4570603}}},partial_match:!0,place_id:"ChIJi73bYWusQjQRgqQGXK260bw",types:["administrative_area_level_1","political"]}],status:"OK"},{results:[{address_components:[{long_name:"B1",short_name:"B1",types:["subpremise"]},{long_name:"68\u865f",short_name:"68\u865f",types:["street_number"]},{long_name:"\u5fe0\u5b5d\u6771\u8def\u4e94\u6bb5",short_name:"\u5fe0\u5b5d\u6771\u8def\u4e94\u6bb5",types:["route"]},{long_name:"\u8208\u96c5\u91cc",short_name:"\u8208\u96c5\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u4fe1\u7fa9\u5340",short_name:"\u4fe1\u7fa9\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u53f0\u5317\u5e02",short_name:"\u53f0\u5317\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"110",short_name:"110",types:["postal_code"]}],formatted_address:"B1, No. 68\u865f\u5fe0\u5b5d\u6771\u8def\u4e94\u6bb5\u4fe1\u7fa9\u5340\u53f0\u5317\u5e02\u53f0\u7063 110",geometry:{location:{lat:25.0406017,lng:121.5670112},location_type:"ROOFTOP",viewport:{northeast:{lat:25.0421696802915,lng:121.5683668302915},southwest:{lat:25.0394717197085,lng:121.5656688697085}}},place_id:"ChIJIZiwlLurQjQRduNThJd_3lk",types:["subpremise"]},{address_components:[{long_name:"B1",short_name:"B1",types:["subpremise"]},{long_name:"68\u865f",short_name:"68\u865f",types:["street_number"]},{long_name:"\u5fe0\u5b5d\u6771\u8def\u4e94\u6bb5",short_name:"\u5fe0\u5b5d\u6771\u8def\u4e94\u6bb5",types:["route"]},{long_name:"\u8208\u96c5\u91cc",short_name:"\u8208\u96c5\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u4fe1\u7fa9\u5340",short_name:"\u4fe1\u7fa9\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u53f0\u5317\u5e02",short_name:"\u53f0\u5317\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"110",short_name:"110",types:["postal_code"]}],formatted_address:"B1, No. 68\u865f\u5fe0\u5b5d\u6771\u8def\u4e94\u6bb5\u4fe1\u7fa9\u5340\u53f0\u5317\u5e02\u53f0\u7063 110",geometry:{location:{lat:25.0406017,lng:121.5670112},location_type:"ROOFTOP",viewport:{northeast:{lat:25.0421696802915,lng:121.5683668302915},southwest:{lat:25.0394717197085,lng:121.5656688697085}}},place_id:"ChIJIZiwlLurQjQRduNThJd_3lk",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"2\u6a13",short_name:"2\u6a13",types:["subpremise"]},{long_name:"3\u865f",short_name:"3\u865f",types:["street_number"]},{long_name:"\u5317\u5e73\u897f\u8def",short_name:"\u5317\u5e73\u897f\u8def",types:["route"]},{long_name:"\u9ece\u660e\u91cc",short_name:"\u9ece\u660e\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u4e2d\u6b63\u5340",short_name:"\u4e2d\u6b63\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u53f0\u5317\u5e02",short_name:"\u53f0\u5317\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"100",short_name:"100",types:["postal_code"]}],formatted_address:"100\u53f0\u7063\u53f0\u5317\u5e02\u4e2d\u6b63\u5340\u5317\u5e73\u897f\u8def3\u865f2\u6a13",geometry:{location:{lat:25.0477467,lng:121.5169983},location_type:"ROOFTOP",viewport:{northeast:{lat:25.0490956802915,lng:121.5183472802915},southwest:{lat:25.04639771970849,lng:121.5156493197085}}},place_id:"ChIJxeVZh3KpQjQR0ESgIfL9Ug0",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"\u865f8\u6a13",short_name:"\u865f8\u6a13",types:["subpremise"]},{long_name:"12\u865f",short_name:"12\u865f",types:["street_number"]},{long_name:"\u5357\u4eac\u897f\u8def",short_name:"\u5357\u4eac\u897f\u8def",types:["route"]},{long_name:"\u6c11\u5b89\u91cc",short_name:"\u6c11\u5b89\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u4e2d\u5c71\u5340",short_name:"\u4e2d\u5c71\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u53f0\u5317\u5e02",short_name:"\u53f0\u5317\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"10491",short_name:"10491",types:["postal_code"]}],formatted_address:"10491\u53f0\u7063\u53f0\u5317\u5e02\u4e2d\u5c71\u5340\u5357\u4eac\u897f\u8def12\u865f, \u865f8\u6a13",geometry:{location:{lat:25.0523295,lng:121.5210381},location_type:"ROOFTOP",viewport:{northeast:{lat:25.0537450802915,lng:121.5224026302915},southwest:{lat:25.0510471197085,lng:121.5197046697085}}},place_id:"ChIJwZn0tG6pQjQRoZq5OE4obDQ",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"2",short_name:"2",types:["subpremise"]},{long_name:"133",short_name:"133",types:["street_number"]},{long_name:"\u5b89\u548c\u8def\u4e8c\u6bb5",short_name:"\u5b89\u548c\u8def\u4e8c\u6bb5",types:["route"]},{long_name:"\u901a\u5b89\u91cc",short_name:"\u901a\u5b89\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u5927\u5b89\u5340",short_name:"\u5927\u5b89\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u53f0\u5317\u5e02",short_name:"\u53f0\u5317\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"106",short_name:"106",types:["postal_code"]}],formatted_address:"106\u53f0\u7063\u53f0\u5317\u5e02\u5927\u5b89\u5340\u5b89\u548c\u8def\u4e8c\u6bb5133\u865f2",geometry:{location:{lat:25.0290777,lng:121.5511697},location_type:"ROOFTOP",viewport:{northeast:{lat:25.0304823802915,lng:121.5524596302915},southwest:{lat:25.0277844197085,lng:121.5497616697085}}},place_id:"EkkyLCBOby4gMTMzLCBTZWN0aW9uIDIsIEFuaGUgUmQsIERh4oCZYW4gRGlzdHJpY3QsIFRhaXBlaSBDaXR5LCBUYWl3YW4gMTA2Ih0aGwoWChQKEgkzSmzWMqpCNBEUut47WTp6fRIBMg",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"12\u6a13",short_name:"12\u6a13",types:["subpremise"]},{long_name:"66\u865f",short_name:"66\u865f",types:["street_number"]},{long_name:"\u5fe0\u5b5d\u897f\u8def\u4e00\u6bb5",short_name:"\u5fe0\u5b5d\u897f\u8def\u4e00\u6bb5",types:["route"]},{long_name:"\u9ece\u660e\u91cc",short_name:"\u9ece\u660e\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u4e2d\u6b63\u5340",short_name:"\u4e2d\u6b63\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u53f0\u5317\u5e02",short_name:"\u53f0\u5317\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"100",short_name:"100",types:["postal_code"]}],formatted_address:"100\u53f0\u7063\u53f0\u5317\u5e02\u4e2d\u6b63\u5340\u5fe0\u5b5d\u897f\u8def\u4e00\u6bb566\u865f12\u6a13",geometry:{location:{lat:25.0461864,lng:121.5153037},location_type:"ROOFTOP",viewport:{northeast:{lat:25.04777793029151,lng:121.5167156302915},southwest:{lat:25.0450799697085,lng:121.5140176697085}}},place_id:"ChIJNyOh3nKpQjQR3hMRuMCqRtA",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"2F",short_name:"2F",types:["subpremise"]},{long_name:"11\u865f",short_name:"11\u865f",types:["street_number"]},{long_name:"\u677e\u5c71\u8def",short_name:"\u677e\u5c71\u8def",types:["route"]},{long_name:"\u6c38\u5409\u91cc",short_name:"\u6c38\u5409\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u4fe1\u4e49\u533a",short_name:"\u4fe1\u4e49\u533a",types:["administrative_area_level_3","political"]},{long_name:"\u53f0\u5317\u5e02",short_name:"\u53f0\u5317\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"110",short_name:"110",types:["postal_code"]}],formatted_address:"110\u53f0\u7063\u53f0\u5317\u5e02\u4fe1\u4e49\u533a\u677e\u5c71\u8def11\u865f2F",geometry:{location:{lat:25.0493031,lng:121.5786215},location_type:"ROOFTOP",viewport:{northeast:{lat:25.0506370302915,lng:121.5795802802915},southwest:{lat:25.0479390697085,lng:121.5768823197085}}},place_id:"ChIJU_Dunp6rQjQRNnLLkn2zaAc",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"8\u6a13C\u68df",short_name:"8\u6a13C\u68df",types:["subpremise"]},{long_name:"369\u865f",short_name:"369\u865f",types:["street_number"]},{long_name:"\u5fe0\u5b5d\u6771\u8def\u4e03\u6bb5",short_name:"\u5fe0\u5b5d\u6771\u8def\u4e03\u6bb5",types:["route"]},{long_name:"\u6771\u660e\u91cc",short_name:"\u6771\u660e\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u5357\u6e2f\u5340",short_name:"\u5357\u6e2f\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u53f0\u5317\u5e02",short_name:"\u53f0\u5317\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"11561",short_name:"11561",types:["postal_code"]}],formatted_address:"11561\u53f0\u7063\u53f0\u5317\u5e02\u5357\u6e2f\u5340\u5fe0\u5b5d\u6771\u8def\u4e03\u6bb5369\u865f8\u6a13C\u68df",geometry:{location:{lat:25.0525582,lng:121.604518},location_type:"ROOFTOP",viewport:{northeast:{lat:25.0535651302915,lng:121.6059169302915},southwest:{lat:25.0508671697085,lng:121.6032189697085}}},place_id:"ChIJl_iiaWerQjQRR0aKhzskskE",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"246",short_name:"246",types:["street_number"]},{long_name:"\u5167\u6e56\u8def\u4e00\u6bb5",short_name:"\u5167\u6e56\u8def\u4e00\u6bb5",types:["route"]},{long_name:"\u897f\u6e56\u91cc",short_name:"\u897f\u6e56\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u5167\u6e56\u5340",short_name:"\u5167\u6e56\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u53f0\u5317\u5e02",short_name:"\u53f0\u5317\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"114",short_name:"114",types:["postal_code"]}],formatted_address:"114\u53f0\u7063\u53f0\u5317\u5e02\u5167\u6e56\u5340\u5167\u6e56\u8def\u4e00\u6bb5246\u865f",geometry:{location:{lat:25.0818438,lng:121.5661028},location_type:"ROOFTOP",viewport:{northeast:{lat:25.0833526802915,lng:121.5675359802915},southwest:{lat:25.08065471970849,lng:121.5648380197085}}},place_id:"ChIJa8jNhW6sQjQRi5t_-Qy2KGs",plus_code:{compound_code:"3HJ8+PC \u53f0\u7063\u53f0\u5317\u5e02\u5167\u6e56\u5340",global_code:"7QQ33HJ8+PC"},types:["street_address"]}],status:"OK"},{results:[{address_components:[{long_name:"a 7",short_name:"a 7",types:["subpremise"]},{long_name:"68",short_name:"68",types:["street_number"]},{long_name:"\u5929\u6bcd\u6771\u8def",short_name:"\u5929\u6bcd\u6771\u8def",types:["route"]},{long_name:"\u5929\u798f\u91cc",short_name:"\u5929\u798f\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u58eb\u6797\u5340",short_name:"\u58eb\u6797\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u53f0\u5317\u5e02",short_name:"\u53f0\u5317\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"111",short_name:"111",types:["postal_code"]}],formatted_address:"111\u53f0\u7063\u53f0\u5317\u5e02\u58eb\u6797\u5340\u5929\u6bcd\u6771\u8def68\u865fa 7",geometry:{bounds:{northeast:{lat:25.1179579,lng:121.5343171},southwest:{lat:25.1175992,lng:121.5336029}},location:{lat:25.1178315,lng:121.5338781},location_type:"ROOFTOP",viewport:{northeast:{lat:25.1191712802915,lng:121.5353089802915},southwest:{lat:25.11647331970849,lng:121.5326110197085}}},place_id:"EkJhIDcsIE5vLiA2OCwgVGlhbm11IEUgUmQsIFNoaWxpbiBEaXN0cmljdCwgVGFpcGVpIENpdHksIFRhaXdhbiAxMTEiHxodChYKFAoSCaNZRYaArkI0Eeaf26ojTurbEgNhIDc",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"654",short_name:"654",types:["street_number"]},{long_name:"\u91cd\u65b0\u8def\u4e94\u6bb5",short_name:"\u91cd\u65b0\u8def\u4e94\u6bb5",types:["route"]},{long_name:"\u4e2d\u8208\u91cc",short_name:"\u4e2d\u8208\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u4e09\u91cd\u5340",short_name:"\u4e09\u91cd\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u65b0\u5317\u5e02",short_name:"\u65b0\u5317\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"241",short_name:"241",types:["postal_code"]}],formatted_address:"241\u53f0\u7063\u65b0\u5317\u5e02\u4e09\u91cd\u5340\u91cd\u65b0\u8def\u4e94\u6bb5654\u865f",geometry:{location:{lat:25.0432729,lng:121.4675175},location_type:"ROOFTOP",viewport:{northeast:{lat:25.0447271802915,lng:121.4687456802915},southwest:{lat:25.0420292197085,lng:121.4660477197085}}},place_id:"ChIJ0QMaT2eoQjQRA5ZdsLV7k0c",plus_code:{compound_code:"2FV9+82 \u53f0\u7063\u65b0\u5317\u5e02\u4e09\u91cd\u5340",global_code:"7QQ32FV9+82"},types:["street_address"]}],status:"OK"},{results:[{address_components:[{long_name:"\u865f7F",short_name:"\u865f7F",types:["subpremise"]},{long_name:"40-6",short_name:"40-6",types:["street_number"]},{long_name:"\u6a39\u65b0\u8def",short_name:"\u6a39\u65b0\u8def",types:["route"]},{long_name:"\u4fdd\u5b89\u91cc",short_name:"\u4fdd\u5b89\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u6a39\u6797\u5340",short_name:"\u6a39\u6797\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u65b0\u5317\u5e02",short_name:"\u65b0\u5317\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"23847",short_name:"23847",types:["postal_code"]}],formatted_address:"23847\u53f0\u7063\u65b0\u5317\u5e02\u6a39\u6797\u5340\u6a39\u65b0\u8def40-6\u865f\u865f7F",geometry:{location:{lat:24.9955124,lng:121.4284262},location_type:"ROOFTOP",viewport:{northeast:{lat:24.9970065302915,lng:121.4295582302915},southwest:{lat:24.9943085697085,lng:121.4268602697085}}},place_id:"ChIJUfJHs0AdaDQRC10LVyZZHYc",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"10\u6a13",short_name:"10\u6a13",types:["subpremise"]},{long_name:"8\u865f",short_name:"8\u865f",types:["street_number"]},{long_name:"\u4e2d\u5c71\u8def",short_name:"\u4e2d\u5c71\u8def",types:["route"]},{long_name:"\u9577\u5e9a\u91cc",short_name:"\u9577\u5e9a\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u6de1\u6c34\u5340",short_name:"\u6de1\u6c34\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u65b0\u5317\u5e02",short_name:"\u65b0\u5317\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"251",short_name:"251",types:["postal_code"]}],formatted_address:"251\u53f0\u7063\u65b0\u5317\u5e02\u6de1\u6c34\u5340\u4e2d\u5c71\u8def8\u865f10\u6a13",geometry:{location:{lat:25.1691131,lng:121.444993},location_type:"ROOFTOP",viewport:{northeast:{lat:25.1704620802915,lng:121.4463419802915},southwest:{lat:25.1677641197085,lng:121.4436440197085}}},place_id:"ChIJVVWVelilQjQRhrC7o221jDk",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"111",short_name:"111",types:["street_number"]},{long_name:"\u5929\u6bcd\u897f\u8def",short_name:"\u5929\u6bcd\u897f\u8def",types:["route"]},{long_name:"\u6c38\u6b23\u91cc",short_name:"\u6c38\u6b23\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u5317\u6295\u5340",short_name:"\u5317\u6295\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u53f0\u5317\u5e02",short_name:"\u53f0\u5317\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"112",short_name:"112",types:["postal_code"]}],formatted_address:"112\u53f0\u7063\u53f0\u5317\u5e02\u5317\u6295\u5340\u5929\u6bcd\u897f\u8def111\u865f",geometry:{location:{lat:25.1189355,lng:121.5234462},location_type:"ROOFTOP",viewport:{northeast:{lat:25.12023023029151,lng:121.5247750302915},southwest:{lat:25.11753226970851,lng:121.5220770697085}}},place_id:"ChIJ_3z3T4iuQjQRy6U6pRKhUzU",plus_code:{compound_code:"4G9F+H9 \u53f0\u7063\u53f0\u5317\u5e02\u5317\u6295\u5340",global_code:"7QQ34G9F+H9"},types:["street_address"]}],status:"OK"},{results:[{address_components:[{long_name:"2\u6a13",short_name:"2\u6a13",types:["subpremise"]},{long_name:"356\u865f",short_name:"356\u865f",types:["street_number"]},{long_name:"\u6587\u5316\u4e09\u8def\u4e00\u6bb5",short_name:"\u6587\u5316\u4e09\u8def\u4e00\u6bb5",types:["route"]},{long_name:"\u5357\u52e2\u91cc",short_name:"\u5357\u52e2\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u6797\u53e3\u5340",short_name:"\u6797\u53e3\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u65b0\u5317\u5e02",short_name:"\u65b0\u5317\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"244",short_name:"244",types:["postal_code"]}],formatted_address:"244\u53f0\u7063\u65b0\u5317\u5e02\u6797\u53e3\u5340\u6587\u5316\u4e09\u8def\u4e00\u6bb5356\u865f2\u6a13",geometry:{location:{lat:25.0707927,lng:121.364181},location_type:"ROOFTOP",viewport:{northeast:{lat:25.0724083802915,lng:121.3651821802915},southwest:{lat:25.0697104197085,lng:121.3624842197085}}},place_id:"ChIJIVV0YCinQjQRS_ncy889ySU",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"95",short_name:"95",types:["street_number"]},{long_name:"\u6b63\u7fa9\u5317\u8def",short_name:"\u6b63\u7fa9\u5317\u8def",types:["route"]},{long_name:"\u6587\u5316\u91cc",short_name:"\u6587\u5316\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u4e09\u91cd\u5340",short_name:"\u4e09\u91cd\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u65b0\u5317\u5e02",short_name:"\u65b0\u5317\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"241",short_name:"241",types:["postal_code"]}],formatted_address:"241\u53f0\u7063\u65b0\u5317\u5e02\u4e09\u91cd\u5340\u6b63\u7fa9\u5317\u8def95\u865f",geometry:{location:{lat:25.0653023,lng:121.497147},location_type:"ROOFTOP",viewport:{northeast:{lat:25.0666305302915,lng:121.4984099802915},southwest:{lat:25.06393256970849,lng:121.4957120197085}}},place_id:"ChIJIY24JyKpQjQRVfJqhLTo7Q8",plus_code:{compound_code:"3F8W+4V \u53f0\u7063\u65b0\u5317\u5e02\u4e09\u91cd\u5340",global_code:"7QQ33F8W+4V"},types:["street_address"]}],status:"OK"},{results:[{address_components:[{long_name:"2",short_name:"2",types:["subpremise"]},{long_name:"750",short_name:"750",types:["street_number"]},{long_name:"\u5e78\u798f\u8def",short_name:"\u5e78\u798f\u8def",types:["route"]},{long_name:"\u4e2d\u6e2f\u91cc",short_name:"\u4e2d\u6e2f\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u65b0\u838a\u5340",short_name:"\u65b0\u838a\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u65b0\u5317\u5e02",short_name:"\u65b0\u5317\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"242",short_name:"242",types:["postal_code"]}],formatted_address:"242\u53f0\u7063\u65b0\u5317\u5e02\u65b0\u838a\u5340\u5e78\u798f\u8def750\u865f2",geometry:{location:{lat:25.0492352,lng:121.4478086},location_type:"ROOFTOP",viewport:{northeast:{lat:25.0505196302915,lng:121.4491590802915},southwest:{lat:25.0478216697085,lng:121.4464611197085}}},place_id:"EkYyLCBOby4gNzUwLCBYaW5nZnUgUmQsIFhpbnpodWFuZyBEaXN0cmljdCwgTmV3IFRhaXBlaSBDaXR5LCBUYWl3YW4gMjQyIh0aGwoWChQKEgkDlzolf6hCNBEPOx3PyUmnAxIBMg",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"2\u6a13",short_name:"2\u6a13",types:["subpremise"]},{long_name:"22\u865f",short_name:"22\u865f",types:["street_number"]},{long_name:"\u656c\u696d\u4e09\u8def",short_name:"\u656c\u696d\u4e09\u8def",types:["route"]},{long_name:"\u5927\u76f4",short_name:"\u5927\u76f4",types:["neighborhood","political"]},{long_name:"\u91d1\u6cf0\u91cc",short_name:"\u91d1\u6cf0\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u4e2d\u5c71\u5340",short_name:"\u4e2d\u5c71\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u53f0\u5317\u5e02",short_name:"\u53f0\u5317\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"104",short_name:"104",types:["postal_code"]}],formatted_address:"104\u53f0\u7063\u53f0\u5317\u5e02\u4e2d\u5c71\u5340\u656c\u696d\u4e09\u8def22\u865f2\u6a13",geometry:{location:{lat:25.0836504,lng:121.5571597},location_type:"ROOFTOP",viewport:{northeast:{lat:25.0850003302915,lng:121.5581201802915},southwest:{lat:25.0823023697085,lng:121.5554222197085}}},partial_match:!0,place_id:"ChIJpU1L_hKsQjQRaev35ZVH1xc",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"179",short_name:"179",types:["street_number"]},{long_name:"\u5efa\u4e00\u8def",short_name:"\u5efa\u4e00\u8def",types:["route"]},{long_name:"\u5e73\u6cb3\u91cc",short_name:"\u5e73\u6cb3\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u4e2d\u548c\u5340",short_name:"\u4e2d\u548c\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u65b0\u5317\u5e02",short_name:"\u65b0\u5317\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"235",short_name:"235",types:["postal_code"]}],formatted_address:"235\u53f0\u7063\u65b0\u5317\u5e02\u4e2d\u548c\u5340\u5efa\u4e00\u8def179\u865f",geometry:{location:{lat:24.9986781,lng:121.4883472},location_type:"ROOFTOP",viewport:{northeast:{lat:25.0000247802915,lng:121.4896180802915},southwest:{lat:24.9973268197085,lng:121.4869201197085}}},place_id:"ChIJH0cdA4ECaDQRG4qAF6QItYw",plus_code:{compound_code:"XFXQ+F8 \u53f0\u7063\u65b0\u5317\u5e02\u4e2d\u548c\u5340",global_code:"7QP3XFXQ+F8"},types:["street_address"]}],status:"OK"},{results:[{address_components:[{long_name:"65",short_name:"65",types:["street_number"]},{long_name:"\u6587\u5316\u8def\u4e00\u6bb5",short_name:"\u6587\u5316\u8def\u4e00\u6bb5",types:["route"]},{long_name:"\u6f22\u751f\u91cc",short_name:"\u6f22\u751f\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u677f\u6a4b\u5340",short_name:"\u677f\u6a4b\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u65b0\u5317\u5e02",short_name:"\u65b0\u5317\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"220",short_name:"220",types:["postal_code"]}],formatted_address:"220\u53f0\u7063\u65b0\u5317\u5e02\u677f\u6a4b\u5340\u6587\u5316\u8def\u4e00\u6bb565\u865f",geometry:{location:{lat:25.0138111,lng:121.4608474},location_type:"ROOFTOP",viewport:{northeast:{lat:25.0151263802915,lng:121.4622463802915},southwest:{lat:25.0124284197085,lng:121.4595484197085}}},place_id:"ChIJzydCiRuoQjQR6Y2CVb9oIz0",plus_code:{compound_code:"2F76+G8 \u53f0\u7063\u65b0\u5317\u5e02\u677f\u6a4b\u5340",global_code:"7QQ32F76+G8"},types:["street_address"]}],status:"OK"},{results:[{address_components:[{long_name:"13\u6a13",short_name:"13\u6a13",types:["subpremise"]},{long_name:"152\u865f",short_name:"152\u865f",types:["street_number"]},{long_name:"\u4e2d\u5c71\u8def\u4e00\u6bb5",short_name:"\u4e2d\u5c71\u8def\u4e00\u6bb5",types:["route"]},{long_name:"\u6df1\u4e18\u91cc",short_name:"\u6df1\u4e18\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u677f\u6a4b\u5340",short_name:"\u677f\u6a4b\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u65b0\u5317\u5e02",short_name:"\u65b0\u5317\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"220",short_name:"220",types:["postal_code"]}],formatted_address:"220\u53f0\u7063\u65b0\u5317\u5e02\u677f\u6a4b\u5340\u4e2d\u5c71\u8def\u4e00\u6bb5152\u865f13\u6a13",geometry:{location:{lat:25.0109769,lng:121.4644504},location_type:"ROOFTOP",viewport:{northeast:{lat:25.0124680802915,lng:121.4657169302915},southwest:{lat:25.0097701197085,lng:121.4630189697085}}},place_id:"ChIJt0dr7B6oQjQRzASO1u71hYM",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"1\u6a13",short_name:"1\u6a13",types:["subpremise"]},{long_name:"99\u865f",short_name:"99\u865f",types:["street_number"]},{long_name:"\u65b0\u53f0\u4e94\u8def\u4e00\u6bb5",short_name:"\u65b0\u53f0\u4e94\u8def\u4e00\u6bb5",types:["route"]},{long_name:"\u5fe0\u5b5d\u91cc",short_name:"\u5fe0\u5b5d\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u6c50\u6b62\u5340",short_name:"\u6c50\u6b62\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u65b0\u5317\u5e02",short_name:"\u65b0\u5317\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"22175",short_name:"22175",types:["postal_code"]}],formatted_address:"22175\u53f0\u7063\u65b0\u5317\u5e02\u6c50\u6b62\u5340\u65b0\u53f0\u4e94\u8def\u4e00\u6bb599\u865f1\u6a13",geometry:{location:{lat:25.0620419,lng:121.6485728},location_type:"ROOFTOP",viewport:{northeast:{lat:25.0630346802915,lng:121.6499746802915},southwest:{lat:25.0603367197085,lng:121.6472767197085}}},place_id:"ChIJeSQ7_0JTXTQRLeLueBME4A8",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"2\u6a13",short_name:"2\u6a13",types:["subpremise"]},{long_name:"8\u865f",short_name:"8\u865f",types:["street_number"]},{long_name:"\u5fa9\u8208\u4e00\u8def",short_name:"\u5fa9\u8208\u4e00\u8def",types:["route"]},{long_name:"\u516c\u897f\u91cc",short_name:"\u516c\u897f\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u9f9c\u5c71\u5340",short_name:"\u9f9c\u5c71\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u6843\u5712\u5e02",short_name:"\u6843\u5712\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"333",short_name:"333",types:["postal_code"]}],formatted_address:"333\u53f0\u7063\u6843\u5712\u5e02\u9f9c\u5c71\u5340\u5fa9\u8208\u4e00\u8def8\u865f, 2\u6a13",geometry:{location:{lat:25.0603021,lng:121.3697947},location_type:"ROOFTOP",viewport:{northeast:{lat:25.0617571302915,lng:121.3710611802915},southwest:{lat:25.0590591697085,lng:121.3683632197085}}},place_id:"ChIJbboSPzunQjQRutkxZx-aOj8",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"6\u6a13\u865f",short_name:"6\u6a13\u865f",types:["subpremise"]},{long_name:"112\u865f",short_name:"112\u865f",types:["street_number"]},{long_name:"\u5357\u5d01\u8def\u4e00\u6bb5",short_name:"\u5357\u5d01\u8def\u4e00\u6bb5",types:["route"]},{long_name:"\u9326\u4e2d\u91cc",short_name:"\u9326\u4e2d\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u8606\u7af9\u5340",short_name:"\u8606\u7af9\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u6843\u5712\u5e02",short_name:"\u6843\u5712\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"338",short_name:"338",types:["postal_code"]}],formatted_address:"338\u53f0\u7063\u6843\u5712\u5e02\u8606\u7af9\u5340\u5357\u5d01\u8def\u4e00\u6bb5112\u865f6\u6a13\u865f",geometry:{location:{lat:25.0533369,lng:121.2877693},location_type:"ROOFTOP",viewport:{northeast:{lat:25.0545796802915,lng:121.2890222302915},southwest:{lat:25.05188171970849,lng:121.2863242697085}}},place_id:"ChIJbQKLj3SgQjQRAjF42F1zC1M",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"2\u6a13",short_name:"2\u6a13",types:["subpremise"]},{long_name:"107\u865f",short_name:"107\u865f",types:["street_number"]},{long_name:"\u6625\u5fb7\u8def",short_name:"\u6625\u5fb7\u8def",types:["route"]},{long_name:"2\u9130",short_name:"2\u9130",types:["neighborhood","political"]},{long_name:"\u4e2d\u58e2\u5340",short_name:"\u4e2d\u58e2\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u6843\u5712\u5e02",short_name:"\u6843\u5712\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"320",short_name:"320",types:["postal_code"]}],formatted_address:"320\u53f0\u7063\u6843\u5712\u5e02\u4e2d\u58e2\u5340\u6625\u5fb7\u8def107\u865f2\u6a13",geometry:{location:{lat:25.0168255,lng:121.2133654},location_type:"ROOFTOP",viewport:{northeast:{lat:25.0180665802915,lng:121.2144580802915},southwest:{lat:25.0153686197085,lng:121.2117601197085}}},partial_match:!0,place_id:"ChIJveOK5wYhaDQR4r5X8be8mj8",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"2",short_name:"2",types:["subpremise"]},{long_name:"116\u865f",short_name:"116\u865f",types:["street_number"]},{long_name:"\u6c38\u548c\u8def\u4e8c\u6bb5",short_name:"\u6c38\u548c\u8def\u4e8c\u6bb5",types:["route"]},{long_name:"\u6b63\u8208\u91cc",short_name:"\u6b63\u8208\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u6c38\u548c\u5340",short_name:"\u6c38\u548c\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u65b0\u5317\u5e02",short_name:"\u65b0\u5317\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"234",short_name:"234",types:["postal_code"]}],formatted_address:"234\u53f0\u7063\u65b0\u5317\u5e02\u6c38\u548c\u5340\u6c38\u548c\u8def\u4e8c\u6bb5116\u865f2",geometry:{location:{lat:25.0120873,lng:121.5152146},location_type:"ROOFTOP",viewport:{northeast:{lat:25.0134478302915,lng:121.5165169802915},southwest:{lat:25.01074986970849,lng:121.5138190197085}}},place_id:"ChIJiRmyEOqpQjQRrS4CL07ig7Y",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"2",short_name:"2",types:["subpremise"]},{long_name:"268",short_name:"268",types:["street_number"]},{long_name:"\u5efa\u570b\u8def",short_name:"\u5efa\u570b\u8def",types:["route"]},{long_name:"\u5fa9\u8208\u91cc",short_name:"\u5fa9\u8208\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u65b0\u5e97\u5340",short_name:"\u65b0\u5e97\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u65b0\u5317\u5e02",short_name:"\u65b0\u5317\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"231",short_name:"231",types:["postal_code"]}],formatted_address:"231\u53f0\u7063\u65b0\u5317\u5e02\u65b0\u5e97\u5340\u5efa\u570b\u8def268\u865f2",geometry:{bounds:{northeast:{lat:24.9835858,lng:121.5380182},southwest:{lat:24.9830411,lng:121.5375051}},location:{lat:24.983287,lng:121.5376693},location_type:"ROOFTOP",viewport:{northeast:{lat:24.9846624302915,lng:121.5391106302915},southwest:{lat:24.98196446970849,lng:121.5364126697085}}},place_id:"EkUyLCBOby4gMjY4LCBKaWFuZ3VvIFJkLCBYaW5kaWFuIERpc3RyaWN0LCBOZXcgVGFpcGVpIENpdHksIFRhaXdhbiAyMzEiHRobChYKFAoSCRt5I5f4AWg0Ebj-Rxke6ziTEgEy",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"4\u6a13",short_name:"4\u6a13",types:["subpremise"]},{long_name:"122\u865f",short_name:"122\u865f",types:["street_number"]},{long_name:"\u4e2d\u5c71\u8def\u4e09\u6bb5",short_name:"\u4e2d\u5c71\u8def\u4e09\u6bb5",types:["route"]},{long_name:"\u54e1\u5c71\u91cc",short_name:"\u54e1\u5c71\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u4e2d\u548c\u5340",short_name:"\u4e2d\u548c\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u65b0\u5317\u5e02",short_name:"\u65b0\u5317\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"235",short_name:"235",types:["postal_code"]}],formatted_address:"235\u53f0\u7063\u65b0\u5317\u5e02\u4e2d\u548c\u5340\u4e2d\u5c71\u8def\u4e09\u6bb5122\u865f4\u6a13",geometry:{location:{lat:25.0069668,lng:121.4749549},location_type:"ROOFTOP",viewport:{northeast:{lat:25.0083525302915,lng:121.4765074302915},southwest:{lat:25.0056545697085,lng:121.4738094697085}}},place_id:"ChIJQZpFJSeoQjQRIE5L-OC8LwE",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"10\u6a13",short_name:"10\u6a13",types:["subpremise"]},{long_name:"19\u865f",short_name:"19\u865f",types:["street_number"]},{long_name:"\u4e2d\u6b63\u8def",short_name:"\u4e2d\u6b63\u8def",types:["route"]},{long_name:"\u6587\u5316\u91cc",short_name:"\u6587\u5316\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u6843\u5712\u5340",short_name:"\u6843\u5712\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u6843\u5712\u5e02",short_name:"\u6843\u5712\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"330",short_name:"330",types:["postal_code"]}],formatted_address:"330\u53f0\u7063\u6843\u5712\u5e02\u6843\u5712\u5340\u4e2d\u6b63\u8def19\u865f10\u6a13",geometry:{location:{lat:24.9899878,lng:121.312985},location_type:"ROOFTOP",viewport:{northeast:{lat:24.9913646302915,lng:121.3144297802915},southwest:{lat:24.9886666697085,lng:121.3117318197085}}},place_id:"ChIJlUYZtPweaDQRiK2UAlL3OCg",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"4\u6a13",short_name:"4\u6a13",types:["subpremise"]},{long_name:"509\u865f",short_name:"509\u865f",types:["street_number"]},{long_name:"\u4e2d\u5712\u8def\u4e8c\u6bb5",short_name:"\u4e2d\u5712\u8def\u4e8c\u6bb5",types:["route"]},{long_name:"\u6c38\u798f\u91cc",short_name:"\u6c38\u798f\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u4e2d\u58e2\u5340",short_name:"\u4e2d\u58e2\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u6843\u5712\u5e02",short_name:"\u6843\u5712\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"320",short_name:"320",types:["postal_code"]}],formatted_address:"320\u53f0\u7063\u6843\u5712\u5e02\u4e2d\u58e2\u5340\u4e2d\u5712\u8def\u4e8c\u6bb5509\u865f4\u6a13",geometry:{location:{lat:25.0016584,lng:121.2289405},location_type:"ROOFTOP",viewport:{northeast:{lat:25.0030473802915,lng:121.2305134302915},southwest:{lat:25.0003494197085,lng:121.2278154697085}}},place_id:"ChIJp4m-0LwhaDQRs8-QnYit1YM",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"8\u6a13",short_name:"8\u6a13",types:["subpremise"]},{long_name:"189\u865f",short_name:"189\u865f",types:["street_number"]},{long_name:"\u5927\u6709\u8def",short_name:"\u5927\u6709\u8def",types:["route"]},{long_name:"\u4e09\u5143\u91cc",short_name:"\u4e09\u5143\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u6843\u5712\u5340",short_name:"\u6843\u5712\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u6843\u5712\u5e02",short_name:"\u6843\u5712\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"330",short_name:"330",types:["postal_code"]}],formatted_address:"330\u53f0\u7063\u6843\u5712\u5e02\u6843\u5712\u5340\u5927\u6709\u8def189\u865f8\u6a13",geometry:{location:{lat:25.0082097,lng:121.3200167},location_type:"ROOFTOP",viewport:{northeast:{lat:25.0096167302915,lng:121.3215557302915},southwest:{lat:25.00691876970849,lng:121.3188577697085}}},place_id:"ChIJdVjgoFoeaDQRGhy3fimuci4",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"2",short_name:"2",types:["subpremise"]},{long_name:"370",short_name:"370",types:["street_number"]},{long_name:"\u5357\u5e73\u8def",short_name:"\u5357\u5e73\u8def",types:["route"]},{long_name:"\u540c\u5fb7\u91cc",short_name:"\u540c\u5fb7\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u6843\u5712\u5340",short_name:"\u6843\u5712\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u6843\u5712\u5e02",short_name:"\u6843\u5712\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"330",short_name:"330",types:["postal_code"]}],formatted_address:"330\u53f0\u7063\u6843\u5712\u5e02\u6843\u5712\u5340\u5357\u5e73\u8def370\u865f2",geometry:{location:{lat:25.0178346,lng:121.2971188},location_type:"ROOFTOP",viewport:{northeast:{lat:25.0191062302915,lng:121.2985090802915},southwest:{lat:25.0164082697085,lng:121.2958111197085}}},place_id:"EkIyLCBOby4gMzcwLCBOYW5waW5nIFJkLCBUYW95dWFuIERpc3RyaWN0LCBUYW95dWFuIENpdHksIFRhaXdhbiAzMzAiHRobChYKFAoSCdG_5IKwH2g0ETelqkHwLXqSEgEy",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"187",short_name:"187",types:["street_number"]},{long_name:"\u5149\u660e\u4e00\u8def",short_name:"\u5149\u660e\u4e00\u8def",types:["route"]},{long_name:"\u5341\u8208\u91cc",short_name:"\u5341\u8208\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u7af9\u5317\u5e02",short_name:"\u7af9\u5317\u5e02",types:["administrative_area_level_3","political"]},{long_name:"\u65b0\u7af9\u7e23",short_name:"\u65b0\u7af9\u7e23",types:["administrative_area_level_2","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"302",short_name:"302",types:["postal_code"]}],formatted_address:"302\u53f0\u7063\u65b0\u7af9\u7e23\u7af9\u5317\u5e02\u5149\u660e\u4e00\u8def187\u865f",geometry:{location:{lat:24.8304182,lng:121.0141923},location_type:"ROOFTOP",viewport:{northeast:{lat:24.8318522302915,lng:121.0155544302915},southwest:{lat:24.8291542697085,lng:121.0128564697085}}},place_id:"ChIJ43jtj-s2aDQRY13Fd-ZNIMs",plus_code:{compound_code:"R2J7+5M \u53f0\u7063\u65b0\u7af9\u7e23\u7af9\u5317\u5e02",global_code:"7QP3R2J7+5M"},types:["street_address"]}],status:"OK"},{results:[{address_components:[{long_name:"88",short_name:"88",types:["street_number"]},{long_name:"\u91d1\u5c71\u8857",short_name:"\u91d1\u5c71\u8857",types:["route"]},{long_name:"\u91d1\u5c71\u91cc",short_name:"\u91d1\u5c71\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u6771\u5340",short_name:"\u6771\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u65b0\u7af9\u5e02",short_name:"\u65b0\u7af9\u5e02",types:["administrative_area_level_2","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"300",short_name:"300",types:["postal_code"]}],formatted_address:"300\u53f0\u7063\u65b0\u7af9\u5e02\u6771\u5340\u91d1\u5c71\u885788\u865f",geometry:{location:{lat:24.7772467,lng:121.0228901},location_type:"ROOFTOP",viewport:{northeast:{lat:24.7786418302915,lng:121.0242683802915},southwest:{lat:24.7759438697085,lng:121.0215704197085}}},place_id:"ChIJD3fFdy82aDQR46sphT2iiIY",plus_code:{compound_code:"Q2GF+V5 \u53f0\u7063\u65b0\u7af9\u5e02\u6771\u5340",global_code:"7QP3Q2GF+V5"},types:["street_address"]}],status:"OK"},{results:[{address_components:[{long_name:"7F",short_name:"7F",types:["subpremise"]},{long_name:"229\u865f",short_name:"229\u865f",types:["street_number"]},{long_name:"\u4e2d\u592e\u8def",short_name:"\u4e2d\u592e\u8def",types:["route"]},{long_name:"\u5fa9\u4e2d\u91cc",short_name:"\u5fa9\u4e2d\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u6771\u5340",short_name:"\u6771\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u65b0\u7af9\u5e02",short_name:"\u65b0\u7af9\u5e02",types:["administrative_area_level_2","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"300",short_name:"300",types:["postal_code"]}],formatted_address:"300\u53f0\u7063\u65b0\u7af9\u5e02\u6771\u5340\u4e2d\u592e\u8def229\u865f7F",geometry:{location:{lat:24.8094355,lng:120.9749907},location_type:"ROOFTOP",viewport:{northeast:{lat:24.8106208802915,lng:120.9764046802915},southwest:{lat:24.8079229197085,lng:120.9737067197085}}},place_id:"ChIJzUUf38Q1aDQReAJtTJGS_jQ",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"8F",short_name:"8F",types:["subpremise"]},{long_name:"357\u865f",short_name:"357\u865f",types:["street_number"]},{long_name:"\u5143\u5316\u8def",short_name:"\u5143\u5316\u8def",types:["route"]},{long_name:"\u91d1\u83ef\u91cc",short_name:"\u91d1\u83ef\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u4e2d\u58e2\u5340",short_name:"\u4e2d\u58e2\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u6843\u5712\u5e02",short_name:"\u6843\u5712\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"320",short_name:"320",types:["postal_code"]}],formatted_address:"320\u53f0\u7063\u6843\u5712\u5e02\u4e2d\u58e2\u5340\u5143\u5316\u8def357\u865f8F",geometry:{location:{lat:24.9626852,lng:121.2238578},location_type:"ROOFTOP",viewport:{northeast:{lat:24.9638296302915,lng:121.2251678802915},southwest:{lat:24.9611316697085,lng:121.2224699197085}}},place_id:"ChIJIf36SjEiaDQRnsQZpQIcm-U",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"2",short_name:"2",types:["subpremise"]},{long_name:"79",short_name:"79",types:["street_number"]},{long_name:"\u95dc\u65b0\u8def",short_name:"\u95dc\u65b0\u8def",types:["route"]},{long_name:"\u65b0\u838a\u91cc",short_name:"\u65b0\u838a\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u6771\u5340",short_name:"\u6771\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u65b0\u7af9\u5e02",short_name:"\u65b0\u7af9\u5e02",types:["administrative_area_level_2","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"300",short_name:"300",types:["postal_code"]}],formatted_address:"300\u53f0\u7063\u65b0\u7af9\u5e02\u6771\u5340\u95dc\u65b0\u8def79\u865f2",geometry:{location:{lat:24.7867199,lng:121.0189641},location_type:"ROOFTOP",viewport:{northeast:{lat:24.7880416302915,lng:121.0203776802915},southwest:{lat:24.7853436697085,lng:121.0176797197085}}},place_id:"Ej4yLCBOby4gNzksIEd1YW54aW4gUmQsIEVhc3QgRGlzdHJpY3QsIEhzaW5jaHUgQ2l0eSwgVGFpd2FuIDMwMCIdGhsKFgoUChIJcSKpeTk2aDQRicyLrU_N__oSATI",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"B-1",short_name:"B-1",types:["subpremise"]},{long_name:"91-2\u865f",short_name:"91-2\u865f",types:["street_number"]},{long_name:"\u6e73\u96c5\u8857",short_name:"\u6e73\u96c5\u8857",types:["route"]},{long_name:"\u6e73\u96c5\u91cc",short_name:"\u6e73\u96c5\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u5317\u5340",short_name:"\u5317\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u65b0\u7af9\u5e02",short_name:"\u65b0\u7af9\u5e02",types:["administrative_area_level_2","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"300",short_name:"300",types:["postal_code"]}],formatted_address:"300\u53f0\u7063\u65b0\u7af9\u5e02\u5317\u5340\u6e73\u96c5\u885791-2\u865fB-1",geometry:{location:{lat:24.8193117,lng:120.9695793},location_type:"ROOFTOP",viewport:{northeast:{lat:24.8205748302915,lng:120.9708238302915},southwest:{lat:24.8178768697085,lng:120.9681258697085}}},place_id:"ChIJH5Hi5Ms1aDQRklEfsw_7dh4",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"\u982d\u4efd",short_name:"\u982d\u4efd",types:["colloquial_area","locality","political"]},{long_name:"\u982d\u4efd\u5e02",short_name:"\u982d\u4efd\u5e02",types:["administrative_area_level_3","political"]},{long_name:"\u82d7\u6817\u7e23",short_name:"\u82d7\u6817\u7e23",types:["administrative_area_level_2","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]}],formatted_address:"\u53f0\u7063\u82d7\u6817\u7e23\u982d\u4efd\u5e02\u982d\u4efd",geometry:{bounds:{northeast:{lat:24.7032653,lng:120.9721581},southwest:{lat:24.630135,lng:120.8763}},location:{lat:24.6884438,lng:120.9024836},location_type:"APPROXIMATE",viewport:{northeast:{lat:24.7032653,lng:120.9721581},southwest:{lat:24.630135,lng:120.8763}}},partial_match:!0,place_id:"ChIJC61tyLZMaDQRw3ZNvdg54pU",types:["colloquial_area","locality","political"]},{address_components:[{long_name:"\u80b2\u6a02\u8857",short_name:"\u80b2\u6a02\u8857",types:["route"]},{long_name:"\u6843\u5712\u5340",short_name:"\u6843\u5712\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u6843\u5712\u5e02",short_name:"\u6843\u5712\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"330",short_name:"330",types:["postal_code"]}],formatted_address:"330\u53f0\u7063\u6843\u5712\u5e02\u6843\u5712\u5340\u80b2\u6a02\u8857",geometry:{bounds:{northeast:{lat:24.9932393,lng:121.3046547},southwest:{lat:24.9904168,lng:121.3032246}},location:{lat:24.991568,lng:121.3039857},location_type:"GEOMETRIC_CENTER",viewport:{northeast:{lat:24.9932393,lng:121.3052886302915},southwest:{lat:24.9904168,lng:121.3025906697085}}},partial_match:!0,place_id:"ChIJ-bE6SwMfaDQRsVV6EfshSzI",types:["route"]}],status:"OK"},{results:[{address_components:[{long_name:"2\u6a13",short_name:"2\u6a13",types:["subpremise"]},{long_name:"459\u865f",short_name:"459\u865f",types:["street_number"]},{long_name:"\u53f0\u7063\u5927\u9053\u4e8c\u6bb5",short_name:"\u53f0\u7063\u5927\u9053\u4e8c\u6bb5",types:["route"]},{long_name:"\u5fe0\u660e\u91cc",short_name:"\u5fe0\u660e\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u897f\u5c6f\u5340",short_name:"\u897f\u5c6f\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u53f0\u4e2d\u5e02",short_name:"\u53f0\u4e2d\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"407",short_name:"407",types:["postal_code"]}],formatted_address:"407\u53f0\u7063\u53f0\u4e2d\u5e02\u897f\u5c6f\u5340\u53f0\u7063\u5927\u9053\u4e8c\u6bb5459\u865f2\u6a13",geometry:{location:{lat:24.1554814,lng:120.6617291},location_type:"ROOFTOP",viewport:{northeast:{lat:24.1569434802915,lng:120.6631533802915},southwest:{lat:24.1542455197085,lng:120.6604554197085}}},place_id:"ChIJ1TsNwJw9aTQRtjXzkKyHZmI",types:["subpremise"]},{address_components:[{long_name:"2\u6a13",short_name:"2\u6a13",types:["subpremise"]},{long_name:"459\u865f",short_name:"459\u865f",types:["street_number"]},{long_name:"\u53f0\u7063\u5927\u9053\u4e8c\u6bb5",short_name:"\u53f0\u7063\u5927\u9053\u4e8c\u6bb5",types:["route"]},{long_name:"\u5fe0\u660e\u91cc",short_name:"\u5fe0\u660e\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u897f\u5c6f\u5340",short_name:"\u897f\u5c6f\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u53f0\u4e2d\u5e02",short_name:"\u53f0\u4e2d\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"407",short_name:"407",types:["postal_code"]}],formatted_address:"407\u53f0\u7063\u53f0\u4e2d\u5e02\u897f\u5c6f\u5340\u53f0\u7063\u5927\u9053\u4e8c\u6bb5459\u865f2\u6a13",geometry:{location:{lat:24.1554814,lng:120.6617291},location_type:"ROOFTOP",viewport:{northeast:{lat:24.1569434802915,lng:120.6631533802915},southwest:{lat:24.1542455197085,lng:120.6604554197085}}},place_id:"ChIJ1TsNwJw9aTQRtjXzkKyHZmI",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"1\u6a13",short_name:"1\u6a13",types:["subpremise"]},{long_name:"\u9e97\u5bf6outlet",short_name:"\u9e97\u5bf6outlet",types:["establishment","point_of_interest"]},{long_name:"201\u865f",short_name:"201\u865f",types:["street_number"]},{long_name:"\u798f\u5bb9\u8def",short_name:"\u798f\u5bb9\u8def",types:["route"]},{long_name:"\u6708\u7709\u91cc",short_name:"\u6708\u7709\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u540e\u91cc\u5340",short_name:"\u540e\u91cc\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u53f0\u4e2d\u5e02",short_name:"\u53f0\u4e2d\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"421",short_name:"421",types:["postal_code"]}],formatted_address:"421\u53f0\u7063\u53f0\u4e2d\u5e02\u540e\u91cc\u5340\u798f\u5bb9\u8def201\u865f\u9e97\u5bf6outlet1\u6a13",geometry:{location:{lat:24.3242977,lng:120.6991781},location_type:"ROOFTOP",viewport:{northeast:{lat:24.3255230802915,lng:120.7006030302915},southwest:{lat:24.3228251197085,lng:120.6979050697085}}},place_id:"ChIJDSYMXRsQaTQRgg0hECx2DSg",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"B1\u6a13",short_name:"B1\u6a13",types:["subpremise"]},{long_name:"68\u865f",short_name:"68\u865f",types:["street_number"]},{long_name:"\u516c\u76ca\u8def",short_name:"\u516c\u76ca\u8def",types:["route"]},{long_name:"\u6c11\u9f8d\u91cc",short_name:"\u6c11\u9f8d\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u897f\u5340",short_name:"\u897f\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u53f0\u4e2d\u5e02",short_name:"\u53f0\u4e2d\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"403",short_name:"403",types:["postal_code"]}],formatted_address:"403\u53f0\u7063\u53f0\u4e2d\u5e02\u897f\u5340\u516c\u76ca\u8def68\u865fB1\u6a13",geometry:{location:{lat:24.15104,lng:120.663848},location_type:"ROOFTOP",viewport:{northeast:{lat:24.1522988802915,lng:120.6651961302915},southwest:{lat:24.1496009197085,lng:120.6624981697085}}},place_id:"ChIJzYkn2J09aTQRImXVkRTz7yU",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"3\u6a13",short_name:"3\u6a13",types:["subpremise"]},{long_name:"299\u865f",short_name:"299\u865f",types:["street_number"]},{long_name:"\u6587\u5316\u8def",short_name:"\u6587\u5316\u8def",types:["route"]},{long_name:"\u6e56\u908a\u91cc",short_name:"\u6e56\u908a\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u897f\u5340",short_name:"\u897f\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u5609\u7fa9\u5e02",short_name:"\u5609\u7fa9\u5e02",types:["administrative_area_level_2","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"600",short_name:"600",types:["postal_code"]}],formatted_address:"600\u53f0\u7063\u5609\u7fa9\u5e02\u897f\u5340\u6587\u5316\u8def299\u865f3\u6a13",geometry:{location:{lat:23.4853918,lng:120.44777},location_type:"ROOFTOP",viewport:{northeast:{lat:23.4867891802915,lng:120.4492621302915},southwest:{lat:23.4840912197085,lng:120.4465641697085}}},place_id:"ChIJDyyIpTKUbjQRDM5_eiaqKlc",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"4\u6a13",short_name:"4\u6a13",types:["subpremise"]},{long_name:"186\u865f",short_name:"186\u865f",types:["street_number"]},{long_name:"\u5fa9\u8208\u8def\u56db\u6bb5",short_name:"\u5fa9\u8208\u8def\u56db\u6bb5",types:["route"]},{long_name:"\u65b0\u5e84\u91cc",short_name:"\u65b0\u5e84\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u6771\u5340",short_name:"\u6771\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u53f0\u4e2d\u5e02",short_name:"\u53f0\u4e2d\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"401",short_name:"401",types:["postal_code"]}],formatted_address:"401\u53f0\u7063\u53f0\u4e2d\u5e02\u6771\u5340\u5fa9\u8208\u8def\u56db\u6bb5186\u865f4\u6a13",geometry:{location:{lat:24.1361012,lng:120.6876041},location_type:"ROOFTOP",viewport:{northeast:{lat:24.1375520802915,lng:120.6889023802915},southwest:{lat:24.1348541197085,lng:120.6862044197085}}},place_id:"ChIJvY166hU9aTQRtd0OCobYLM8",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"3F",short_name:"3F",types:["subpremise"]},{long_name:"210",short_name:"210",types:["street_number"]},{long_name:"\u524d\u92d2\u8def",short_name:"\u524d\u92d2\u8def",types:["route"]},{long_name:"\u6210\u5927\u91cc",short_name:"\u6210\u5927\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u6771\u5340",short_name:"\u6771\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u53f0\u5357\u5e02",short_name:"\u53f0\u5357\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"701",short_name:"701",types:["postal_code"]}],formatted_address:"701\u53f0\u7063\u53f0\u5357\u5e02\u6771\u5340\u524d\u92d2\u8def210\u865f3F",geometry:{location:{lat:22.9963247,lng:120.2143364},location_type:"ROOFTOP",viewport:{northeast:{lat:22.9977342302915,lng:120.2152744302915},southwest:{lat:22.9950362697085,lng:120.2125764697085}}},place_id:"ChIJVTxOqI12bjQR1Umf_fLrQ1I",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"a 12",short_name:"a 12",types:["subpremise"]},{long_name:"161-4\u865f",short_name:"161-4\u865f",types:["street_number"]},{long_name:"\u4e09\u6c11\u8def\u4e09\u6bb5",short_name:"\u4e09\u6c11\u8def\u4e09\u6bb5",types:["route"]},{long_name:"\u9326\u5e73\u91cc",short_name:"\u9326\u5e73\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u5317\u5340",short_name:"\u5317\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u53f0\u4e2d\u5e02",short_name:"\u53f0\u4e2d\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"404",short_name:"404",types:["postal_code"]}],formatted_address:"404\u53f0\u7063\u53f0\u4e2d\u5e02\u5317\u5340\u4e09\u6c11\u8def\u4e09\u6bb5161-4\u865fa 12",geometry:{location:{lat:24.1522437,lng:120.6848058},location_type:"ROOFTOP",viewport:{northeast:{lat:24.1535551302915,lng:120.6862677302915},southwest:{lat:24.1508571697085,lng:120.6835697697085}}},place_id:"ElNhIDEyLCBOby4gMTYxLTTomZ8sIFNlY3Rpb24gMywgU2FubWluIFJkLCBOb3J0aCBEaXN0cmljdCwgVGFpY2h1bmcgQ2l0eSwgVGFpd2FuIDQwNCIgGh4KFgoUChIJN9XFImY9aTQRoeZ5nsyLv5cSBGEgMTI",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"\u865f10\u6a13",short_name:"\u865f10\u6a13",types:["subpremise"]},{long_name:"301",short_name:"301",types:["street_number"]},{long_name:"\u53f0\u7063\u5927\u9053\u4e09\u6bb5",short_name:"\u53f0\u7063\u5927\u9053\u4e09\u6bb5",types:["route"]},{long_name:"\u60e0\u4f86\u91cc",short_name:"\u60e0\u4f86\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u897f\u5c6f\u5340",short_name:"\u897f\u5c6f\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u53f0\u4e2d\u5e02",short_name:"\u53f0\u4e2d\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"407",short_name:"407",types:["postal_code"]}],formatted_address:"\u865f10\u6a13, No. 301\u53f0\u7063\u5927\u9053\u4e09\u6bb5\u897f\u5c6f\u5340\u53f0\u4e2d\u5e02\u53f0\u7063 407",geometry:{location:{lat:24.1652972,lng:120.6437528},location_type:"ROOFTOP",viewport:{northeast:{lat:24.1667684802915,lng:120.6451820802915},southwest:{lat:24.1640705197085,lng:120.6424841197085}}},place_id:"ChIJQaGZuow9aTQRMMOPbNE6ug4",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"11\u6a13",short_name:"11\u6a13",types:["subpremise"]},{long_name:"726\u865f",short_name:"726\u865f",types:["street_number"]},{long_name:"\u5782\u694a\u8def",short_name:"\u5782\u694a\u8def",types:["route"]},{long_name:"\u6c38\u548c\u91cc",short_name:"\u6c38\u548c\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u897f\u5340",short_name:"\u897f\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u5609\u7fa9\u5e02",short_name:"\u5609\u7fa9\u5e02",types:["administrative_area_level_2","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"600",short_name:"600",types:["postal_code"]}],formatted_address:"600\u53f0\u7063\u5609\u7fa9\u5e02\u897f\u5340\u5782\u694a\u8def726\u865f11\u6a13",geometry:{location:{lat:23.4736912,lng:120.4410656},location_type:"ROOFTOP",viewport:{northeast:{lat:23.4747487802915,lng:120.4424292302915},southwest:{lat:23.4720508197085,lng:120.4397312697085}}},place_id:"ChIJAZg_hCaUbjQR4RdLf40KpVM",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"8 \u6a13",short_name:"8 \u6a13",types:["subpremise"]},{long_name:"\u65b0\u5149 \u4e09\u8d8a \u5e97",short_name:"\u65b0\u5149 \u4e09\u8d8a \u5e97",types:["establishment","point_of_interest"]},{long_name:"123",short_name:"123",types:["street_number"]},{long_name:"\u9ad8\u9435\u8def",short_name:"\u9ad8\u9435\u8def",types:["route"]},{long_name:"\u5de6\u71df",short_name:"\u5de6\u71df",types:["neighborhood","political"]},{long_name:"\u5de6\u71df\u5340",short_name:"\u5de6\u71df\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u9ad8\u96c4\u5e02",short_name:"\u9ad8\u96c4\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"813",short_name:"813",types:["postal_code"]}],formatted_address:"813\u53f0\u7063\u9ad8\u96c4\u5e02\u5de6\u71df\u5340\u9ad8\u9435\u8def123\u865f\u65b0\u5149 \u4e09\u8d8a \u5e978 \u6a13",geometry:{location:{lat:22.6892697,lng:120.3107261},location_type:"ROOFTOP",viewport:{northeast:{lat:22.6905624302915,lng:120.3121490802915},southwest:{lat:22.6878644697085,lng:120.3094511197085}}},place_id:"ChIJj7CFYWUFbjQR3ERGVRErfQc",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"12\u6a13",short_name:"12\u6a13",types:["subpremise"]},{long_name:"162\u865f",short_name:"162\u865f",types:["street_number"]},{long_name:"\u4e2d\u5c71\u8def",short_name:"\u4e2d\u5c71\u8def",types:["route"]},{long_name:"\u516c\u6b63\u91cc",short_name:"\u516c\u6b63\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u4e2d\u897f\u5340",short_name:"\u4e2d\u897f\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u53f0\u5357\u5e02",short_name:"\u53f0\u5357\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"700",short_name:"700",types:["postal_code"]}],formatted_address:"700\u53f0\u7063\u53f0\u5357\u5e02\u4e2d\u897f\u5340\u4e2d\u5c71\u8def162\u865f12\u6a13",geometry:{location:{lat:22.9955137,lng:120.2098312},location_type:"ROOFTOP",viewport:{northeast:{lat:22.9968928802915,lng:120.2111681302915},southwest:{lat:22.9941949197085,lng:120.2084701697085}}},place_id:"ChIJy_gu74t2bjQRMFTOCBbUNRY",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"3 \u6a13",short_name:"3 \u6a13",types:["subpremise"]},{long_name:"1-1",short_name:"1-1",types:["street_number"]},{long_name:"\u4e2d\u5b89\u8def",short_name:"\u4e2d\u5b89\u8def",types:["route"]},{long_name:"\u660e\u6b63\u91cc",short_name:"\u660e\u6b63\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u524d\u93ae\u5340",short_name:"\u524d\u93ae\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u9ad8\u96c4\u5e02",short_name:"\u9ad8\u96c4\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"806",short_name:"806",types:["postal_code"]}],formatted_address:"806\u53f0\u7063\u9ad8\u96c4\u5e02\u524d\u93ae\u5340\u4e2d\u5b89\u8def1-1\u865f3 \u6a13",geometry:{location:{lat:22.5826665,lng:120.3309539},location_type:"ROOFTOP",viewport:{northeast:{lat:22.5839483802915,lng:120.3323499302915},southwest:{lat:22.5812504197085,lng:120.3296519697085}}},place_id:"ChIJK98DHDoDbjQRhWuhqUKTj64",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"B2",short_name:"B2",types:["subpremise"]},{long_name:"57",short_name:"57",types:["street_number"]},{long_name:"\u4e94\u798f\u4e09\u8def",short_name:"\u4e94\u798f\u4e09\u8def",types:["route"]},{long_name:"\u6587\u897f\u91cc",short_name:"\u6587\u897f\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u524d\u91d1\u5340",short_name:"\u524d\u91d1\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u9ad8\u96c4\u5e02",short_name:"\u9ad8\u96c4\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"801",short_name:"801",types:["postal_code"]}],formatted_address:"801\u53f0\u7063\u9ad8\u96c4\u5e02\u524d\u91d1\u5340\u4e94\u798f\u4e09\u8def57\u865fB2",geometry:{location:{lat:22.6216729,lng:120.2983545},location_type:"ROOFTOP",viewport:{northeast:{lat:22.6231134802915,lng:120.2997409802915},southwest:{lat:22.62041551970849,lng:120.2970430197085}}},place_id:"ChIJayDJs4AEbjQROJkX8E3KcYw",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"4\u6a13",short_name:"4\u6a13",types:["subpremise"]},{long_name:"777\u865f",short_name:"777\u865f",types:["street_number"]},{long_name:"\u535a\u611b\u4e8c\u8def",short_name:"\u535a\u611b\u4e8c\u8def",types:["route"]},{long_name:"\u65b0\u4e0b\u91cc",short_name:"\u65b0\u4e0b\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u5de6\u71df\u5340",short_name:"\u5de6\u71df\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u9ad8\u96c4\u5e02",short_name:"\u9ad8\u96c4\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"813",short_name:"813",types:["postal_code"]}],formatted_address:"813\u53f0\u7063\u9ad8\u96c4\u5e02\u5de6\u71df\u5340\u535a\u611b\u4e8c\u8def777\u865f4\u6a13",geometry:{location:{lat:22.6697561,lng:120.3025183},location_type:"ROOFTOP",viewport:{northeast:{lat:22.67108343029151,lng:120.3042678302915},southwest:{lat:22.6683854697085,lng:120.3015698697085}}},place_id:"ChIJd2ZFrwgFbjQR4TYlbvSOud4",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"357-1",short_name:"357-1",types:["street_number"]},{long_name:"\u660e\u8aa0\u4e8c\u8def",short_name:"\u660e\u8aa0\u4e8c\u8def",types:["route"]},{long_name:"\u65b0\u4e0a\u91cc",short_name:"\u65b0\u4e0a\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u5de6\u71df\u5340",short_name:"\u5de6\u71df\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u9ad8\u96c4\u5e02",short_name:"\u9ad8\u96c4\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"813",short_name:"813",types:["postal_code"]}],formatted_address:"813\u53f0\u7063\u9ad8\u96c4\u5e02\u5de6\u71df\u5340\u660e\u8aa0\u4e8c\u8def357-1\u865f",geometry:{location:{lat:22.6608957,lng:120.3082233},location_type:"ROOFTOP",viewport:{northeast:{lat:22.6622734802915,lng:120.3095732302915},southwest:{lat:22.65957551970849,lng:120.3068752697085}}},place_id:"ChIJSz2BOgMFbjQR--40AoawP2Y",plus_code:{compound_code:"M865+97 \u53f0\u7063\u9ad8\u96c4\u5e02\u5de6\u71df\u5340",global_code:"7QJ2M865+97"},types:["street_address"]}],status:"OK"},{results:[{address_components:[{long_name:"\u6a13C\u5340",short_name:"\u6a13C\u5340",types:["subpremise"]},{long_name:"12\u865f2",short_name:"12\u865f2",types:["street_number"]},{long_name:"\u5b78\u57ce\u8def\u4e00\u6bb5",short_name:"\u5b78\u57ce\u8def\u4e00\u6bb5",types:["route"]},{long_name:"\u4e09\u548c\u91cc",short_name:"\u4e09\u548c\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u5927\u6a39\u5340",short_name:"\u5927\u6a39\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u9ad8\u96c4\u5e02",short_name:"\u9ad8\u96c4\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"840",short_name:"840",types:["postal_code"]}],formatted_address:"840\u53f0\u7063\u9ad8\u96c4\u5e02\u5927\u6a39\u5340\u5b78\u57ce\u8def\u4e00\u6bb512\u865f2\u865f\u6a13C\u5340",geometry:{location:{lat:22.7302634,lng:120.4026345},location_type:"ROOFTOP",viewport:{northeast:{lat:22.7314735302915,lng:120.4039436302915},southwest:{lat:22.7287755697085,lng:120.4012456697085}}},partial_match:!0,place_id:"ChIJ5XmnahsRbjQRFJaDixGGbhI",types:["subpremise"]},{address_components:[{long_name:"\u6a13C\u5340",short_name:"\u6a13C\u5340",types:["subpremise"]},{long_name:"12\u865f",short_name:"12\u865f",types:["street_number"]},{long_name:"\u5b78\u57ce\u8def\u4e00\u6bb5",short_name:"\u5b78\u57ce\u8def\u4e00\u6bb5",types:["route"]},{long_name:"\u4e09\u548c\u91cc",short_name:"\u4e09\u548c\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u5927\u6a39\u5340",short_name:"\u5927\u6a39\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u9ad8\u96c4\u5e02",short_name:"\u9ad8\u96c4\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"840",short_name:"840",types:["postal_code"]}],formatted_address:"840\u53f0\u7063\u9ad8\u96c4\u5e02\u5927\u6a39\u5340\u5b78\u57ce\u8def\u4e00\u6bb512\u865f\u6a13C\u5340",geometry:{location:{lat:22.7303876,lng:120.402402},location_type:"ROOFTOP",viewport:{northeast:{lat:22.7318271802915,lng:120.4037823802915},southwest:{lat:22.7291292197085,lng:120.4010844197085}}},partial_match:!0,place_id:"ChIJZaFkPxsRbjQRL0SWIIS9FlU",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"\u865fB3",short_name:"\u865fB3",types:["subpremise"]},{long_name:"266-1",short_name:"266-1",types:["street_number"]},{long_name:"\u6210\u529f\u4e00\u8def",short_name:"\u6210\u529f\u4e00\u8def",types:["route"]},{long_name:"\u69ae\u5fa9\u91cc",short_name:"\u69ae\u5fa9\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u524d\u91d1\u5340",short_name:"\u524d\u91d1\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u9ad8\u96c4\u5e02",short_name:"\u9ad8\u96c4\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"801",short_name:"801",types:["postal_code"]}],formatted_address:"801\u53f0\u7063\u9ad8\u96c4\u5e02\u524d\u91d1\u5340\u6210\u529f\u4e00\u8def266-1\u865f\u865fB3",geometry:{location:{lat:22.6193366,lng:120.2960446},location_type:"ROOFTOP",viewport:{northeast:{lat:22.6206276302915,lng:120.2972305302915},southwest:{lat:22.6179296697085,lng:120.2945325697085}}},place_id:"ChIJn1bpyX8EbjQRjPTucqfxrT0",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"12F",short_name:"12F",types:["subpremise"]},{long_name:"21",short_name:"21",types:["street_number"]},{long_name:"\u4e09\u591a\u56db\u8def",short_name:"\u4e09\u591a\u56db\u8def",types:["route"]},{long_name:"\u610f\u8aa0\u91cc",short_name:"\u610f\u8aa0\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u82d3\u96c5\u5340",short_name:"\u82d3\u96c5\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u9ad8\u96c4\u5e02",short_name:"\u9ad8\u96c4\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"802",short_name:"802",types:["postal_code"]}],formatted_address:"802\u53f0\u7063\u9ad8\u96c4\u5e02\u82d3\u96c5\u5340\u4e09\u591a\u56db\u8def21\u865f12F",geometry:{location:{lat:22.6130987,lng:120.3039755},location_type:"ROOFTOP",viewport:{northeast:{lat:22.6147378302915,lng:120.3052102302915},southwest:{lat:22.6120398697085,lng:120.3025122697085}}},place_id:"ChIJIQgOzn0DbjQREnocZVmjFAY",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"6\u6a13",short_name:"6\u6a13",types:["subpremise"]},{long_name:"658\u865f",short_name:"658\u865f",types:["street_number"]},{long_name:"\u897f\u9580\u8def\u4e00\u6bb5",short_name:"\u897f\u9580\u8def\u4e00\u6bb5",types:["route"]},{long_name:"\u5c0f\u897f\u91cc",short_name:"\u5c0f\u897f\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u4e2d\u897f\u5340",short_name:"\u4e2d\u897f\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u53f0\u5357\u5e02",short_name:"\u53f0\u5357\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"700",short_name:"700",types:["postal_code"]}],formatted_address:"700\u53f0\u7063\u53f0\u5357\u5e02\u4e2d\u897f\u5340\u897f\u9580\u8def\u4e00\u6bb5658\u865f6\u6a13",geometry:{location:{lat:22.9868032,lng:120.1982502},location_type:"ROOFTOP",viewport:{northeast:{lat:22.9881409802915,lng:120.1992674302915},southwest:{lat:22.9854430197085,lng:120.1965694697085}}},place_id:"ChIJK0Cg5nt2bjQRcJQMKdQNQHc",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"B1\u6a13",short_name:"B1\u6a13",types:["subpremise"]},{long_name:"789\u865f",short_name:"789\u865f",types:["street_number"]},{long_name:"\u4e2d\u83ef\u4e94\u8def",short_name:"\u4e2d\u83ef\u4e94\u8def",types:["route"]},{long_name:"\u8208\u90a6\u91cc",short_name:"\u8208\u90a6\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u524d\u93ae\u5340",short_name:"\u524d\u93ae\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u9ad8\u96c4\u5e02",short_name:"\u9ad8\u96c4\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"806",short_name:"806",types:["postal_code"]}],formatted_address:"806\u53f0\u7063\u9ad8\u96c4\u5e02\u524d\u93ae\u5340\u4e2d\u83ef\u4e94\u8def789\u865fB1\u6a13",geometry:{location:{lat:22.5953346,lng:120.3069499},location_type:"ROOFTOP",viewport:{northeast:{lat:22.5966835802915,lng:120.3082988802915},southwest:{lat:22.59398561970849,lng:120.3056009197085}}},place_id:"ChIJ2fzV73IDbjQRcIZ3ml7rlbI",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"12\u6a13",short_name:"12\u6a13",types:["subpremise"]},{long_name:"213\u865f",short_name:"213\u865f",types:["street_number"]},{long_name:"\u4e09\u591a\u4e09\u8def",short_name:"\u4e09\u591a\u4e09\u8def",types:["route"]},{long_name:"\u76db\u8208\u91cc",short_name:"\u76db\u8208\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u524d\u93ae\u5340",short_name:"\u524d\u93ae\u5340",types:["administrative_area_level_3","political"]},{long_name:"\u9ad8\u96c4\u5e02",short_name:"\u9ad8\u96c4\u5e02",types:["administrative_area_level_1","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"806",short_name:"806",types:["postal_code"]}],formatted_address:"806\u53f0\u7063\u9ad8\u96c4\u5e02\u524d\u93ae\u5340\u4e09\u591a\u4e09\u8def213\u865f12\u6a13",geometry:{location:{lat:22.6144461,lng:120.3067782},location_type:"ROOFTOP",viewport:{northeast:{lat:22.6159041302915,lng:120.3080845302915},southwest:{lat:22.6132061697085,lng:120.3053865697085}}},place_id:"ChIJKZtNe30DbjQRds0VhXXSZSk",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"2F",short_name:"2F",types:["subpremise"]},{long_name:"80\u865f",short_name:"80\u865f",types:["street_number"]},{long_name:"\u4e2d\u83ef\u8def",short_name:"\u4e2d\u83ef\u8def",types:["route"]},{long_name:"\u8208\u6a02\u91cc",short_name:"\u8208\u6a02\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u5c4f\u6771\u5e02",short_name:"\u5c4f\u6771\u5e02",types:["administrative_area_level_3","political"]},{long_name:"\u5c4f\u6771\u7e23",short_name:"\u5c4f\u6771\u7e23",types:["administrative_area_level_2","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"900",short_name:"900",types:["postal_code"]}],formatted_address:"900\u53f0\u7063\u5c4f\u6771\u7e23\u5c4f\u6771\u5e02\u4e2d\u83ef\u8def80\u865f2F",geometry:{location:{lat:22.6740893,lng:120.4906227},location_type:"ROOFTOP",viewport:{northeast:{lat:22.67544438029151,lng:120.4919506302915},southwest:{lat:22.6727464197085,lng:120.4892526697085}}},place_id:"ChIJWzwl35oXbjQRP1wrGZlUPtI",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"4\u6a13",short_name:"4\u6a13",types:["subpremise"]},{long_name:"38\u5df76\u865f",short_name:"38\u5df76\u865f",types:["street_number"]},{long_name:"\u6c11\u6b0a\u8def\u4e8c\u6bb5",short_name:"\u6c11\u6b0a\u8def\u4e8c\u6bb5",types:["route"]},{long_name:"\u5357\u9580\u91cc",short_name:"\u5357\u9580\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u5b9c\u862d\u5e02",short_name:"\u5b9c\u862d\u5e02",types:["administrative_area_level_3","political"]},{long_name:"\u5b9c\u862d\u7e23",short_name:"\u5b9c\u862d\u7e23",types:["administrative_area_level_2","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"260",short_name:"260",types:["postal_code"]}],formatted_address:"260\u53f0\u7063\u5b9c\u862d\u7e23\u5b9c\u862d\u5e02\u6c11\u6b0a\u8def\u4e8c\u6bb538\u5df76\u865f4\u6a13",geometry:{location:{lat:24.7540596,lng:121.7505349},location_type:"ROOFTOP",viewport:{northeast:{lat:24.75510498029151,lng:121.7517642802915},southwest:{lat:24.7524070197085,lng:121.7490663197085}}},place_id:"ChIJZdiBhMPkZzQRVCbFfxAV9sE",types:["subpremise"]}],status:"OK"},{results:[{address_components:[{long_name:"4\u6a13",short_name:"4\u6a13",types:["subpremise"]},{long_name:"38\u5df76\u865f",short_name:"38\u5df76\u865f",types:["street_number"]},{long_name:"\u6c11\u6b0a\u8def\u4e8c\u6bb5",short_name:"\u6c11\u6b0a\u8def\u4e8c\u6bb5",types:["route"]},{long_name:"\u5357\u9580\u91cc",short_name:"\u5357\u9580\u91cc",types:["administrative_area_level_4","political"]},{long_name:"\u5b9c\u862d\u5e02",short_name:"\u5b9c\u862d\u5e02",types:["administrative_area_level_3","political"]},{long_name:"\u5b9c\u862d\u7e23",short_name:"\u5b9c\u862d\u7e23",types:["administrative_area_level_2","political"]},{long_name:"\u53f0\u7063",short_name:"TW",types:["country","political"]},{long_name:"260",short_name:"260",types:["postal_code"]}],formatted_address:"260\u53f0\u7063\u5b9c\u862d\u7e23\u5b9c\u862d\u5e02\u6c11\u6b0a\u8def\u4e8c\u6bb538\u5df76\u865f4\u6a13",geometry:{location:{lat:23.7540596,lng:121.7505349},location_type:"ROOFTOP",viewport:{northeast:{lat:24.75510498029151,lng:121.7517642802915},southwest:{lat:24.7524070197085,lng:121.7490663197085}}},place_id:"ChIJZdiBhMPkZzQRVCbFfxAV9sE",types:["subpremise"]}],status:"OK"}][s],pointData:r}))),this.convertAddressToRawGeoencoding=sn(i=>{let r=i.map(o=>{const a=encodeURIComponent(o.address);return this.getGeoLonLat(a,o)});return On(this.groupRequest(r)).pipe(Ns(o=>nP(o)))}),this.groupRequest=i=>{const r=[];for(let s=0;s<i.length;s+=10){const l=new Array(10).fill(s).map((c,u)=>i[c+u]).filter(c=>Boolean(c));r.push(l)}return r},this.getGeoLonLat=(i,r)=>this.httpClient.get(`https://maps.googleapis.com/maps/api/geocode/json?address=${i}&key=AIzaSyAAQr-IWEpmXbcOk3trYWMMcasLuIBZ280`).pipe(tt(s=>(console.log(JSON.stringify(s)),{geoencodingRaw:s,pointData:r}))),this.convertGeoencodingToLonLat=tt(i=>i.map(r=>{const s=r.geoencodingRaw.results[0].geometry.location;return{lonLat:new j(s.lng,s.lat),pinData:r.pointData}}))}}return n.\u0275fac=function(t){return new(t||n)(pe(Ed))},n.\u0275prov=Ne({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Fh=(()=>{class n{constructor(t,i){var r=this;this.httpClient=t,this.pointLocationsService=i,this.mockOptions={cameraPosition:{x:10,y:20,z:0},colors:{mainColor:"#ff00ff"},connectMode:"triangle",connectedPoints:[1,2,4],focusOnPoint:{x:-10,y:0,z:0},meshSettings:{columns:{defaultColumn:{opacity:.1,color:"#528bff",heightScale:1,scale:.5},hoveredColumn:{opacity:.1,color:"#528bff"},selectedColumn:{opacity:.1,color:"#528bff"}},ground:{color:"#528bff",opacity:.5},polygon:{color:"#528bff",opacity:.8},outline:{color:"#ffffff",opacity:.02}},radius:2},this.mockSetting={deleted:!0,valid:!0,options:this.mockOptions,tableCreateDate:"2022/05/08",tableCreator:"Umas",tableName:"2022 Q2\u5229\u6f64",tableSource:"1dS8M_sBKtwwpXg6iWe3poICrJ2_39e1F0Av9mVm6rS4"},this.initFirebase=()=>{const s=function r7(n,e={}){"object"!=typeof e&&(e={name:e});const t=Object.assign({name:iw,automaticDataCollectionEnabled:!1},e),i=t.name;if("string"!=typeof i||!i)throw go.create("bad-app-name",{appName:String(i)});const r=ga.get(i);if(r){if(J0(n,r.options)&&J0(t,r.config))return r;throw go.create("duplicate-app",{appName:i})}const s=new x9(i);for(const a of Gp.values())s.addComponent(a);const o=new n7(n,t,s);return ga.set(i,o),o}(this.firebaseConfig);return function Iq(n=function s7(n=iw){const e=ga.get(n);if(!e)throw go.create("no-app",{appName:n});return e}(),e){return function ZI(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}(n,"database").getImmediate({identifier:e})}(s)},this.addCategory=s=>{const a=yb(Ta(this.dataBase,"/pointTables"));return ih(a,s),a.key},this.addCategoryOptions=function(){var s=Je(function*(o){const a=Ta(r.dataBase,"/mapOptions"),l=yield yb(a);return yield ih(l,o),l.key});return function(o){return s.apply(this,arguments)}}(),this.getCategorySettings=()=>{const s=Ta(this.dataBase,"/pointTables");return new en(o=>{vb(s,a=>{const l=a.val();o.next(l)})})},this.deleteCategorySetting=s=>{ih(Ta(this.dataBase,`/pointTables/${s}`),{})},this.getCategorySetting=s=>{const o=Ta(this.dataBase,`/pointTables/${s}`);return new en(a=>{vb(o,l=>{const c=l.val();a.next(c)})})},this.getMockCategorySetting=s=>Be({deleted:!0,valid:!0,options:{cameraPosition:{x:10,y:20,z:0},colors:{mainColor:"#ff00ff"},meshSettings:{columns:{defaultColumn:{opacity:.1,color:"#528bff",heightScale:.1,scale:.5},hoveredColumn:{opacity:1,color:"#d2abff"},selectedColumn:{opacity:1,color:"#528bff"}},polygon:{opacity:.6,color:"#528bff"},ground:{color:"#528bff",opacity:.5},outline:{color:"#ffffff",opacity:.02}},connectMode:"triangle",connectedPoints:[1,2,4],focusOnPoint:{x:-10,y:0,z:0},radius:2},tableCreateDate:"2022/04/12",tableCreator:"Umas",tableName:"\u5e97\u71df\u696d\u984d",tableSource:"1ER4MhRBniLOaNZ8_vkgv92Egp410nf-z-CkN9KO1LGg"}),this.getCategoryTable=s=>this.httpClient.get(`https://docs.google.com/spreadsheets/d/${s}/gviz/tq?`,{responseType:"text"}).pipe(this.convertGoogleSheetToAddress),this.getSheetIdFromUrl=s=>{const o=s.match(/(?<=\/d\/).+(?=\/)/g);if(o&&o[0])return o[0];throw new Error("No id found")},this.getCategoryTableByUrl=s=>this.httpClient.get(s,{responseType:"text"}).pipe(tt(a=>200),Ps(a=>(console.log(a.status),Be(a.status)))),this.convertGoogleSheetToAddress=tt(s=>{s=this.pointLocationsService.removeExtraText(s);const l=JSON.parse(s).table.rows.filter((u,d)=>{var h;return"\u843d\u9ede\u540d\u7a31"!==(null===(h=u.c[0])||void 0===h?void 0:h.v)});return this.formatingPointDimensionData(l)}),this.formatingPointDimensionData=s=>s.map((o,a)=>{let l="",c="";return o.c&&(l=o.c[0].v,c=o.c[1].v),{id:a,title:l,value:c}}),this.writeUserData=()=>{yb(Ta(this.dataBase,"/pointTables"),{tableName:"tableName",tableCreator:"tableCreator",tableCreateDate:"tableCreateDate",tableSource:"url",deleted:!0,options:{colors:{mainColor:"#ff00ff"},radius:2,columnHeight:1.5,focusOnPoint:{x:0,y:0,z:0},cameraPosition:{x:0,y:0,z:0},connectMode:"triangle",connectedPoints:[1,2,4]}})},this.getTableFromSettings=function(){var s=Je(function*(o){if(!o)throw new Error("No firebase category found by the route of this page");const l=r.getCategoryTable(o.tableSource);return yield ts(l)});return function(o){return s.apply(this,arguments)}}(),this.firebaseConfig=tP_firebaseConfig,this.dataBase=this.initFirebase()}}return n.\u0275fac=function(t){return new(t||n)(pe(Ed),pe(nL))},n.\u0275prov=Ne({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Ks=(()=>{class n{constructor(){this.onMouseIntersect=new Gn([]),this.onCanvasIntersect=new Gn([]),this.mouseRaycaster=new GN,this.cavasCenterRaycaster=new GN,this.intersectedObjs=[],this.isPaused=!1,this.isNeedImageData=!1,this.imageUrl=new Gn(""),this.getCavasImage=()=>(this.isNeedImageData=!0,this.imageUrl.pipe(ho(t=>Boolean(t)))),this.animate=(t=36e3)=>{if(this.renderer&&this.scene&&this.camera&&this.orbitControl&&this.mouse&&!(this.renderer.info.render.frame>t)&&!this.isPaused){if(this.mouseRaycaster.setFromCamera(this.mouse,this.camera),this.cavasCenterRaycaster.setFromCamera(new j(0,0),this.camera),requestAnimationFrame(()=>{this.animate(),this.renderer&&this.onFrameRender.next({renderer:this.renderer,raycaster:this.mouseRaycaster})}),this.renderer.render(this.scene,this.camera),1==this.isNeedImageData){const i=this.renderer.domElement.toDataURL();console.log(i),this.imageUrl.next(i),this.isNeedImageData=!1}this.onIntersections()}},this.pauseAnimation=()=>this.isPaused=!0,this.resumeAnimation=()=>{this.isPaused=!1,this.animate()},this.onIntersections=()=>{const t=this.mouseRaycaster.intersectObjects(this.intersectedObjs);this.onMouseIntersect.next(t);const i=this.cavasCenterRaycaster.intersectObjects(this.intersectedObjs);this.onCanvasIntersect.next(i)},this.initAnimate=(t,i,r,s,o)=>{this.onFrameRender=new Gn({renderer:t,raycaster:this.mouseRaycaster}),this.renderer=t,this.scene=i,this.camera=r,this.orbitControl=s,this.mouse=o},this.passIntersetObject=t=>{this.intersectedObjs.push(...t)},this.removeIntersetObject=t=>{this.intersectedObjs=this.intersectedObjs.filter(i=>!i.name.includes(t))},this.getCanvasCenter=()=>{var t;return null===(t=this.onCanvasIntersect.value[0])||void 0===t?void 0:t.point}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ne({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),iL=(()=>{class n{constructor(t,i){this._renderer=t,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}}return n.\u0275fac=function(t){return new(t||n)($(Ss),$(Wi))},n.\u0275dir=Ge({type:n}),n})(),Ja=(()=>{class n extends iL{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=ii(n)))(i||n)}}(),n.\u0275dir=Ge({type:n,features:[Ot]}),n})();const ds=new lt("NgValueAccessor"),Nee={provide:ds,useExisting:Yt(()=>Ka),multi:!0},Oee=new lt("CompositionEventMode");let Ka=(()=>{class n extends iL{constructor(t,i,r){super(t,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function Lee(){const n=Jr()?Jr().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",null==t?"":t)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return n.\u0275fac=function(t){return new(t||n)($(Ss),$(Wi),$(Oee,8))},n.\u0275dir=Ge({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,i){1&t&&Ee("input",function(s){return i._handleInput(s.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(s){return i._compositionEnd(s.target.value)})},features:[an([Nee]),Ot]}),n})();function qo(n){return null==n||0===n.length}const ci=new lt("NgValidators"),Yo=new lt("NgAsyncValidators");function lL(n){return qo(n.value)?{required:!0}:null}function Qg(n){return null}function pL(n){return null!=n}function mL(n){const e=$u(n)?On(n):n;return rv(e),e}function gL(n){let e={};return n.forEach(t=>{e=null!=t?Object.assign(Object.assign({},e),t):e}),0===Object.keys(e).length?null:e}function _L(n,e){return e.map(t=>t(n))}function yL(n){return n.map(e=>function kee(n){return!n.validate}(e)?e:t=>e.validate(t))}function Xx(n){return null!=n?function vL(n){if(!n)return null;const e=n.filter(pL);return 0==e.length?null:function(t){return gL(_L(t,e))}}(yL(n)):null}function Qx(n){return null!=n?function wL(n){if(!n)return null;const e=n.filter(pL);return 0==e.length?null:function(t){return nP(_L(t,e).map(mL)).pipe(tt(gL))}}(yL(n)):null}function bL(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function Jx(n){return n?Array.isArray(n)?n:[n]:[]}function Jg(n,e){return Array.isArray(n)?n.includes(e):n===e}function ML(n,e){const t=Jx(e);return Jx(n).forEach(r=>{Jg(t,r)||t.push(r)}),t}function SL(n,e){return Jx(e).filter(t=>!Jg(n,t))}class EL{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Xx(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Qx(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class Xo extends EL{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class bi extends EL{get formDirective(){return null}get path(){return null}}class TL{constructor(e){this._cd=e}is(e){var t,i,r;return"submitted"===e?!!(null===(t=this._cd)||void 0===t?void 0:t.submitted):!!(null===(r=null===(i=this._cd)||void 0===i?void 0:i.control)||void 0===r?void 0:r[e])}}let kh=(()=>{class n extends TL{constructor(t){super(t)}}return n.\u0275fac=function(t){return new(t||n)($(Xo,2))},n.\u0275dir=Ge({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,i){2&t&&Hf("ng-untouched",i.is("untouched"))("ng-touched",i.is("touched"))("ng-pristine",i.is("pristine"))("ng-dirty",i.is("dirty"))("ng-valid",i.is("valid"))("ng-invalid",i.is("invalid"))("ng-pending",i.is("pending"))},features:[Ot]}),n})(),Kx=(()=>{class n extends TL{constructor(t){super(t)}}return n.\u0275fac=function(t){return new(t||n)($(bi,10))},n.\u0275dir=Ge({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(t,i){2&t&&Hf("ng-untouched",i.is("untouched"))("ng-touched",i.is("touched"))("ng-pristine",i.is("pristine"))("ng-dirty",i.is("dirty"))("ng-valid",i.is("valid"))("ng-invalid",i.is("invalid"))("ng-pending",i.is("pending"))("ng-submitted",i.is("submitted"))},features:[Ot]}),n})();function Bh(n,e){tC(n,e),e.valueAccessor.writeValue(n.value),function jee(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&AL(n,e)})}(n,e),function qee(n,e){const t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function $ee(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&AL(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function Wee(n,e){if(e.valueAccessor.setDisabledState){const t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function t_(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function tC(n,e){const t=function xL(n){return n._rawValidators}(n);null!==e.validator?n.setValidators(bL(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const i=function CL(n){return n._rawAsyncValidators}(n);null!==e.asyncValidator?n.setAsyncValidators(bL(i,e.asyncValidator)):"function"==typeof i&&n.setAsyncValidators([i]);const r=()=>n.updateValueAndValidity();t_(e._rawValidators,r),t_(e._rawAsyncValidators,r)}function AL(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function rC(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const Vh="VALID",i_="INVALID",au="PENDING",Uh="DISABLED";function oC(n){return(r_(n)?n.validators:n)||null}function NL(n){return Array.isArray(n)?Xx(n):n||null}function aC(n,e){return(r_(e)?e.asyncValidators:n)||null}function LL(n){return Array.isArray(n)?Qx(n):n||null}function r_(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}const lC=n=>n instanceof uC;function FL(n){return(n=>n instanceof VL)(n)?n.value:n.getRawValue()}function kL(n,e){const t=lC(n),i=n.controls;if(!(t?Object.keys(i):i).length)throw new Ct(1e3,"");if(!i[e])throw new Ct(1001,"")}function BL(n,e){lC(n),n._forEachChild((i,r)=>{if(void 0===e[r])throw new Ct(1002,"")})}class cC{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=e,this._rawAsyncValidators=t,this._composedValidatorFn=NL(this._rawValidators),this._composedAsyncValidatorFn=LL(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Vh}get invalid(){return this.status===i_}get pending(){return this.status==au}get disabled(){return this.status===Uh}get enabled(){return this.status!==Uh}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._rawValidators=e,this._composedValidatorFn=NL(e)}setAsyncValidators(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=LL(e)}addValidators(e){this.setValidators(ML(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(ML(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(SL(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(SL(e,this._rawAsyncValidators))}hasValidator(e){return Jg(this._rawValidators,e)}hasAsyncValidator(e){return Jg(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=au,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=Uh,this.errors=null,this._forEachChild(i=>{i.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=Vh,this._forEachChild(i=>{i.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Vh||this.status===au)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Uh:Vh}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=au,this._hasOwnPendingAsyncValidator=!0;const t=mL(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){return function Jee(n,e,t){if(null==e||(Array.isArray(e)||(e=e.split(t)),Array.isArray(e)&&0===e.length))return null;let i=n;return e.forEach(r=>{i=lC(i)?i.controls.hasOwnProperty(r)?i.controls[r]:null:(n=>n instanceof Zee)(i)&&i.at(r)||null}),i}(this,e,".")}getError(e,t){const i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new pt,this.statusChanges=new pt}_calculateStatus(){return this._allControlsDisabled()?Uh:this.errors?i_:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(au)?au:this._anyControlsHaveStatus(i_)?i_:Vh}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_isBoxedValue(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){r_(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class VL extends cC{constructor(e=null,t,i){super(oC(t),aC(i,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),r_(t)&&t.initialValueIsDefault&&(this.defaultValue=this._isBoxedValue(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){rC(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){rC(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}class uC extends cC{constructor(e,t,i){super(oC(t),aC(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,i={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){BL(this,e),Object.keys(e).forEach(i=>{kL(this,i),this.controls[i].setValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(i=>{this.controls[i]&&this.controls[i].patchValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((i,r)=>{i.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,i)=>(e[i]=FL(t),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,i)=>!!i._syncPendingControls()||t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const i=this.controls[t];i&&e(i,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const t of Object.keys(this.controls)){const i=this.controls[t];if(this.contains(t)&&e(i))return!0}return!1}_reduceValue(){return this._reduceChildren({},(e,t,i)=>((t.enabled||this.disabled)&&(e[i]=t.value),e))}_reduceChildren(e,t){let i=e;return this._forEachChild((r,s)=>{i=t(i,r,s)}),i}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}}class Zee extends cC{constructor(e,t,i){super(oC(t),aC(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[e]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,i={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){BL(this,e),e.forEach((i,r)=>{kL(this,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(e.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((i,r)=>{i.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>FL(e))}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_syncPendingControls(){let e=this.controls.reduce((t,i)=>!!i._syncPendingControls()||t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,i)=>{e(t,i)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}}const ete={provide:bi,useExisting:Yt(()=>zh)},Hh=(()=>Promise.resolve(null))();let zh=(()=>{class n extends bi{constructor(t,i){super(),this.submitted=!1,this._directives=new Set,this.ngSubmit=new pt,this.form=new uC({},Xx(t),Qx(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){Hh.then(()=>{const i=this._findContainer(t.path);t.control=i.registerControl(t.name,t.control),Bh(t.control,t),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){Hh.then(()=>{const i=this._findContainer(t.path);i&&i.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){Hh.then(()=>{const i=this._findContainer(t.path),r=new uC({});(function IL(n,e){tC(n,e)})(r,t),i.registerControl(t.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){Hh.then(()=>{const i=this._findContainer(t.path);i&&i.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,i){Hh.then(()=>{this.form.get(t.path).setValue(i)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submitted=!0,function PL(n,e){n._syncPendingControls(),e.forEach(t=>{const i=t.control;"submit"===i.updateOn&&i._pendingChange&&(t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}(this.form,this._directives),this.ngSubmit.emit(t),!1}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}}return n.\u0275fac=function(t){return new(t||n)($(ci,10),$(Yo,10))},n.\u0275dir=Ge({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(t,i){1&t&&Ee("submit",function(s){return i.onSubmit(s)})("reset",function(){return i.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[an([ete]),Ot]}),n})();const nte={provide:Xo,useExisting:Yt(()=>lu)},zL=(()=>Promise.resolve(null))();let lu=(()=>{class n extends Xo{constructor(t,i,r,s,o){super(),this._changeDetectorRef=o,this.control=new VL,this._registered=!1,this.update=new pt,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function iC(n,e){if(!e)return null;let t,i,r;return Array.isArray(e),e.forEach(s=>{s.constructor===Ka?t=s:function Qee(n){return Object.getPrototypeOf(n.constructor)===Ja}(s)?i=s:r=s}),r||i||t||null}(0,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),function nC(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Bh(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){zL.then(()=>{var i;this.control.setValue(t,{emitViewToModelChange:!1}),null===(i=this._changeDetectorRef)||void 0===i||i.markForCheck()})}_updateDisabled(t){const i=t.isDisabled.currentValue,r=""===i||i&&"false"!==i;zL.then(()=>{var s;r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),null===(s=this._changeDetectorRef)||void 0===s||s.markForCheck()})}_getPath(t){return this._parent?function Zg(n,e){return[...e.path,n]}(t,this._parent):[t]}}return n.\u0275fac=function(t){return new(t||n)($(bi,9),$(ci,10),$(Yo,10),$(ds,10),$(tp,8))},n.\u0275dir=Ge({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[an([nte]),Ot,nr]}),n})(),dC=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=Ge({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),n})();const rte={provide:ds,useExisting:Yt(()=>hC),multi:!0};let WL=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Zi({type:n}),n.\u0275inj=ki({}),n})(),ste=(()=>{class n{constructor(){this._accessors=[]}add(t,i){this._accessors.push([t,i])}remove(t){for(let i=this._accessors.length-1;i>=0;--i)if(this._accessors[i][1]===t)return void this._accessors.splice(i,1)}select(t){this._accessors.forEach(i=>{this._isSameGroup(i,t)&&i[1]!==t&&i[1].fireUncheck(t.value)})}_isSameGroup(t,i){return!!t[0].control&&t[0]._parent===i._control._parent&&t[1].name===i.name}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ne({token:n,factory:n.\u0275fac,providedIn:WL}),n})(),hC=(()=>{class n extends Ja{constructor(t,i,r,s){super(t,i),this._registry=r,this._injector=s,this.onChange=()=>{}}ngOnInit(){this._control=this._injector.get(Xo),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(t){this._state=t===this.value,this.setProperty("checked",this._state)}registerOnChange(t){this._fn=t,this.onChange=()=>{t(this.value),this._registry.select(this)}}fireUncheck(t){this.writeValue(t)}_checkName(){!this.name&&this.formControlName&&(this.name=this.formControlName)}}return n.\u0275fac=function(t){return new(t||n)($(Ss),$(Wi),$(ste),$(si))},n.\u0275dir=Ge({type:n,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(t,i){1&t&&Ee("change",function(){return i.onChange()})("blur",function(){return i.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[an([rte]),Ot]}),n})();const ote={provide:ds,useExisting:Yt(()=>fC),multi:!0};let fC=(()=>{class n extends Ja{writeValue(t){this.setProperty("value",parseFloat(t))}registerOnChange(t){this.onChange=i=>{t(""==i?null:parseFloat(i))}}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=ii(n)))(i||n)}}(),n.\u0275dir=Ge({type:n,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(t,i){1&t&&Ee("change",function(s){return i.onChange(s.target.value)})("input",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},features:[an([ote]),Ot]}),n})(),Za=(()=>{class n{constructor(){this._validator=Qg}ngOnChanges(t){if(this.inputName in t){const i=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):Qg,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return null!=t}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=Ge({type:n,features:[nr]}),n})();const bte={provide:ci,useExisting:Yt(()=>Gh),multi:!0};let Gh=(()=>{class n extends Za{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=t=>function yte(n){return null!=n&&!1!==n&&"false"!=`${n}`}(t),this.createValidator=t=>lL}enabled(t){return t}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=ii(n)))(i||n)}}(),n.\u0275dir=Ge({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(t,i){2&t&&qr("required",i._enabled?"":null)},inputs:{required:"required"},features:[an([bte]),Ot]}),n})();const Ete={provide:ci,useExisting:Yt(()=>vC),multi:!0};let vC=(()=>{class n extends Za{constructor(){super(...arguments),this.inputName="pattern",this.normalizeInput=t=>t,this.createValidator=t=>function fL(n){if(!n)return Qg;let e,t;return"string"==typeof n?(t="","^"!==n.charAt(0)&&(t+="^"),t+=n,"$"!==n.charAt(n.length-1)&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),i=>{if(qo(i.value))return null;const r=i.value;return e.test(r)?null:{pattern:{requiredPattern:t,actualValue:r}}}}(t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=ii(n)))(i||n)}}(),n.\u0275dir=Ge({type:n,selectors:[["","pattern","","formControlName",""],["","pattern","","formControl",""],["","pattern","","ngModel",""]],hostVars:1,hostBindings:function(t,i){2&t&&qr("pattern",i._enabled?i.pattern:null)},inputs:{pattern:"pattern"},features:[an([Ete]),Ot]}),n})(),Tte=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Zi({type:n}),n.\u0275inj=ki({imports:[[WL]]}),n})(),Dte=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Zi({type:n}),n.\u0275inj=ki({imports:[Tte]}),n})();function Ate(n,e){1&n&&ct(0,"img",16),2&n&&ne("src","./assets/icons/cross-"+Re().themeColor+".svg",xs)}function Ite(n,e){1&n&&ct(0,"img",16),2&n&&ne("src","./assets/icons/chevron-left-"+Re().themeColor+".svg",xs)}function Rte(n,e){1&n&&(V(0,"p"),Me(1,"\u6b64\u70ba\u5fc5\u586b"),Y())}function Pte(n,e){1&n&&ct(0,"img",17),2&n&&ne("src","./assets/icons/chevron-right-"+Re().themeColor+".svg",xs)}function Nte(n,e){1&n&&ct(0,"img",18)}const Lte=function(n){return{"background-image":n}},Ote=function(n,e,t){return[n,e,t]};let sO=(()=>{class n{constructor(t){this.animateService=t,this.blurSource="",this.nameString="",this.title="\u8cc7\u6599\u8868\u540d\u7a31",this.placeholder="ex. \u5404\u5206\u5e97\u71df\u696d\u984d",this.backButtonType="arrow",this.themeColor="primary",this.popupBgClass="bg-white/10",this.setHide=new pt,this.onSubmit=new pt,this.hide=()=>{this.setHide.next(!0),this.blurSource=""},this.loadBlurSource=i=>{i?this.animateService.getCavasImage().pipe(Li(1)).subscribe(r=>{this.blurSource=`url(${r})`}):this.blurSource="#ffffff"},this.submit=i=>{i||this.onSubmit.next(this.nameString)}}set setTitle(t){this.title=t}set setPlaceholder(t){this.placeholder=t}set setBackButtonType(t){this.backButtonType=t}set useBlurPadding(t){this.loadBlurSource(t)}set setThemeColor(t){this.themeColor=t}set setPopupBg(t){this.popupBgClass=t}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)($(Ks))},n.\u0275cmp=Ci({type:n,selectors:[["app-add-name"]],inputs:{setTitle:"setTitle",setPlaceholder:"setPlaceholder",setBackButtonType:"setBackButtonType",useBlurPadding:"useBlurPadding",setThemeColor:"setThemeColor",setPopupBg:"setPopupBg"},outputs:{setHide:"setHide",onSubmit:"onSubmit"},decls:22,vars:21,consts:[[1,"z-10","pointer-events-none","absolute","w-full","h-screen","top-0","left-0","flex","justify-center","items-center",3,"ngClass"],[1,"absolute","bg-white/30","p-6","rounded-4xl","glass-blur",3,"ngStyle"],[1,"w-50","py-6","px-9","bg-white","rounded-2xl","pointer-events-auto",3,"ngClass"],[1,"items-center","flex"],[1,"pl-0","pr-5","py-5",3,"click"],[3,"src",4,"ngIf"],[1,"text-2xl"],[1,"step","mt-6","mb-3"],["for","catalog-link",1,"rounded-xl","px-5","py-5","block",3,"ngClass"],["id","catalog-link","type","url","required","",1,"border-b-2","w-full","text-xl",3,"ngModel","size","placeholder","ngClass","ngModelChange"],["name","ngModel","nameInput",""],[1,"px-5","pt-2","text-sm","text-error-500"],[4,"ngIf"],[1,"rounded-full","py-3","flex","w-full","items-center","justify-center","space-x-2",3,"ngClass","click"],["class","pb-0.5",3,"src",4,"ngIf"],["class","pb-0.5","src","./assets/icons/chevron-right-grey.svg",4,"ngIf"],[3,"src"],[1,"pb-0.5",3,"src"],["src","./assets/icons/chevron-right-grey.svg",1,"pb-0.5"]],template:function(t,i){if(1&t){const r=Gt();V(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),Ee("click",function(){return i.hide()}),rt(5,Ate,1,1,"img",5),rt(6,Ite,1,1,"img",5),Y(),V(7,"h2",6),Me(8),Y()(),V(9,"div",7)(10,"label",8)(11,"input",9,10),Ee("ngModelChange",function(o){return i.nameString=o}),Y()(),V(14,"div",11),rt(15,Rte,2,0,"p",12),Y()(),V(16,"div")(17,"button",13),Ee("click",function(){je(r);const o=Yr(12);return i.submit(o.errors)}),V(18,"p"),Me(19,"\u65b0\u589e"),Y(),rt(20,Pte,1,1,"img",14),rt(21,Nte,1,0,"img",15),Y()()()()()}if(2&t){const r=Yr(12);ne("ngClass",i.popupBgClass),ie(1),ne("ngStyle",ji(15,Lte,i.blurSource)),ie(1),ne("ngClass","text-"+i.themeColor+"-500"),ie(3),ne("ngIf","cross"===i.backButtonType),ie(1),ne("ngIf","arrow"===i.backButtonType),ie(2),Gi(i.title),ie(2),ne("ngClass","bg-"+i.themeColor+"-200"),ie(1),ov("placeholder",i.placeholder),ne("ngModel",i.nameString)("size",13)("ngClass",PT(17,Ote,"border-"+i.themeColor+"-400","placeholder:text-"+i.themeColor+"-400","bg-"+i.themeColor+"-200")),ie(4),ne("ngIf",r.touched&&r.errors&&r.errors.required),ie(2),ne("ngClass",r.errors?"bg-grey-100 text-grey-300":"bg-"+i.themeColor+"-400"),ie(3),ne("ngIf",!r.errors),ie(1),ne("ngIf",r.errors)}},directives:[ud,Rs,Is,Ka,Gh,kh,lu],styles:["input[_ngcontent-%COMP%]{letter-spacing:.3rem}"]}),n})();function Fte(n,e){if(1&n){const t=Gt();V(0,"button",8),Ee("click",function(){return je(t),Re().submit()}),V(1,"p"),Me(2),Y()()}if(2&n){const t=Re();ne("ngClass","bg-"+t.themeColor+"-200"),ie(2),Ei("\u5207\u63db\u9ad8\u5ea6\u8cc7\u6599\u5230\u300c",t.name,"\u300d")}}const kte=function(n){return{"background-image":n}};let oO=(()=>{class n{constructor(t){this.animateService=t,this.blurSource="",this.themeColor="primary",this.popupBgClass="bg-white/10",this.enableCta=!0,this.setHide=new pt,this.onSubmit=new pt,this.name="",this.submit=()=>{this.hide(),this.onSubmit.next(!0)},this.hide=()=>{this.setHide.next(!0)},this.loadBlurSource=i=>{i?this.animateService.getCavasImage().pipe(Li(1)).subscribe(r=>{this.blurSource=`url(${r})`}):this.blurSource="#ffffff"}}set useBlurPadding(t){this.loadBlurSource(t)}set setThemeColor(t){this.themeColor=t}set setPopupBg(t){this.popupBgClass=t}set setCta(t){this.enableCta=t}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)($(Ks))},n.\u0275cmp=Ci({type:n,selectors:[["app-completed"]],inputs:{useBlurPadding:"useBlurPadding",name:"name",setThemeColor:"setThemeColor",setPopupBg:"setPopupBg",setCta:"setCta"},outputs:{setHide:"setHide",onSubmit:"onSubmit"},decls:10,vars:7,consts:[[1,"z-10","pointer-events-none","absolute","w-full","h-screen","top-0","left-0","flex","justify-center","items-center",3,"ngClass"],[1,"absolute","bg-white/30","p-6","rounded-4xl","glass-blur",3,"ngStyle"],[1,"w-50","py-6","px-9","bg-white","rounded-2xl","pointer-events-auto",3,"ngClass"],[1,"items-center","flex","justify-between"],[1,"text-2xl"],[1,"p-5",3,"click"],[3,"src"],["class","rounded-full py-3 px-6 flex w-full items-center justify-center space-x-2",3,"ngClass","click",4,"ngIf"],[1,"rounded-full","py-3","px-6","flex","w-full","items-center","justify-center","space-x-2",3,"ngClass","click"]],template:function(t,i){1&t&&(V(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),Me(5,"\u65b0\u589e\u6210\u529f\uff01"),Y(),V(6,"button",5),Ee("click",function(){return i.hide()}),ct(7,"img",6),Y()(),V(8,"div"),rt(9,Fte,3,2,"button",7),Y()()()()),2&t&&(ne("ngClass",i.popupBgClass),ie(1),ne("ngStyle",ji(5,kte,i.blurSource)),ie(1),ne("ngClass","text-"+i.themeColor+"-500"),ie(5),ne("src","./assets/icons/cross-"+i.themeColor+".svg",xs),ie(2),ne("ngIf",i.enableCta))},directives:[ud,Rs,Is],styles:[""]}),n})();class Bte extends Ni{constructor(e,t){super()}schedule(e,t=0){return this}}const s_={setInterval(...n){const{delegate:e}=s_;return((null==e?void 0:e.setInterval)||setInterval)(...n)},clearInterval(n){const{delegate:e}=s_;return((null==e?void 0:e.clearInterval)||clearInterval)(n)},delegate:void 0},aO={now:()=>(aO.delegate||Date).now(),delegate:void 0};class Wh{constructor(e,t=Wh.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}}Wh.now=aO.now;const wC=new class Ute extends Wh{constructor(e,t=Wh.now){super(e,t),this.actions=[],this._active=!1,this._scheduled=void 0}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let i;this._active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}(class Vte extends Bte{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}requestAsyncId(e,t,i=0){return s_.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;s_.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,nl(i,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}),Hte=wC;function Gte(n,e){1&n&&(V(0,"p",18),Me(1,"\u6b64\u70ba\u5fc5\u586b"),Y())}function Wte(n,e){1&n&&(V(0,"p",18),Me(1,"\u5fc5\u9808\u70bagoogle sheet\u5206\u4eab\u9023\u7d50"),Y())}function jte(n,e){1&n&&(V(0,"p",30),Me(1,"\u9a57\u8b49\u8a66\u7b97\u8868..."),Y())}function $te(n,e){if(1&n&&(V(0,"p",30),Me(1),Y()),2&n){const t=Re();ie(1),Gi(t.googleSheetSuccessDscription)}}function qte(n,e){1&n&&(V(0,"div",31),ct(1,"img",32),Y())}function Yte(n,e){1&n&&ct(0,"img",33)}function Xte(n,e){1&n&&ct(0,"img",34)}function Qte(n,e){1&n&&(V(0,"p"),Me(1,"\u8acb\u5148\u586b\u5165\u8a66\u7b97\u8868\u9023\u7d50"),Y())}const Jte=function(n){return{"background-image":n}},Kte=function(n){return{transform:n}};let lO=(()=>{class n{constructor(t,i){this.animateService=t,this.categoryService=i,this.showSubmitTip=!1,this.googleSheetErrorDscription="",this.googleSheetSuccessDscription="",this.showTip=!1,this.blurSource="",this.sheetUrl="",this.popupBgClass="bg-white/10",this.onKeyChange=new gr,this.onSubmit=new pt,this.setHide=new pt,this.toggleShowTip=()=>this.showTip=!this.showTip,this.hide=()=>this.setHide.emit(),this.urlKeyUp=(r,s,o)=>{o||this.onKeyChange.next(s)},this.loadBlurSource=r=>{r?this.animateService.getCavasImage().pipe(Li(1)).subscribe(s=>{this.blurSource=`url(${s})`}):this.blurSource="#ffffff"},this.checkUrlAccessable=()=>{this.onKeyChange.pipe(function zte(n,e=wC){return Ln((t,i)=>{let r=null,s=null,o=null;const a=()=>{if(r){r.unsubscribe(),r=null;const c=s;s=null,i.next(c)}};function l(){const c=o+n,u=e.now();if(u<c)return r=this.schedule(void 0,c-u),void i.add(r);a()}t.subscribe(new Mn(i,c=>{s=c,o=e.now(),r||(r=e.schedule(l,n),i.add(r))},()=>{a(),i.complete()},void 0,()=>{s=r=null}))})}(500),Kr(r=>Be(r))).subscribe(r=>{this.categoryService.getCategoryTableByUrl(r).subscribe(s=>{switch(console.log(s),s){case 401:this.googleSheetErrorDscription="\u8acb\u4f9d\u7167\u4e0b\u4e00\u6b65\uff0c\u8a2d\u5b9a\u8a66\u7b97\u8868\u70ba\u516c\u958b\u3002",this.googleSheetSuccessDscription="";break;case 404:this.googleSheetErrorDscription="\u8d85\u9023\u7d50\u88e1\u9762\u6c92\u6709\u8a66\u7b97\u8868\uff0c\u8a72\u8a66\u7b97\u8868\u662f\u5426\u5df2\u88ab\u522a\u9664\uff1f",this.googleSheetSuccessDscription="";break;case 0:this.googleSheetErrorDscription="\u8acb\u7e7c\u7e8c\u4e0b\u4e00\u6b65\uff0c\u8a2d\u5b9a\u8a66\u7b97\u8868\u70ba\u516c\u958b\u3002\u6216\u78ba\u4fdd\u7db2\u8def\u6b63\u5e38",this.googleSheetSuccessDscription="";break;case 200:this.googleSheetErrorDscription="",this.googleSheetSuccessDscription="\u8a66\u7b97\u8868\u6c92\u6709\u554f\u984c\uff0c\u8b9a\uff01"}})})},this.getSheetId=()=>this.categoryService.getSheetIdFromUrl(this.sheetUrl),this.submit=r=>{r||(this.showSubmitTip=!0,this.onSubmit.next(this.sheetUrl),this.hide())}}ngOnInit(){this.checkUrlAccessable()}set useBlurPadding(t){this.loadBlurSource(t)}set setPopupBg(t){this.popupBgClass=t}}return n.\u0275fac=function(t){return new(t||n)($(Ks),$(Fh))},n.\u0275cmp=Ci({type:n,selectors:[["app-add-category"]],inputs:{useBlurPadding:"useBlurPadding",setPopupBg:"setPopupBg"},outputs:{onSubmit:"onSubmit",setHide:"setHide"},decls:46,vars:18,consts:[[1,"z-10","pointer-events-none","absolute","w-full","h-screen","top-0","left-0","flex","justify-center","items-center",3,"ngClass"],[1,"absolute","bg-white/30","p-6","rounded-4xl","glass-blur",3,"ngStyle"],[1,"w-50","py-6","px-9","bg-white","rounded-2xl","text-category-500","pointer-events-auto"],[1,"items-center","flex","justify-between"],[1,"text-2xl"],[1,"p-5",3,"click"],["src","./assets/icons/cross-category.svg"],[1,"step","mb-6"],[1,"py-2"],["href","https://docs.google.com/spreadsheets/d/1rGYgg9SDkrafXSGpleAitmpaYMIUd_QNeDnogccZ0Fc/copy","target","_blank"],[1,"bg-category-400","rounded-full","pt-3","pb-2","flex","w-full","items-center","justify-center","space-x-2"],["src","./assets/icons/external-link.svg",1,"pb-1.5"],[1,"step","mt-6","mb-3"],["for","catalog-link",1,"bg-category-200","rounded-xl","px-5","py-5","block"],["id","catalog-link","type","url","required","","pattern","https://docs.google.com/spreadsheets/d/.+","placeholder","https://docs.google.com/spreadsheets/d/1rGYgg9SDkrafXSGpleAitmpaYMIUd_QNeDnogccZ0Fc/copy",1,"border-b-2","border-category-400","placeholder:text-category-400","bg-category-200","w-full",3,"ngModel","ngModelChange","keyup"],["name","ngModel"],[1,"px-5","pt-2","text-sm"],["class","text-error-500",4,"ngIf"],[1,"text-error-500"],["class","text-category-500",4,"ngIf"],[1,"flex"],[1,"flex","items-center","border-b-2","border-category-400",3,"click"],[1,"text-sm"],["src","./assets/icons/chevron-down-category.svg",1,"icon-transition",3,"ngStyle"],["class","bg-category-200 rounded-3xl py-3 px-3 mt-3",4,"ngIf"],[1,"rounded-full","py-3","flex","w-full","items-center","justify-center","space-x-2",3,"ngClass","click"],["class","pb-0.5","src","./assets/icons/chevron-right-category.svg",4,"ngIf"],["class","pb-0.5","src","./assets/icons/chevron-right-grey.svg",4,"ngIf"],[1,"px-5","pt-2","text-sm","text-error-500"],[4,"ngIf"],[1,"text-category-500"],[1,"bg-category-200","rounded-3xl","py-3","px-3","mt-3"],["src","./assets/step3@2x.gif",1,"w-96","rounded-xl"],["src","./assets/icons/chevron-right-category.svg",1,"pb-0.5"],["src","./assets/icons/chevron-right-grey.svg",1,"pb-0.5"]],template:function(t,i){if(1&t){const r=Gt();V(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),Me(5,"\u65b0\u589e\u8cc7\u6599\u6b65\u9a5f"),Y(),V(6,"button",5),Ee("click",function(){return i.hide()}),ct(7,"img",6),Y()(),V(8,"div",7)(9,"h3",8),Me(10,"\u4e00\u3001\u5efa\u7acb\u8a66\u7b97\u8868\u4e26\u586b\u5165\u8cc7\u6599"),Y(),V(11,"a",9)(12,"button",10)(13,"p"),Me(14,"\u7531\u7bc4\u672c\u5efa\u7acb\u8a66\u7b97\u8868"),Y(),ct(15,"img",11),Y()()(),V(16,"div",12)(17,"h3",8),Me(18,"\u4e8c\u3001\u8907\u88fd\u5176\u9023\u7d50\u4e26\u8cbc\u4e0a"),Y(),V(19,"label",13)(20,"input",14,15),Ee("ngModelChange",function(o){return i.sheetUrl=o})("keyup",function(o){je(r);const a=Yr(21);return i.urlKeyUp(o,a.value,null==a.errors?null:a.errors.pattern)}),Y()(),V(22,"div",16),rt(23,Gte,2,0,"p",17),rt(24,Wte,2,0,"p",17),V(25,"p",18),Me(26),Y(),rt(27,jte,2,0,"p",19),rt(28,$te,2,1,"p",19),Y()(),V(29,"div",7)(30,"h3",8),Me(31,"\u4e09\u3001\u8a2d\u70ba\u516c\u958b"),Y(),V(32,"div",20)(33,"button",21),Ee("click",function(){return i.toggleShowTip()}),V(34,"small",22),Me(35,"\u8a2d\u516c\u958b\u6559\u5b78"),Y(),ct(36,"img",23),Y()(),rt(37,qte,2,0,"div",24),Y(),V(38,"div")(39,"button",25),Ee("click",function(){je(r);const o=Yr(21);return i.submit(o.errors)}),V(40,"p"),Me(41,"\u65b0\u589e"),Y(),rt(42,Yte,1,0,"img",26),rt(43,Xte,1,0,"img",27),Y(),V(44,"div",28),rt(45,Qte,2,0,"p",29),Y()()()()()}if(2&t){const r=Yr(21);ne("ngClass",i.popupBgClass),ie(1),ne("ngStyle",ji(14,Jte,i.blurSource)),ie(19),ne("ngModel",i.sheetUrl),ie(3),ne("ngIf",r.touched&&r.errors&&r.errors.required),ie(1),ne("ngIf",r.touched&&r.errors&&r.errors.pattern),ie(2),Gi(i.googleSheetErrorDscription),ie(1),ne("ngIf",r.touched&&!r.errors&&!i.googleSheetErrorDscription&&!i.googleSheetSuccessDscription),ie(1),ne("ngIf",i.googleSheetSuccessDscription),ie(8),ne("ngStyle",ji(16,Kte,i.showTip?"rotate(180deg)":"")),ie(1),ne("ngIf",i.showTip),ie(2),ne("ngClass",r.errors?"bg-grey-100 text-grey-300":"bg-category-400"),ie(3),ne("ngIf",!r.errors),ie(1),ne("ngIf",r.errors),ie(2),ne("ngIf",i.showSubmitTip&&!r.touched)}},directives:[ud,Rs,Ka,Gh,vC,kh,lu,Is],styles:[""]}),n})();function Zte(n,e){if(1&n){const t=Gt();V(0,"div")(1,"div",44),Ee("click",function(r){return je(t),Re(2).clickSpace(r)}),V(2,"button",45),Ee("click",function(r){je(t);const s=Re().$implicit;return Re().deleteMap(r,s.mapId)}),Me(3," \u522a\u9664 "),Y(),V(4,"button",45),Ee("click",function(r){je(t);const s=Re().$implicit;return Re().renameMap(r,s.mapId)}),Me(5," \u91cd\u65b0\u547d\u540d "),Y()()()}}function ene(n,e){if(1&n){const t=Gt();V(0,"button",38),Ee("click",function(){const s=je(t).$implicit;return Re().onMapClick(s.mapId)}),ct(1,"img",39),V(2,"div",40)(3,"h2",41),Me(4),Y(),rt(5,Zte,6,0,"div",42),V(6,"button",43),Ee("click",function(r){const o=je(t).$implicit;return Re().editMap(r,o.mapId)}),Me(7,"\u7de8\u8f2f"),Y()()()}if(2&n){const t=e.$implicit,i=Re();ie(1),ne("src","./assets/icons/map-list-"+(t.mapId%3+1)+".svg",xs),ie(3),Gi(t.mapName),ie(1),ne("ngIf",t.mapId===i.editingMapId)}}function tne(n,e){if(1&n){const t=Gt();V(0,"div")(1,"div",44),Ee("click",function(r){return je(t),Re(2).clickSpace(r)}),V(2,"button",50),Ee("click",function(r){je(t);const s=Re().$implicit;return Re().deleteCategory(r,s.categoryId)}),Me(3," \u522a\u9664 "),Y(),V(4,"button",50),Ee("click",function(r){je(t);const s=Re().$implicit;return Re().editCategoryTable(r,s.categoryId)}),Me(5," \u7de8\u8f2f\u8cc7\u6599 "),Y()()()}}function nne(n,e){if(1&n){const t=Gt();V(0,"button",46)(1,"p",47),Me(2),Y(),ct(3,"img",48),V(4,"h2",41),Me(5),Y(),rt(6,tne,6,0,"div",42),V(7,"button",49),Ee("click",function(r){const o=je(t).$implicit;return Re().editCategory(r,o.categoryId)}),Me(8,"\u7de8\u8f2f"),Y()()}if(2&n){const t=e.$implicit,i=e.index,r=Re();ie(2),Ei("",i+1,"."),ie(1),ne("src","./assets/icons/category-list-"+(i%3+1)+".svg",xs),ie(2),Gi(t.tableName),ie(1),ne("ngIf",t.categoryId===r.editingCategoryId)}}function ine(n,e){if(1&n){const t=Gt();V(0,"app-add-name",51),Ee("setHide",function(){return je(t),Re().toggleAddMapNamePopup()})("onSubmit",function(r){return je(t),Re().onGotName(r)}),Y()}2&n&&ne("setTitle","\u5730\u5716\u540d\u7a31")("setPlaceholder","ex.\u5206\u5e97\u5730\u5716")("setBackButtonType","cross")("useBlurPadding",!1)("setThemeColor","primary")("setPopupBg","bg-black/10")}function rne(n,e){if(1&n){const t=Gt();V(0,"app-add-name",51),Ee("setHide",function(){return je(t),Re().toggleMapRenamePopup()})("onSubmit",function(r){return je(t),Re().onRenamed(r)}),Y()}2&n&&ne("setTitle","\u4fee\u6539\u5730\u5716\u540d\u7a31")("setPlaceholder","ex.\u5206\u5e97\u5730\u5716")("setBackButtonType","cross")("useBlurPadding",!1)("setThemeColor","primary")("setPopupBg","bg-black/10")}function sne(n,e){if(1&n){const t=Gt();V(0,"app-completed",52),Ee("setHide",function(){return je(t),Re().toggleAddCompletePopup()})("onSubmit",function(){return je(t),Re().switchNewMap()}),Y()}2&n&&ne("name",Re().addedMapName)("useBlurPadding",!1)("setThemeColor","primary")("setPopupBg","bg-black/10")}function one(n,e){if(1&n){const t=Gt();V(0,"app-add-category",53),Ee("setHide",function(){return je(t),Re().toggleAddCategoryShow()})("onSubmit",function(r){return je(t),Re().onGotSheetUrl(r)}),Y()}2&n&&ne("useBlurPadding",!1)("setPopupBg","bg-black/10")}function ane(n,e){if(1&n){const t=Gt();V(0,"app-add-name",54),Ee("setHide",function(){return je(t),Re().nameMoveLastSetp()})("onSubmit",function(r){return je(t),Re().onGotCategoryName(r)}),Y()}2&n&&ne("useBlurPadding",!1)("setThemeColor","category")("setPopupBg","bg-black/10")}function lne(n,e){if(1&n){const t=Gt();V(0,"app-completed",55),Ee("setHide",function(){return je(t),Re().toggleCompletedShow()}),Y()}2&n&&ne("name",Re().categoryNameToAdd)("useBlurPadding",!1)("setThemeColor","category")("setPopupBg","bg-black/10")("setCta",!1)}const cO=function(){return{"background-image":"url('./assets/icons/create-category-bg.svg')"}};let cne=(()=>{class n{constructor(t,i,r){var s=this;this.mapHttpService=t,this.router=i,this.categoryService=r,this.maps=[],this.categories=[],this.showAddNamePopup=!1,this.showReamePopup=!1,this.showAddCompletePopup=!1,this.addedMapName="",this.addedMapId="",this.updateMaps=()=>this.mapHttpService.getMaps(),this.onMapClick=o=>{this.router.navigate(["map",o])},this.editMap=(o,a)=>{o.stopPropagation(),this.editingMapId=a},this.deleteMap=function(){var o=Je(function*(a,l){a.stopPropagation(),yield ts(s.mapHttpService.deleteMap(l)),s.maps=yield ts(s.updateMaps())});return function(a,l){return o.apply(this,arguments)}}(),this.renameMap=(o,a)=>{this.mapIdRenaming=a,o.stopPropagation(),console.log(o),this.toggleMapRenamePopup()},this.onGotName=o=>{this.categoryService.addCategoryOptions(this.categoryService.mockOptions).then(a=>{if(console.log(a),!a)throw new Error("failed to create category options");this.mapHttpService.addMap(o,"admin","-N-SasgrgpgWs2szH-aH",a).subscribe(l=>{console.log(l),this.addedMapName=l.name,this.addedMapId=l.id,this.toggleAddCompletePopup()})}),this.toggleAddMapNamePopup()},this.onRenamed=function(){var o=Je(function*(a){if(!s.mapIdRenaming)throw new Error("no rename id found");yield ts(s.mapHttpService.renameMap(s.mapIdRenaming,a)),s.maps=yield ts(s.updateMaps()),s.toggleMapRenamePopup()});return function(a){return o.apply(this,arguments)}}(),this.toggleAddMapNamePopup=()=>this.showAddNamePopup=!this.showAddNamePopup,this.toggleMapRenamePopup=()=>this.showReamePopup=!this.showReamePopup,this.toggleAddCompletePopup=()=>this.showAddCompletePopup=!this.showAddCompletePopup,this.switchNewMap=()=>{if(!this.addedMapId||!+this.addedMapId)throw new Error("the map id that was added is not an number");this.onMapClick(+this.addedMapId)},this.onAddMapClick=o=>{console.log(o),this.toggleAddMapNamePopup()},this.clickSpace=o=>{o.stopPropagation(),this.editingMapId=void 0,this.editingCategoryId=void 0},this.isAddCategoryShow=!1,this.isAddNameShow=!1,this.isCompletedShow=!1,this.categoryNameToAdd="",this.categoryUrlToAdd="",this.toggleAddCategoryShow=()=>this.isAddCategoryShow=!this.isAddCategoryShow,this.toggleAddNameShow=()=>this.isAddNameShow=!this.isAddNameShow,this.toggleCompletedShow=()=>this.isCompletedShow=!this.isCompletedShow,this.onGotSheetUrl=o=>{this.categoryUrlToAdd=o,this.toggleAddNameShow()},this.nameMoveLastSetp=()=>{this.toggleAddCategoryShow(),this.toggleAddNameShow()},this.onGotCategoryName=o=>{this.categoryNameToAdd=o,this.toggleCompletedShow(),this.toggleAddNameShow();const a=this.categoryService.mockSetting;if(a.tableName=o,!this.categoryUrlToAdd)throw new Error("no google sheet url before creating new category on database");a.tableSource=this.categoryService.getSheetIdFromUrl(this.categoryUrlToAdd),this.categoryService.addCategory(a)},this.deleteCategory=function(){var o=Je(function*(a,l){a.stopPropagation(),console.log(l),s.categoryService.deleteCategorySetting(l),s.maps=yield ts(s.updateMaps())});return function(a,l){return o.apply(this,arguments)}}(),this.editCategoryTable=function(){var o=Je(function*(a,l){const c=s.categories.find(u=>u.categoryId===l);if(!c)throw new Error("no url link provided in the firebase category data");window.open(`https://docs.google.com/spreadsheets/d/${c.tableSource}/edit`,"_blank")});return function(a,l){return o.apply(this,arguments)}}(),this.categorySettingsAppendKeyName=o=>{const a=[];for(const l in o){const u=Object.assign({categoryId:l},o[l]);a.push(u)}return a},this.editCategory=(o,a)=>{o.stopPropagation(),console.log(o),this.editingCategoryId=a}}ngOnInit(){var t=this;return Je(function*(){t.maps=yield ts(t.updateMaps()),t.categoryService.getCategorySettings().pipe(tt(t.categorySettingsAppendKeyName)).subscribe(i=>{t.categories=i})})()}}return n.\u0275fac=function(t){return new(t||n)($(q0),$(Di),$(Fh))},n.\u0275cmp=Ci({type:n,selectors:[["app-dashboard"]],inputs:{onGotName:"onGotName",onRenamed:"onRenamed",toggleAddCategoryShow:"toggleAddCategoryShow",toggleCompletedShow:"toggleCompletedShow",onGotSheetUrl:"onGotSheetUrl",nameMoveLastSetp:"nameMoveLastSetp",onGotCategoryName:"onGotCategoryName"},decls:50,vars:12,consts:[[1,"flex"],[1,"w-16","bg-menu-500","h-screen","flex","flex-col","items-center","justify-between","z-20"],[1,"hover:bg-menu-600","rounded-xl","my-2","p-2"],["src","./assets/icons/logo.svg",1,"w-8"],[1,"hover:bg-menu-600","p-2","my-2","rounded-xl"],["src","./assets/icons/log-out.svg",1,"w-8","p-0.5"],[1,"text-white","pt-2"],[1,"flex","w-full","pointer-events-auto",3,"click"],[1,"absolute","text-primary-500","flex","flex-col","justify-between","h-full","p-6"],[1,"text-2xl","font-medium","tracking-widest"],[1,"category","bg-primary-100","w-7/12","flex","items-end","justify-end"],[1,"absolute","w-full","h-full","pointer-events-none",2,"z-index","1","top","0px","left","0px"],["src","./assets/icons/map-circle-xl.svg",1,"absolute",2,"left","40%","top","13%"],["src","./assets/icons/map-pin-xl.svg",1,"absolute",2,"left","40%","top","80%"],["src","./assets/icons/map-paper-xl.svg",1,"absolute",2,"left","3%","top","60%"],[1,"bg-primary-300","text-primary-500","float-right","w-5/6","z-10"],[1,"mt-10","mx-10"],[1,"bg-primary-500","create-category","tint-shadow-primary","mix-blend-darken","flex","rounded-3xl","text-white","w-full","items-center",3,"ngStyle","click"],["src","./assets/icons/map-add-lg.svg",1,"px-3","py-9","xl:p-9"],[1,"flex-col","flex-col","items-start","flex"],[1,"text-xl","font-semibold"],[1,"list","grid","grid-cols-1","2xl:grid-cols-2","auto-rows-auto","gap-4","overflow-y-auto","p-6","mx-6","ml-8"],["class","bg-white p-9 tint-shadow-primary-sm rounded-2xl flex ",3,"click",4,"ngFor","ngForOf"],[1,"category","bg-category-100","w-5/12","flex","items-end","justify-start"],["src","./assets/icons/category-circle-xl.svg",1,"absolute",2,"left","70%","top","70%"],["src","./assets/icons/category-column-tall-xl.svg",1,"absolute",2,"left","80%","top","1%"],["src","./assets/icons/category-column-short-xl.svg",1,"absolute",2,"left","90%","top","70%"],[1,"text-category-500","float-left","w-5/6","z-10"],[1,"bg-category-500","create-category","tint-shadow-primary","mix-blend-darken","flex","rounded-3xl","text-white","w-full","items-center",3,"ngStyle","click"],["src","./assets/icons/category-add-lg.svg",1,"px-3","py-9","xl:p-9"],[1,"text-left","mr-4"],[1,"list","flex","flex-col","overflow-y-auto","p-6","mx-6","ml-8"],["class","bg-white p-3 xl:p-6 my-3 space-x-2 xl:space-x-4 tint-shadow-primary-sm rounded-2xl flex items-center text-left",4,"ngFor","ngForOf"],[3,"setTitle","setPlaceholder","setBackButtonType","useBlurPadding","setThemeColor","setPopupBg","setHide","onSubmit",4,"ngIf"],[3,"name","useBlurPadding","setThemeColor","setPopupBg","setHide","onSubmit",4,"ngIf"],[3,"useBlurPadding","setPopupBg","setHide","onSubmit",4,"ngIf"],[3,"useBlurPadding","setThemeColor","setPopupBg","setHide","onSubmit",4,"ngIf"],[3,"name","useBlurPadding","setThemeColor","setPopupBg","setCta","setHide",4,"ngIf"],[1,"bg-white","p-9","tint-shadow-primary-sm","rounded-2xl","flex",3,"click"],[1,"mr-4",3,"src"],[1,"flex","flex-col","items-start","text-left"],[1,"text-xl"],[4,"ngIf"],[1,"px-6","py-2","bg-primary-200","rounded-2xl","word-break-keep",3,"click"],[1,"dropdown","absolute","p-2","bg-white","rounded-2xl","flex","flex-col","space-y-2","tint-shadow-primary-sm",3,"click"],[1,"px-6","py-2","hover:bg-primary-200","rounded-2xl",3,"click"],[1,"bg-white","p-3","xl:p-6","my-3","space-x-2","xl:space-x-4","tint-shadow-primary-sm","rounded-2xl","flex","items-center","text-left"],[1,"hidden","xl:inline","text"],[1,"hidden","xl:block","mr-1","xl:mr-4",3,"src"],[1,"px-6","py-2","bg-category-200","rounded-2xl","word-break-keep",3,"click"],[1,"px-6","py-2","hover:bg-category-200","rounded-2xl",3,"click"],[3,"setTitle","setPlaceholder","setBackButtonType","useBlurPadding","setThemeColor","setPopupBg","setHide","onSubmit"],[3,"name","useBlurPadding","setThemeColor","setPopupBg","setHide","onSubmit"],[3,"useBlurPadding","setPopupBg","setHide","onSubmit"],[3,"useBlurPadding","setThemeColor","setPopupBg","setHide","onSubmit"],[3,"name","useBlurPadding","setThemeColor","setPopupBg","setCta","setHide"]],template:function(t,i){1&t&&(V(0,"div",0)(1,"nav",1)(2,"button",2),ct(3,"img",3),Y(),V(4,"button",4),ct(5,"img",5),V(6,"p",6),Me(7,"\u767b\u51fa"),Y()()(),V(8,"main",7),Ee("click",function(s){return i.clickSpace(s)}),V(9,"section",8)(10,"h1",9),Me(11,"GeoStat.tw"),Y()(),V(12,"section",10)(13,"div",11),ct(14,"img",12)(15,"img",13)(16,"img",14),Y(),V(17,"div",15)(18,"div",16)(19,"button",17),Ee("click",function(s){return i.onAddMapClick(s)}),ct(20,"img",18),V(21,"div",19)(22,"h2",20),Me(23,"\u65b0\u589e\u5730\u5716"),Y(),V(24,"p"),Me(25,"\u53d6\u4e00\u500b\u540d\u5b57\uff0c\u5efa\u7acb\u4e00\u500b\u65b0\u5730\u5716"),Y()()()(),V(26,"div",21),rt(27,ene,8,3,"button",22),Y()()(),V(28,"section",23)(29,"div",11),ct(30,"img",24)(31,"img",25)(32,"img",26),Y(),V(33,"div",27)(34,"div",16)(35,"button",28),Ee("click",function(){return i.toggleAddCategoryShow()}),ct(36,"img",29),V(37,"div",19)(38,"h2",20),Me(39,"\u65b0\u589e\u9ad8\u5ea6\u8cc7\u6599"),Y(),V(40,"p",30),Me(41,"\u53d6\u4e00\u500b\u540d\u5b57\uff0c\u5efa\u7acb\u4e00\u500b\u9ad8\u5ea6\u8cc7\u6599"),Y()()()(),V(42,"div",31),rt(43,nne,9,4,"button",32),Y()()()()(),rt(44,ine,1,6,"app-add-name",33),rt(45,rne,1,6,"app-add-name",33),rt(46,sne,1,4,"app-completed",34),rt(47,one,1,2,"app-add-category",35),rt(48,ane,1,3,"app-add-name",36),rt(49,lne,1,5,"app-completed",37)),2&t&&(ie(19),ne("ngStyle",Xf(10,cO)),ie(8),ne("ngForOf",i.maps),ie(8),ne("ngStyle",Xf(11,cO)),ie(8),ne("ngForOf",i.categories),ie(1),ne("ngIf",i.showAddNamePopup),ie(1),ne("ngIf",i.showReamePopup),ie(1),ne("ngIf",i.showAddCompletePopup),ie(1),ne("ngIf",i.isAddCategoryShow),ie(1),ne("ngIf",i.isAddNameShow),ie(1),ne("ngIf",i.isCompletedShow))},directives:[Rs,dd,Is,sO,oO,lO],styles:[".create-category[_ngcontent-%COMP%]{background-position:center;background-repeat:no-repeat;background-size:auto}.list[_ngcontent-%COMP%]{max-height:66vh}"]}),n})();const uO=function(n){return{"background-image":n}};function une(n,e){if(1&n){const t=Gt();Bl(0),V(1,"label",17)(2,"label",18)(3,"p",19),Me(4),Y()(),V(5,"input",20),Ee("ngModelChange",function(r){return je(t),Re(2).radioValue=r})("change",function(){const s=je(t).$implicit;return Re(2).changeCategory(s.categoryId)}),Y()(),Vl()}if(2&n){const t=e.$implicit,i=e.index,r=Re(2);ie(2),ne("for","category"+i),ie(2),Gi(t.tableName),ie(1),ne("id","category"+i)("value",t.categoryId)("ngModel",r.radioValue)("ngStyle",ji(6,uO,r.updateSelectedStyle(t.categoryId)))}}function dne(n,e){if(1&n){const t=Gt();V(0,"section",8)(1,"div",9)(2,"h2",10),Me(3,"\u9ad8\u5ea6\u8868\u793a\u8cc7\u6599"),Y(),V(4,"form",11)(5,"fieldset")(6,"div",12)(7,"div",13),rt(8,une,6,8,"ng-container",14),Me(9),Y()()()(),V(10,"button",15),Ee("click",function(){return je(t),Re().toggleAddCategory()}),V(11,"p"),Me(12,"\u65b0\u589e"),Y(),ct(13,"img",16),Y()()()}if(2&n){const t=Re();ne("ngStyle",ji(3,uO,t.blurSource)),ie(8),ne("ngForOf",t.categoriesMappedId),ie(1),Ei(" ",t.radioValue," ")}}function hne(n,e){if(1&n){const t=Gt();V(0,"app-add-category",21),Ee("setHide",function(){return je(t),Re().toggleAddCategory()})("onSubmit",function(r){return je(t),Re().onGotSheetUrl(r)}),Y()}2&n&&ne("useBlurPadding",!0)("setPopupBg","bg-white/10")}function fne(n,e){if(1&n){const t=Gt();V(0,"app-add-name",22),Ee("setHide",function(){return je(t),Re().nameMoveLastSetp()})("onSubmit",function(r){return je(t),Re().onGotName(r)}),Y()}2&n&&ne("useBlurPadding",!0)("setThemeColor","category")("setPopupBg","bg-white/10")}function pne(n,e){if(1&n){const t=Gt();V(0,"app-completed",23),Ee("setHide",function(){return je(t),Re().toggleCompletedShow()})("onSubmit",function(r){return je(t),Re().switchNewCategory(r)}),Y()}2&n&&ne("name",Re().addedName)("useBlurPadding",!0)("setThemeColor","category")("setPopupBg","bg-white/10")("setCta",!0)}let mne=(()=>{class n{constructor(t,i,r,s){this.animateService=t,this.categoryService=i,this.mapHttpService=r,this.activatedRoute=s,this.blurSource="",this.categoriesMappedId=[],this.radioValue="",this.isAddCategoryShow=!1,this.isAddNameShow=!1,this.addedName="",this.isCompletedShow=!1,this.categoryChangeSubject=new gr,this.changeCategoryOnCanvas=new pt,this.onCategoryChange=()=>{this.categoryChangeSubject.pipe(sn(o=>Be({mapId:this.activatedRoute.snapshot.paramMap.get("id")||"",categoryId:o})),sn(({mapId:o,categoryId:a})=>(console.log(a),this.mapHttpService.changeDefaultCategory(o,a)))).subscribe(o=>{console.log(o)})},this.isShow=!0,this.toggleShow=()=>{this.isShow=!this.isShow,this.isShow&&this.animateService.getCavasImage().pipe(Li(1)).subscribe(o=>{this.blurSource=`url(${o})`})},this.changeCategory=o=>{this.categoryChangeSubject.next(o),this.changeCategoryOnCanvas.emit(o)},this.toggleAddCategory=()=>this.isAddCategoryShow=!this.isAddCategoryShow,this.nameMoveLastSetp=()=>{this.toggleAddName(),this.toggleAddCategory()},this.onGotSheetUrl=o=>{console.log(o),this.addingSheetUrl=o,this.toggleAddName()},this.toggleAddName=()=>this.isAddNameShow=!this.isAddNameShow,this.toggleCompletedShow=()=>this.isCompletedShow=!this.isCompletedShow,this.switchNewCategory=o=>{if(console.log(this.isCompletedShow),!this.addingCategoryId)throw new Error("no addingCategoryId. the category could failed without internet connection");this.changeCategory(this.addingCategoryId),this.radioValue=this.addingCategoryId},this.onGotName=o=>{this.toggleAddName(),this.toggleCompletedShow();const a=this.categoryService.mockSetting;if(a.tableName=o,this.addedName=o,!this.addingSheetUrl)throw new Error("no google sheet url before creating new category on database");a.tableSource=this.categoryService.getSheetIdFromUrl(this.addingSheetUrl),this.addingCategoryId=this.categoryService.addCategory(a)||""},this.updateSelectedStyle=o=>o===this.radioValue?"url('./assets/icons/checked-radio.svg')":"initial"}ngOnInit(){var t=this;return Je(function*(){t.categoryService.getCategorySettings().subscribe(r=>{const s=[];for(const o in r){const l=Object.assign({categoryId:o},r[o]);s.push(l)}console.log(s),t.categoriesMappedId=s}),t.onCategoryChange();const i=t.activatedRoute.snapshot.paramMap.get("id");if(null!==i&&NaN!=+i){const r=yield ts(t.mapHttpService.getMap(+i));t.changeCategory(r.defualtCategoryId),t.radioValue=r.defualtCategoryId}})()}}return n.\u0275fac=function(t){return new(t||n)($(Ks),$(Fh),$(q0),$(fo))},n.\u0275cmp=Ci({type:n,selectors:[["app-category-picker"]],outputs:{changeCategoryOnCanvas:"changeCategoryOnCanvas"},decls:10,vars:4,consts:[[1,"flex","flex-col","m-6"],[1,"text-primary-500","pb-3"],[1,"pointer-events-auto","tint-shadow-primary","gradient-bg","bg-primary","text-xl","mr-auto","py-4","px-8","rounded-full","flex","items-center","text-white",3,"click"],["src","./assets/icons/chevron-down-white.svg"],["class","pointer-events-auto glass-blur rounded-2xl my-6",3,"ngStyle",4,"ngIf"],[3,"useBlurPadding","setPopupBg","setHide","onSubmit",4,"ngIf"],[3,"useBlurPadding","setThemeColor","setPopupBg","setHide","onSubmit",4,"ngIf"],[3,"name","useBlurPadding","setThemeColor","setPopupBg","setCta","setHide","onSubmit",4,"ngIf"],[1,"pointer-events-auto","glass-blur","rounded-2xl","my-6",3,"ngStyle"],[1,"bg-white/90","m-3","p-3","rounded-xl","flex","text-category-500","flex-col"],[1,"p-2","text-xl"],[1,"my-3","rounded-xl"],[1,"flex","flex-col"],[1,"unselected-category","overflow-y-auto"],[4,"ngFor","ngForOf"],[1,"rounded-full","bg-category-400","py-3","px-6","flex","justify-center","space-x-2","items-center","my-1","mx-3",3,"click"],["src","./assets/icons/add-category.svg"],[1,"rounded-full","bg-category-200","py-3","px-6","flex","space-x-2","items-center","my-1","mx-3"],[1,"flex","space-x-2","mr-auto",3,"for"],[1,"pr-6"],["type","radio","name","category",3,"id","value","ngModel","ngStyle","ngModelChange","change"],[3,"useBlurPadding","setPopupBg","setHide","onSubmit"],[3,"useBlurPadding","setThemeColor","setPopupBg","setHide","onSubmit"],[3,"name","useBlurPadding","setThemeColor","setPopupBg","setCta","setHide","onSubmit"]],template:function(t,i){1&t&&(V(0,"div",0)(1,"p",1),Me(2,"\u9ad8\u5ea6\u8868\u793a\uff1a"),Y(),V(3,"button",2),Ee("click",function(){return i.toggleShow()}),Me(4," \u5e97\u71df\u696d\u984d "),ct(5,"img",3),Y(),rt(6,dne,14,5,"section",4),Y(),rt(7,hne,1,2,"app-add-category",5),rt(8,fne,1,3,"app-add-name",6),rt(9,pne,1,5,"app-completed",7)),2&t&&(ie(6),ne("ngIf",i.isShow),ie(1),ne("ngIf",i.isAddCategoryShow),ie(1),ne("ngIf",i.isAddNameShow),ie(1),ne("ngIf",i.isCompletedShow))},directives:[Is,Rs,dC,Kx,zh,dd,hC,Ka,kh,lu,lO,sO,oO],styles:[".gradient-bg[_ngcontent-%COMP%]{background:linear-gradient(306deg,#3488b8 0%,#4b9ecd 100%)}.tint-shadow[_ngcontent-%COMP%]{box-shadow:0 21px 16px -11px #4b9ecd55,0 3px 13px #06091829}input[type=radio][_ngcontent-%COMP%]{-webkit-appearance:none;width:20px;height:20px;border-radius:100px;background-color:none;border:solid 2px;background-repeat:no-repeat;background-position:center}input[type=radio][_ngcontent-%COMP%]:checked{background-position:center}.unselected-category[_ngcontent-%COMP%]{max-height:50vh}"]}),n})();var el=(()=>{return(n=el||(el={})).triangle="triangle",n.rectangle="rectangle",el;var n})();function gne(n,e){1&n&&ct(0,"img",13)}function _ne(n,e){1&n&&ct(0,"img",14)}const yne=function(){return{"background-image":"url('./assets/icons/checked-box.svg')"}};function vne(n,e){if(1&n){const t=Gt();Bl(0),V(1,"label",7)(2,"label",8)(3,"p",9),Me(4),Y()(),rt(5,gne,1,0,"img",10),rt(6,_ne,1,0,"img",11),V(7,"input",12),Ee("change",function(){const s=je(t).$implicit;return Re().uncheckPin(s)}),Y()(),Vl()}if(2&n){const t=e.$implicit,i=e.index,r=Re();ie(1),ne("for","selected-pin-"+i),ie(1),ne("for","selected-pin-"+i),ie(2),Gi(t.title),ie(1),ne("ngIf",r.isPinTypeTriangle(t)),ie(1),ne("ngIf",r.isPinTypeRectangle(t)),ie(1),ne("id","selected-pin-"+i)("name",t.id)("checked",!0)("ngStyle",Xf(9,yne))}}function wne(n,e){if(1&n){const t=Gt();Bl(0),V(1,"label",15)(2,"label",8)(3,"p",9),Me(4),Y()(),V(5,"input",16),Ee("change",function(){const s=je(t).$implicit;return Re().checkPin(s)}),Y()(),Vl()}if(2&n){const t=e.$implicit,i=e.index;ie(2),ne("for","unselected-pin-"+i),ie(2),Gi(t.title),ie(1),ne("id","unselected-pin-"+i)("name",t.id)}}const bne=function(n){return{backgroundImage:n}};let xne=(()=>{class n{constructor(){this.pins=[],this.unselectedPins=[],this.selectedPins=[],this.selectedPinsWithType=[],this.polygons=[],this.blurSource="",this.pinChecked=new pt,this.updateUnselected=()=>{const t=this.pins.filter(i=>{var r;return!(null===(r=this.selectedPins)||void 0===r?void 0:r.some(o=>o.id===i.id))});this.unselectedPins=t},this.uncheckPin=t=>{this.selectedPins=this.selectedPins.filter(i=>i.id!==t.id),this.updateUnselected(),this.pinChecked.emit(this.selectedPins)},this.checkPin=t=>{var i;null===(i=this.selectedPins)||void 0===i||i.push(t),this.updateUnselected(),this.pinChecked.emit(this.selectedPins)},this.onPolygonUpdated=t=>{this.polygons=t,this.selectedPinsWithType=this.mapPinsWithPolygonType(this.selectedPins,this.polygons)},this.mapPinsWithPolygonType=(t,i)=>t.map(r=>{let s=this.findPolygonType(i,r);return s.polygonType||(s.polygonType=[]),s}),this.findPolygonType=(t,i)=>{let r=JSON.parse(JSON.stringify(i));return t.forEach(s=>{s.points.find(a=>i.id===a.id)&&(r.polygonType?r.polygonType.push(s.type):r.polygonType=[s.type])}),r},this.isPinTypeTriangle=t=>t.polygonType.some(i=>i===el.triangle),this.isPinTypeRectangle=t=>t.polygonType.some(i=>i===el.rectangle)}set setPolygons(t){this.onPolygonUpdated(t)}set setSelectedPins(t){this.selectedPins=t,this.updateUnselected()}set setPins(t){this.pins=t,this.updateUnselected()}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Ci({type:n,selectors:[["app-map-pin-settings"]],inputs:{polygons:"polygons",setPolygons:"setPolygons",blurSource:"blurSource",setSelectedPins:"setSelectedPins",setPins:"setPins"},outputs:{pinChecked:"pinChecked"},decls:11,vars:5,consts:[[1,"glass-blur","rounded-2xl","pointer-events-auto",3,"ngStyle"],[1,"bg-white/90","m-3","p-3","rounded-xl","flex","text-pins-500","flex-col"],[1,"p-2","text-xl"],[1,"flex","flex-col","pins"],[1,"selected-pins"],[4,"ngFor","ngForOf"],[1,"unselected-pins"],[1,"rounded-full","bg-pins-400","flex","space-x-2","items-center","my-1","mx-3","py-3","px-6",3,"for"],[1,"flex","space-x-2","mr-auto",3,"for"],[1,"pr-6"],["src","./assets/icons/polygon-triangle.svg",4,"ngIf"],["src","./assets/icons/polygon-rectangle.svg",4,"ngIf"],["type","checkbox",3,"id","name","checked","ngStyle","change"],["src","./assets/icons/polygon-triangle.svg"],["src","./assets/icons/polygon-rectangle.svg"],[1,"rounded-full","bg-pins-300","py-3","px-6","flex","space-x-2","items-center","my-1","mx-3"],["type","checkbox",3,"id","name","change"]],template:function(t,i){1&t&&(V(0,"section",0)(1,"div",1)(2,"h2",2),Me(3,"\u9078\u53d6\u843d\u9ede"),Y(),V(4,"form")(5,"fieldset")(6,"div",3)(7,"div",4),rt(8,vne,8,10,"ng-container",5),Y(),V(9,"div",6),rt(10,wne,6,4,"ng-container",5),Y()()()()()()),2&t&&(ne("ngStyle",ji(3,bne,i.blurSource)),ie(8),ne("ngForOf",i.selectedPinsWithType),ie(2),ne("ngForOf",i.unselectedPins))},directives:[Rs,dC,Kx,zh,dd,Is],styles:["p[_ngcontent-%COMP%]{word-break:keep-all}input[type=checkbox][_ngcontent-%COMP%]{-webkit-appearance:none;width:20px;height:20px;border-radius:5px;background-color:none;border:solid 2px}input[type=checkbox][_ngcontent-%COMP%]:checked{background-position:center}.pins[_ngcontent-%COMP%]{height:calc(100vh - 14rem);overflow-y:auto}"]}),n})();const Cne=["resizeContainer"],Mne=function(n){return{backgroundImage:n}},o_=function(n){return{"mr-3":n}};let Sne=(()=>{class n{constructor(){this.blurSource="",this.columnChanged=new pt,this.polygonChanged=new pt,this.isScrollBarShow=!1,this.onResize=t=>{this.isScrollBarShow=this.resizeContainer.nativeElement.scrollHeight>this.resizeContainer.nativeElement.clientHeight},this.changeColumn=t=>this.columnChanged.emit(t),this.changePolygon=t=>this.polygonChanged.emit(t)}ngOnInit(){}ngAfterViewInit(){setTimeout(()=>{this.onResize()},0)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Ci({type:n,selectors:[["app-map-3d-settings"]],viewQuery:function(t,i){if(1&t&&Av(Cne,5),2&t){let r;id(r=rd())&&(i.resizeContainer=r.first)}},inputs:{columnSettings:"columnSettings",polygonSettings:"polygonSettings",blurSource:"blurSource"},outputs:{columnChanged:"columnChanged",polygonChanged:"polygonChanged"},decls:93,vars:39,consts:[[1,"glass-blur","rounded-2xl","mr-3","pointer-events-auto",3,"ngStyle"],[1,"mx-3","my-3","rounded-2xl",3,"resize"],["resizeContainer",""],[1,"bg-white/90","p-3","rounded-xl","flex",3,"ngClass"],["src","./assets/icons/polygon-triangle.svg",1,"p-2"],[1,"p-2","text-xl"],[1,"bg-white/90","mr-3","my-3","p-3","rounded-xl","flex","flex-col","text-setting-500",3,"ngClass"],[1,"flex","p-2","items-center","space-x-4"],["src","./assets/icons/column-color.svg"],[1,"flex","flex-col","w-full"],[1,"flex","items-center"],["type","color",1,"mr-4","w-full","h-3","rounded-xl","overflow-hidden",3,"ngModel","ngModelChange","change"],[1,"w-16"],["src","./assets/icons/column-height.svg"],[1,"flex","flex-col"],["type","range","min","0","max","1","step","0.01",1,"mr-4",3,"ngModel","ngModelChange","change"],["src","./assets/icons/column-opacity.svg"],["src","./assets/icons/column-bottom-radius.svg"],["src","./assets/icons/column-selected-opacity.svg"],["src","./assets/icons/column-bottom-color.svg"],["src","./assets/icons/column-bottom-opacity.svg"],[1,"bg-white/90","mr-3","mt-3","mt-3","p-3","rounded-xl","flex","flex-col","text-setting-500",3,"ngClass"]],template:function(t,i){1&t&&(V(0,"section",0)(1,"div",1,2),Ee("resize",function(s){return i.onResize(s)},!1,_S),V(3,"div",3),ct(4,"img",4),V(5,"h2",5),Me(6,"\u4e09\u89d2\u5f62\u6a21\u5f0f"),Y()(),V(7,"div",6)(8,"div",7),ct(9,"img",8),V(10,"div",9)(11,"p"),Me(12,"\u5713\u67f1\u984f\u8272"),Y(),V(13,"div",10)(14,"input",11),Ee("ngModelChange",function(s){return i.columnSettings.columns.defaultColumn.color=s})("change",function(s){return i.changeColumn(s)}),Y(),V(15,"p",12),Me(16),Y()()()(),V(17,"div",7),ct(18,"img",13),V(19,"div",14)(20,"p"),Me(21,"\u5713\u67f1\u9ad8\u5ea6"),Y(),V(22,"div",10)(23,"input",15),Ee("ngModelChange",function(s){return i.columnSettings.columns.defaultColumn.heightScale=s})("change",function(s){return i.changeColumn(s)}),Y(),V(24,"p",12),Me(25),Y()()()(),V(26,"div",7),ct(27,"img",16),V(28,"div",14)(29,"p"),Me(30,"\u5713\u67f1\u900f\u660e\u5ea6"),Y(),V(31,"div",10)(32,"input",15),Ee("ngModelChange",function(s){return i.columnSettings.columns.defaultColumn.opacity=s})("change",function(s){return i.changeColumn(s)}),Y(),V(33,"p",12),Me(34),vv(35,"number"),Y()()()(),V(36,"div",7),ct(37,"img",17),V(38,"div",14)(39,"p"),Me(40,"\u5713\u67f1\u534a\u5f91"),Y(),V(41,"div",10)(42,"input",15),Ee("ngModelChange",function(s){return i.columnSettings.columns.defaultColumn.scale=s})("change",function(s){return i.changeColumn(s)}),Y(),V(43,"p",12),Me(44),Y()()()(),V(45,"div",7),ct(46,"img",18),V(47,"div",14)(48,"p"),Me(49,"\u9078\u4e2d\u7684\u5713\u67f1\u900f\u660e\u5ea6"),Y(),V(50,"div",10)(51,"input",15),Ee("ngModelChange",function(s){return i.columnSettings.columns.selectedColumn.opacity=s})("change",function(s){return i.changeColumn(s)}),Y(),V(52,"p",12),Me(53),vv(54,"number"),Y()()()()(),V(55,"div",6)(56,"div",7),ct(57,"img",19),V(58,"div",9)(59,"p"),Me(60,"\u5713\u67f1\u5e95\u9762\u984f\u8272"),Y(),V(61,"div",10)(62,"input",11),Ee("ngModelChange",function(s){return i.columnSettings.ground.color=s})("change",function(s){return i.changeColumn(s)}),Y(),V(63,"p",12),Me(64),Y()()()(),V(65,"div",7),ct(66,"img",20),V(67,"div",14)(68,"p"),Me(69,"\u5713\u67f1\u5e95\u9762\u900f\u660e\u5ea6"),Y(),V(70,"div",10)(71,"input",15),Ee("ngModelChange",function(s){return i.columnSettings.ground.opacity=s})("change",function(s){return i.changeColumn(s)}),Y(),V(72,"p",12),Me(73),Y()()()()(),V(74,"div",21)(75,"div",7),ct(76,"img",19),V(77,"div",9)(78,"p"),Me(79,"\u591a\u908a\u5f62\u984f\u8272"),Y(),V(80,"div",10)(81,"input",11),Ee("ngModelChange",function(s){return i.polygonSettings.color=s})("change",function(s){return i.changePolygon(s)}),Y(),V(82,"p",12),Me(83),Y()()()(),V(84,"div",7),ct(85,"img",20),V(86,"div",14)(87,"p"),Me(88,"\u591a\u908a\u5f62\u900f\u660e\u5ea6"),Y(),V(89,"div",10)(90,"input",15),Ee("ngModelChange",function(s){return i.polygonSettings.opacity=s})("change",function(s){return i.changePolygon(s)}),Y(),V(91,"p",12),Me(92),Y()()()()()()()),2&t&&(ne("ngStyle",ji(29,Mne,i.blurSource)),ie(3),ne("ngClass",ji(31,o_,i.isScrollBarShow)),ie(4),ne("ngClass",ji(33,o_,i.isScrollBarShow)),ie(7),ne("ngModel",i.columnSettings.columns.defaultColumn.color),ie(2),Gi(i.columnSettings.columns.defaultColumn.color),ie(7),ne("ngModel",i.columnSettings.columns.defaultColumn.heightScale),ie(2),Ei("",i.columnSettings.columns.defaultColumn.heightScale," KM"),ie(7),ne("ngModel",i.columnSettings.columns.defaultColumn.opacity),ie(2),Ei(" ",wv(35,23,100*i.columnSettings.columns.defaultColumn.opacity,"1.0-0")," % "),ie(8),ne("ngModel",i.columnSettings.columns.defaultColumn.scale),ie(2),Ei("",i.columnSettings.columns.defaultColumn.scale," KM"),ie(7),ne("ngModel",i.columnSettings.columns.selectedColumn.opacity),ie(2),Ei(" ",wv(54,26,100*i.columnSettings.columns.selectedColumn.opacity,"1.0-0")," % "),ie(2),ne("ngClass",ji(35,o_,i.isScrollBarShow)),ie(7),ne("ngModel",i.columnSettings.ground.color),ie(2),Gi(i.columnSettings.columns.defaultColumn.color),ie(7),ne("ngModel",i.columnSettings.ground.opacity),ie(2),Ei("",i.columnSettings.columns.defaultColumn.heightScale," KM"),ie(1),ne("ngClass",ji(37,o_,i.isScrollBarShow)),ie(7),ne("ngModel",i.polygonSettings.color),ie(2),Gi(i.columnSettings.polygon.color),ie(7),ne("ngModel",i.polygonSettings.opacity),ie(2),Ei("",i.columnSettings.polygon.opacity,"%"))},directives:[Rs,ud,Ka,kh,lu,fC],pipes:[ZD],styles:['input[type=color][_ngcontent-%COMP%]::-webkit-color-swatch-wrapper{padding:0}input[type=color][_ngcontent-%COMP%]::-webkit-color-swatch{border:none}input[type=color][_ngcontent-%COMP%]::-moz-color-swatch{border:none}input[type=range][_ngcontent-%COMP%]{-webkit-appearance:none;height:4px;outline:none;border-radius:30px;background:#8354bf;width:170px}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{-webkit-appearance:none;-moz-appearance:none;width:23px;height:23px;background:#8354BF;-moz-transition:.2s;transition:.2s;border-width:0px;border-radius:30px}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none;-moz-appearance:none;width:23px;height:23px;background:#8354BF;-webkit-transition:.2s;transition:.2s;border-width:0px;border-radius:30px}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb:before{position:absolute;top:3px;width:2000px;height:4px;content:"";pointer-events:none;-webkit-transition:.2s;transition:.2s}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb:after{position:absolute;top:3px;width:2000px;height:4px;content:"";pointer-events:none;-webkit-transition:.2s;transition:.2s}.glass-blur[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{max-height:calc(100vh - 9.8rem);overflow-y:auto}']}),n})();function Ene(n,e){if(1&n){const t=Gt();V(0,"button",3),Ee("click",function(){return je(t),Re().toggleShow()}),Me(1," \u8a2d\u5b9a "),ct(2,"img",4),Y()}}function Tne(n,e){if(1&n){const t=Gt();V(0,"button",3),Ee("click",function(){return je(t),Re().toggleShow()}),V(1,"p"),Me(2,"\u5132\u5b58\u8a2d\u5b9a"),Y(),ct(3,"img",5),Y()}}function Dne(n,e){if(1&n){const t=Gt();V(0,"div",6)(1,"app-map-pin-settings",7),Ee("pinChecked",function(r){return je(t),Re().onPinSelected(r)}),Y(),V(2,"app-map-3d-settings",8),Ee("columnChanged",function(r){return je(t),Re().onColumnChanged(r)})("polygonChanged",function(r){return je(t),Re().onPolygonChanged(r)}),Y()()}if(2&n){const t=Re();ie(1),ne("blurSource",t.blurSource)("setPins",t.pins)("setSelectedPins",t.selectedPins)("setPolygons",t.polygons),ie(1),ne("polygonSettings",t.polygonSettings)("columnSettings",t.columnSettings)("blurSource",t.blurSource)}}let Ane=(()=>{class n{constructor(t){this.animateService=t,this.columnChanged=new pt,this.polygonChanged=new pt,this.polygons=[],this.pins=[],this.hoveringPins=[],this.selectedPins=[],this.pinSelected=new pt,this.testValue=.5,this.blurSource="",this.showSettings=!1,this.toggleShow=()=>{this.showSettings=!this.showSettings,this.showSettings&&this.animateService.getCavasImage().pipe(Li(1)).subscribe(i=>{this.blurSource=`url(${i})`})},this.onPinSelected=i=>{this.pinSelected.emit(i)},this.onColumnChanged=i=>{this.columnChanged.emit(i)},this.onPolygonChanged=i=>{this.polygonChanged.emit(i)}}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)($(Ks))},n.\u0275cmp=Ci({type:n,selectors:[["app-map-settings"]],inputs:{columnSettings:"columnSettings",polygonSettings:"polygonSettings",polygons:"polygons",pins:"pins",hoveringPins:"hoveringPins",selectedPins:"selectedPins"},outputs:{columnChanged:"columnChanged",polygonChanged:"polygonChanged",pinSelected:"pinSelected"},decls:4,vars:3,consts:[[1,"flex","flex-col"],["class","tint-shadow-primary gradient-bg m-6 ml-auto bg-primary text-xl py-4 px-8 rounded-full flex items-center text-white pointer-events-auto",3,"click",4,"ngIf"],["class","flex",4,"ngIf"],[1,"tint-shadow-primary","gradient-bg","m-6","ml-auto","bg-primary","text-xl","py-4","px-8","rounded-full","flex","items-center","text-white","pointer-events-auto",3,"click"],["src","./assets/icons/tool.svg"],["src","./assets/icons/check.svg"],[1,"flex"],[1,"flex","float-right","flex-col","pr-4",3,"blurSource","setPins","setSelectedPins","setPolygons","pinChecked"],[3,"polygonSettings","columnSettings","blurSource","columnChanged","polygonChanged"]],template:function(t,i){1&t&&(V(0,"div",0),rt(1,Ene,3,0,"button",1),rt(2,Tne,4,0,"button",1),rt(3,Dne,3,7,"div",2),Y()),2&t&&(ie(1),ne("ngIf",!i.showSettings),ie(1),ne("ngIf",i.showSettings),ie(1),ne("ngIf",i.showSettings))},directives:[Is,xne,Sne],styles:[""]}),n})();const dO={type:"change"},bC={type:"start"},hO={type:"end"};class Ine extends Ro{constructor(e,t){super(),void 0===t&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new C,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.touches={ONE:0,TWO:2},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(R){R.addEventListener("keydown",E),this._domElementKeyEvents=R},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(dO),i.update(),s=r.NONE},this.update=function(){const R=new C,le=(new Yn).setFromUnitVectors(e.up,new C(0,1,0)),Ce=le.clone().invert(),_e=new C,I=new Yn,xe=2*Math.PI;return function(){const qe=i.object.position;R.copy(qe).sub(i.target),R.applyQuaternion(le),a.setFromVector3(R),i.autoRotate&&s===r.NONE&&z(function A(){return 2*Math.PI/60/60*i.autoRotateSpeed}()),i.enableDamping?(a.theta+=l.theta*i.dampingFactor,a.phi+=l.phi*i.dampingFactor):(a.theta+=l.theta,a.phi+=l.phi);let fe=i.minAzimuthAngle,re=i.maxAzimuthAngle;return isFinite(fe)&&isFinite(re)&&(fe<-Math.PI?fe+=xe:fe>Math.PI&&(fe-=xe),re<-Math.PI?re+=xe:re>Math.PI&&(re-=xe),a.theta=fe<=re?Math.max(fe,Math.min(re,a.theta)):a.theta>(fe+re)/2?Math.max(fe,a.theta):Math.min(re,a.theta)),a.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,a.phi)),a.makeSafe(),a.radius*=c,a.radius=Math.max(i.minDistance,Math.min(i.maxDistance,a.radius)),!0===i.enableDamping?i.target.addScaledVector(u,i.dampingFactor):i.target.add(u),R.setFromSpherical(a),R.applyQuaternion(Ce),qe.copy(i.target).add(R),i.object.lookAt(i.target),!0===i.enableDamping?(l.theta*=1-i.dampingFactor,l.phi*=1-i.dampingFactor,u.multiplyScalar(1-i.dampingFactor)):(l.set(0,0,0),u.set(0,0,0)),c=1,!!(d||_e.distanceToSquared(i.object.position)>o||8*(1-I.dot(i.object.quaternion))>o)&&(i.dispatchEvent(dO),_e.copy(i.object.position),I.copy(i.object.quaternion),d=!1,!0)}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",ee),i.domElement.removeEventListener("pointerdown",de),i.domElement.removeEventListener("pointercancel",ze),i.domElement.removeEventListener("wheel",jt),i.domElement.removeEventListener("pointermove",Te),i.domElement.removeEventListener("pointerup",we),null!==i._domElementKeyEvents&&i._domElementKeyEvents.removeEventListener("keydown",E)};const i=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=r.NONE;const o=1e-6,a=new jN,l=new jN;let c=1;const u=new C;let d=!1;const h=new j,f=new j,p=new j,_=new j,y=new j,g=new j,m=new j,v=new j,w=new j,b=[],T={};function P(){return Math.pow(.95,i.zoomSpeed)}function z(R){l.theta-=R}function N(R){l.phi-=R}const x=function(){const R=new C;return function(Ce,_e){R.setFromMatrixColumn(_e,0),R.multiplyScalar(-Ce),u.add(R)}}(),D=function(){const R=new C;return function(Ce,_e){!0===i.screenSpacePanning?R.setFromMatrixColumn(_e,1):(R.setFromMatrixColumn(_e,0),R.crossVectors(i.object.up,R)),R.multiplyScalar(Ce),u.add(R)}}(),L=function(){const R=new C;return function(Ce,_e){const I=i.domElement;if(i.object.isPerspectiveCamera){R.copy(i.object.position).sub(i.target);let ye=R.length();ye*=Math.tan(i.object.fov/2*Math.PI/180),x(2*Ce*ye/I.clientHeight,i.object.matrix),D(2*_e*ye/I.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(x(Ce*(i.object.right-i.object.left)/i.object.zoom/I.clientWidth,i.object.matrix),D(_e*(i.object.top-i.object.bottom)/i.object.zoom/I.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function O(R){i.object.isPerspectiveCamera?c/=R:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom*R)),i.object.updateProjectionMatrix(),d=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function U(R){i.object.isPerspectiveCamera?c*=R:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/R)),i.object.updateProjectionMatrix(),d=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function B(R){h.set(R.clientX,R.clientY)}function F(R){_.set(R.clientX,R.clientY)}function xt(){1===b.length?h.set(b[0].pageX,b[0].pageY):h.set(.5*(b[0].pageX+b[1].pageX),.5*(b[0].pageY+b[1].pageY))}function He(){1===b.length?_.set(b[0].pageX,b[0].pageY):_.set(.5*(b[0].pageX+b[1].pageX),.5*(b[0].pageY+b[1].pageY))}function J(){const R=b[0].pageX-b[1].pageX,le=b[0].pageY-b[1].pageY,Ce=Math.sqrt(R*R+le*le);m.set(0,Ce)}function Ae(R){if(1==b.length)f.set(R.pageX,R.pageY);else{const Ce=Q(R);f.set(.5*(R.pageX+Ce.x),.5*(R.pageY+Ce.y))}p.subVectors(f,h).multiplyScalar(i.rotateSpeed);const le=i.domElement;z(2*Math.PI*p.x/le.clientHeight),N(2*Math.PI*p.y/le.clientHeight),h.copy(f)}function Ie(R){if(1===b.length)y.set(R.pageX,R.pageY);else{const le=Q(R);y.set(.5*(R.pageX+le.x),.5*(R.pageY+le.y))}g.subVectors(y,_).multiplyScalar(i.panSpeed),L(g.x,g.y),_.copy(y)}function _t(R){const le=Q(R),Ce=R.pageX-le.x,_e=R.pageY-le.y,I=Math.sqrt(Ce*Ce+_e*_e);v.set(0,I),w.set(0,Math.pow(v.y/m.y,i.zoomSpeed)),O(w.y),m.copy(v)}function de(R){!1!==i.enabled&&(0===b.length&&(i.domElement.setPointerCapture(R.pointerId),i.domElement.addEventListener("pointermove",Te),i.domElement.addEventListener("pointerup",we)),function he(R){b.push(R)}(R),"touch"===R.pointerType?function M(R){switch(Fe(R),b.length){case 1:switch(i.touches.ONE){case 0:if(!1===i.enableRotate)return;xt(),s=r.TOUCH_ROTATE;break;case 1:if(!1===i.enablePan)return;He(),s=r.TOUCH_PAN;break;default:s=r.NONE}break;case 2:switch(i.touches.TWO){case 2:if(!1===i.enableZoom&&!1===i.enablePan)return;(function St(){i.enableZoom&&J(),i.enablePan&&He()})(),s=r.TOUCH_DOLLY_PAN;break;case 3:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function et(){i.enableZoom&&J(),i.enableRotate&&xt()})(),s=r.TOUCH_DOLLY_ROTATE;break;default:s=r.NONE}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(bC)}(R):function Le(R){let le;switch(R.button){case 0:le=i.mouseButtons.LEFT;break;case 1:le=i.mouseButtons.MIDDLE;break;case 2:le=i.mouseButtons.RIGHT;break;default:le=-1}switch(le){case 1:if(!1===i.enableZoom)return;(function q(R){m.set(R.clientX,R.clientY)})(R),s=r.DOLLY;break;case 0:if(R.ctrlKey||R.metaKey||R.shiftKey){if(!1===i.enablePan)return;F(R),s=r.PAN}else{if(!1===i.enableRotate)return;B(R),s=r.ROTATE}break;case 2:if(R.ctrlKey||R.metaKey||R.shiftKey){if(!1===i.enableRotate)return;B(R),s=r.ROTATE}else{if(!1===i.enablePan)return;F(R),s=r.PAN}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(bC)}(R))}function Te(R){!1!==i.enabled&&("touch"===R.pointerType?function X(R){switch(Fe(R),s){case r.TOUCH_ROTATE:if(!1===i.enableRotate)return;Ae(R),i.update();break;case r.TOUCH_PAN:if(!1===i.enablePan)return;Ie(R),i.update();break;case r.TOUCH_DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;(function G(R){i.enableZoom&&_t(R),i.enablePan&&Ie(R)})(R),i.update();break;case r.TOUCH_DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function se(R){i.enableZoom&&_t(R),i.enableRotate&&Ae(R)})(R),i.update();break;default:s=r.NONE}}(R):function ot(R){if(!1!==i.enabled)switch(s){case r.ROTATE:if(!1===i.enableRotate)return;!function Z(R){f.set(R.clientX,R.clientY),p.subVectors(f,h).multiplyScalar(i.rotateSpeed);const le=i.domElement;z(2*Math.PI*p.x/le.clientHeight),N(2*Math.PI*p.y/le.clientHeight),h.copy(f),i.update()}(R);break;case r.DOLLY:if(!1===i.enableZoom)return;!function oe(R){v.set(R.clientX,R.clientY),w.subVectors(v,m),w.y>0?O(P()):w.y<0&&U(P()),m.copy(v),i.update()}(R);break;case r.PAN:if(!1===i.enablePan)return;!function ae(R){y.set(R.clientX,R.clientY),g.subVectors(y,_).multiplyScalar(i.panSpeed),L(g.x,g.y),_.copy(y),i.update()}(R)}}(R))}function we(R){Se(R),0===b.length&&(i.domElement.releasePointerCapture(R.pointerId),i.domElement.removeEventListener("pointermove",Te),i.domElement.removeEventListener("pointerup",we)),i.dispatchEvent(hO),s=r.NONE}function ze(R){Se(R)}function jt(R){!1===i.enabled||!1===i.enableZoom||s!==r.NONE||(R.preventDefault(),i.dispatchEvent(bC),function ce(R){R.deltaY<0?U(P()):R.deltaY>0&&O(P()),i.update()}(R),i.dispatchEvent(hO))}function E(R){!1===i.enabled||!1===i.enablePan||function Oe(R){let le=!1;switch(R.code){case i.keys.UP:L(0,i.keyPanSpeed),le=!0;break;case i.keys.BOTTOM:L(0,-i.keyPanSpeed),le=!0;break;case i.keys.LEFT:L(i.keyPanSpeed,0),le=!0;break;case i.keys.RIGHT:L(-i.keyPanSpeed,0),le=!0}le&&(R.preventDefault(),i.update())}(R)}function ee(R){!1!==i.enabled&&R.preventDefault()}function Se(R){delete T[R.pointerId];for(let le=0;le<b.length;le++)if(b[le].pointerId==R.pointerId)return void b.splice(le,1)}function Fe(R){let le=T[R.pointerId];void 0===le&&(le=new j,T[R.pointerId]=le),le.set(R.pageX,R.pageY)}function Q(R){return T[(R.pointerId===b[0].pointerId?b[1]:b[0]).pointerId]}i.domElement.addEventListener("contextmenu",ee),i.domElement.addEventListener("pointerdown",de),i.domElement.addEventListener("pointercancel",ze),i.domElement.addEventListener("wheel",jt,{passive:!1}),this.update()}}function fO(n,e){return e?t=>bp(e.pipe(Li(1),function Rne(){return Ln((n,e)=>{n.subscribe(new Mn(e,fu))})}()),t.pipe(fO(n))):sn((t,i)=>n(t,i).pipe(Li(1),function Pne(n){return tt(()=>n)}(t)))}function xC(n,e=wC){const t=function Lne(n=0,e,t=Hte){let i=-1;return null!=e&&(QC(e)?t=e:i=e),new en(r=>{let s=function Nne(n){return n instanceof Date&&!isNaN(n)}(n)?+n-t.now():n;s<0&&(s=0);let o=0;return t.schedule(function(){r.closed||(r.next(o++),0<=i?this.schedule(void 0,i):r.complete())},s)})}(n,e);return fO(()=>t)}let One=(()=>{class n{constructor(){this.makeScene=()=>{const t=new wh;return t.background=new me(16772846),t}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ne({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Fne=(()=>{class n{constructor(){this.renderer=new Pt({precision:"lowp",antialias:!0}),this.makeRenderer=(t,i)=>(this.renderer.setSize(i.x,i.y),t.nativeElement.appendChild(this.renderer.domElement),this.renderer.domElement.id="canvas",this.renderer),this.updateMouse=t=>new j((t.clientX-this.renderer.domElement.offsetLeft)/this.renderer.domElement.width*2-1,-(t.clientY-this.renderer.domElement.offsetTop)/this.renderer.domElement.height*2+1)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ne({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),kne=(()=>{class n{constructor(){this.makeCamera=t=>{const i=new Hn(45,t.x/t.y,.01,1e3);return i.position.set(20,20,10),i},this.makeOrthographicCamera=(t=600,i=450)=>{const r=new yh(t/-2,t/2,i/2,i/-2,1,1e3);return r.position.set(80,80,80),r}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ne({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Bne=(()=>{class n{constructor(){this.makeLight=t=>{this.makeAmbientLight(t),this.makePointLight(t)},this.makePointLight=t=>{const i=new Ux(16777215,.5);i.position.set(40,20,10);const r=new Eee(i,5,0);t.add(i),t.add(r)},this.makeAmbientLight=t=>{const i=new Hx(16777215,.7);i.position.set(0,20,10),t.add(i)}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ne({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Une=(()=>{class n{constructor(t){var i=this;this.httpClient=t,this.textureMapppingCacheAndId=[],this.applyTexture=function(){var r=Je(function*(s){for(const o of s){const a=yield i.getTextureFromCache(o.id),l=i.arrayBufferToBase64(a),c=yield i.getTextureByTextureLoader(l);if(!o.mesh)throw new Error("no mesh to apply texture!");o.mesh.material.map=c,o.mesh.material.needsUpdate=!0}});return function(s){return r.apply(this,arguments)}}(),this.getTextureFromCache=function(){var r=Je(function*(s){const o=i.textureMapppingCacheAndId.find(a=>i.isTileIdEqualInTextureService(s,a.id));if(o)return console.log(o),o.texture;{console.log("get from internet");const a=yield i.getTextureBuffer(s);return i.textureMapppingCacheAndId.push({id:s,texture:a}),a}});return function(s){return r.apply(this,arguments)}}(),this.getTextureBuffer=function(){var r=Je(function*(s){return function Vne(n,e){const t="object"==typeof e;return new Promise((i,r)=>{const s=new Qh({next:o=>{i(o),s.unsubscribe()},error:r,complete:()=>{t?i(e.defaultValue):r(new ql)}});n.subscribe(s)})}(i.httpClient.get(`https://api.mapbox.com/styles/v1/mapbox/light-v10/tiles/512/${s.z}/${s.x}/${s.y}?access_token=pk.eyJ1IjoidW1hc3Nzc3MiLCJhIjoiY2wwb3l2cHB6MHhwdDNqbnRiZnV1bnF5MyJ9.oh8mJyUQCRsnvOurebxe7w`,{responseType:"arraybuffer"}))});return function(s){return r.apply(this,arguments)}}(),this.applyMockTexture=function(){var r=Je(function*(s){for(const o of s){const a=()=>Math.floor(255*Math.random()),l=a().toString(16),c=a().toString(16),u=a().toString(16),d=new me(+("0x"+l+c+u));if(!o.mesh)throw new Error("no mesh to apply texture!");o.mesh.material.color=d,o.mesh.material.needsUpdate=!0}return ts(Be("").pipe(xC(100)))});return function(s){return r.apply(this,arguments)}}(),this.arrayBufferToBase64=r=>{let s="";const o=new Uint8ClampedArray(r),a=o.byteLength;for(let l=0;l<a;l++)s+=String.fromCharCode(o[l]);return"data:image/jpg;base64,"+window.btoa(s)},this.applyDisplacementTexture=function(){var r=Je(function*(s){s.forEach(function(){var o=Je(function*(a,l){const c=i.getHeightTileSrc(a.id.z,a.id.x,a.id.y),u=i.getHeightTileSrc(a.id.z,a.id.x-1,a.id.y),d=i.getHeightTileSrc(a.id.z,a.id.x,a.id.y-1),{canvas:h,imageData:f,leftImageData:p,topImageData:_}=yield i.loadImagesFromSrc(c,u,d),y=yield i.getHeightDataUrl(h,f,p,_);if(!a.mesh)throw new Error("no mesh to apply height texture");const g=yield i.getTextureByTextureLoader(y);a.mesh.material.displacementMap=g,a.mesh.material.needsUpdate=!0});return function(a,l){return o.apply(this,arguments)}}())});return function(s){return r.apply(this,arguments)}}(),this.getTextureByTextureLoader=function(){var r=Je(function*(s){return yield(new bN).loadAsync(s)});return function(s){return r.apply(this,arguments)}}(),this.loadImagesFromSrc=(r,s,o)=>new Promise((a,l)=>{this.loadImage(r,(c,u)=>{this.loadImage(s,d=>{this.loadImage(o,h=>{a({canvas:u,imageData:c,leftImageData:d,topImageData:h})})})})}),this.loadImage=(r,s)=>{var o=new Image;o.crossOrigin="Anonymous",o.onload=()=>{const a=this.createCanvasFromImage(o),l=a.getContext("2d");if(!l)throw new Error("no context");const c=l.getImageData(0,0,256,256);s(c,a)},o.src=r,(o.complete||void 0===o.complete)&&(o.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",o.src=r)},this.createCanvasFromImage=r=>{const s=document.createElement("CANVAS"),o=s.getContext("2d");return s.height=256,s.width=256,o.drawImage(r,0,0),s},this.getHeightDataUrl=(r,s,o,a)=>new Promise((l,c)=>{this.convertRawToHeight(s,o,a);const u=r.getContext("2d");if(!u)throw new Error("No Context!");u.putImageData(s,0,0),l(r.toDataURL("png"))}),this.convertRawToHeight=(r,s,o)=>{for(let a=0;a<o.width;a++){const l=this.getBottomEdgePxPosition(o,a);this.setupHeight(l,o,r,a,0)}for(let a=1;a<r.height;a++){const l=this.getRightEdgePxPosition(s,a);this.setupHeight(l,s,r,0,a);for(let c=1;c<r.width;c++)this.setupHeight(a*r.width+c,r,r,c,a)}},this.getRightEdgePxPosition=(r,s)=>r.width*(s+1)-1,this.getBottomEdgePxPosition=(r,s)=>(r.height-1)*r.width+s,this.setupHeight=(r,s,o,a,l)=>{const c=this.getHeight(r,s);this.applytHeight(o,a,l,c)},this.getHeight=(r,s)=>{const o=4*r;return this.getHeightFromColors(s.data[o],s.data[o+1],s.data[o+2])},this.getHeightFromColors=(r,s,o)=>Math.floor((.1*(256*r*256+256*s+o)-1e4+10.8)/3800*256),this.applytHeight=(r,s,o,a)=>{const l=4*(o*r.width+s);r.data[l]=a,r.data[l+1]=a,r.data[l+2]=a},this.getHeightTileSrc=(r,s,o)=>(console.log({z:r,x:s,y:o}),`http://localhost:3000/${r}/${s}/${o}.pngraw`),this.isTileIdEqualInTextureService=(r,s)=>r.x===s.x&&r.y===s.y&&r.z===s.z}}return n.\u0275fac=function(t){return new(t||n)(pe(Ed))},n.\u0275prov=Ne({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),CC=(()=>{class n{constructor(t,i){var r=this;this.animateService=t,this.textureService=i,this.initTileId={x:212,y:108,z:8},this.isTileEqual=(s,o)=>s.id.x===o.id.x&&s.id.y===o.id.y&&s.id.z===o.id.z,this.isTileIdEqual=(s,o)=>s.x===o.x&&s.y===o.y&&s.z===o.z,this.tilesFilterDuplicateByIds=s=>{const o=[];return s.forEach(a=>{o.some(c=>this.isTileIdEqual(c,a))||o.push(a)}),o},this.tilesFilterDuplicate=s=>{const o=[];return s.forEach(a=>{o.some(c=>this.isTileIdEqual(a.id,c.id))||o.push(a)}),o},this.tilesFarToCamera=(s,o)=>s.filter(a=>{if(a.mesh)return(new C).subVectors(a.mesh.position,o).length()>20*this.getDistanceThresholdOfTileToCamera(a);throw new Error("there are tiles missing mesh in runtime")}),this.getTileById=(s,o)=>s.find(a=>this.isTileIdEqual(a.id,o)),this.getIdFromChildTile=s=>({z:s.z-1,x:Math.floor(s.x/2),y:Math.floor(s.y/2)}),this.initTileMeshById=s=>{const o=[];for(const a of s){const c=Math.pow(2,a.z-8),u=12/c,h=this.getPlane(u,`planeZ${a.z}X${a.x}Y${a.y}`),p=this.initTileId.y*c,_=.5;h.position.setX((a.x-this.initTileId.x*c+_)*u),h.position.setZ((a.y-p+_)*u),h.rotateX(.5*-Math.PI),o.push({id:a,mesh:h})}return o},this.addTilesById=function(){var s=Je(function*(o,a,l){const c=yield r.getTileMeshById(o);return a.push(...c),r.updateTileToRaycaster(a),r.addTilesToScene(c,l),a});return function(o,a,l){return s.apply(this,arguments)}}(),this.addChildTile=function(){var s=Je(function*(o,a,l){const c=r.calculateChildTileIdsFromIds(o);return yield r.addTilesById(c,a,l)});return function(o,a,l){return s.apply(this,arguments)}}(),this.addTilesToScene=(s,o)=>{s.forEach(a=>{if(!a.mesh)throw new Error("no mesh to add to scene");o.add(a.mesh)})},this.getTileMeshById=function(){var s=Je(function*(o){const a=r.initTileMeshById(o);return yield r.textureService.applyTexture(a),a});return function(o){return s.apply(this,arguments)}}(),this.getPlane=(s=50,o="planeDefalut")=>{const a=new Gc(s,s,100,100),l=new kg({color:16777215,side:2}),c=new nn(a,l);return c.name=o,c},this.removeTileFromModalById=(s,o)=>o.filter(a=>!this.isTileIdEqual(a.id,s)),this.removeTileFromScene=s=>s.removeFromParent(),this.removeTile=(s,o)=>{if(s.mesh)return this.removeTileFromScene(s.mesh),this.removeTileFromModalById(s.id,o);throw new Error("No mesh to remove tile")},this.removeTileById=(s,o,a)=>{const c=new RegExp(`planeZ${s.z}X${s.x}Y${s.y}`),u=a.children.find(d=>c.test(d.name));if(u)return this.removeTileFromScene(u),this.removeTileFromModalById(s,o);throw console.error(JSON.stringify(s),(new Date).toISOString()),new Error("no tile to remove")},this.removeTileByIds=(s,o,a)=>(s.forEach(l=>{o=this.removeTileById(l,o,a)}),o),this.calculateChildTileIdsFromId=s=>{const o=[];for(let a=0;a<2;a++)for(let l=0;l<2;l++)o.push({z:s.z+1,x:2*s.x+a,y:2*s.y+l});return o},this.calculateChildTileIdsFromIds=s=>{const o=[];return s.forEach(a=>{const l=this.calculateChildTileIdsFromId(a);o.push(...l)}),o},this.getTileCenter=s=>{const o=Math.pow(2,s.id.z-8),a=1/o*12,l=a/2;return new C(a*(s.id.x-this.initTileId.x*o)+l,0,a*(s.id.y-this.initTileId.y*o)+l)},this.getTileCorner=s=>{const o=Math.pow(2,s.id.z-8),a=1/o*12;return new C(a*(s.id.x-this.initTileId.x*o),0,a*(s.id.y-this.initTileId.y*o))},this.isAnyTileCloseToCamera=(s,o)=>(u=>{const d=[],h=o.position.clone();return u.forEach(p=>(p=>{if(p.mesh){const _=h.distanceTo(p.mesh.position);d.push({tile:p,distance:_})}else console.error("no mesh to child")})(p)),d})(s).some(({tile:u,distance:d})=>(console.log(u.id.z,this.getDistanceThresholdOfTileToCamera(u)),d<this.getDistanceThresholdOfTileToCamera(u))),this.getDistanceThresholdOfTileToCamera=s=>{switch(s.id.z){case 9:return 4;case 8:return 10;default:return 10/((s.id.z-8)*(s.id.z-8))-1/(s.id.z-8)-.14}},this.tilesFarToCanvasCenter=(s,o)=>s.filter(a=>{const l=this.getTileCenter(a),c=this.getTileCorner(a);return(new C).subVectors(l,o).length()>2*(new C).subVectors(l,c).length()*4}),this.tilesCloseToCanvasCenter=(s,o)=>s.filter(a=>{const l=this.getTileCenter(a),c=this.getTileCorner(a);return(new C).subVectors(l,o).length()<2*(new C).subVectors(l,c).length()}),this.updateTileToRaycaster=s=>{const o=s.map(a=>a.mesh);this.animateService.removeIntersetObject("plane"),this.animateService.passIntersetObject(o)}}}return n.\u0275fac=function(t){return new(t||n)(pe(Ks),pe(Une))},n.\u0275prov=Ne({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Hne=(()=>{class n{constructor(t,i){var r=this;this.tileUtilsService=t,this.animateService=i,this.onUserUpdateCamera=new Gn(""),this.initTileIdsOfLevel8=()=>{const s=[];for(let o=0;o<4;o++)for(let a=0;a<5;a++)s.push({x:this.tileUtilsService.initTileId.x+o,y:this.tileUtilsService.initTileId.y+a,z:this.tileUtilsService.initTileId.z});return s},this.initTileMesh=s=>{for(const o of s){const l=Math.pow(2,o.id.z-8),c=12/l,d=this.tileUtilsService.getPlane(c,`planeZ${o.id.z}X${o.id.x}Y${o.id.y}`),f=this.tileUtilsService.initTileId.y*l,p=.5;d.position.setX((o.id.x-this.tileUtilsService.initTileId.x*l+p)*c),d.position.setZ((o.id.y-f+p)*c),d.rotateX(.5*-Math.PI),o.mesh=d}},this.initOnUserUpdateResolution=()=>{this.onUserUpdateCamera.pipe(Kr(s=>Be(s).pipe(xC(1e3)))).pipe(Ns(()=>this.queueToUpdateResolution.pipe(Li(1)))).subscribe()},this.checkSiblingsCanMerge=(s,o)=>{const a=c=>c.map(h=>{const f=o.some(p=>this.tileUtilsService.isTileIdEqual(h,p.id));return{tile:h,isExist:f}}).every(h=>h.isExist);return s.filter(c=>{const u=this.tileUtilsService.getIdFromChildTile(c.id);if(u){const d=this.tileUtilsService.calculateChildTileIdsFromId(u);return a(d)&&!0}return console.error("No parent tile"),!1})},this.mergeTile=function(){var s=Je(function*(o,a,l){const c=function(){var g=Je(function*(m,v){for(const w of m)w.z>7&&(v=yield r.tileUtilsService.addTilesById([w],v,l));return v});return function(v,w){return g.apply(this,arguments)}}(),f=o.map(g=>r.tileUtilsService.getIdFromChildTile(g.id)),p=r.tileUtilsService.tilesFilterDuplicateByIds(f),_=r.tileUtilsService.calculateChildTileIdsFromIds(p);let y=p.map(g=>({id:g}));return a=yield c(p,a),y=(g=>{for(const m of g)m.id.z>7&&m.mesh&&m.mesh.traverse(v=>{v.visible=!1});return g})(y),((g,m)=>{for(const v of g){const w=m.find(b=>r.tileUtilsService.isTileIdEqual(b.id,v));if(!(null==w?void 0:w.mesh))throw new Error("incorrect tile mesh mapping");w.mesh.traverse(b=>{b.visible=!0})}})(p,a=((g,m)=>{for(const v of g){const w=r.tileUtilsService.getTileById(m,v);if(!(null==w?void 0:w.mesh))throw new Error("incorrect tile mesh mapping");w.id.z>8&&(m=r.tileUtilsService.removeTile(w,m))}return m})(_,a)),a});return function(o,a,l){return s.apply(this,arguments)}}(),this.getMergingTiles=(s,o,a)=>{const l=this.tileUtilsService.tilesFarToCamera(s,o),c=this.tileUtilsService.tilesFarToCanvasCenter(s,a);let u=[];return u.push(...c,...l),u=this.tileUtilsService.tilesFilterDuplicate(u),u=this.checkSiblingsCanMerge(u,s),u=u.filter(d=>d.id.z>8),u},this.splitTiles=function(){var s=Je(function*(o,a,l){const c=o.map(u=>u.id);return a=yield r.tileUtilsService.addChildTile(c,a,l),r.tileUtilsService.removeTileByIds(c,a,l)});return function(o,a,l){return s.apply(this,arguments)}}(),this.updateTilesResolution=function(){var s=Je(function*(o,a,l){const c=function(){var h=Je(function*(f,p){let _=r.tileUtilsService.tilesCloseToCanvasCenter(f,p),y=r.tileUtilsService.isAnyTileCloseToCamera(_,l),g=_.length>0&&y;for(;g;){try{f=yield r.splitTiles(_,f,a)}catch(m){console.warn("abandon removing ",_.map(v=>JSON.stringify(v.id)).join(", "))}y=r.tileUtilsService.isAnyTileCloseToCamera(_,l),_=r.tileUtilsService.tilesCloseToCanvasCenter(f,p),g=_.length>0&&y}return f});return function(p,_){return h.apply(this,arguments)}}(),u=function(){var h=Je(function*(f,p){let _=r.getMergingTiles(f,l.position,p);for(;0!==_.length;)try{f=yield r.mergeTile(_,f,a),_=r.getMergingTiles(f,l.position,p)}catch(y){console.warn("abandon merging"),console.warn(y)}return f});return function(p,_){return h.apply(this,arguments)}}(),d=r.animateService.getCanvasCenter();return d&&(o=yield c(o,d),o=yield u(o,d)),o});return function(o,a,l){return s.apply(this,arguments)}}()}}return n.\u0275fac=function(t){return new(t||n)(pe(CC),pe(Ks))},n.\u0275prov=Ne({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),pO=(()=>{class n{constructor(){this.intLonLat2Tile=(t,i,r)=>({x:this.intLon2tile(t,r),y:this.intLat2tile(i,r),zoom:r}),this.intLon2tile=(t,i)=>Math.floor((t+180)/360*Math.pow(2,i)),this.intLat2tile=(t,i)=>{const r=Math.PI;return Math.floor((1-Math.log(Math.tan(t*r/180)+1/Math.cos(t*r/180))/r)/2*Math.pow(2,i))},this.lonLat2Tile=(t,i,r)=>({x:this.lon2tile(t,r),y:this.lat2tile(i,r),zoom:r}),this.lon2tile=(t,i)=>(t+180)/360*Math.pow(2,i),this.lat2tile=(t,i)=>{const r=Math.PI;return(1-Math.log(Math.tan(t*r/180)+1/Math.cos(t*r/180))/r)/2*Math.pow(2,i)},this.tile2lon=(t,i)=>t/Math.pow(2,i)*360-180,this.tile2lat=(t,i)=>{var r=Math.PI,s=r-2*r*t/Math.pow(2,i);return 180/r*Math.atan(.5*(Math.exp(s)-Math.exp(-s)))}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ne({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),zne=(()=>{class n{constructor(){this.mappingPinAndTable=(t,i)=>([...this.filterMappedPins(t,i,!0),...this.filterMappedRows(t,i,!0)].length&&console.error("Unmapped pins or category rows detected"),{mappedPins:this.filterMappedPins(t,i,!1),mappedRows:this.filterMappedRows(t,i,!1)}),this.filterMappedRows=(t,i,r)=>t.filter(o=>{const a=i.some(l=>l.title===o.title);return r?!a:a}),this.filterMappedPins=(t,i,r)=>i.filter(o=>{const a=t.some(l=>o.title===l.title);return r?!a:a})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ne({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),mO=(()=>{class n{constructor(){this.isSamePins=(t,i)=>{const r=t.map(a=>+a.id).sort((a,l)=>a-l),s=i.map(a=>+a.id).sort((a,l)=>a-l);return JSON.stringify(r)===JSON.stringify(s)},this.isObjectAGroup=t=>t.children.find(r=>{var s;return null===(s=r.parent)||void 0===s?void 0:s.name.includes("group")}),this.aFilterFromB=(t,i)=>t.filter(s=>!i.some(a=>s.id===a.id)),this.findPinById=(t,i)=>i.map(r=>{const s=t.find(o=>o.id+""===r);if(!s)throw new Error("the raycasted group object is not found in this.pins");return s}),this.getMeshesById=(t,i)=>{const r=t.find(o=>o.id===i),s=null==r?void 0:r.mesh;if(s)return{column:this.getPinMeshInGroup(s,"column"),ground:this.getPinMeshInGroup(s,"ground")};throw new Error("No group found ")},this.mappingToGroups=t=>t.filter(i=>i.mesh).map(i=>i.mesh),this.filterGroupFromObjs=t=>t.filter(i=>this.isObjectAGroup(i)),this.filterDuplicateGroup=t=>{const i=[];return t.forEach(r=>{r&&(i.some(o=>o.name===(null==r?void 0:r.name))||i.push(r))}),i},this.getPinIdsFromIntersections=t=>{const r=t.map(l=>l.object).map(l=>l.parent).filter(l=>Boolean(l)),s=this.filterGroupFromObjs(r);return this.filterDuplicateGroup(s).map(l=>this.getPinIdFromGroup(l))},this.getPinIdFromGroup=t=>{const i=t.name.match(/(?=.+_?)\d+/);if(i&&i[0])return i[0];throw new Error("hovered pin has no valid id")},this.getPinMeshInGroup=(t,i)=>t.children.find(r=>r.name.includes(i)),this.getPinsDnc=(t,i,r)=>t.map(l=>{if(!l.position3d)throw new Error("no position in selected pin");const c=l.position3d.clone().project(r),u=((l,c)=>(l+1)/2*c)(c.x,i.x),d=((l,c)=>(1-l)/2*c)(c.y,i.y);return Object.assign(Object.assign({},l),{deviceCoordinate:new j(u,d)})}),this.testProject=(t,i)=>{const l=i.clone().project(t);return new j(300*l.x+300,-225*l.y+225)},this.testUnproject=(t,i)=>{const r=i;r.unproject(t);const s=(new C).subVectors(r,t.position).normalize();return s.multiplyScalar((0-t.position.z)/s.z),(new C).copy(t.position).add(s)}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ne({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),MC=(()=>{class n{constructor(t){this.pinUtilsService=t,this.createColumn3dLayers=(i,r)=>{const s=new za,o=this.getColumn3d(i,1,`pin_column_${i.id}_normalBlending`,r.columns.defaultColumn),a=this.getGround3d(i,1,`pin_ground_${i.id}`,r.ground,r.columns.defaultColumn.scale);return s.add(a),s.add(o),s.name="pin_group_"+i.id,s},this.parseStringColorToInt=i=>{const r=i.slice(1,3),s=i.slice(3,5),o=i.slice(5,7);return parseInt(`0x${r}${s}${o}`,16)},this.getGround3d=(i,r,s,o,a)=>{if(!i.position3d)throw new Error("No Longitude or latitude when initing mesh");const l=Math.pow(a,2),c=new Sh(l,18);c.rotateX(.5*-Math.PI),c.rotateY(Math.PI/18),c.translate(i.position3d.x,1e-4*i.id+1e-4,i.position3d.z);const d=new iu({transparent:!0,opacity:o.opacity,color:this.parseStringColorToInt(o.color),blending:r}),h=new nn(c,d);return h.name=s,h},this.getOutline3d=(i,r,s,o,a,l)=>{if(!i.position3d)throw new Error("No Longitude or latitude when initing mesh");const c=new Ex(l.geometry),u=new Ys(c,new Qn({color:this.parseStringColorToInt(a),opacity:o,transparent:!0,blending:r}));return u.name=s,u},this.getColumn3d=(i,r,s,o)=>{if(!i.position3d)throw new Error("No Longitude or latitude when initing mesh");let a;a=new iu({transparent:!0,opacity:o.opacity,color:this.parseStringColorToInt(o.color),blending:r,depthWrite:!1});const l=Math.pow(o.scale,2),c=Math.pow(o.scale,2),u=i.height*Math.pow(o.heightScale,2),f=new ja(l,c,u,18,5,!1),p=new nn(f,a);return p.geometry.translate(i.position3d.x,i.position3d.y+u/2-.01,i.position3d.z),p.name=s,p},this.setDepthWrite=(i,r,s)=>{i.forEach(o=>{s.forEach(a=>{this.pinUtilsService.getPinMeshInGroup(o,a).material.depthWrite=r})})},this.updatePinsStyle=(i,r,s=[],o)=>(console.log(`to selected style: ${o}`),(u=>{u.forEach(d=>{const{column:h}=this.pinUtilsService.getMeshesById(u,d.id);h.material.opacity=r.columns.defaultColumn.opacity,h.material.color=new me(this.parseStringColorToInt(r.columns.defaultColumn.color)),h.material.depthWrite=!1})})(s),(u=>{u.forEach(d=>{const{column:h}=this.pinUtilsService.getMeshesById(u,d.id);h.material.depthWrite=!0,h.material.opacity=r.columns.hoveredColumn.opacity,h.material.color=new me(this.parseStringColorToInt(r.columns.hoveredColumn.color))})})(i),(u=>{u.forEach(d=>{const{column:h}=this.pinUtilsService.getMeshesById(u,d.id);h.material.depthWrite=!0,h.material.opacity=r.columns.selectedColumn.opacity,h.material.color=new me(this.parseStringColorToInt(r.columns.selectedColumn.color))})})(o),i)}}return n.\u0275fac=function(t){return new(t||n)(pe(mO))},n.\u0275prov=Ne({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Gne=(()=>{class n{constructor(t,i,r,s,o,a,l){var c=this;this.tileLonLatCalculation=t,this.pinsTableService=i,this.categoryService=r,this.pinCategoryMapping=s,this.tileUtilsService=o,this.column3dService=a,this.animateService=l,this.initPinsModel=Je(function*(){const u=yield ts(c.pinsTableService.getPinLonLat());return console.log(u),c.createPinsModel(u)}),this.createPinsModel=u=>{const d=f=>new C(f.x,0,f.y),h=f=>{const p=f.x,y=this.tileLonLatCalculation.lat2tile(f.y,8),g=this.tileLonLatCalculation.lon2tile(p,8);return new j(y,g)};return u.map(f=>({id:f.pinData.id,height:.3,color:16718173,title:f.pinData.title,address:f.pinData.address,position3d:d(f.lonLat),positionTile:h(f.lonLat),positionLongLat:f.lonLat,radius:.1}))},this.applyPinHeightFromSetting=function(){var u=Je(function*(d,h){if(!d.valid)return;const f=yield c.categoryService.getTableFromSettings(d),{mappedPins:p,mappedRows:_}=c.pinCategoryMapping.mappingPinAndTable(f,h);return{setting:d,pins:h=c.updatePinHeightFromRows(p,_)}});return function(d,h){return u.apply(this,arguments)}}(),this.updatePinHeightFromRows=(u,d)=>(u.forEach(h=>{const f=d.find(_=>_.title===h.title);if(!f)throw new Error(`row is not found in pin ${h.title}`);const p=Number(f.value);if(!p)throw new Error(`value in row ${f.title} in not a number`);h.height=p}),u),this.updatePin3ds=(u,d,h)=>{this.removePins(u),this.initPins(u,d,h)},this.initPins=(u,d,h)=>{u.forEach(f=>{if(!f.positionLongLat)throw new Error("No Longitude or latitude");f.position3d=this.longLatToPosition3d(f.positionLongLat);const p=this.column3dService.createColumn3dLayers(f,h);this.animateService.passIntersetObject([p]),f.mesh=p,d.add(p)})},this.removePins=u=>{u.forEach(d=>{!d.mesh||(d.mesh.removeFromParent(),this.animateService.removeIntersetObject("pin"))})},this.longLatToPosition3d=u=>{const h=u.y,f=this.tileLonLatCalculation.lon2tile(u.x,8),p=this.tileLonLatCalculation.lat2tile(h,8);return new C(12*(f-this.tileUtilsService.initTileId.x),0,12*(p-this.tileUtilsService.initTileId.y))},this.updateSelectedPins=(u,d)=>{let f=[];return f=d.some(p=>p.id===u.id)?d.filter(p=>p.id!==u.id):[...d,u],f}}}return n.\u0275fac=function(t){return new(t||n)(pe(pO),pe(nL),pe(Fh),pe(zne),pe(CC),pe(MC),pe(Ks))},n.\u0275prov=Ne({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Wne=(()=>{class n{constructor(t){this.column3dService=t,this.createPolygons=(i,r)=>{const s=i.length,o=s%3==1&&s/3>1,l=i.slice(0,s-s%3),{models:c,meshes:u}=this.createTriangles(l,r);if(o){const d=i.slice(-4),{model:h,mesh:f}=this.createRectangle(d,r);c.push(h),u.push(f)}return{models:c,meshes:u}},this.removePolygons=i=>(i.forEach(r=>{if(!r.mesh)throw new Error("no mesh to remove");r.mesh.removeFromParent()}),[]),this.createRectangle=(i,r)=>{const s=this.createPolygonModel(i,el.rectangle,r),o=this.createRectangleMesh(s);return s.mesh=o,{model:s,mesh:o}},this.createTriangles=(i,r)=>{const s=[],o=[];for(let a=0;a<i.length;a+=3){const l=i.slice(a,a+3),c=this.createPolygonModel(l,el.triangle,r);c.mesh=this.createPolygonMesh(c),o.push(c.mesh),s.push(c)}return{meshes:o,models:s}},this.createPolygonModel=(i,r,s)=>({id:`polygon_${r}_${i.map(a=>a.id).join("_")}`,points:i,color:this.column3dService.parseStringColorToInt(s.color),opacity:s.opacity,type:r}),this.createRectangleMesh=i=>{const r=i.points.map(p=>{if(!p.position3d)throw new Error("a pin has no position when creating triangle polygon");return p.position3d}),o=r.reduce((p,_)=>p.clone().add(_)).multiplyScalar(.25),c=r.map((p,_)=>{const y=p.clone().sub(o),g=new j(y.x,y.z);return{position3d:p,slope:Math.atan2(g.y,g.x)/Math.PI}}).sort((p,_)=>p.slope-_.slope).map(({position3d:p})=>[p.x,p.z]);console.log(c);const u=new ls;u.moveTo(...c[0]),u.lineTo(...c[1]),u.lineTo(...c[2]),u.lineTo(...c[3]),u.lineTo(...c[0]);const d=new nu(u);d.rotateX(.5*Math.PI);const h=new iu({color:i.color,opacity:i.opacity,transparent:!0,side:2}),f=new nn(d,h);return f.name=i.id,f.position.setY(.005+.001*Math.random()),f},this.createPolygonMesh=i=>{const s=i.points.map(u=>{if(!u.position3d)throw new Error("a pin has no position when creating triangle polygon");return u.position3d}).map(u=>u.toArray()).flat(),o=new Float32Array(s),a=new Ve;a.setAttribute("position",new Ut(o,3));const l=new iu({color:i.color,opacity:i.opacity,transparent:!0,side:2}),c=new nn(a,l);return c.name=i.id,c.position.setY(.005+1e-4*Math.random()),c}}}return n.\u0275fac=function(t){return new(t||n)(pe(MC))},n.\u0275prov=Ne({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const jne=["canvasContainer"];function $ne(n,e){if(1&n){const t=Gt();V(0,"button",4),Ee("click",function(){return je(t),Re().resumeAnimation()}),Me(1,"Resume Animation"),Y()}}function qne(n,e){if(1&n){const t=Gt();V(0,"button",4),Ee("click",function(){return je(t),Re().pauseAnimation()}),Me(1,"Pause Animation"),Y()}}let Yne=(()=>{class n{constructor(t,i,r,s,o,a,l,c,u,d,h,f,p,_,y){var g=this;this.sceneService=t,this.rendererService=i,this.cameraService=r,this.animateService=s,this.lightService=o,this.tileService=a,this.tileUtilsService=l,this.tileLonLatCalculation=c,this.categoryService=u,this.activatedRoute=d,this.pinModelService=h,this.pinUtilsService=f,this.column3dService=p,this.polygon3dService=_,this.httpMapService=y,this.scene=new wh,this.renderer=new Pt,this.camera=new Hn,this.mousePosition=new j(0,0),this.tiles=[],this.lines=[],this.onUserUpdateCamera=new Gn(""),this.tilesToMerge=[],this.pins=[],this.isPaused=!1,this.hoveringPins=[],this.hoverPinChangeSuject=new Gn([]),this.hoverOnPin=new pt,this.canvasDimention=new j(window.innerWidth,window.innerHeight),this.screenRatio=2,this.selectedPins=[],this.polygons=[],this.polygonUpdate=new pt,this.selectedPinsWithDnc=[],this.selectedPinsWithDncEmitter=new pt,this.guiPolygonSettings={color:"#528bff",opacity:.6},this.guiColumnSettings=this.categoryService.mockSetting.options.meshSettings,this.initQueueToUpdateResolution=()=>{this.queueToUpdateResolution=new en(m=>{this.tileService.updateTilesResolution(this.tiles,this.scene,this.camera).then(v=>{this.tiles=v,m.next()})})},this.uiUpdatePin=m=>{console.log("pin updated"),this.pinModelService.updatePin3ds(this.pins,this.scene,this.guiColumnSettings),this.column3dService.updatePinsStyle(this.hoveringPins,this.guiColumnSettings,[],this.selectedPins)},this.onMouseIntersect=m=>{const v=this.pinUtilsService.getPinIdsFromIntersections(m),w=this.pinUtilsService.findPinById(this.pins,v);this.changeLegendText(w[0]),this.onPinsHovered(w)},this.onPinsHovered=m=>{m=m.slice(0,1);const v=this.pinUtilsService.mappingToGroups(m);this.column3dService.setDepthWrite(v,m.length>0,["column","ground"]),!this.pinUtilsService.isSamePins(this.hoveringPins||[],m)&&this.hoverPinChangeSuject.next(m)},this.changeLegendText=m=>{if(m){const v=this.getPositionOnHtml(this.mousePosition,this.canvasDimention);this.hoverOnPin.emit({pin:m,legendPosition:v})}else this.hoverOnPin.emit()},this.getPositionOnHtml=(m,v)=>new j((m.x+1)/2*v.x,(m.y-1)/2*v.y),this.getCategoryIdFromMapId=m=>{const v=Number(m);if(v||0===v)return this.httpMapService.getMap(v).pipe(tt(w=>w.defualtCategoryId));throw new Error("map id should be a number")},this.appendUrlStatusCode=m=>this.categoryService.getCategoryTableByUrl(`https://docs.google.com/spreadsheets/d/${m.tableSource}/gviz/tq?`).pipe(tt(v=>(m.valid=Boolean(200===v),m))),this.applySettings=m=>this.guiColumnSettings=m.options.meshSettings,this.initOnUserUpdateResolution=()=>{this.onUserUpdateCamera.pipe(Kr(m=>Be(m).pipe(xC(1e3)))).pipe(Ns(()=>this.queueToUpdateResolution.pipe(Li(1)))).subscribe()},this.onCategoryChageFromPicker=m=>{this.categoryService.getCategorySetting(m).pipe(sn(v=>this.appendUrlStatusCode(v)),sn(v=>this.pinModelService.applyPinHeightFromSetting(v,this.pins))).subscribe(v=>{v?(this.pins=v.pins,this.applySettings(v.setting),this.pinModelService.updatePin3ds(this.pins,this.scene,v.setting.options.meshSettings)):alert("\u8cc7\u6599\u4f86\u6e90\u932f\u8aa4\u3002\u8acb\u78ba\u4fdd\u5176Google Sheet\u5df2\u8a2d\u70ba\u516c\u958b")})},this.getCategoryIdFromRouteAsync=Je(function*(){return new Promise((m,v)=>{g.activatedRoute.paramMap.subscribe(w=>{const b=w.get("id");if(!b)throw new Error("No param specified in router");m(b)})})}),this.getCategoryIdFromRoute=()=>this.activatedRoute.paramMap.pipe(tt(m=>{const v=m.get("id");if(!v)throw new Error("No param specified in router");return v})),this.getBox=(m=5)=>{const v=new Vo(m,m,m),w=new $s({color:16711680});return new nn(v,w)},this.initThree=()=>{this.scene=this.sceneService.makeScene(),this.renderer=this.rendererService.makeRenderer(this.canvasContainer,this.canvasDimention),this.renderer.domElement.addEventListener("mousemove",this.onMouseMove),this.camera=this.cameraService.makeCamera(this.canvasDimention),this.scene.add(this.camera),this.orbitControl=new Ine(this.camera,this.renderer.domElement),this.orbitControl.target.set(20,5,20),this.orbitControl.update(),this.orbitControl.listenToKeyEvents(window),this.orbitControl.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.orbitControl.touches={ONE:2,TWO:0},this.orbitControl.addEventListener("change",this.onCameraChange),this.animateService.initAnimate(this.renderer,this.scene,this.camera,this.orbitControl,this.mousePosition),this.animateService.animate(),this.box=this.getBox(),this.plane=this.tileUtilsService.getPlane(),this.plane.rotateX(.5*-Math.PI),this.plane.position.setY(-.1),this.animateService.onFrameRender.subscribe(({})=>{}),this.lightService.makeLight(this.scene)},this.initTile=Je(function*(){const m=g.tileService.initTileIdsOfLevel8(),v=yield g.tileUtilsService.getTileMeshById(m);g.tileUtilsService.updateTileToRaycaster(v),g.tiles=v,g.tileUtilsService.addTilesToScene(v,g.scene)}),this.onMouseMove=function(){var m=Je(function*(v){const w=g.rendererService.updateMouse(v);g.mousePosition.set(w.x,w.y)});return function(v){return m.apply(this,arguments)}}(),this.onMouseScroll=Je(function*(){g.onUserUpdateCamera.next("")}),this.onMouseClick=Je(function*(){if(g.hoveringPins&&g.hoveringPins[0]){const v=g.hoveringPins[0];g.selectedPins=g.pinModelService.updateSelectedPins(v,g.selectedPins),g.updatePolygons(),g.changePinStyleOnClick(v),g.onCameraChange()}g.onUserUpdateCamera.next("")}),this.updatePolygons=()=>{this.polygons=this.polygon3dService.removePolygons(this.polygons);const{models:m,meshes:v}=this.polygon3dService.createPolygons(this.selectedPins,this.guiPolygonSettings);this.polygons.push(...m),this.polygonUpdate.emit(this.polygons),v.forEach(w=>this.scene.add(w))},this.showUnprojectPosition=(m,v)=>{const w=this.pinUtilsService.testUnproject(m,new C(v.x,v.y,v.z)),b=this.getBox(3);b.position.set(w.x,w.y,w.z),this.scene.add(b)},this.changePinStyleOnClick=m=>{const v=m.mesh;v&&(this.pinUtilsService.getPinMeshInGroup(v,"column").material.color=new me(0))},this.onCameraChange=()=>{this.selectedPinsWithDnc=this.pinUtilsService.getPinsDnc(this.selectedPins,this.canvasDimention,this.camera),this.selectedPinsWithDncEmitter.emit(this.selectedPinsWithDnc)},this.uiUpdatePolygon=m=>{this.updatePolygons(),console.log("update")},this.pauseAnimation=()=>{this.isPaused=!0,this.animateService.pauseAnimation()},this.resumeAnimation=()=>{this.isPaused=!1,this.animateService.resumeAnimation(),this.timeoutToPause()},this.timeoutToPause=()=>{setTimeout(()=>{this.pauseAnimation()},2e4)},this.initQueueToUpdateResolution()}set onPinSelected(t){if(t){const i=this.pinUtilsService.aFilterFromB(this.selectedPins,t);this.selectedPins=t,this.hoveringPins=this.column3dService.updatePinsStyle([],this.guiColumnSettings,i,this.selectedPins),this.updatePolygons(),setTimeout(()=>{this.onCameraChange()},0)}else console.warn("no pin selected when updating canvas")}ngOnInit(){var t=this;return Je(function*(){t.hoverPinChangeSuject.subscribe(i=>{t.hoveringPins=t.column3dService.updatePinsStyle(i,t.guiColumnSettings,t.hoveringPins,t.selectedPins),i=t.hoveringPins}),t.timeoutToPause(),t.initOnUserUpdateResolution(),t.animateService.onMouseIntersect.subscribe(i=>t.onMouseIntersect(i))})()}ngAfterViewInit(){var t=this;return Je(function*(){t.initThree(),t.canvasContainer.nativeElement.addEventListener("mousewheel",t.onMouseScroll),t.canvasContainer.nativeElement.addEventListener("click",t.onMouseClick),t.pins=yield t.pinModelService.initPinsModel(),yield t.initTile()})()}}return n.\u0275fac=function(t){return new(t||n)($(One),$(Fne),$(kne),$(Ks),$(Bne),$(Hne),$(CC),$(pO),$(Fh),$(fo),$(Gne),$(mO),$(MC),$(Wne),$(q0))},n.\u0275cmp=Ci({type:n,selectors:[["app-map-canvas"]],viewQuery:function(t,i){if(1&t&&Av(jne,5),2&t){let r;id(r=rd())&&(i.canvasContainer=r.first)}},inputs:{onPinSelected:"onPinSelected",onCategoryChageFromPicker:"onCategoryChageFromPicker"},outputs:{hoverOnPin:"hoverOnPin",polygonUpdate:"polygonUpdate",selectedPinsWithDncEmitter:"selectedPinsWithDncEmitter"},decls:5,vars:3,consts:[[1,"canvas-container"],["canvasContainer",""],[3,"ngSwitch"],[3,"click",4,"ngSwitchCase"],[3,"click"]],template:function(t,i){1&t&&(ct(0,"div",0,1),V(2,"div",2),rt(3,$ne,2,0,"button",3),rt(4,qne,2,0,"button",3),Y()),2&t&&(ie(2),ne("ngSwitch",i.isPaused),ie(1),ne("ngSwitchCase",!0),ie(1),ne("ngSwitchCase",!1))},directives:[mp,QD],styles:[".canvas-container[_ngcontent-%COMP%]{position:absolute;z-index:-1}"]}),n})();const gO=function(n,e){return{left:n,top:e}};function Xne(n,e){if(1&n&&(V(0,"p",7),Me(1),Y()),2&n){const t=Re();ne("ngStyle",yv(2,gO,t.hoverPin.legendPosition.x+"px",-t.hoverPin.legendPosition.y+"px")),ie(1),Ei(" ",t.hoverPin.pin.title,"\n")}}function Qne(n,e){if(1&n&&(V(0,"p",7),Me(1),Y()),2&n){const t=e.$implicit;ne("ngStyle",yv(2,gO,t.deviceCoordinate.x+"px",t.deviceCoordinate.y+"px")),ie(1),Ei(" ",t.title,"\n")}}const Jne=[{path:"",redirectTo:"/dashboard",pathMatch:"full"},{path:"map/:id",component:(()=>{class n{constructor(){this.selectedPin=[],this.pinsSelectedWithDnc=[],this.averageMoving=[],this.pins=[],this.changeHoverLegend=t=>{this.hoverPin=t},this.onPinSelected=t=>{const i=[...t];this.pinSelected=i},this.onSelectedPinsWithDnc=t=>{this.pinsSelectedWithDnc.forEach((i,r)=>{if(Boolean(t[r])){const l=t[r].deviceCoordinate.clone().sub(i.deviceCoordinate).multiplyScalar(.3);t[r].deviceCoordinate=i.deviceCoordinate.clone().add(l)}}),this.pinsSelectedWithDnc=t},this.polygonUpdate=t=>{console.log(t)}}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Ci({type:n,selectors:[["app-map-viewer"]],decls:7,vars:8,consts:[["class","legend pointer-events-none",3,"ngStyle",4,"ngIf"],["class","legend pointer-events-none",3,"ngStyle",4,"ngFor","ngForOf"],[1,"flex","flex-row","justify-between","absolute","pointer-events-none","w-full"],[1,"flex","flex-col",3,"changeCategoryOnCanvas"],[1,"flex","float-right","flex-col",3,"columnSettings","polygonSettings","pins","selectedPins","polygons","columnChanged","polygonChanged","pinSelected"],[1,"absolute","h-screen",3,"onPinSelected","hoverOnPin","selectedPinsWithDncEmitter"],["mapCanvas",""],[1,"legend","pointer-events-none",3,"ngStyle"]],template:function(t,i){if(1&t){const r=Gt();rt(0,Xne,2,5,"p",0),rt(1,Qne,2,5,"p",1),V(2,"div",2)(3,"app-category-picker",3),Ee("changeCategoryOnCanvas",function(o){return je(r),Yr(6).onCategoryChageFromPicker(o)}),Y(),V(4,"app-map-settings",4),Ee("columnChanged",function(o){return je(r),Yr(6).uiUpdatePin(o)})("polygonChanged",function(o){return je(r),Yr(6).uiUpdatePolygon(o)})("pinSelected",function(o){return i.onPinSelected(o)}),Y()(),V(5,"app-map-canvas",5,6),Ee("hoverOnPin",function(o){return i.changeHoverLegend(o)})("selectedPinsWithDncEmitter",function(o){return i.onSelectedPinsWithDnc(o)}),Y()}if(2&t){const r=Yr(6);ne("ngIf",i.hoverPin),ie(1),ne("ngForOf",i.pinsSelectedWithDnc),ie(3),ne("columnSettings",r.guiColumnSettings)("polygonSettings",r.guiPolygonSettings)("pins",r.pins)("selectedPins",r.selectedPins)("polygons",r.polygons),ie(1),ne("onPinSelected",i.pinSelected)}},directives:[Is,Rs,dd,mne,Ane,Yne],styles:[".legend[_ngcontent-%COMP%]{position:absolute;z-index:2;top:0px;float:left}.slidecontainer[_ngcontent-%COMP%]{display:block;float:left}app-map-canvas[_ngcontent-%COMP%]{left:0}"]}),n})()},{path:"dashboard",component:cne},{path:"**",redirectTo:"dashboard"}];let Kne=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Zi({type:n}),n.\u0275inj=ki({imports:[[xI.forRoot(Jne,{useHash:!0})],xI]}),n})(),Zne=(()=>{class n{constructor(){this.title="geostat-tw"}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Ci({type:n,selectors:[["app-root"]],decls:1,vars:0,template:function(t,i){1&t&&ct(0,"router-outlet")},directives:[P0],styles:[""]}),n})(),eie=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Zi({type:n,bootstrap:[Zne]}),n.\u0275inj=ki({providers:[],imports:[[sz,Kne,XW,Dte]]}),n})();(function qH(){CD=!1})(),iz().bootstrapModule(eie).catch(n=>console.error(n))}},qt=>{qt(qt.s=881)}]);